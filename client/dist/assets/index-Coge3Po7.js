function kN(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function AN(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var eS={exports:{}},cm={},tS={exports:{}},fr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wf=Symbol.for("react.element"),IN=Symbol.for("react.portal"),CN=Symbol.for("react.fragment"),NN=Symbol.for("react.strict_mode"),RN=Symbol.for("react.profiler"),PN=Symbol.for("react.provider"),jN=Symbol.for("react.context"),DN=Symbol.for("react.forward_ref"),FN=Symbol.for("react.suspense"),LN=Symbol.for("react.memo"),ON=Symbol.for("react.lazy"),Ry=Symbol.iterator;function MN(t){return t===null||typeof t!="object"?null:(t=Ry&&t[Ry]||t["@@iterator"],typeof t=="function"?t:null)}var rS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nS=Object.assign,sS={};function xu(t,e,r){this.props=t,this.context=e,this.refs=sS,this.updater=r||rS}xu.prototype.isReactComponent={};xu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};xu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function aS(){}aS.prototype=xu.prototype;function Zx(t,e,r){this.props=t,this.context=e,this.refs=sS,this.updater=r||rS}var e1=Zx.prototype=new aS;e1.constructor=Zx;nS(e1,xu.prototype);e1.isPureReactComponent=!0;var Py=Array.isArray,iS=Object.prototype.hasOwnProperty,t1={current:null},oS={key:!0,ref:!0,__self:!0,__source:!0};function lS(t,e,r){var n,s={},a=null,i=null;if(e!=null)for(n in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(a=""+e.key),e)iS.call(e,n)&&!oS.hasOwnProperty(n)&&(s[n]=e[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:wf,type:t,key:a,ref:i,props:s,_owner:t1.current}}function $N(t,e){return{$$typeof:wf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function r1(t){return typeof t=="object"&&t!==null&&t.$$typeof===wf}function UN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var jy=/\/+/g;function mp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?UN(""+t.key):e.toString(36)}function D0(t,e,r,n,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case wf:case IN:i=!0}}if(i)return i=t,s=s(i),t=n===""?"."+mp(i,0):n,Py(s)?(r="",t!=null&&(r=t.replace(jy,"$&/")+"/"),D0(s,e,r,"",function(u){return u})):s!=null&&(r1(s)&&(s=$N(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(jy,"$&/")+"/")+t)),e.push(s)),1;if(i=0,n=n===""?".":n+":",Py(t))for(var o=0;o<t.length;o++){a=t[o];var c=n+mp(a,o);i+=D0(a,e,r,c,s)}else if(c=MN(t),typeof c=="function")for(t=c.call(t),o=0;!(a=t.next()).done;)a=a.value,c=n+mp(a,o++),i+=D0(a,e,r,c,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Yf(t,e,r){if(t==null)return t;var n=[],s=0;return D0(t,n,"","",function(a){return e.call(r,a,s++)}),n}function VN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var $s={current:null},F0={transition:null},BN={ReactCurrentDispatcher:$s,ReactCurrentBatchConfig:F0,ReactCurrentOwner:t1};function cS(){throw Error("act(...) is not supported in production builds of React.")}fr.Children={map:Yf,forEach:function(t,e,r){Yf(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Yf(t,function(){e++}),e},toArray:function(t){return Yf(t,function(e){return e})||[]},only:function(t){if(!r1(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};fr.Component=xu;fr.Fragment=CN;fr.Profiler=RN;fr.PureComponent=Zx;fr.StrictMode=NN;fr.Suspense=FN;fr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BN;fr.act=cS;fr.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=nS({},t.props),s=t.key,a=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,i=t1.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(c in e)iS.call(e,c)&&!oS.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&o!==void 0?o[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:wf,type:t.type,key:s,ref:a,props:n,_owner:i}};fr.createContext=function(t){return t={$$typeof:jN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:PN,_context:t},t.Consumer=t};fr.createElement=lS;fr.createFactory=function(t){var e=lS.bind(null,t);return e.type=t,e};fr.createRef=function(){return{current:null}};fr.forwardRef=function(t){return{$$typeof:DN,render:t}};fr.isValidElement=r1;fr.lazy=function(t){return{$$typeof:ON,_payload:{_status:-1,_result:t},_init:VN}};fr.memo=function(t,e){return{$$typeof:LN,type:t,compare:e===void 0?null:e}};fr.startTransition=function(t){var e=F0.transition;F0.transition={};try{t()}finally{F0.transition=e}};fr.unstable_act=cS;fr.useCallback=function(t,e){return $s.current.useCallback(t,e)};fr.useContext=function(t){return $s.current.useContext(t)};fr.useDebugValue=function(){};fr.useDeferredValue=function(t){return $s.current.useDeferredValue(t)};fr.useEffect=function(t,e){return $s.current.useEffect(t,e)};fr.useId=function(){return $s.current.useId()};fr.useImperativeHandle=function(t,e,r){return $s.current.useImperativeHandle(t,e,r)};fr.useInsertionEffect=function(t,e){return $s.current.useInsertionEffect(t,e)};fr.useLayoutEffect=function(t,e){return $s.current.useLayoutEffect(t,e)};fr.useMemo=function(t,e){return $s.current.useMemo(t,e)};fr.useReducer=function(t,e,r){return $s.current.useReducer(t,e,r)};fr.useRef=function(t){return $s.current.useRef(t)};fr.useState=function(t){return $s.current.useState(t)};fr.useSyncExternalStore=function(t,e,r){return $s.current.useSyncExternalStore(t,e,r)};fr.useTransition=function(){return $s.current.useTransition()};fr.version="18.3.1";tS.exports=fr;var G=tS.exports;const uS=AN(G),zN=kN({__proto__:null,default:uS},[G]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WN=G,HN=Symbol.for("react.element"),GN=Symbol.for("react.fragment"),qN=Object.prototype.hasOwnProperty,KN=WN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,QN={key:!0,ref:!0,__self:!0,__source:!0};function dS(t,e,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(i=e.ref);for(n in e)qN.call(e,n)&&!QN.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:HN,type:t,key:a,ref:i,props:s,_owner:KN.current}}cm.Fragment=GN;cm.jsx=dS;cm.jsxs=dS;eS.exports=cm;var l=eS.exports,vg={},fS={exports:{}},pa={},hS={exports:{}},mS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ze,ie){var Ye=ze.length;ze.push(ie);e:for(;0<Ye;){var _e=Ye-1>>>1,Q=ze[_e];if(0<s(Q,ie))ze[_e]=ie,ze[Ye]=Q,Ye=_e;else break e}}function r(ze){return ze.length===0?null:ze[0]}function n(ze){if(ze.length===0)return null;var ie=ze[0],Ye=ze.pop();if(Ye!==ie){ze[0]=Ye;e:for(var _e=0,Q=ze.length,ae=Q>>>1;_e<ae;){var le=2*(_e+1)-1,ne=ze[le],Ae=le+1,st=ze[Ae];if(0>s(ne,Ye))Ae<Q&&0>s(st,ne)?(ze[_e]=st,ze[Ae]=Ye,_e=Ae):(ze[_e]=ne,ze[le]=Ye,_e=le);else if(Ae<Q&&0>s(st,Ye))ze[_e]=st,ze[Ae]=Ye,_e=Ae;else break e}}return ie}function s(ze,ie){var Ye=ze.sortIndex-ie.sortIndex;return Ye!==0?Ye:ze.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var c=[],u=[],d=1,h=null,m=3,p=!1,y=!1,v=!1,b=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(ze){for(var ie=r(u);ie!==null;){if(ie.callback===null)n(u);else if(ie.startTime<=ze)n(u),ie.sortIndex=ie.expirationTime,e(c,ie);else break;ie=r(u)}}function B(ze){if(v=!1,w(ze),!y)if(r(c)!==null)y=!0,ft(J);else{var ie=r(u);ie!==null&&rt(B,ie.startTime-ze)}}function J(ze,ie){y=!1,v&&(v=!1,E(I),I=-1),p=!0;var Ye=m;try{for(w(ie),h=r(c);h!==null&&(!(h.expirationTime>ie)||ze&&!F());){var _e=h.callback;if(typeof _e=="function"){h.callback=null,m=h.priorityLevel;var Q=_e(h.expirationTime<=ie);ie=t.unstable_now(),typeof Q=="function"?h.callback=Q:h===r(c)&&n(c),w(ie)}else n(c);h=r(c)}if(h!==null)var ae=!0;else{var le=r(u);le!==null&&rt(B,le.startTime-ie),ae=!1}return ae}finally{h=null,m=Ye,p=!1}}var Z=!1,_=null,I=-1,C=5,L=-1;function F(){return!(t.unstable_now()-L<C)}function V(){if(_!==null){var ze=t.unstable_now();L=ze;var ie=!0;try{ie=_(!0,ze)}finally{ie?O():(Z=!1,_=null)}}else Z=!1}var O;if(typeof T=="function")O=function(){T(V)};else if(typeof MessageChannel<"u"){var ct=new MessageChannel,me=ct.port2;ct.port1.onmessage=V,O=function(){me.postMessage(null)}}else O=function(){b(V,0)};function ft(ze){_=ze,Z||(Z=!0,O())}function rt(ze,ie){I=b(function(){ze(t.unstable_now())},ie)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ze){ze.callback=null},t.unstable_continueExecution=function(){y||p||(y=!0,ft(J))},t.unstable_forceFrameRate=function(ze){0>ze||125<ze?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<ze?Math.floor(1e3/ze):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(ze){switch(m){case 1:case 2:case 3:var ie=3;break;default:ie=m}var Ye=m;m=ie;try{return ze()}finally{m=Ye}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ze,ie){switch(ze){case 1:case 2:case 3:case 4:case 5:break;default:ze=3}var Ye=m;m=ze;try{return ie()}finally{m=Ye}},t.unstable_scheduleCallback=function(ze,ie,Ye){var _e=t.unstable_now();switch(typeof Ye=="object"&&Ye!==null?(Ye=Ye.delay,Ye=typeof Ye=="number"&&0<Ye?_e+Ye:_e):Ye=_e,ze){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=Ye+Q,ze={id:d++,callback:ie,priorityLevel:ze,startTime:Ye,expirationTime:Q,sortIndex:-1},Ye>_e?(ze.sortIndex=Ye,e(u,ze),r(c)===null&&ze===r(u)&&(v?(E(I),I=-1):v=!0,rt(B,Ye-_e))):(ze.sortIndex=Q,e(c,ze),y||p||(y=!0,ft(J))),ze},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(ze){var ie=m;return function(){var Ye=m;m=ie;try{return ze.apply(this,arguments)}finally{m=Ye}}}})(mS);hS.exports=mS;var XN=hS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YN=G,ha=XN;function lt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pS=new Set,Fd={};function Kl(t,e){tu(t,e),tu(t+"Capture",e)}function tu(t,e){for(Fd[t]=e,t=0;t<e.length;t++)pS.add(e[t])}var qi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),yg=Object.prototype.hasOwnProperty,JN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Dy={},Fy={};function ZN(t){return yg.call(Fy,t)?!0:yg.call(Dy,t)?!1:JN.test(t)?Fy[t]=!0:(Dy[t]=!0,!1)}function e3(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function t3(t,e,r,n){if(e===null||typeof e>"u"||e3(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Us(t,e,r,n,s,a,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=i}var is={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){is[t]=new Us(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];is[e]=new Us(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){is[t]=new Us(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){is[t]=new Us(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){is[t]=new Us(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){is[t]=new Us(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){is[t]=new Us(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){is[t]=new Us(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){is[t]=new Us(t,5,!1,t.toLowerCase(),null,!1,!1)});var n1=/[\-:]([a-z])/g;function s1(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(n1,s1);is[e]=new Us(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(n1,s1);is[e]=new Us(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(n1,s1);is[e]=new Us(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){is[t]=new Us(t,1,!1,t.toLowerCase(),null,!1,!1)});is.xlinkHref=new Us("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){is[t]=new Us(t,1,!1,t.toLowerCase(),null,!0,!0)});function a1(t,e,r,n){var s=is.hasOwnProperty(e)?is[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(t3(e,r,s,n)&&(r=null),n||s===null?ZN(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var ro=YN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Jf=Symbol.for("react.element"),Ec=Symbol.for("react.portal"),Tc=Symbol.for("react.fragment"),i1=Symbol.for("react.strict_mode"),wg=Symbol.for("react.profiler"),gS=Symbol.for("react.provider"),xS=Symbol.for("react.context"),o1=Symbol.for("react.forward_ref"),bg=Symbol.for("react.suspense"),_g=Symbol.for("react.suspense_list"),l1=Symbol.for("react.memo"),go=Symbol.for("react.lazy"),vS=Symbol.for("react.offscreen"),Ly=Symbol.iterator;function $u(t){return t===null||typeof t!="object"?null:(t=Ly&&t[Ly]||t["@@iterator"],typeof t=="function"?t:null)}var tn=Object.assign,pp;function Ku(t){if(pp===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);pp=e&&e[1]||""}return`
`+pp+t}var gp=!1;function xp(t,e){if(!t||gp)return"";gp=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var c=`
`+s[i].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=i&&0<=o);break}}}finally{gp=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ku(t):""}function r3(t){switch(t.tag){case 5:return Ku(t.type);case 16:return Ku("Lazy");case 13:return Ku("Suspense");case 19:return Ku("SuspenseList");case 0:case 2:case 15:return t=xp(t.type,!1),t;case 11:return t=xp(t.type.render,!1),t;case 1:return t=xp(t.type,!0),t;default:return""}}function Sg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Tc:return"Fragment";case Ec:return"Portal";case wg:return"Profiler";case i1:return"StrictMode";case bg:return"Suspense";case _g:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case xS:return(t.displayName||"Context")+".Consumer";case gS:return(t._context.displayName||"Context")+".Provider";case o1:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case l1:return e=t.displayName||null,e!==null?e:Sg(t.type)||"Memo";case go:e=t._payload,t=t._init;try{return Sg(t(e))}catch{}}return null}function n3(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Sg(e);case 8:return e===i1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Wo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function yS(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function s3(t){var e=yS(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Zf(t){t._valueTracker||(t._valueTracker=s3(t))}function wS(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=yS(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function rh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Eg(t,e){var r=e.checked;return tn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Oy(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Wo(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function bS(t,e){e=e.checked,e!=null&&a1(t,"checked",e,!1)}function Tg(t,e){bS(t,e);var r=Wo(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?kg(t,e.type,r):e.hasOwnProperty("defaultValue")&&kg(t,e.type,Wo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function My(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function kg(t,e,r){(e!=="number"||rh(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Qu=Array.isArray;function $c(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Wo(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Ag(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(lt(91));return tn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function $y(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(lt(92));if(Qu(r)){if(1<r.length)throw Error(lt(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Wo(r)}}function _S(t,e){var r=Wo(e.value),n=Wo(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Uy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function SS(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ig(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?SS(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var e0,ES=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(e0=e0||document.createElement("div"),e0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=e0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ld(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var ud={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},a3=["Webkit","ms","Moz","O"];Object.keys(ud).forEach(function(t){a3.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ud[e]=ud[t]})});function TS(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||ud.hasOwnProperty(t)&&ud[t]?(""+e).trim():e+"px"}function kS(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=TS(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var i3=tn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Cg(t,e){if(e){if(i3[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(lt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(lt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(lt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(lt(62))}}function Ng(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rg=null;function c1(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Pg=null,Uc=null,Vc=null;function Vy(t){if(t=Sf(t)){if(typeof Pg!="function")throw Error(lt(280));var e=t.stateNode;e&&(e=mm(e),Pg(t.stateNode,t.type,e))}}function AS(t){Uc?Vc?Vc.push(t):Vc=[t]:Uc=t}function IS(){if(Uc){var t=Uc,e=Vc;if(Vc=Uc=null,Vy(t),e)for(t=0;t<e.length;t++)Vy(e[t])}}function CS(t,e){return t(e)}function NS(){}var vp=!1;function RS(t,e,r){if(vp)return t(e,r);vp=!0;try{return CS(t,e,r)}finally{vp=!1,(Uc!==null||Vc!==null)&&(NS(),IS())}}function Od(t,e){var r=t.stateNode;if(r===null)return null;var n=mm(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(lt(231,e,typeof r));return r}var jg=!1;if(qi)try{var Uu={};Object.defineProperty(Uu,"passive",{get:function(){jg=!0}}),window.addEventListener("test",Uu,Uu),window.removeEventListener("test",Uu,Uu)}catch{jg=!1}function o3(t,e,r,n,s,a,i,o,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var dd=!1,nh=null,sh=!1,Dg=null,l3={onError:function(t){dd=!0,nh=t}};function c3(t,e,r,n,s,a,i,o,c){dd=!1,nh=null,o3.apply(l3,arguments)}function u3(t,e,r,n,s,a,i,o,c){if(c3.apply(this,arguments),dd){if(dd){var u=nh;dd=!1,nh=null}else throw Error(lt(198));sh||(sh=!0,Dg=u)}}function Ql(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function PS(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function By(t){if(Ql(t)!==t)throw Error(lt(188))}function d3(t){var e=t.alternate;if(!e){if(e=Ql(t),e===null)throw Error(lt(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return By(s),t;if(a===n)return By(s),e;a=a.sibling}throw Error(lt(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(lt(189))}}if(r.alternate!==n)throw Error(lt(190))}if(r.tag!==3)throw Error(lt(188));return r.stateNode.current===r?t:e}function jS(t){return t=d3(t),t!==null?DS(t):null}function DS(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=DS(t);if(e!==null)return e;t=t.sibling}return null}var FS=ha.unstable_scheduleCallback,zy=ha.unstable_cancelCallback,f3=ha.unstable_shouldYield,h3=ha.unstable_requestPaint,fn=ha.unstable_now,m3=ha.unstable_getCurrentPriorityLevel,u1=ha.unstable_ImmediatePriority,LS=ha.unstable_UserBlockingPriority,ah=ha.unstable_NormalPriority,p3=ha.unstable_LowPriority,OS=ha.unstable_IdlePriority,um=null,xi=null;function g3(t){if(xi&&typeof xi.onCommitFiberRoot=="function")try{xi.onCommitFiberRoot(um,t,void 0,(t.current.flags&128)===128)}catch{}}var Ya=Math.clz32?Math.clz32:y3,x3=Math.log,v3=Math.LN2;function y3(t){return t>>>=0,t===0?32:31-(x3(t)/v3|0)|0}var t0=64,r0=4194304;function Xu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ih(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,a=t.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=Xu(o):(a&=i,a!==0&&(n=Xu(a)))}else i=r&~s,i!==0?n=Xu(i):a!==0&&(n=Xu(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Ya(e),s=1<<r,n|=t[r],e&=~s;return n}function w3(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function b3(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var i=31-Ya(a),o=1<<i,c=s[i];c===-1?(!(o&r)||o&n)&&(s[i]=w3(o,e)):c<=e&&(t.expiredLanes|=o),a&=~o}}function Fg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function MS(){var t=t0;return t0<<=1,!(t0&4194240)&&(t0=64),t}function yp(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function bf(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ya(e),t[e]=r}function _3(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Ya(r),a=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~a}}function d1(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Ya(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var Pr=0;function $S(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var US,f1,VS,BS,zS,Lg=!1,n0=[],Ro=null,Po=null,jo=null,Md=new Map,$d=new Map,vo=[],S3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wy(t,e){switch(t){case"focusin":case"focusout":Ro=null;break;case"dragenter":case"dragleave":Po=null;break;case"mouseover":case"mouseout":jo=null;break;case"pointerover":case"pointerout":Md.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$d.delete(e.pointerId)}}function Vu(t,e,r,n,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},e!==null&&(e=Sf(e),e!==null&&f1(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function E3(t,e,r,n,s){switch(e){case"focusin":return Ro=Vu(Ro,t,e,r,n,s),!0;case"dragenter":return Po=Vu(Po,t,e,r,n,s),!0;case"mouseover":return jo=Vu(jo,t,e,r,n,s),!0;case"pointerover":var a=s.pointerId;return Md.set(a,Vu(Md.get(a)||null,t,e,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,$d.set(a,Vu($d.get(a)||null,t,e,r,n,s)),!0}return!1}function WS(t){var e=yl(t.target);if(e!==null){var r=Ql(e);if(r!==null){if(e=r.tag,e===13){if(e=PS(r),e!==null){t.blockedOn=e,zS(t.priority,function(){VS(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function L0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Og(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Rg=n,r.target.dispatchEvent(n),Rg=null}else return e=Sf(r),e!==null&&f1(e),t.blockedOn=r,!1;e.shift()}return!0}function Hy(t,e,r){L0(t)&&r.delete(e)}function T3(){Lg=!1,Ro!==null&&L0(Ro)&&(Ro=null),Po!==null&&L0(Po)&&(Po=null),jo!==null&&L0(jo)&&(jo=null),Md.forEach(Hy),$d.forEach(Hy)}function Bu(t,e){t.blockedOn===e&&(t.blockedOn=null,Lg||(Lg=!0,ha.unstable_scheduleCallback(ha.unstable_NormalPriority,T3)))}function Ud(t){function e(s){return Bu(s,t)}if(0<n0.length){Bu(n0[0],t);for(var r=1;r<n0.length;r++){var n=n0[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Ro!==null&&Bu(Ro,t),Po!==null&&Bu(Po,t),jo!==null&&Bu(jo,t),Md.forEach(e),$d.forEach(e),r=0;r<vo.length;r++)n=vo[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<vo.length&&(r=vo[0],r.blockedOn===null);)WS(r),r.blockedOn===null&&vo.shift()}var Bc=ro.ReactCurrentBatchConfig,oh=!0;function k3(t,e,r,n){var s=Pr,a=Bc.transition;Bc.transition=null;try{Pr=1,h1(t,e,r,n)}finally{Pr=s,Bc.transition=a}}function A3(t,e,r,n){var s=Pr,a=Bc.transition;Bc.transition=null;try{Pr=4,h1(t,e,r,n)}finally{Pr=s,Bc.transition=a}}function h1(t,e,r,n){if(oh){var s=Og(t,e,r,n);if(s===null)Cp(t,e,n,lh,r),Wy(t,n);else if(E3(s,t,e,r,n))n.stopPropagation();else if(Wy(t,n),e&4&&-1<S3.indexOf(t)){for(;s!==null;){var a=Sf(s);if(a!==null&&US(a),a=Og(t,e,r,n),a===null&&Cp(t,e,n,lh,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else Cp(t,e,n,null,r)}}var lh=null;function Og(t,e,r,n){if(lh=null,t=c1(n),t=yl(t),t!==null)if(e=Ql(t),e===null)t=null;else if(r=e.tag,r===13){if(t=PS(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return lh=t,null}function HS(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(m3()){case u1:return 1;case LS:return 4;case ah:case p3:return 16;case OS:return 536870912;default:return 16}default:return 16}}var To=null,m1=null,O0=null;function GS(){if(O0)return O0;var t,e=m1,r=e.length,n,s="value"in To?To.value:To.textContent,a=s.length;for(t=0;t<r&&e[t]===s[t];t++);var i=r-t;for(n=1;n<=i&&e[r-n]===s[a-n];n++);return O0=s.slice(t,1<n?1-n:void 0)}function M0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function s0(){return!0}function Gy(){return!1}function ga(t){function e(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?s0:Gy,this.isPropagationStopped=Gy,this}return tn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=s0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=s0)},persist:function(){},isPersistent:s0}),e}var vu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},p1=ga(vu),_f=tn({},vu,{view:0,detail:0}),I3=ga(_f),wp,bp,zu,dm=tn({},_f,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:g1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==zu&&(zu&&t.type==="mousemove"?(wp=t.screenX-zu.screenX,bp=t.screenY-zu.screenY):bp=wp=0,zu=t),wp)},movementY:function(t){return"movementY"in t?t.movementY:bp}}),qy=ga(dm),C3=tn({},dm,{dataTransfer:0}),N3=ga(C3),R3=tn({},_f,{relatedTarget:0}),_p=ga(R3),P3=tn({},vu,{animationName:0,elapsedTime:0,pseudoElement:0}),j3=ga(P3),D3=tn({},vu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),F3=ga(D3),L3=tn({},vu,{data:0}),Ky=ga(L3),O3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},M3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function U3(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=$3[t])?!!e[t]:!1}function g1(){return U3}var V3=tn({},_f,{key:function(t){if(t.key){var e=O3[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=M0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?M3[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:g1,charCode:function(t){return t.type==="keypress"?M0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?M0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),B3=ga(V3),z3=tn({},dm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qy=ga(z3),W3=tn({},_f,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:g1}),H3=ga(W3),G3=tn({},vu,{propertyName:0,elapsedTime:0,pseudoElement:0}),q3=ga(G3),K3=tn({},dm,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Q3=ga(K3),X3=[9,13,27,32],x1=qi&&"CompositionEvent"in window,fd=null;qi&&"documentMode"in document&&(fd=document.documentMode);var Y3=qi&&"TextEvent"in window&&!fd,qS=qi&&(!x1||fd&&8<fd&&11>=fd),Xy=" ",Yy=!1;function KS(t,e){switch(t){case"keyup":return X3.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function QS(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var kc=!1;function J3(t,e){switch(t){case"compositionend":return QS(e);case"keypress":return e.which!==32?null:(Yy=!0,Xy);case"textInput":return t=e.data,t===Xy&&Yy?null:t;default:return null}}function Z3(t,e){if(kc)return t==="compositionend"||!x1&&KS(t,e)?(t=GS(),O0=m1=To=null,kc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return qS&&e.locale!=="ko"?null:e.data;default:return null}}var e5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!e5[t.type]:e==="textarea"}function XS(t,e,r,n){AS(n),e=ch(e,"onChange"),0<e.length&&(r=new p1("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var hd=null,Vd=null;function t5(t){oE(t,0)}function fm(t){var e=Cc(t);if(wS(e))return t}function r5(t,e){if(t==="change")return e}var YS=!1;if(qi){var Sp;if(qi){var Ep="oninput"in document;if(!Ep){var Zy=document.createElement("div");Zy.setAttribute("oninput","return;"),Ep=typeof Zy.oninput=="function"}Sp=Ep}else Sp=!1;YS=Sp&&(!document.documentMode||9<document.documentMode)}function ew(){hd&&(hd.detachEvent("onpropertychange",JS),Vd=hd=null)}function JS(t){if(t.propertyName==="value"&&fm(Vd)){var e=[];XS(e,Vd,t,c1(t)),RS(t5,e)}}function n5(t,e,r){t==="focusin"?(ew(),hd=e,Vd=r,hd.attachEvent("onpropertychange",JS)):t==="focusout"&&ew()}function s5(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return fm(Vd)}function a5(t,e){if(t==="click")return fm(e)}function i5(t,e){if(t==="input"||t==="change")return fm(e)}function o5(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ei=typeof Object.is=="function"?Object.is:o5;function Bd(t,e){if(ei(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!yg.call(e,s)||!ei(t[s],e[s]))return!1}return!0}function tw(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function rw(t,e){var r=tw(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=tw(r)}}function ZS(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?ZS(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function eE(){for(var t=window,e=rh();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=rh(t.document)}return e}function v1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function l5(t){var e=eE(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&ZS(r.ownerDocument.documentElement,r)){if(n!==null&&v1(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!t.extend&&a>n&&(s=n,n=a,a=s),s=rw(r,a);var i=rw(r,n);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var c5=qi&&"documentMode"in document&&11>=document.documentMode,Ac=null,Mg=null,md=null,$g=!1;function nw(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;$g||Ac==null||Ac!==rh(n)||(n=Ac,"selectionStart"in n&&v1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),md&&Bd(md,n)||(md=n,n=ch(Mg,"onSelect"),0<n.length&&(e=new p1("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Ac)))}function a0(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Ic={animationend:a0("Animation","AnimationEnd"),animationiteration:a0("Animation","AnimationIteration"),animationstart:a0("Animation","AnimationStart"),transitionend:a0("Transition","TransitionEnd")},Tp={},tE={};qi&&(tE=document.createElement("div").style,"AnimationEvent"in window||(delete Ic.animationend.animation,delete Ic.animationiteration.animation,delete Ic.animationstart.animation),"TransitionEvent"in window||delete Ic.transitionend.transition);function hm(t){if(Tp[t])return Tp[t];if(!Ic[t])return t;var e=Ic[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in tE)return Tp[t]=e[r];return t}var rE=hm("animationend"),nE=hm("animationiteration"),sE=hm("animationstart"),aE=hm("transitionend"),iE=new Map,sw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function tl(t,e){iE.set(t,e),Kl(e,[t])}for(var kp=0;kp<sw.length;kp++){var Ap=sw[kp],u5=Ap.toLowerCase(),d5=Ap[0].toUpperCase()+Ap.slice(1);tl(u5,"on"+d5)}tl(rE,"onAnimationEnd");tl(nE,"onAnimationIteration");tl(sE,"onAnimationStart");tl("dblclick","onDoubleClick");tl("focusin","onFocus");tl("focusout","onBlur");tl(aE,"onTransitionEnd");tu("onMouseEnter",["mouseout","mouseover"]);tu("onMouseLeave",["mouseout","mouseover"]);tu("onPointerEnter",["pointerout","pointerover"]);tu("onPointerLeave",["pointerout","pointerover"]);Kl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Kl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Kl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Kl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Kl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Kl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),f5=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yu));function aw(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,u3(n,e,void 0,t),t.currentTarget=null}function oE(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var i=n.length-1;0<=i;i--){var o=n[i],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==a&&s.isPropagationStopped())break e;aw(s,o,u),a=c}else for(i=0;i<n.length;i++){if(o=n[i],c=o.instance,u=o.currentTarget,o=o.listener,c!==a&&s.isPropagationStopped())break e;aw(s,o,u),a=c}}}if(sh)throw t=Dg,sh=!1,Dg=null,t}function Br(t,e){var r=e[Wg];r===void 0&&(r=e[Wg]=new Set);var n=t+"__bubble";r.has(n)||(lE(e,t,2,!1),r.add(n))}function Ip(t,e,r){var n=0;e&&(n|=4),lE(r,t,n,e)}var i0="_reactListening"+Math.random().toString(36).slice(2);function zd(t){if(!t[i0]){t[i0]=!0,pS.forEach(function(r){r!=="selectionchange"&&(f5.has(r)||Ip(r,!1,t),Ip(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[i0]||(e[i0]=!0,Ip("selectionchange",!1,e))}}function lE(t,e,r,n){switch(HS(e)){case 1:var s=k3;break;case 4:s=A3;break;default:s=h1}r=s.bind(null,e,r,t),s=void 0,!jg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function Cp(t,e,r,n,s){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;o!==null;){if(i=yl(o),i===null)return;if(c=i.tag,c===5||c===6){n=a=i;continue e}o=o.parentNode}}n=n.return}RS(function(){var u=a,d=c1(r),h=[];e:{var m=iE.get(t);if(m!==void 0){var p=p1,y=t;switch(t){case"keypress":if(M0(r)===0)break e;case"keydown":case"keyup":p=B3;break;case"focusin":y="focus",p=_p;break;case"focusout":y="blur",p=_p;break;case"beforeblur":case"afterblur":p=_p;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=qy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=N3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=H3;break;case rE:case nE:case sE:p=j3;break;case aE:p=q3;break;case"scroll":p=I3;break;case"wheel":p=Q3;break;case"copy":case"cut":case"paste":p=F3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Qy}var v=(e&4)!==0,b=!v&&t==="scroll",E=v?m!==null?m+"Capture":null:m;v=[];for(var T=u,w;T!==null;){w=T;var B=w.stateNode;if(w.tag===5&&B!==null&&(w=B,E!==null&&(B=Od(T,E),B!=null&&v.push(Wd(T,B,w)))),b)break;T=T.return}0<v.length&&(m=new p(m,y,null,r,d),h.push({event:m,listeners:v}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",m&&r!==Rg&&(y=r.relatedTarget||r.fromElement)&&(yl(y)||y[Ki]))break e;if((p||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,p?(y=r.relatedTarget||r.toElement,p=u,y=y?yl(y):null,y!==null&&(b=Ql(y),y!==b||y.tag!==5&&y.tag!==6)&&(y=null)):(p=null,y=u),p!==y)){if(v=qy,B="onMouseLeave",E="onMouseEnter",T="mouse",(t==="pointerout"||t==="pointerover")&&(v=Qy,B="onPointerLeave",E="onPointerEnter",T="pointer"),b=p==null?m:Cc(p),w=y==null?m:Cc(y),m=new v(B,T+"leave",p,r,d),m.target=b,m.relatedTarget=w,B=null,yl(d)===u&&(v=new v(E,T+"enter",y,r,d),v.target=w,v.relatedTarget=b,B=v),b=B,p&&y)t:{for(v=p,E=y,T=0,w=v;w;w=pc(w))T++;for(w=0,B=E;B;B=pc(B))w++;for(;0<T-w;)v=pc(v),T--;for(;0<w-T;)E=pc(E),w--;for(;T--;){if(v===E||E!==null&&v===E.alternate)break t;v=pc(v),E=pc(E)}v=null}else v=null;p!==null&&iw(h,m,p,v,!1),y!==null&&b!==null&&iw(h,b,y,v,!0)}}e:{if(m=u?Cc(u):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var J=r5;else if(Jy(m))if(YS)J=i5;else{J=s5;var Z=n5}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(J=a5);if(J&&(J=J(t,u))){XS(h,J,r,d);break e}Z&&Z(t,m,u),t==="focusout"&&(Z=m._wrapperState)&&Z.controlled&&m.type==="number"&&kg(m,"number",m.value)}switch(Z=u?Cc(u):window,t){case"focusin":(Jy(Z)||Z.contentEditable==="true")&&(Ac=Z,Mg=u,md=null);break;case"focusout":md=Mg=Ac=null;break;case"mousedown":$g=!0;break;case"contextmenu":case"mouseup":case"dragend":$g=!1,nw(h,r,d);break;case"selectionchange":if(c5)break;case"keydown":case"keyup":nw(h,r,d)}var _;if(x1)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else kc?KS(t,r)&&(I="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(I="onCompositionStart");I&&(qS&&r.locale!=="ko"&&(kc||I!=="onCompositionStart"?I==="onCompositionEnd"&&kc&&(_=GS()):(To=d,m1="value"in To?To.value:To.textContent,kc=!0)),Z=ch(u,I),0<Z.length&&(I=new Ky(I,t,null,r,d),h.push({event:I,listeners:Z}),_?I.data=_:(_=QS(r),_!==null&&(I.data=_)))),(_=Y3?J3(t,r):Z3(t,r))&&(u=ch(u,"onBeforeInput"),0<u.length&&(d=new Ky("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:u}),d.data=_))}oE(h,e)})}function Wd(t,e,r){return{instance:t,listener:e,currentTarget:r}}function ch(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Od(t,r),a!=null&&n.unshift(Wd(t,a,s)),a=Od(t,e),a!=null&&n.push(Wd(t,a,s))),t=t.return}return n}function pc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function iw(t,e,r,n,s){for(var a=e._reactName,i=[];r!==null&&r!==n;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&u!==null&&(o=u,s?(c=Od(r,a),c!=null&&i.unshift(Wd(r,c,o))):s||(c=Od(r,a),c!=null&&i.push(Wd(r,c,o)))),r=r.return}i.length!==0&&t.push({event:e,listeners:i})}var h5=/\r\n?/g,m5=/\u0000|\uFFFD/g;function ow(t){return(typeof t=="string"?t:""+t).replace(h5,`
`).replace(m5,"")}function o0(t,e,r){if(e=ow(e),ow(t)!==e&&r)throw Error(lt(425))}function uh(){}var Ug=null,Vg=null;function Bg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var zg=typeof setTimeout=="function"?setTimeout:void 0,p5=typeof clearTimeout=="function"?clearTimeout:void 0,lw=typeof Promise=="function"?Promise:void 0,g5=typeof queueMicrotask=="function"?queueMicrotask:typeof lw<"u"?function(t){return lw.resolve(null).then(t).catch(x5)}:zg;function x5(t){setTimeout(function(){throw t})}function Np(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),Ud(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Ud(e)}function Do(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function cw(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var yu=Math.random().toString(36).slice(2),gi="__reactFiber$"+yu,Hd="__reactProps$"+yu,Ki="__reactContainer$"+yu,Wg="__reactEvents$"+yu,v5="__reactListeners$"+yu,y5="__reactHandles$"+yu;function yl(t){var e=t[gi];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ki]||r[gi]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=cw(t);t!==null;){if(r=t[gi])return r;t=cw(t)}return e}t=r,r=t.parentNode}return null}function Sf(t){return t=t[gi]||t[Ki],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Cc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(lt(33))}function mm(t){return t[Hd]||null}var Hg=[],Nc=-1;function rl(t){return{current:t}}function Wr(t){0>Nc||(t.current=Hg[Nc],Hg[Nc]=null,Nc--)}function Mr(t,e){Nc++,Hg[Nc]=t.current,t.current=e}var Ho={},_s=rl(Ho),Ys=rl(!1),Dl=Ho;function ru(t,e){var r=t.type.contextTypes;if(!r)return Ho;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Js(t){return t=t.childContextTypes,t!=null}function dh(){Wr(Ys),Wr(_s)}function uw(t,e,r){if(_s.current!==Ho)throw Error(lt(168));Mr(_s,e),Mr(Ys,r)}function cE(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(lt(108,n3(t)||"Unknown",s));return tn({},r,n)}function fh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ho,Dl=_s.current,Mr(_s,t),Mr(Ys,Ys.current),!0}function dw(t,e,r){var n=t.stateNode;if(!n)throw Error(lt(169));r?(t=cE(t,e,Dl),n.__reactInternalMemoizedMergedChildContext=t,Wr(Ys),Wr(_s),Mr(_s,t)):Wr(Ys),Mr(Ys,r)}var Oi=null,pm=!1,Rp=!1;function uE(t){Oi===null?Oi=[t]:Oi.push(t)}function w5(t){pm=!0,uE(t)}function nl(){if(!Rp&&Oi!==null){Rp=!0;var t=0,e=Pr;try{var r=Oi;for(Pr=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Oi=null,pm=!1}catch(s){throw Oi!==null&&(Oi=Oi.slice(t+1)),FS(u1,nl),s}finally{Pr=e,Rp=!1}}return null}var Rc=[],Pc=0,hh=null,mh=0,_a=[],Sa=0,Fl=null,Mi=1,$i="";function pl(t,e){Rc[Pc++]=mh,Rc[Pc++]=hh,hh=t,mh=e}function dE(t,e,r){_a[Sa++]=Mi,_a[Sa++]=$i,_a[Sa++]=Fl,Fl=t;var n=Mi;t=$i;var s=32-Ya(n)-1;n&=~(1<<s),r+=1;var a=32-Ya(e)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Mi=1<<32-Ya(e)+s|r<<s|n,$i=a+t}else Mi=1<<a|r<<s|n,$i=t}function y1(t){t.return!==null&&(pl(t,1),dE(t,1,0))}function w1(t){for(;t===hh;)hh=Rc[--Pc],Rc[Pc]=null,mh=Rc[--Pc],Rc[Pc]=null;for(;t===Fl;)Fl=_a[--Sa],_a[Sa]=null,$i=_a[--Sa],_a[Sa]=null,Mi=_a[--Sa],_a[Sa]=null}var da=null,ca=null,Kr=!1,Ha=null;function fE(t,e){var r=Ta(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function fw(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,da=t,ca=Do(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,da=t,ca=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Fl!==null?{id:Mi,overflow:$i}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Ta(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,da=t,ca=null,!0):!1;default:return!1}}function Gg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function qg(t){if(Kr){var e=ca;if(e){var r=e;if(!fw(t,e)){if(Gg(t))throw Error(lt(418));e=Do(r.nextSibling);var n=da;e&&fw(t,e)?fE(n,r):(t.flags=t.flags&-4097|2,Kr=!1,da=t)}}else{if(Gg(t))throw Error(lt(418));t.flags=t.flags&-4097|2,Kr=!1,da=t}}}function hw(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;da=t}function l0(t){if(t!==da)return!1;if(!Kr)return hw(t),Kr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Bg(t.type,t.memoizedProps)),e&&(e=ca)){if(Gg(t))throw hE(),Error(lt(418));for(;e;)fE(t,e),e=Do(e.nextSibling)}if(hw(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(lt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){ca=Do(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}ca=null}}else ca=da?Do(t.stateNode.nextSibling):null;return!0}function hE(){for(var t=ca;t;)t=Do(t.nextSibling)}function nu(){ca=da=null,Kr=!1}function b1(t){Ha===null?Ha=[t]:Ha.push(t)}var b5=ro.ReactCurrentBatchConfig;function Wu(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(lt(309));var n=r.stateNode}if(!n)throw Error(lt(147,t));var s=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},e._stringRef=a,e)}if(typeof t!="string")throw Error(lt(284));if(!r._owner)throw Error(lt(290,t))}return t}function c0(t,e){throw t=Object.prototype.toString.call(e),Error(lt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function mw(t){var e=t._init;return e(t._payload)}function mE(t){function e(E,T){if(t){var w=E.deletions;w===null?(E.deletions=[T],E.flags|=16):w.push(T)}}function r(E,T){if(!t)return null;for(;T!==null;)e(E,T),T=T.sibling;return null}function n(E,T){for(E=new Map;T!==null;)T.key!==null?E.set(T.key,T):E.set(T.index,T),T=T.sibling;return E}function s(E,T){return E=Mo(E,T),E.index=0,E.sibling=null,E}function a(E,T,w){return E.index=w,t?(w=E.alternate,w!==null?(w=w.index,w<T?(E.flags|=2,T):w):(E.flags|=2,T)):(E.flags|=1048576,T)}function i(E){return t&&E.alternate===null&&(E.flags|=2),E}function o(E,T,w,B){return T===null||T.tag!==6?(T=Mp(w,E.mode,B),T.return=E,T):(T=s(T,w),T.return=E,T)}function c(E,T,w,B){var J=w.type;return J===Tc?d(E,T,w.props.children,B,w.key):T!==null&&(T.elementType===J||typeof J=="object"&&J!==null&&J.$$typeof===go&&mw(J)===T.type)?(B=s(T,w.props),B.ref=Wu(E,T,w),B.return=E,B):(B=H0(w.type,w.key,w.props,null,E.mode,B),B.ref=Wu(E,T,w),B.return=E,B)}function u(E,T,w,B){return T===null||T.tag!==4||T.stateNode.containerInfo!==w.containerInfo||T.stateNode.implementation!==w.implementation?(T=$p(w,E.mode,B),T.return=E,T):(T=s(T,w.children||[]),T.return=E,T)}function d(E,T,w,B,J){return T===null||T.tag!==7?(T=Il(w,E.mode,B,J),T.return=E,T):(T=s(T,w),T.return=E,T)}function h(E,T,w){if(typeof T=="string"&&T!==""||typeof T=="number")return T=Mp(""+T,E.mode,w),T.return=E,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Jf:return w=H0(T.type,T.key,T.props,null,E.mode,w),w.ref=Wu(E,null,T),w.return=E,w;case Ec:return T=$p(T,E.mode,w),T.return=E,T;case go:var B=T._init;return h(E,B(T._payload),w)}if(Qu(T)||$u(T))return T=Il(T,E.mode,w,null),T.return=E,T;c0(E,T)}return null}function m(E,T,w,B){var J=T!==null?T.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return J!==null?null:o(E,T,""+w,B);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Jf:return w.key===J?c(E,T,w,B):null;case Ec:return w.key===J?u(E,T,w,B):null;case go:return J=w._init,m(E,T,J(w._payload),B)}if(Qu(w)||$u(w))return J!==null?null:d(E,T,w,B,null);c0(E,w)}return null}function p(E,T,w,B,J){if(typeof B=="string"&&B!==""||typeof B=="number")return E=E.get(w)||null,o(T,E,""+B,J);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case Jf:return E=E.get(B.key===null?w:B.key)||null,c(T,E,B,J);case Ec:return E=E.get(B.key===null?w:B.key)||null,u(T,E,B,J);case go:var Z=B._init;return p(E,T,w,Z(B._payload),J)}if(Qu(B)||$u(B))return E=E.get(w)||null,d(T,E,B,J,null);c0(T,B)}return null}function y(E,T,w,B){for(var J=null,Z=null,_=T,I=T=0,C=null;_!==null&&I<w.length;I++){_.index>I?(C=_,_=null):C=_.sibling;var L=m(E,_,w[I],B);if(L===null){_===null&&(_=C);break}t&&_&&L.alternate===null&&e(E,_),T=a(L,T,I),Z===null?J=L:Z.sibling=L,Z=L,_=C}if(I===w.length)return r(E,_),Kr&&pl(E,I),J;if(_===null){for(;I<w.length;I++)_=h(E,w[I],B),_!==null&&(T=a(_,T,I),Z===null?J=_:Z.sibling=_,Z=_);return Kr&&pl(E,I),J}for(_=n(E,_);I<w.length;I++)C=p(_,E,I,w[I],B),C!==null&&(t&&C.alternate!==null&&_.delete(C.key===null?I:C.key),T=a(C,T,I),Z===null?J=C:Z.sibling=C,Z=C);return t&&_.forEach(function(F){return e(E,F)}),Kr&&pl(E,I),J}function v(E,T,w,B){var J=$u(w);if(typeof J!="function")throw Error(lt(150));if(w=J.call(w),w==null)throw Error(lt(151));for(var Z=J=null,_=T,I=T=0,C=null,L=w.next();_!==null&&!L.done;I++,L=w.next()){_.index>I?(C=_,_=null):C=_.sibling;var F=m(E,_,L.value,B);if(F===null){_===null&&(_=C);break}t&&_&&F.alternate===null&&e(E,_),T=a(F,T,I),Z===null?J=F:Z.sibling=F,Z=F,_=C}if(L.done)return r(E,_),Kr&&pl(E,I),J;if(_===null){for(;!L.done;I++,L=w.next())L=h(E,L.value,B),L!==null&&(T=a(L,T,I),Z===null?J=L:Z.sibling=L,Z=L);return Kr&&pl(E,I),J}for(_=n(E,_);!L.done;I++,L=w.next())L=p(_,E,I,L.value,B),L!==null&&(t&&L.alternate!==null&&_.delete(L.key===null?I:L.key),T=a(L,T,I),Z===null?J=L:Z.sibling=L,Z=L);return t&&_.forEach(function(V){return e(E,V)}),Kr&&pl(E,I),J}function b(E,T,w,B){if(typeof w=="object"&&w!==null&&w.type===Tc&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Jf:e:{for(var J=w.key,Z=T;Z!==null;){if(Z.key===J){if(J=w.type,J===Tc){if(Z.tag===7){r(E,Z.sibling),T=s(Z,w.props.children),T.return=E,E=T;break e}}else if(Z.elementType===J||typeof J=="object"&&J!==null&&J.$$typeof===go&&mw(J)===Z.type){r(E,Z.sibling),T=s(Z,w.props),T.ref=Wu(E,Z,w),T.return=E,E=T;break e}r(E,Z);break}else e(E,Z);Z=Z.sibling}w.type===Tc?(T=Il(w.props.children,E.mode,B,w.key),T.return=E,E=T):(B=H0(w.type,w.key,w.props,null,E.mode,B),B.ref=Wu(E,T,w),B.return=E,E=B)}return i(E);case Ec:e:{for(Z=w.key;T!==null;){if(T.key===Z)if(T.tag===4&&T.stateNode.containerInfo===w.containerInfo&&T.stateNode.implementation===w.implementation){r(E,T.sibling),T=s(T,w.children||[]),T.return=E,E=T;break e}else{r(E,T);break}else e(E,T);T=T.sibling}T=$p(w,E.mode,B),T.return=E,E=T}return i(E);case go:return Z=w._init,b(E,T,Z(w._payload),B)}if(Qu(w))return y(E,T,w,B);if($u(w))return v(E,T,w,B);c0(E,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,T!==null&&T.tag===6?(r(E,T.sibling),T=s(T,w),T.return=E,E=T):(r(E,T),T=Mp(w,E.mode,B),T.return=E,E=T),i(E)):r(E,T)}return b}var su=mE(!0),pE=mE(!1),ph=rl(null),gh=null,jc=null,_1=null;function S1(){_1=jc=gh=null}function E1(t){var e=ph.current;Wr(ph),t._currentValue=e}function Kg(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function zc(t,e){gh=t,_1=jc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Xs=!0),t.firstContext=null)}function Aa(t){var e=t._currentValue;if(_1!==t)if(t={context:t,memoizedValue:e,next:null},jc===null){if(gh===null)throw Error(lt(308));jc=t,gh.dependencies={lanes:0,firstContext:t}}else jc=jc.next=t;return e}var wl=null;function T1(t){wl===null?wl=[t]:wl.push(t)}function gE(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,T1(e)):(r.next=s.next,s.next=r),e.interleaved=r,Qi(t,n)}function Qi(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var xo=!1;function k1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function zi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Fo(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Sr&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Qi(t,r)}return s=n.interleaved,s===null?(e.next=e,T1(n)):(e.next=s.next,s.next=e),n.interleaved=e,Qi(t,r)}function $0(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,d1(t,r)}}function pw(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=e:a=a.next=e}else s=a=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function xh(t,e,r,n){var s=t.updateQueue;xo=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var c=o,u=c.next;c.next=null,i===null?a=u:i.next=u,i=c;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==i&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(a!==null){var h=s.baseState;i=0,d=u=c=null,o=a;do{var m=o.lane,p=o.eventTime;if((n&m)===m){d!==null&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,v=o;switch(m=e,p=r,v.tag){case 1:if(y=v.payload,typeof y=="function"){h=y.call(p,h,m);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=v.payload,m=typeof y=="function"?y.call(p,h,m):y,m==null)break e;h=tn({},h,m);break e;case 2:xo=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[o]:m.push(o))}else p={eventTime:p,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=p,c=h):d=d.next=p,i|=m;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;m=o,o=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);Ol|=i,t.lanes=i,t.memoizedState=h}}function gw(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(lt(191,s));s.call(n)}}}var Ef={},vi=rl(Ef),Gd=rl(Ef),qd=rl(Ef);function bl(t){if(t===Ef)throw Error(lt(174));return t}function A1(t,e){switch(Mr(qd,e),Mr(Gd,t),Mr(vi,Ef),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ig(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ig(e,t)}Wr(vi),Mr(vi,e)}function au(){Wr(vi),Wr(Gd),Wr(qd)}function vE(t){bl(qd.current);var e=bl(vi.current),r=Ig(e,t.type);e!==r&&(Mr(Gd,t),Mr(vi,r))}function I1(t){Gd.current===t&&(Wr(vi),Wr(Gd))}var Jr=rl(0);function vh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Pp=[];function C1(){for(var t=0;t<Pp.length;t++)Pp[t]._workInProgressVersionPrimary=null;Pp.length=0}var U0=ro.ReactCurrentDispatcher,jp=ro.ReactCurrentBatchConfig,Ll=0,en=null,jn=null,zn=null,yh=!1,pd=!1,Kd=0,_5=0;function us(){throw Error(lt(321))}function N1(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!ei(t[r],e[r]))return!1;return!0}function R1(t,e,r,n,s,a){if(Ll=a,en=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,U0.current=t===null||t.memoizedState===null?k5:A5,t=r(n,s),pd){a=0;do{if(pd=!1,Kd=0,25<=a)throw Error(lt(301));a+=1,zn=jn=null,e.updateQueue=null,U0.current=I5,t=r(n,s)}while(pd)}if(U0.current=wh,e=jn!==null&&jn.next!==null,Ll=0,zn=jn=en=null,yh=!1,e)throw Error(lt(300));return t}function P1(){var t=Kd!==0;return Kd=0,t}function mi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zn===null?en.memoizedState=zn=t:zn=zn.next=t,zn}function Ia(){if(jn===null){var t=en.alternate;t=t!==null?t.memoizedState:null}else t=jn.next;var e=zn===null?en.memoizedState:zn.next;if(e!==null)zn=e,jn=t;else{if(t===null)throw Error(lt(310));jn=t,t={memoizedState:jn.memoizedState,baseState:jn.baseState,baseQueue:jn.baseQueue,queue:jn.queue,next:null},zn===null?en.memoizedState=zn=t:zn=zn.next=t}return zn}function Qd(t,e){return typeof e=="function"?e(t):e}function Dp(t){var e=Ia(),r=e.queue;if(r===null)throw Error(lt(311));r.lastRenderedReducer=t;var n=jn,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,c=null,u=a;do{var d=u.lane;if((Ll&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=h,i=n):c=c.next=h,en.lanes|=d,Ol|=d}u=u.next}while(u!==null&&u!==a);c===null?i=n:c.next=o,ei(n,e.memoizedState)||(Xs=!0),e.memoizedState=n,e.baseState=i,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do a=s.lane,en.lanes|=a,Ol|=a,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Fp(t){var e=Ia(),r=e.queue;if(r===null)throw Error(lt(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,a=e.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=t(a,i.action),i=i.next;while(i!==s);ei(a,e.memoizedState)||(Xs=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function yE(){}function wE(t,e){var r=en,n=Ia(),s=e(),a=!ei(n.memoizedState,s);if(a&&(n.memoizedState=s,Xs=!0),n=n.queue,j1(SE.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||zn!==null&&zn.memoizedState.tag&1){if(r.flags|=2048,Xd(9,_E.bind(null,r,n,s,e),void 0,null),Wn===null)throw Error(lt(349));Ll&30||bE(r,e,s)}return s}function bE(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=en.updateQueue,e===null?(e={lastEffect:null,stores:null},en.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function _E(t,e,r,n){e.value=r,e.getSnapshot=n,EE(e)&&TE(t)}function SE(t,e,r){return r(function(){EE(e)&&TE(t)})}function EE(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!ei(t,r)}catch{return!0}}function TE(t){var e=Qi(t,1);e!==null&&Ja(e,t,1,-1)}function xw(t){var e=mi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qd,lastRenderedState:t},e.queue=t,t=t.dispatch=T5.bind(null,en,t),[e.memoizedState,t]}function Xd(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=en.updateQueue,e===null?(e={lastEffect:null,stores:null},en.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function kE(){return Ia().memoizedState}function V0(t,e,r,n){var s=mi();en.flags|=t,s.memoizedState=Xd(1|e,r,void 0,n===void 0?null:n)}function gm(t,e,r,n){var s=Ia();n=n===void 0?null:n;var a=void 0;if(jn!==null){var i=jn.memoizedState;if(a=i.destroy,n!==null&&N1(n,i.deps)){s.memoizedState=Xd(e,r,a,n);return}}en.flags|=t,s.memoizedState=Xd(1|e,r,a,n)}function vw(t,e){return V0(8390656,8,t,e)}function j1(t,e){return gm(2048,8,t,e)}function AE(t,e){return gm(4,2,t,e)}function IE(t,e){return gm(4,4,t,e)}function CE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function NE(t,e,r){return r=r!=null?r.concat([t]):null,gm(4,4,CE.bind(null,e,t),r)}function D1(){}function RE(t,e){var r=Ia();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&N1(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function PE(t,e){var r=Ia();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&N1(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function jE(t,e,r){return Ll&21?(ei(r,e)||(r=MS(),en.lanes|=r,Ol|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Xs=!0),t.memoizedState=r)}function S5(t,e){var r=Pr;Pr=r!==0&&4>r?r:4,t(!0);var n=jp.transition;jp.transition={};try{t(!1),e()}finally{Pr=r,jp.transition=n}}function DE(){return Ia().memoizedState}function E5(t,e,r){var n=Oo(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},FE(t))LE(e,r);else if(r=gE(t,e,r,n),r!==null){var s=Fs();Ja(r,t,n,s),OE(r,e,n)}}function T5(t,e,r){var n=Oo(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(FE(t))LE(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var i=e.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,ei(o,i)){var c=e.interleaved;c===null?(s.next=s,T1(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}r=gE(t,e,s,n),r!==null&&(s=Fs(),Ja(r,t,n,s),OE(r,e,n))}}function FE(t){var e=t.alternate;return t===en||e!==null&&e===en}function LE(t,e){pd=yh=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function OE(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,d1(t,r)}}var wh={readContext:Aa,useCallback:us,useContext:us,useEffect:us,useImperativeHandle:us,useInsertionEffect:us,useLayoutEffect:us,useMemo:us,useReducer:us,useRef:us,useState:us,useDebugValue:us,useDeferredValue:us,useTransition:us,useMutableSource:us,useSyncExternalStore:us,useId:us,unstable_isNewReconciler:!1},k5={readContext:Aa,useCallback:function(t,e){return mi().memoizedState=[t,e===void 0?null:e],t},useContext:Aa,useEffect:vw,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,V0(4194308,4,CE.bind(null,e,t),r)},useLayoutEffect:function(t,e){return V0(4194308,4,t,e)},useInsertionEffect:function(t,e){return V0(4,2,t,e)},useMemo:function(t,e){var r=mi();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=mi();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=E5.bind(null,en,t),[n.memoizedState,t]},useRef:function(t){var e=mi();return t={current:t},e.memoizedState=t},useState:xw,useDebugValue:D1,useDeferredValue:function(t){return mi().memoizedState=t},useTransition:function(){var t=xw(!1),e=t[0];return t=S5.bind(null,t[1]),mi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=en,s=mi();if(Kr){if(r===void 0)throw Error(lt(407));r=r()}else{if(r=e(),Wn===null)throw Error(lt(349));Ll&30||bE(n,e,r)}s.memoizedState=r;var a={value:r,getSnapshot:e};return s.queue=a,vw(SE.bind(null,n,a,t),[t]),n.flags|=2048,Xd(9,_E.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=mi(),e=Wn.identifierPrefix;if(Kr){var r=$i,n=Mi;r=(n&~(1<<32-Ya(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Kd++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=_5++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},A5={readContext:Aa,useCallback:RE,useContext:Aa,useEffect:j1,useImperativeHandle:NE,useInsertionEffect:AE,useLayoutEffect:IE,useMemo:PE,useReducer:Dp,useRef:kE,useState:function(){return Dp(Qd)},useDebugValue:D1,useDeferredValue:function(t){var e=Ia();return jE(e,jn.memoizedState,t)},useTransition:function(){var t=Dp(Qd)[0],e=Ia().memoizedState;return[t,e]},useMutableSource:yE,useSyncExternalStore:wE,useId:DE,unstable_isNewReconciler:!1},I5={readContext:Aa,useCallback:RE,useContext:Aa,useEffect:j1,useImperativeHandle:NE,useInsertionEffect:AE,useLayoutEffect:IE,useMemo:PE,useReducer:Fp,useRef:kE,useState:function(){return Fp(Qd)},useDebugValue:D1,useDeferredValue:function(t){var e=Ia();return jn===null?e.memoizedState=t:jE(e,jn.memoizedState,t)},useTransition:function(){var t=Fp(Qd)[0],e=Ia().memoizedState;return[t,e]},useMutableSource:yE,useSyncExternalStore:wE,useId:DE,unstable_isNewReconciler:!1};function za(t,e){if(t&&t.defaultProps){e=tn({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Qg(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:tn({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var xm={isMounted:function(t){return(t=t._reactInternals)?Ql(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Fs(),s=Oo(t),a=zi(n,s);a.payload=e,r!=null&&(a.callback=r),e=Fo(t,a,s),e!==null&&(Ja(e,t,s,n),$0(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Fs(),s=Oo(t),a=zi(n,s);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=Fo(t,a,s),e!==null&&(Ja(e,t,s,n),$0(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Fs(),n=Oo(t),s=zi(r,n);s.tag=2,e!=null&&(s.callback=e),e=Fo(t,s,n),e!==null&&(Ja(e,t,n,r),$0(e,t,n))}};function yw(t,e,r,n,s,a,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,i):e.prototype&&e.prototype.isPureReactComponent?!Bd(r,n)||!Bd(s,a):!0}function ME(t,e,r){var n=!1,s=Ho,a=e.contextType;return typeof a=="object"&&a!==null?a=Aa(a):(s=Js(e)?Dl:_s.current,n=e.contextTypes,a=(n=n!=null)?ru(t,s):Ho),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=xm,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function ww(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&xm.enqueueReplaceState(e,e.state,null)}function Xg(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},k1(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=Aa(a):(a=Js(e)?Dl:_s.current,s.context=ru(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(Qg(t,e,a,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&xm.enqueueReplaceState(s,s.state,null),xh(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function iu(t,e){try{var r="",n=e;do r+=r3(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function Lp(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Yg(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var C5=typeof WeakMap=="function"?WeakMap:Map;function $E(t,e,r){r=zi(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){_h||(_h=!0,ox=n),Yg(t,e)},r}function UE(t,e,r){r=zi(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){Yg(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Yg(t,e),typeof n!="function"&&(Lo===null?Lo=new Set([this]):Lo.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),r}function bw(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new C5;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=z5.bind(null,t,e,r),e.then(t,t))}function _w(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Sw(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=zi(-1,1),e.tag=2,Fo(r,e,1))),r.lanes|=1),t)}var N5=ro.ReactCurrentOwner,Xs=!1;function Rs(t,e,r,n){e.child=t===null?pE(e,null,r,n):su(e,t.child,r,n)}function Ew(t,e,r,n,s){r=r.render;var a=e.ref;return zc(e,s),n=R1(t,e,r,n,a,s),r=P1(),t!==null&&!Xs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Xi(t,e,s)):(Kr&&r&&y1(e),e.flags|=1,Rs(t,e,n,s),e.child)}function Tw(t,e,r,n,s){if(t===null){var a=r.type;return typeof a=="function"&&!B1(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,VE(t,e,a,n,s)):(t=H0(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Bd,r(i,n)&&t.ref===e.ref)return Xi(t,e,s)}return e.flags|=1,t=Mo(a,n),t.ref=e.ref,t.return=e,e.child=t}function VE(t,e,r,n,s){if(t!==null){var a=t.memoizedProps;if(Bd(a,n)&&t.ref===e.ref)if(Xs=!1,e.pendingProps=n=a,(t.lanes&s)!==0)t.flags&131072&&(Xs=!0);else return e.lanes=t.lanes,Xi(t,e,s)}return Jg(t,e,r,n,s)}function BE(t,e,r){var n=e.pendingProps,s=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mr(Fc,aa),aa|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Mr(Fc,aa),aa|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Mr(Fc,aa),aa|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,Mr(Fc,aa),aa|=n;return Rs(t,e,s,r),e.child}function zE(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Jg(t,e,r,n,s){var a=Js(r)?Dl:_s.current;return a=ru(e,a),zc(e,s),r=R1(t,e,r,n,a,s),n=P1(),t!==null&&!Xs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Xi(t,e,s)):(Kr&&n&&y1(e),e.flags|=1,Rs(t,e,r,s),e.child)}function kw(t,e,r,n,s){if(Js(r)){var a=!0;fh(e)}else a=!1;if(zc(e,s),e.stateNode===null)B0(t,e),ME(e,r,n),Xg(e,r,n,s),n=!0;else if(t===null){var i=e.stateNode,o=e.memoizedProps;i.props=o;var c=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=Aa(u):(u=Js(r)?Dl:_s.current,u=ru(e,u));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||c!==u)&&ww(e,i,n,u),xo=!1;var m=e.memoizedState;i.state=m,xh(e,n,i,s),c=e.memoizedState,o!==n||m!==c||Ys.current||xo?(typeof d=="function"&&(Qg(e,r,d,n),c=e.memoizedState),(o=xo||yw(e,r,o,n,m,c,u))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),i.props=n,i.state=c,i.context=u,n=o):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{i=e.stateNode,xE(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:za(e.type,o),i.props=u,h=e.pendingProps,m=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=Aa(c):(c=Js(r)?Dl:_s.current,c=ru(e,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==h||m!==c)&&ww(e,i,n,c),xo=!1,m=e.memoizedState,i.state=m,xh(e,n,i,s);var y=e.memoizedState;o!==h||m!==y||Ys.current||xo?(typeof p=="function"&&(Qg(e,r,p,n),y=e.memoizedState),(u=xo||yw(e,r,u,n,m,y,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,y,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,y,c)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=y),i.props=n,i.state=y,i.context=c,n=u):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),n=!1)}return Zg(t,e,r,n,a,s)}function Zg(t,e,r,n,s,a){zE(t,e);var i=(e.flags&128)!==0;if(!n&&!i)return s&&dw(e,r,!1),Xi(t,e,a);n=e.stateNode,N5.current=e;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&i?(e.child=su(e,t.child,null,a),e.child=su(e,null,o,a)):Rs(t,e,o,a),e.memoizedState=n.state,s&&dw(e,r,!0),e.child}function WE(t){var e=t.stateNode;e.pendingContext?uw(t,e.pendingContext,e.pendingContext!==e.context):e.context&&uw(t,e.context,!1),A1(t,e.containerInfo)}function Aw(t,e,r,n,s){return nu(),b1(s),e.flags|=256,Rs(t,e,r,n),e.child}var ex={dehydrated:null,treeContext:null,retryLane:0};function tx(t){return{baseLanes:t,cachePool:null,transitions:null}}function HE(t,e,r){var n=e.pendingProps,s=Jr.current,a=!1,i=(e.flags&128)!==0,o;if((o=i)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Mr(Jr,s&1),t===null)return qg(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=n.children,t=n.fallback,a?(n=e.mode,a=e.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=wm(i,n,0,null),t=Il(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=tx(r),e.memoizedState=ex,t):F1(e,i));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return R5(t,e,i,n,o,s,r);if(a){a=n.fallback,i=e.mode,s=t.child,o=s.sibling;var c={mode:"hidden",children:n.children};return!(i&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Mo(s,c),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=Mo(o,a):(a=Il(a,i,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,i=t.child.memoizedState,i=i===null?tx(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=t.childLanes&~r,e.memoizedState=ex,n}return a=t.child,t=a.sibling,n=Mo(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function F1(t,e){return e=wm({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function u0(t,e,r,n){return n!==null&&b1(n),su(e,t.child,null,r),t=F1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function R5(t,e,r,n,s,a,i){if(r)return e.flags&256?(e.flags&=-257,n=Lp(Error(lt(422))),u0(t,e,i,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,s=e.mode,n=wm({mode:"visible",children:n.children},s,0,null),a=Il(a,s,i,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&su(e,t.child,null,i),e.child.memoizedState=tx(i),e.memoizedState=ex,a);if(!(e.mode&1))return u0(t,e,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(lt(419)),n=Lp(a,n,void 0),u0(t,e,i,n)}if(o=(i&t.childLanes)!==0,Xs||o){if(n=Wn,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Qi(t,s),Ja(n,t,s,-1))}return V1(),n=Lp(Error(lt(421))),u0(t,e,i,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=W5.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,ca=Do(s.nextSibling),da=e,Kr=!0,Ha=null,t!==null&&(_a[Sa++]=Mi,_a[Sa++]=$i,_a[Sa++]=Fl,Mi=t.id,$i=t.overflow,Fl=e),e=F1(e,n.children),e.flags|=4096,e)}function Iw(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Kg(t.return,e,r)}function Op(t,e,r,n,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function GE(t,e,r){var n=e.pendingProps,s=n.revealOrder,a=n.tail;if(Rs(t,e,n.children,r),n=Jr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Iw(t,r,e);else if(t.tag===19)Iw(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Mr(Jr,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&vh(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),Op(e,!1,s,r,a);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&vh(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}Op(e,!0,r,null,a);break;case"together":Op(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function B0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Xi(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ol|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(lt(153));if(e.child!==null){for(t=e.child,r=Mo(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Mo(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function P5(t,e,r){switch(e.tag){case 3:WE(e),nu();break;case 5:vE(e);break;case 1:Js(e.type)&&fh(e);break;case 4:A1(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Mr(ph,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Mr(Jr,Jr.current&1),e.flags|=128,null):r&e.child.childLanes?HE(t,e,r):(Mr(Jr,Jr.current&1),t=Xi(t,e,r),t!==null?t.sibling:null);Mr(Jr,Jr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return GE(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Mr(Jr,Jr.current),n)break;return null;case 22:case 23:return e.lanes=0,BE(t,e,r)}return Xi(t,e,r)}var qE,rx,KE,QE;qE=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};rx=function(){};KE=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,bl(vi.current);var a=null;switch(r){case"input":s=Eg(t,s),n=Eg(t,n),a=[];break;case"select":s=tn({},s,{value:void 0}),n=tn({},n,{value:void 0}),a=[];break;case"textarea":s=Ag(t,s),n=Ag(t,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=uh)}Cg(r,n);var i;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Fd.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(o=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Fd.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Br("scroll",t),a||o===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(e.updateQueue=u)&&(e.flags|=4)}};QE=function(t,e,r,n){r!==n&&(e.flags|=4)};function Hu(t,e){if(!Kr)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function ds(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function j5(t,e,r){var n=e.pendingProps;switch(w1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ds(e),null;case 1:return Js(e.type)&&dh(),ds(e),null;case 3:return n=e.stateNode,au(),Wr(Ys),Wr(_s),C1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(l0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ha!==null&&(ux(Ha),Ha=null))),rx(t,e),ds(e),null;case 5:I1(e);var s=bl(qd.current);if(r=e.type,t!==null&&e.stateNode!=null)KE(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(lt(166));return ds(e),null}if(t=bl(vi.current),l0(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[gi]=e,n[Hd]=a,t=(e.mode&1)!==0,r){case"dialog":Br("cancel",n),Br("close",n);break;case"iframe":case"object":case"embed":Br("load",n);break;case"video":case"audio":for(s=0;s<Yu.length;s++)Br(Yu[s],n);break;case"source":Br("error",n);break;case"img":case"image":case"link":Br("error",n),Br("load",n);break;case"details":Br("toggle",n);break;case"input":Oy(n,a),Br("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Br("invalid",n);break;case"textarea":$y(n,a),Br("invalid",n)}Cg(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&o0(n.textContent,o,t),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&o0(n.textContent,o,t),s=["children",""+o]):Fd.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Br("scroll",n)}switch(r){case"input":Zf(n),My(n,a,!0);break;case"textarea":Zf(n),Uy(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=uh)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=SS(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=i.createElement(r,{is:n.is}):(t=i.createElement(r),r==="select"&&(i=t,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):t=i.createElementNS(t,r),t[gi]=e,t[Hd]=n,qE(t,e,!1,!1),e.stateNode=t;e:{switch(i=Ng(r,n),r){case"dialog":Br("cancel",t),Br("close",t),s=n;break;case"iframe":case"object":case"embed":Br("load",t),s=n;break;case"video":case"audio":for(s=0;s<Yu.length;s++)Br(Yu[s],t);s=n;break;case"source":Br("error",t),s=n;break;case"img":case"image":case"link":Br("error",t),Br("load",t),s=n;break;case"details":Br("toggle",t),s=n;break;case"input":Oy(t,n),s=Eg(t,n),Br("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=tn({},n,{value:void 0}),Br("invalid",t);break;case"textarea":$y(t,n),s=Ag(t,n),Br("invalid",t);break;default:s=n}Cg(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="style"?kS(t,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ES(t,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Ld(t,c):typeof c=="number"&&Ld(t,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Fd.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Br("scroll",t):c!=null&&a1(t,a,c,i))}switch(r){case"input":Zf(t),My(t,n,!1);break;case"textarea":Zf(t),Uy(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Wo(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?$c(t,!!n.multiple,a,!1):n.defaultValue!=null&&$c(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=uh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ds(e),null;case 6:if(t&&e.stateNode!=null)QE(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(lt(166));if(r=bl(qd.current),bl(vi.current),l0(e)){if(n=e.stateNode,r=e.memoizedProps,n[gi]=e,(a=n.nodeValue!==r)&&(t=da,t!==null))switch(t.tag){case 3:o0(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&o0(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[gi]=e,e.stateNode=n}return ds(e),null;case 13:if(Wr(Jr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Kr&&ca!==null&&e.mode&1&&!(e.flags&128))hE(),nu(),e.flags|=98560,a=!1;else if(a=l0(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(lt(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(lt(317));a[gi]=e}else nu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ds(e),a=!1}else Ha!==null&&(ux(Ha),Ha=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Jr.current&1?Fn===0&&(Fn=3):V1())),e.updateQueue!==null&&(e.flags|=4),ds(e),null);case 4:return au(),rx(t,e),t===null&&zd(e.stateNode.containerInfo),ds(e),null;case 10:return E1(e.type._context),ds(e),null;case 17:return Js(e.type)&&dh(),ds(e),null;case 19:if(Wr(Jr),a=e.memoizedState,a===null)return ds(e),null;if(n=(e.flags&128)!==0,i=a.rendering,i===null)if(n)Hu(a,!1);else{if(Fn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=vh(t),i!==null){for(e.flags|=128,Hu(a,!1),n=i.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,t=i.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Mr(Jr,Jr.current&1|2),e.child}t=t.sibling}a.tail!==null&&fn()>ou&&(e.flags|=128,n=!0,Hu(a,!1),e.lanes=4194304)}else{if(!n)if(t=vh(i),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Hu(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!Kr)return ds(e),null}else 2*fn()-a.renderingStartTime>ou&&r!==1073741824&&(e.flags|=128,n=!0,Hu(a,!1),e.lanes=4194304);a.isBackwards?(i.sibling=e.child,e.child=i):(r=a.last,r!==null?r.sibling=i:e.child=i,a.last=i)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=fn(),e.sibling=null,r=Jr.current,Mr(Jr,n?r&1|2:r&1),e):(ds(e),null);case 22:case 23:return U1(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?aa&1073741824&&(ds(e),e.subtreeFlags&6&&(e.flags|=8192)):ds(e),null;case 24:return null;case 25:return null}throw Error(lt(156,e.tag))}function D5(t,e){switch(w1(e),e.tag){case 1:return Js(e.type)&&dh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return au(),Wr(Ys),Wr(_s),C1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return I1(e),null;case 13:if(Wr(Jr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(lt(340));nu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Wr(Jr),null;case 4:return au(),null;case 10:return E1(e.type._context),null;case 22:case 23:return U1(),null;case 24:return null;default:return null}}var d0=!1,xs=!1,F5=typeof WeakSet=="function"?WeakSet:Set,Ct=null;function Dc(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){an(t,e,n)}else r.current=null}function nx(t,e,r){try{r()}catch(n){an(t,e,n)}}var Cw=!1;function L5(t,e){if(Ug=oh,t=eE(),v1(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,c=-1,u=0,d=0,h=t,m=null;t:for(;;){for(var p;h!==r||s!==0&&h.nodeType!==3||(o=i+s),h!==a||n!==0&&h.nodeType!==3||(c=i+n),h.nodeType===3&&(i+=h.nodeValue.length),(p=h.firstChild)!==null;)m=h,h=p;for(;;){if(h===t)break t;if(m===r&&++u===s&&(o=i),m===a&&++d===n&&(c=i),(p=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=p}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Vg={focusedElem:t,selectionRange:r},oh=!1,Ct=e;Ct!==null;)if(e=Ct,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ct=t;else for(;Ct!==null;){e=Ct;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var v=y.memoizedProps,b=y.memoizedState,E=e.stateNode,T=E.getSnapshotBeforeUpdate(e.elementType===e.type?v:za(e.type,v),b);E.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(lt(163))}}catch(B){an(e,e.return,B)}if(t=e.sibling,t!==null){t.return=e.return,Ct=t;break}Ct=e.return}return y=Cw,Cw=!1,y}function gd(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&nx(e,r,a)}s=s.next}while(s!==n)}}function vm(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function sx(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function XE(t){var e=t.alternate;e!==null&&(t.alternate=null,XE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[gi],delete e[Hd],delete e[Wg],delete e[v5],delete e[y5])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function YE(t){return t.tag===5||t.tag===3||t.tag===4}function Nw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||YE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ax(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=uh));else if(n!==4&&(t=t.child,t!==null))for(ax(t,e,r),t=t.sibling;t!==null;)ax(t,e,r),t=t.sibling}function ix(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(ix(t,e,r),t=t.sibling;t!==null;)ix(t,e,r),t=t.sibling}var Jn=null,Wa=!1;function fo(t,e,r){for(r=r.child;r!==null;)JE(t,e,r),r=r.sibling}function JE(t,e,r){if(xi&&typeof xi.onCommitFiberUnmount=="function")try{xi.onCommitFiberUnmount(um,r)}catch{}switch(r.tag){case 5:xs||Dc(r,e);case 6:var n=Jn,s=Wa;Jn=null,fo(t,e,r),Jn=n,Wa=s,Jn!==null&&(Wa?(t=Jn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Jn.removeChild(r.stateNode));break;case 18:Jn!==null&&(Wa?(t=Jn,r=r.stateNode,t.nodeType===8?Np(t.parentNode,r):t.nodeType===1&&Np(t,r),Ud(t)):Np(Jn,r.stateNode));break;case 4:n=Jn,s=Wa,Jn=r.stateNode.containerInfo,Wa=!0,fo(t,e,r),Jn=n,Wa=s;break;case 0:case 11:case 14:case 15:if(!xs&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&nx(r,e,i),s=s.next}while(s!==n)}fo(t,e,r);break;case 1:if(!xs&&(Dc(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){an(r,e,o)}fo(t,e,r);break;case 21:fo(t,e,r);break;case 22:r.mode&1?(xs=(n=xs)||r.memoizedState!==null,fo(t,e,r),xs=n):fo(t,e,r);break;default:fo(t,e,r)}}function Rw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new F5),e.forEach(function(n){var s=H5.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Ua(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=t,i=e,o=i;e:for(;o!==null;){switch(o.tag){case 5:Jn=o.stateNode,Wa=!1;break e;case 3:Jn=o.stateNode.containerInfo,Wa=!0;break e;case 4:Jn=o.stateNode.containerInfo,Wa=!0;break e}o=o.return}if(Jn===null)throw Error(lt(160));JE(a,i,s),Jn=null,Wa=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){an(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ZE(e,t),e=e.sibling}function ZE(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ua(e,t),di(t),n&4){try{gd(3,t,t.return),vm(3,t)}catch(v){an(t,t.return,v)}try{gd(5,t,t.return)}catch(v){an(t,t.return,v)}}break;case 1:Ua(e,t),di(t),n&512&&r!==null&&Dc(r,r.return);break;case 5:if(Ua(e,t),di(t),n&512&&r!==null&&Dc(r,r.return),t.flags&32){var s=t.stateNode;try{Ld(s,"")}catch(v){an(t,t.return,v)}}if(n&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,i=r!==null?r.memoizedProps:a,o=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&bS(s,a),Ng(o,i);var u=Ng(o,a);for(i=0;i<c.length;i+=2){var d=c[i],h=c[i+1];d==="style"?kS(s,h):d==="dangerouslySetInnerHTML"?ES(s,h):d==="children"?Ld(s,h):a1(s,d,h,u)}switch(o){case"input":Tg(s,a);break;case"textarea":_S(s,a);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?$c(s,!!a.multiple,p,!1):m!==!!a.multiple&&(a.defaultValue!=null?$c(s,!!a.multiple,a.defaultValue,!0):$c(s,!!a.multiple,a.multiple?[]:"",!1))}s[Hd]=a}catch(v){an(t,t.return,v)}}break;case 6:if(Ua(e,t),di(t),n&4){if(t.stateNode===null)throw Error(lt(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(v){an(t,t.return,v)}}break;case 3:if(Ua(e,t),di(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ud(e.containerInfo)}catch(v){an(t,t.return,v)}break;case 4:Ua(e,t),di(t);break;case 13:Ua(e,t),di(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(M1=fn())),n&4&&Rw(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(xs=(u=xs)||d,Ua(e,t),xs=u):Ua(e,t),di(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(Ct=t,d=t.child;d!==null;){for(h=Ct=d;Ct!==null;){switch(m=Ct,p=m.child,m.tag){case 0:case 11:case 14:case 15:gd(4,m,m.return);break;case 1:Dc(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){n=m,r=m.return;try{e=n,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(v){an(n,r,v)}}break;case 5:Dc(m,m.return);break;case 22:if(m.memoizedState!==null){jw(h);continue}}p!==null?(p.return=m,Ct=p):jw(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=h.stateNode,c=h.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=TS("display",i))}catch(v){an(t,t.return,v)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(v){an(t,t.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ua(e,t),di(t),n&4&&Rw(t);break;case 21:break;default:Ua(e,t),di(t)}}function di(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(YE(r)){var n=r;break e}r=r.return}throw Error(lt(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Ld(s,""),n.flags&=-33);var a=Nw(t);ix(t,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=Nw(t);ax(t,o,i);break;default:throw Error(lt(161))}}catch(c){an(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function O5(t,e,r){Ct=t,eT(t)}function eT(t,e,r){for(var n=(t.mode&1)!==0;Ct!==null;){var s=Ct,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||d0;if(!i){var o=s.alternate,c=o!==null&&o.memoizedState!==null||xs;o=d0;var u=xs;if(d0=i,(xs=c)&&!u)for(Ct=s;Ct!==null;)i=Ct,c=i.child,i.tag===22&&i.memoizedState!==null?Dw(s):c!==null?(c.return=i,Ct=c):Dw(s);for(;a!==null;)Ct=a,eT(a),a=a.sibling;Ct=s,d0=o,xs=u}Pw(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Ct=a):Pw(t)}}function Pw(t){for(;Ct!==null;){var e=Ct;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:xs||vm(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!xs)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:za(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&gw(e,a,n);break;case 3:var i=e.updateQueue;if(i!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}gw(e,i,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Ud(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(lt(163))}xs||e.flags&512&&sx(e)}catch(m){an(e,e.return,m)}}if(e===t){Ct=null;break}if(r=e.sibling,r!==null){r.return=e.return,Ct=r;break}Ct=e.return}}function jw(t){for(;Ct!==null;){var e=Ct;if(e===t){Ct=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Ct=r;break}Ct=e.return}}function Dw(t){for(;Ct!==null;){var e=Ct;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{vm(4,e)}catch(c){an(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(c){an(e,s,c)}}var a=e.return;try{sx(e)}catch(c){an(e,a,c)}break;case 5:var i=e.return;try{sx(e)}catch(c){an(e,i,c)}}}catch(c){an(e,e.return,c)}if(e===t){Ct=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ct=o;break}Ct=e.return}}var M5=Math.ceil,bh=ro.ReactCurrentDispatcher,L1=ro.ReactCurrentOwner,ka=ro.ReactCurrentBatchConfig,Sr=0,Wn=null,Sn=null,ns=0,aa=0,Fc=rl(0),Fn=0,Yd=null,Ol=0,ym=0,O1=0,xd=null,Ks=null,M1=0,ou=1/0,Fi=null,_h=!1,ox=null,Lo=null,f0=!1,ko=null,Sh=0,vd=0,lx=null,z0=-1,W0=0;function Fs(){return Sr&6?fn():z0!==-1?z0:z0=fn()}function Oo(t){return t.mode&1?Sr&2&&ns!==0?ns&-ns:b5.transition!==null?(W0===0&&(W0=MS()),W0):(t=Pr,t!==0||(t=window.event,t=t===void 0?16:HS(t.type)),t):1}function Ja(t,e,r,n){if(50<vd)throw vd=0,lx=null,Error(lt(185));bf(t,r,n),(!(Sr&2)||t!==Wn)&&(t===Wn&&(!(Sr&2)&&(ym|=r),Fn===4&&yo(t,ns)),Zs(t,n),r===1&&Sr===0&&!(e.mode&1)&&(ou=fn()+500,pm&&nl()))}function Zs(t,e){var r=t.callbackNode;b3(t,e);var n=ih(t,t===Wn?ns:0);if(n===0)r!==null&&zy(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&zy(r),e===1)t.tag===0?w5(Fw.bind(null,t)):uE(Fw.bind(null,t)),g5(function(){!(Sr&6)&&nl()}),r=null;else{switch($S(n)){case 1:r=u1;break;case 4:r=LS;break;case 16:r=ah;break;case 536870912:r=OS;break;default:r=ah}r=lT(r,tT.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function tT(t,e){if(z0=-1,W0=0,Sr&6)throw Error(lt(327));var r=t.callbackNode;if(Wc()&&t.callbackNode!==r)return null;var n=ih(t,t===Wn?ns:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Eh(t,n);else{e=n;var s=Sr;Sr|=2;var a=nT();(Wn!==t||ns!==e)&&(Fi=null,ou=fn()+500,Al(t,e));do try{V5();break}catch(o){rT(t,o)}while(!0);S1(),bh.current=a,Sr=s,Sn!==null?e=0:(Wn=null,ns=0,e=Fn)}if(e!==0){if(e===2&&(s=Fg(t),s!==0&&(n=s,e=cx(t,s))),e===1)throw r=Yd,Al(t,0),yo(t,n),Zs(t,fn()),r;if(e===6)yo(t,n);else{if(s=t.current.alternate,!(n&30)&&!$5(s)&&(e=Eh(t,n),e===2&&(a=Fg(t),a!==0&&(n=a,e=cx(t,a))),e===1))throw r=Yd,Al(t,0),yo(t,n),Zs(t,fn()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(lt(345));case 2:gl(t,Ks,Fi);break;case 3:if(yo(t,n),(n&130023424)===n&&(e=M1+500-fn(),10<e)){if(ih(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Fs(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=zg(gl.bind(null,t,Ks,Fi),e);break}gl(t,Ks,Fi);break;case 4:if(yo(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var i=31-Ya(n);a=1<<i,i=e[i],i>s&&(s=i),n&=~a}if(n=s,n=fn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*M5(n/1960))-n,10<n){t.timeoutHandle=zg(gl.bind(null,t,Ks,Fi),n);break}gl(t,Ks,Fi);break;case 5:gl(t,Ks,Fi);break;default:throw Error(lt(329))}}}return Zs(t,fn()),t.callbackNode===r?tT.bind(null,t):null}function cx(t,e){var r=xd;return t.current.memoizedState.isDehydrated&&(Al(t,e).flags|=256),t=Eh(t,e),t!==2&&(e=Ks,Ks=r,e!==null&&ux(e)),t}function ux(t){Ks===null?Ks=t:Ks.push.apply(Ks,t)}function $5(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!ei(a(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function yo(t,e){for(e&=~O1,e&=~ym,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Ya(e),n=1<<r;t[r]=-1,e&=~n}}function Fw(t){if(Sr&6)throw Error(lt(327));Wc();var e=ih(t,0);if(!(e&1))return Zs(t,fn()),null;var r=Eh(t,e);if(t.tag!==0&&r===2){var n=Fg(t);n!==0&&(e=n,r=cx(t,n))}if(r===1)throw r=Yd,Al(t,0),yo(t,e),Zs(t,fn()),r;if(r===6)throw Error(lt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,gl(t,Ks,Fi),Zs(t,fn()),null}function $1(t,e){var r=Sr;Sr|=1;try{return t(e)}finally{Sr=r,Sr===0&&(ou=fn()+500,pm&&nl())}}function Ml(t){ko!==null&&ko.tag===0&&!(Sr&6)&&Wc();var e=Sr;Sr|=1;var r=ka.transition,n=Pr;try{if(ka.transition=null,Pr=1,t)return t()}finally{Pr=n,ka.transition=r,Sr=e,!(Sr&6)&&nl()}}function U1(){aa=Fc.current,Wr(Fc)}function Al(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,p5(r)),Sn!==null)for(r=Sn.return;r!==null;){var n=r;switch(w1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&dh();break;case 3:au(),Wr(Ys),Wr(_s),C1();break;case 5:I1(n);break;case 4:au();break;case 13:Wr(Jr);break;case 19:Wr(Jr);break;case 10:E1(n.type._context);break;case 22:case 23:U1()}r=r.return}if(Wn=t,Sn=t=Mo(t.current,null),ns=aa=e,Fn=0,Yd=null,O1=ym=Ol=0,Ks=xd=null,wl!==null){for(e=0;e<wl.length;e++)if(r=wl[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}wl=null}return t}function rT(t,e){do{var r=Sn;try{if(S1(),U0.current=wh,yh){for(var n=en.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}yh=!1}if(Ll=0,zn=jn=en=null,pd=!1,Kd=0,L1.current=null,r===null||r.return===null){Fn=1,Yd=e,Sn=null;break}e:{var a=t,i=r.return,o=r,c=e;if(e=ns,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=_w(i);if(p!==null){p.flags&=-257,Sw(p,i,o,a,e),p.mode&1&&bw(a,u,e),e=p,c=u;var y=e.updateQueue;if(y===null){var v=new Set;v.add(c),e.updateQueue=v}else y.add(c);break e}else{if(!(e&1)){bw(a,u,e),V1();break e}c=Error(lt(426))}}else if(Kr&&o.mode&1){var b=_w(i);if(b!==null){!(b.flags&65536)&&(b.flags|=256),Sw(b,i,o,a,e),b1(iu(c,o));break e}}a=c=iu(c,o),Fn!==4&&(Fn=2),xd===null?xd=[a]:xd.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var E=$E(a,c,e);pw(a,E);break e;case 1:o=c;var T=a.type,w=a.stateNode;if(!(a.flags&128)&&(typeof T.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Lo===null||!Lo.has(w)))){a.flags|=65536,e&=-e,a.lanes|=e;var B=UE(a,o,e);pw(a,B);break e}}a=a.return}while(a!==null)}aT(r)}catch(J){e=J,Sn===r&&r!==null&&(Sn=r=r.return);continue}break}while(!0)}function nT(){var t=bh.current;return bh.current=wh,t===null?wh:t}function V1(){(Fn===0||Fn===3||Fn===2)&&(Fn=4),Wn===null||!(Ol&268435455)&&!(ym&268435455)||yo(Wn,ns)}function Eh(t,e){var r=Sr;Sr|=2;var n=nT();(Wn!==t||ns!==e)&&(Fi=null,Al(t,e));do try{U5();break}catch(s){rT(t,s)}while(!0);if(S1(),Sr=r,bh.current=n,Sn!==null)throw Error(lt(261));return Wn=null,ns=0,Fn}function U5(){for(;Sn!==null;)sT(Sn)}function V5(){for(;Sn!==null&&!f3();)sT(Sn)}function sT(t){var e=oT(t.alternate,t,aa);t.memoizedProps=t.pendingProps,e===null?aT(t):Sn=e,L1.current=null}function aT(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=D5(r,e),r!==null){r.flags&=32767,Sn=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Fn=6,Sn=null;return}}else if(r=j5(r,e,aa),r!==null){Sn=r;return}if(e=e.sibling,e!==null){Sn=e;return}Sn=e=t}while(e!==null);Fn===0&&(Fn=5)}function gl(t,e,r){var n=Pr,s=ka.transition;try{ka.transition=null,Pr=1,B5(t,e,r,n)}finally{ka.transition=s,Pr=n}return null}function B5(t,e,r,n){do Wc();while(ko!==null);if(Sr&6)throw Error(lt(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(lt(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(_3(t,a),t===Wn&&(Sn=Wn=null,ns=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||f0||(f0=!0,lT(ah,function(){return Wc(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=ka.transition,ka.transition=null;var i=Pr;Pr=1;var o=Sr;Sr|=4,L1.current=null,L5(t,r),ZE(r,t),l5(Vg),oh=!!Ug,Vg=Ug=null,t.current=r,O5(r),h3(),Sr=o,Pr=i,ka.transition=a}else t.current=r;if(f0&&(f0=!1,ko=t,Sh=s),a=t.pendingLanes,a===0&&(Lo=null),g3(r.stateNode),Zs(t,fn()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(_h)throw _h=!1,t=ox,ox=null,t;return Sh&1&&t.tag!==0&&Wc(),a=t.pendingLanes,a&1?t===lx?vd++:(vd=0,lx=t):vd=0,nl(),null}function Wc(){if(ko!==null){var t=$S(Sh),e=ka.transition,r=Pr;try{if(ka.transition=null,Pr=16>t?16:t,ko===null)var n=!1;else{if(t=ko,ko=null,Sh=0,Sr&6)throw Error(lt(331));var s=Sr;for(Sr|=4,Ct=t.current;Ct!==null;){var a=Ct,i=a.child;if(Ct.flags&16){var o=a.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(Ct=u;Ct!==null;){var d=Ct;switch(d.tag){case 0:case 11:case 15:gd(8,d,a)}var h=d.child;if(h!==null)h.return=d,Ct=h;else for(;Ct!==null;){d=Ct;var m=d.sibling,p=d.return;if(XE(d),d===u){Ct=null;break}if(m!==null){m.return=p,Ct=m;break}Ct=p}}}var y=a.alternate;if(y!==null){var v=y.child;if(v!==null){y.child=null;do{var b=v.sibling;v.sibling=null,v=b}while(v!==null)}}Ct=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Ct=i;else e:for(;Ct!==null;){if(a=Ct,a.flags&2048)switch(a.tag){case 0:case 11:case 15:gd(9,a,a.return)}var E=a.sibling;if(E!==null){E.return=a.return,Ct=E;break e}Ct=a.return}}var T=t.current;for(Ct=T;Ct!==null;){i=Ct;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,Ct=w;else e:for(i=T;Ct!==null;){if(o=Ct,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:vm(9,o)}}catch(J){an(o,o.return,J)}if(o===i){Ct=null;break e}var B=o.sibling;if(B!==null){B.return=o.return,Ct=B;break e}Ct=o.return}}if(Sr=s,nl(),xi&&typeof xi.onPostCommitFiberRoot=="function")try{xi.onPostCommitFiberRoot(um,t)}catch{}n=!0}return n}finally{Pr=r,ka.transition=e}}return!1}function Lw(t,e,r){e=iu(r,e),e=$E(t,e,1),t=Fo(t,e,1),e=Fs(),t!==null&&(bf(t,1,e),Zs(t,e))}function an(t,e,r){if(t.tag===3)Lw(t,t,r);else for(;e!==null;){if(e.tag===3){Lw(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Lo===null||!Lo.has(n))){t=iu(r,t),t=UE(e,t,1),e=Fo(e,t,1),t=Fs(),e!==null&&(bf(e,1,t),Zs(e,t));break}}e=e.return}}function z5(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Fs(),t.pingedLanes|=t.suspendedLanes&r,Wn===t&&(ns&r)===r&&(Fn===4||Fn===3&&(ns&130023424)===ns&&500>fn()-M1?Al(t,0):O1|=r),Zs(t,e)}function iT(t,e){e===0&&(t.mode&1?(e=r0,r0<<=1,!(r0&130023424)&&(r0=4194304)):e=1);var r=Fs();t=Qi(t,e),t!==null&&(bf(t,e,r),Zs(t,r))}function W5(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),iT(t,r)}function H5(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(lt(314))}n!==null&&n.delete(e),iT(t,r)}var oT;oT=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ys.current)Xs=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Xs=!1,P5(t,e,r);Xs=!!(t.flags&131072)}else Xs=!1,Kr&&e.flags&1048576&&dE(e,mh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;B0(t,e),t=e.pendingProps;var s=ru(e,_s.current);zc(e,r),s=R1(null,e,n,t,s,r);var a=P1();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Js(n)?(a=!0,fh(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,k1(e),s.updater=xm,e.stateNode=s,s._reactInternals=e,Xg(e,n,t,r),e=Zg(null,e,n,!0,a,r)):(e.tag=0,Kr&&a&&y1(e),Rs(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(B0(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=q5(n),t=za(n,t),s){case 0:e=Jg(null,e,n,t,r);break e;case 1:e=kw(null,e,n,t,r);break e;case 11:e=Ew(null,e,n,t,r);break e;case 14:e=Tw(null,e,n,za(n.type,t),r);break e}throw Error(lt(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:za(n,s),Jg(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:za(n,s),kw(t,e,n,s,r);case 3:e:{if(WE(e),t===null)throw Error(lt(387));n=e.pendingProps,a=e.memoizedState,s=a.element,xE(t,e),xh(e,n,null,r);var i=e.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=iu(Error(lt(423)),e),e=Aw(t,e,n,r,s);break e}else if(n!==s){s=iu(Error(lt(424)),e),e=Aw(t,e,n,r,s);break e}else for(ca=Do(e.stateNode.containerInfo.firstChild),da=e,Kr=!0,Ha=null,r=pE(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(nu(),n===s){e=Xi(t,e,r);break e}Rs(t,e,n,r)}e=e.child}return e;case 5:return vE(e),t===null&&qg(e),n=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,i=s.children,Bg(n,s)?i=null:a!==null&&Bg(n,a)&&(e.flags|=32),zE(t,e),Rs(t,e,i,r),e.child;case 6:return t===null&&qg(e),null;case 13:return HE(t,e,r);case 4:return A1(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=su(e,null,n,r):Rs(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:za(n,s),Ew(t,e,n,s,r);case 7:return Rs(t,e,e.pendingProps,r),e.child;case 8:return Rs(t,e,e.pendingProps.children,r),e.child;case 12:return Rs(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,a=e.memoizedProps,i=s.value,Mr(ph,n._currentValue),n._currentValue=i,a!==null)if(ei(a.value,i)){if(a.children===s.children&&!Ys.current){e=Xi(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=zi(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),Kg(a.return,r,e),o.lanes|=r;break}c=c.next}}else if(a.tag===10)i=a.type===e.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(lt(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),Kg(i,r,e),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===e){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Rs(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,zc(e,r),s=Aa(s),n=n(s),e.flags|=1,Rs(t,e,n,r),e.child;case 14:return n=e.type,s=za(n,e.pendingProps),s=za(n.type,s),Tw(t,e,n,s,r);case 15:return VE(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:za(n,s),B0(t,e),e.tag=1,Js(n)?(t=!0,fh(e)):t=!1,zc(e,r),ME(e,n,s),Xg(e,n,s,r),Zg(null,e,n,!0,t,r);case 19:return GE(t,e,r);case 22:return BE(t,e,r)}throw Error(lt(156,e.tag))};function lT(t,e){return FS(t,e)}function G5(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ta(t,e,r,n){return new G5(t,e,r,n)}function B1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function q5(t){if(typeof t=="function")return B1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===o1)return 11;if(t===l1)return 14}return 2}function Mo(t,e){var r=t.alternate;return r===null?(r=Ta(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function H0(t,e,r,n,s,a){var i=2;if(n=t,typeof t=="function")B1(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Tc:return Il(r.children,s,a,e);case i1:i=8,s|=8;break;case wg:return t=Ta(12,r,e,s|2),t.elementType=wg,t.lanes=a,t;case bg:return t=Ta(13,r,e,s),t.elementType=bg,t.lanes=a,t;case _g:return t=Ta(19,r,e,s),t.elementType=_g,t.lanes=a,t;case vS:return wm(r,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case gS:i=10;break e;case xS:i=9;break e;case o1:i=11;break e;case l1:i=14;break e;case go:i=16,n=null;break e}throw Error(lt(130,t==null?t:typeof t,""))}return e=Ta(i,r,e,s),e.elementType=t,e.type=n,e.lanes=a,e}function Il(t,e,r,n){return t=Ta(7,t,n,e),t.lanes=r,t}function wm(t,e,r,n){return t=Ta(22,t,n,e),t.elementType=vS,t.lanes=r,t.stateNode={isHidden:!1},t}function Mp(t,e,r){return t=Ta(6,t,null,e),t.lanes=r,t}function $p(t,e,r){return e=Ta(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function K5(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yp(0),this.expirationTimes=yp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yp(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function z1(t,e,r,n,s,a,i,o,c){return t=new K5(t,e,r,o,c),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Ta(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},k1(a),t}function Q5(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ec,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function cT(t){if(!t)return Ho;t=t._reactInternals;e:{if(Ql(t)!==t||t.tag!==1)throw Error(lt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Js(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(lt(171))}if(t.tag===1){var r=t.type;if(Js(r))return cE(t,r,e)}return e}function uT(t,e,r,n,s,a,i,o,c){return t=z1(r,n,!0,t,s,a,i,o,c),t.context=cT(null),r=t.current,n=Fs(),s=Oo(r),a=zi(n,s),a.callback=e??null,Fo(r,a,s),t.current.lanes=s,bf(t,s,n),Zs(t,n),t}function bm(t,e,r,n){var s=e.current,a=Fs(),i=Oo(s);return r=cT(r),e.context===null?e.context=r:e.pendingContext=r,e=zi(a,i),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Fo(s,e,i),t!==null&&(Ja(t,s,i,a),$0(t,s,i)),i}function Th(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ow(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function W1(t,e){Ow(t,e),(t=t.alternate)&&Ow(t,e)}function X5(){return null}var dT=typeof reportError=="function"?reportError:function(t){console.error(t)};function H1(t){this._internalRoot=t}_m.prototype.render=H1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(lt(409));bm(t,e,null,null)};_m.prototype.unmount=H1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ml(function(){bm(null,t,null,null)}),e[Ki]=null}};function _m(t){this._internalRoot=t}_m.prototype.unstable_scheduleHydration=function(t){if(t){var e=BS();t={blockedOn:null,target:t,priority:e};for(var r=0;r<vo.length&&e!==0&&e<vo[r].priority;r++);vo.splice(r,0,t),r===0&&WS(t)}};function G1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Sm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Mw(){}function Y5(t,e,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=Th(i);a.call(u)}}var i=uT(e,n,t,0,null,!1,!1,"",Mw);return t._reactRootContainer=i,t[Ki]=i.current,zd(t.nodeType===8?t.parentNode:t),Ml(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var u=Th(c);o.call(u)}}var c=z1(t,0,!1,null,null,!1,!1,"",Mw);return t._reactRootContainer=c,t[Ki]=c.current,zd(t.nodeType===8?t.parentNode:t),Ml(function(){bm(e,c,r,n)}),c}function Em(t,e,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var c=Th(i);o.call(c)}}bm(e,i,t,s)}else i=Y5(r,e,t,s,n);return Th(i)}US=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Xu(e.pendingLanes);r!==0&&(d1(e,r|1),Zs(e,fn()),!(Sr&6)&&(ou=fn()+500,nl()))}break;case 13:Ml(function(){var n=Qi(t,1);if(n!==null){var s=Fs();Ja(n,t,1,s)}}),W1(t,1)}};f1=function(t){if(t.tag===13){var e=Qi(t,134217728);if(e!==null){var r=Fs();Ja(e,t,134217728,r)}W1(t,134217728)}};VS=function(t){if(t.tag===13){var e=Oo(t),r=Qi(t,e);if(r!==null){var n=Fs();Ja(r,t,e,n)}W1(t,e)}};BS=function(){return Pr};zS=function(t,e){var r=Pr;try{return Pr=t,e()}finally{Pr=r}};Pg=function(t,e,r){switch(e){case"input":if(Tg(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=mm(n);if(!s)throw Error(lt(90));wS(n),Tg(n,s)}}}break;case"textarea":_S(t,r);break;case"select":e=r.value,e!=null&&$c(t,!!r.multiple,e,!1)}};CS=$1;NS=Ml;var J5={usingClientEntryPoint:!1,Events:[Sf,Cc,mm,AS,IS,$1]},Gu={findFiberByHostInstance:yl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Z5={bundleType:Gu.bundleType,version:Gu.version,rendererPackageName:Gu.rendererPackageName,rendererConfig:Gu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ro.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=jS(t),t===null?null:t.stateNode},findFiberByHostInstance:Gu.findFiberByHostInstance||X5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var h0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!h0.isDisabled&&h0.supportsFiber)try{um=h0.inject(Z5),xi=h0}catch{}}pa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J5;pa.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!G1(e))throw Error(lt(200));return Q5(t,e,null,r)};pa.createRoot=function(t,e){if(!G1(t))throw Error(lt(299));var r=!1,n="",s=dT;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=z1(t,1,!1,null,null,r,!1,n,s),t[Ki]=e.current,zd(t.nodeType===8?t.parentNode:t),new H1(e)};pa.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(lt(188)):(t=Object.keys(t).join(","),Error(lt(268,t)));return t=jS(e),t=t===null?null:t.stateNode,t};pa.flushSync=function(t){return Ml(t)};pa.hydrate=function(t,e,r){if(!Sm(e))throw Error(lt(200));return Em(null,t,e,!0,r)};pa.hydrateRoot=function(t,e,r){if(!G1(t))throw Error(lt(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=dT;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),e=uT(e,null,t,1,r??null,s,!1,a,i),t[Ki]=e.current,zd(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new _m(e)};pa.render=function(t,e,r){if(!Sm(e))throw Error(lt(200));return Em(null,t,e,!1,r)};pa.unmountComponentAtNode=function(t){if(!Sm(t))throw Error(lt(40));return t._reactRootContainer?(Ml(function(){Em(null,null,t,!1,function(){t._reactRootContainer=null,t[Ki]=null})}),!0):!1};pa.unstable_batchedUpdates=$1;pa.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Sm(r))throw Error(lt(200));if(t==null||t._reactInternals===void 0)throw Error(lt(38));return Em(t,e,r,!1,n)};pa.version="18.3.1-next-f1338f8080-20240426";function fT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fT)}catch(t){console.error(t)}}fT(),fS.exports=pa;var eR=fS.exports,$w=eR;vg.createRoot=$w.createRoot,vg.hydrateRoot=$w.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Jd(){return Jd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Jd.apply(this,arguments)}var Ao;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ao||(Ao={}));const Uw="popstate";function tR(t){t===void 0&&(t={});function e(n,s){let{pathname:a,search:i,hash:o}=n.location;return dx("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:hT(s)}return nR(e,r,null,t)}function kn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function q1(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function rR(){return Math.random().toString(36).substr(2,8)}function Vw(t,e){return{usr:t.state,key:t.key,idx:e}}function dx(t,e,r,n){return r===void 0&&(r=null),Jd({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?wu(e):e,{state:r,key:e&&e.key||n||rR()})}function hT(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function wu(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function nR(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=Ao.Pop,c=null,u=d();u==null&&(u=0,i.replaceState(Jd({},i.state,{idx:u}),""));function d(){return(i.state||{idx:null}).idx}function h(){o=Ao.Pop;let b=d(),E=b==null?null:b-u;u=b,c&&c({action:o,location:v.location,delta:E})}function m(b,E){o=Ao.Push;let T=dx(v.location,b,E);u=d()+1;let w=Vw(T,u),B=v.createHref(T);try{i.pushState(w,"",B)}catch(J){if(J instanceof DOMException&&J.name==="DataCloneError")throw J;s.location.assign(B)}a&&c&&c({action:o,location:v.location,delta:1})}function p(b,E){o=Ao.Replace;let T=dx(v.location,b,E);u=d();let w=Vw(T,u),B=v.createHref(T);i.replaceState(w,"",B),a&&c&&c({action:o,location:v.location,delta:0})}function y(b){let E=s.location.origin!=="null"?s.location.origin:s.location.href,T=typeof b=="string"?b:hT(b);return T=T.replace(/ $/,"%20"),kn(E,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,E)}let v={get action(){return o},get location(){return t(s,i)},listen(b){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Uw,h),c=b,()=>{s.removeEventListener(Uw,h),c=null}},createHref(b){return e(s,b)},createURL:y,encodeLocation(b){let E=y(b);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:m,replace:p,go(b){return i.go(b)}};return v}var Bw;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Bw||(Bw={}));function sR(t,e,r){return r===void 0&&(r="/"),aR(t,e,r)}function aR(t,e,r,n){let s=typeof e=="string"?wu(e):e,a=gT(s.pathname||"/",r);if(a==null)return null;let i=mT(t);iR(i);let o=null;for(let c=0;o==null&&c<i.length;++c){let u=vR(a);o=pR(i[c],u)}return o}function mT(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let c={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&(kn(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Cl([n,c.relativePath]),d=r.concat(c);a.children&&a.children.length>0&&(kn(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),mT(a.children,e,d,u)),!(a.path==null&&!a.index)&&e.push({path:u,score:hR(u,a.index),routesMeta:d})};return t.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let c of pT(a.path))s(a,i,c)}),e}function pT(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=pT(n.join("/")),o=[];return o.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&o.push(...i),o.map(c=>t.startsWith("/")&&c===""?"/":c)}function iR(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:mR(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const oR=/^:[\w-]+$/,lR=3,cR=2,uR=1,dR=10,fR=-2,zw=t=>t==="*";function hR(t,e){let r=t.split("/"),n=r.length;return r.some(zw)&&(n+=fR),e&&(n+=cR),r.filter(s=>!zw(s)).reduce((s,a)=>s+(oR.test(a)?lR:a===""?uR:dR),n)}function mR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function pR(t,e,r){let{routesMeta:n}=t,s={},a="/",i=[];for(let o=0;o<n.length;++o){let c=n[o],u=o===n.length-1,d=a==="/"?e:e.slice(a.length)||"/",h=gR({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),m=c.route;if(!h)return null;Object.assign(s,h.params),i.push({params:s,pathname:Cl([a,h.pathname]),pathnameBase:SR(Cl([a,h.pathnameBase])),route:m}),h.pathnameBase!=="/"&&(a=Cl([a,h.pathnameBase]))}return i}function gR(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=xR(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,d,h)=>{let{paramName:m,isOptional:p}=d;if(m==="*"){let v=o[h]||"";i=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const y=o[h];return p&&!y?u[m]=void 0:u[m]=(y||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:t}}function xR(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),q1(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function vR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return q1(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function gT(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const yR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wR=t=>yR.test(t);function bR(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?wu(t):t,a;if(r)if(wR(r))a=r;else{if(r.includes("//")){let i=r;r=r.replace(/\/\/+/g,"/"),q1(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+r))}r.startsWith("/")?a=Ww(r.substring(1),"/"):a=Ww(r,e)}else a=e;return{pathname:a,search:ER(n),hash:TR(s)}}function Ww(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Up(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function _R(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function xT(t,e){let r=_R(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function vT(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=wu(t):(s=Jd({},t),kn(!s.pathname||!s.pathname.includes("?"),Up("?","pathname","search",s)),kn(!s.pathname||!s.pathname.includes("#"),Up("#","pathname","hash",s)),kn(!s.search||!s.search.includes("#"),Up("#","search","hash",s)));let a=t===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let h=e.length-1;if(!n&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),h-=1;s.pathname=m.join("/")}o=h>=0?e[h]:"/"}let c=bR(s,o),u=i&&i!=="/"&&i.endsWith("/"),d=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Cl=t=>t.join("/").replace(/\/\/+/g,"/"),SR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),ER=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,TR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function kR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const yT=["post","put","patch","delete"];new Set(yT);const AR=["get",...yT];new Set(AR);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zd(){return Zd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Zd.apply(this,arguments)}const K1=G.createContext(null),IR=G.createContext(null),Tf=G.createContext(null),Tm=G.createContext(null),Xl=G.createContext({outlet:null,matches:[],isDataRoute:!1}),wT=G.createContext(null);function kf(){return G.useContext(Tm)!=null}function km(){return kf()||kn(!1),G.useContext(Tm).location}function bT(t){G.useContext(Tf).static||G.useLayoutEffect(t)}function Am(){let{isDataRoute:t}=G.useContext(Xl);return t?VR():CR()}function CR(){kf()||kn(!1);let t=G.useContext(K1),{basename:e,future:r,navigator:n}=G.useContext(Tf),{matches:s}=G.useContext(Xl),{pathname:a}=km(),i=JSON.stringify(xT(s,r.v7_relativeSplatPath)),o=G.useRef(!1);return bT(()=>{o.current=!0}),G.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let h=vT(u,JSON.parse(i),a,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Cl([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,i,a,t])}function NR(t,e){return RR(t,e)}function RR(t,e,r,n){kf()||kn(!1);let{navigator:s}=G.useContext(Tf),{matches:a}=G.useContext(Xl),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let u=km(),d;if(e){var h;let b=typeof e=="string"?wu(e):e;c==="/"||(h=b.pathname)!=null&&h.startsWith(c)||kn(!1),d=b}else d=u;let m=d.pathname||"/",p=m;if(c!=="/"){let b=c.replace(/^\//,"").split("/");p="/"+m.replace(/^\//,"").split("/").slice(b.length).join("/")}let y=sR(t,{pathname:p}),v=LR(y&&y.map(b=>Object.assign({},b,{params:Object.assign({},o,b.params),pathname:Cl([c,s.encodeLocation?s.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?c:Cl([c,s.encodeLocation?s.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),a,r,n);return e&&v?G.createElement(Tm.Provider,{value:{location:Zd({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Ao.Pop}},v):v}function PR(){let t=UR(),e=kR(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return G.createElement(G.Fragment,null,G.createElement("h2",null,"Unexpected Application Error!"),G.createElement("h3",{style:{fontStyle:"italic"}},e),r?G.createElement("pre",{style:s},r):null,null)}const jR=G.createElement(PR,null);class DR extends G.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?G.createElement(Xl.Provider,{value:this.props.routeContext},G.createElement(wT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function FR(t){let{routeContext:e,match:r,children:n}=t,s=G.useContext(K1);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),G.createElement(Xl.Provider,{value:e},n)}function LR(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var a;if(!r)return null;if(r.errors)t=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=i.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);d>=0||kn(!1),i=i.slice(0,Math.min(i.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<i.length;d++){let h=i[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:m,errors:p}=r,y=h.route.loader&&m[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||y){c=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,h,m)=>{let p,y=!1,v=null,b=null;r&&(p=o&&h.route.id?o[h.route.id]:void 0,v=h.route.errorElement||jR,c&&(u<0&&m===0?(BR("route-fallback"),y=!0,b=null):u===m&&(y=!0,b=h.route.hydrateFallbackElement||null)));let E=e.concat(i.slice(0,m+1)),T=()=>{let w;return p?w=v:y?w=b:h.route.Component?w=G.createElement(h.route.Component,null):h.route.element?w=h.route.element:w=d,G.createElement(FR,{match:h,routeContext:{outlet:d,matches:E,isDataRoute:r!=null},children:w})};return r&&(h.route.ErrorBoundary||h.route.errorElement||m===0)?G.createElement(DR,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:T(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):T()},null)}var _T=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(_T||{}),ST=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(ST||{});function OR(t){let e=G.useContext(K1);return e||kn(!1),e}function MR(t){let e=G.useContext(IR);return e||kn(!1),e}function $R(t){let e=G.useContext(Xl);return e||kn(!1),e}function ET(t){let e=$R(),r=e.matches[e.matches.length-1];return r.route.id||kn(!1),r.route.id}function UR(){var t;let e=G.useContext(wT),r=MR(),n=ET();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function VR(){let{router:t}=OR(_T.UseNavigateStable),e=ET(ST.UseNavigateStable),r=G.useRef(!1);return bT(()=>{r.current=!0}),G.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Zd({fromRouteId:e},a)))},[t,e])}const Hw={};function BR(t,e,r){Hw[t]||(Hw[t]=!0)}function zR(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function TT(t){let{to:e,replace:r,state:n,relative:s}=t;kf()||kn(!1);let{future:a,static:i}=G.useContext(Tf),{matches:o}=G.useContext(Xl),{pathname:c}=km(),u=Am(),d=vT(e,xT(o,a.v7_relativeSplatPath),c,s==="path"),h=JSON.stringify(d);return G.useEffect(()=>u(JSON.parse(h),{replace:r,state:n,relative:s}),[u,h,s,r,n]),null}function Ju(t){kn(!1)}function WR(t){let{basename:e="/",children:r=null,location:n,navigationType:s=Ao.Pop,navigator:a,static:i=!1,future:o}=t;kf()&&kn(!1);let c=e.replace(/^\/*/,"/"),u=G.useMemo(()=>({basename:c,navigator:a,static:i,future:Zd({v7_relativeSplatPath:!1},o)}),[c,o,a,i]);typeof n=="string"&&(n=wu(n));let{pathname:d="/",search:h="",hash:m="",state:p=null,key:y="default"}=n,v=G.useMemo(()=>{let b=gT(d,c);return b==null?null:{location:{pathname:b,search:h,hash:m,state:p,key:y},navigationType:s}},[c,d,h,m,p,y,s]);return v==null?null:G.createElement(Tf.Provider,{value:u},G.createElement(Tm.Provider,{children:r,value:v}))}function HR(t){let{children:e,location:r}=t;return NR(fx(e),r)}new Promise(()=>{});function fx(t,e){e===void 0&&(e=[]);let r=[];return G.Children.forEach(t,(n,s)=>{if(!G.isValidElement(n))return;let a=[...e,s];if(n.type===G.Fragment){r.push.apply(r,fx(n.props.children,a));return}n.type!==Ju&&kn(!1),!n.props.index||!n.props.children||kn(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=fx(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const GR="6";try{window.__reactRouterVersion=GR}catch{}const qR="startTransition",Gw=zN[qR];function KR(t){let{basename:e,children:r,future:n,window:s}=t,a=G.useRef();a.current==null&&(a.current=tR({window:s,v5Compat:!0}));let i=a.current,[o,c]=G.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},d=G.useCallback(h=>{u&&Gw?Gw(()=>c(h)):c(h)},[c,u]);return G.useLayoutEffect(()=>i.listen(d),[i,d]),G.useEffect(()=>zR(n),[n]),G.createElement(WR,{basename:e,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}var qw;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(qw||(qw={}));var Kw;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Kw||(Kw={}));function Im(){const[t,e]=G.useState(()=>localStorage.getItem("react_darkMode")==="true");return G.useEffect(()=>{const n=document.documentElement;t?(document.body.classList.add("dark-mode"),n.style.setProperty("--theme-bg-primary","#1a1a1a"),n.style.setProperty("--theme-bg-secondary","#2c2c2c"),n.style.setProperty("--theme-bg-card","#2c2c2c"),n.style.setProperty("--theme-text-primary","#ffffff"),n.style.setProperty("--theme-text-secondary","#e5e5e5"),n.style.setProperty("--theme-border","#404040"),n.style.setProperty("--theme-accent","#8B1A1D"),n.style.setProperty("--theme-accent-hover","#9B2A2D"),n.style.setProperty("--theme-alert","#FDB813")):(document.body.classList.remove("dark-mode"),n.style.setProperty("--theme-bg-primary","#ffffff"),n.style.setProperty("--theme-bg-secondary","#f8f9fa"),n.style.setProperty("--theme-bg-card","#ffffff"),n.style.setProperty("--theme-text-primary","#000000"),n.style.setProperty("--theme-text-secondary","#374151"),n.style.setProperty("--theme-border","#e5e7eb"),n.style.setProperty("--theme-accent","#7A1315"),n.style.setProperty("--theme-accent-hover","#8B1A1D"),n.style.setProperty("--theme-alert","#FDB813")),localStorage.setItem("react_darkMode",t)},[t]),{isDarkMode:t,toggleTheme:()=>{e(n=>!n),document.body.classList.add("dark-mode-transition"),setTimeout(()=>{document.body.classList.remove("dark-mode-transition")},300)}}}function QR(){const{isDarkMode:t,toggleTheme:e}=Im();return l.jsxs("button",{id:"themeToggleButton",className:"theme-toggle-button",onClick:e,"aria-label":"Toggle dark mode",children:[l.jsx("img",{src:"/assets/icons/moon.png",alt:"Moon icon",className:`moon-icon w-6 h-6 ${t?"hidden":""}`}),l.jsx("img",{src:"/assets/icons/sun.png",alt:"Sun icon",className:`sun-icon w-6 h-6 ${t?"":"hidden"}`})]})}const XR=()=>{};var Qw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kT=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},YR=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=t[r++];e[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=t[r++],i=t[r++],o=t[r++],c=((s&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const a=t[r++],i=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|i&63)}}return e.join("")},AT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const a=t[s],i=s+1<t.length,o=i?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=a>>2,h=(a&3)<<4|o>>4;let m=(o&15)<<2|u>>6,p=u&63;c||(p=64,i||(m=64)),n.push(r[d],r[h],r[m],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(kT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):YR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const a=r[t.charAt(s++)],o=s<t.length?r[t.charAt(s)]:0;++s;const u=s<t.length?r[t.charAt(s)]:64;++s;const h=s<t.length?r[t.charAt(s)]:64;if(++s,a==null||o==null||u==null||h==null)throw new JR;const m=a<<2|o>>4;if(n.push(m),u!==64){const p=o<<4&240|u>>2;if(n.push(p),h!==64){const y=u<<6&192|h;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class JR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ZR=function(t){const e=kT(t);return AT.encodeByteArray(e,!0)},kh=function(t){return ZR(t).replace(/\./g,"")},IT=function(t){try{return AT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tP=()=>eP().__FIREBASE_DEFAULTS__,rP=()=>{if(typeof process>"u"||typeof Qw>"u")return;const t=Qw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},nP=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&IT(t[1]);return e&&JSON.parse(e)},Cm=()=>{try{return XR()||tP()||rP()||nP()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},CT=t=>{var e,r;return(r=(e=Cm())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},NT=t=>{const e=CT(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},RT=()=>{var t;return(t=Cm())==null?void 0:t.config},PT=t=>{var e;return(e=Cm())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yl(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Q1(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[kh(JSON.stringify(r)),kh(JSON.stringify(i)),""].join(".")}const yd={};function aP(){const t={prod:[],emulator:[]};for(const e of Object.keys(yd))yd[e]?t.emulator.push(e):t.prod.push(e);return t}function iP(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Xw=!1;function X1(t,e){if(typeof window>"u"||typeof document>"u"||!Yl(window.location.host)||yd[t]===e||yd[t]||Xw)return;yd[t]=e;function r(m){return`__firebase__banner__${m}`}const n="__firebase__banner",a=aP().prod.length>0;function i(){const m=document.getElementById(n);m&&m.remove()}function o(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function c(m,p){m.setAttribute("width","24"),m.setAttribute("id",p),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function u(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{Xw=!0,i()},m}function d(m,p){m.setAttribute("id",p),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function h(){const m=iP(n),p=r("text"),y=document.getElementById(p)||document.createElement("span"),v=r("learnmore"),b=document.getElementById(v)||document.createElement("a"),E=r("preprendIcon"),T=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const w=m.element;o(w),d(b,v);const B=u();c(T,E),w.append(T,y,b,B),document.body.appendChild(w)}a?(y.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ss(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function oP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ss())}function lP(){var e;const t=(e=Cm())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function cP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function DT(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function uP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dP(){const t=Ss();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function fP(){return!lP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function FT(){try{return typeof indexedDB=="object"}catch{return!1}}function LT(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var a;e(((a=s.error)==null?void 0:a.message)||"")}}catch(r){e(r)}})}function hP(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mP="FirebaseError";class Ra extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=mP,Object.setPrototypeOf(this,Ra.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Jl.prototype.create)}}class Jl{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,a=this.errors[e],i=a?pP(a,n):"Error",o=`${this.serviceName}: ${i} (${s}).`;return new Ra(s,o,n)}}function pP(t,e){return t.replace(gP,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const gP=/\{\$([^}]+)}/g;function xP(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Go(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const a=t[s],i=e[s];if(Yw(a)&&Yw(i)){if(!Go(a,i))return!1}else if(a!==i)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function Yw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Af(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Zu(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,a]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function ed(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function vP(t,e){const r=new yP(t,e);return r.subscribe.bind(r)}class yP{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");wP(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=Vp),s.error===void 0&&(s.error=Vp),s.complete===void 0&&(s.complete=Vp);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function wP(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Vp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bP=1e3,_P=2,SP=4*60*60*1e3,EP=.5;function Jw(t,e=bP,r=_P){const n=e*Math.pow(r,t),s=Math.round(EP*n*(Math.random()-.5)*2);return Math.min(SP,n+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hn(t){return t&&t._delegate?t._delegate:t}class Ca{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new sP;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(AP(e))try{this.getOrInitializeService({instanceIdentifier:xl})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(e=xl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xl){return this.instances.has(e)}getOptions(e=xl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&i.resolve(s)}return s}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const a=this.instances.get(n);return a&&e(a,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:kP(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=xl){return this.component?this.component.multipleInstances?e:xl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function kP(t){return t===xl?void 0:t}function AP(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new TP(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mr;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(mr||(mr={}));const CP={debug:mr.DEBUG,verbose:mr.VERBOSE,info:mr.INFO,warn:mr.WARN,error:mr.ERROR,silent:mr.SILENT},NP=mr.INFO,RP={[mr.DEBUG]:"log",[mr.VERBOSE]:"log",[mr.INFO]:"info",[mr.WARN]:"warn",[mr.ERROR]:"error"},PP=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=RP[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Nm{constructor(e){this.name=e,this._logLevel=NP,this._logHandler=PP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in mr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?CP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,mr.DEBUG,...e),this._logHandler(this,mr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,mr.VERBOSE,...e),this._logHandler(this,mr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,mr.INFO,...e),this._logHandler(this,mr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,mr.WARN,...e),this._logHandler(this,mr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,mr.ERROR,...e),this._logHandler(this,mr.ERROR,...e)}}const jP=(t,e)=>e.some(r=>t instanceof r);let Zw,e2;function DP(){return Zw||(Zw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function FP(){return e2||(e2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const OT=new WeakMap,hx=new WeakMap,MT=new WeakMap,Bp=new WeakMap,Y1=new WeakMap;function LP(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",i)},a=()=>{r($o(t.result)),s()},i=()=>{n(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",i)});return e.then(r=>{r instanceof IDBCursor&&OT.set(r,t)}).catch(()=>{}),Y1.set(e,t),e}function OP(t){if(hx.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",i),t.removeEventListener("abort",i)},a=()=>{r(),s()},i=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",i),t.addEventListener("abort",i)});hx.set(t,e)}let mx={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return hx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||MT.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return $o(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function MP(t){mx=t(mx)}function $P(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(zp(this),e,...r);return MT.set(n,e.sort?e.sort():[e]),$o(n)}:FP().includes(t)?function(...e){return t.apply(zp(this),e),$o(OT.get(this))}:function(...e){return $o(t.apply(zp(this),e))}}function UP(t){return typeof t=="function"?$P(t):(t instanceof IDBTransaction&&OP(t),jP(t,DP())?new Proxy(t,mx):t)}function $o(t){if(t instanceof IDBRequest)return LP(t);if(Bp.has(t))return Bp.get(t);const e=UP(t);return e!==t&&(Bp.set(t,e),Y1.set(e,t)),e}const zp=t=>Y1.get(t);function $T(t,e,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const i=indexedDB.open(t,e),o=$o(i);return n&&i.addEventListener("upgradeneeded",c=>{n($o(i.result),c.oldVersion,c.newVersion,$o(i.transaction),c)}),r&&i.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),o.then(c=>{a&&c.addEventListener("close",()=>a()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const VP=["get","getKey","getAll","getAllKeys","count"],BP=["put","add","delete","clear"],Wp=new Map;function t2(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Wp.get(e))return Wp.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=BP.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||VP.includes(r)))return;const a=async function(i,...o){const c=this.transaction(i,s?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(o.shift())),(await Promise.all([u[r](...o),s&&c.done]))[0]};return Wp.set(e,a),a}MP(t=>({...t,get:(e,r,n)=>t2(e,r)||t.get(e,r,n),has:(e,r)=>!!t2(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(WP(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function WP(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const px="@firebase/app",r2="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi=new Nm("@firebase/app"),HP="@firebase/app-compat",GP="@firebase/analytics-compat",qP="@firebase/analytics",KP="@firebase/app-check-compat",QP="@firebase/app-check",XP="@firebase/auth",YP="@firebase/auth-compat",JP="@firebase/database",ZP="@firebase/data-connect",ej="@firebase/database-compat",tj="@firebase/functions",rj="@firebase/functions-compat",nj="@firebase/installations",sj="@firebase/installations-compat",aj="@firebase/messaging",ij="@firebase/messaging-compat",oj="@firebase/performance",lj="@firebase/performance-compat",cj="@firebase/remote-config",uj="@firebase/remote-config-compat",dj="@firebase/storage",fj="@firebase/storage-compat",hj="@firebase/firestore",mj="@firebase/ai",pj="@firebase/firestore-compat",gj="firebase",xj="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gx="[DEFAULT]",vj={[px]:"fire-core",[HP]:"fire-core-compat",[qP]:"fire-analytics",[GP]:"fire-analytics-compat",[QP]:"fire-app-check",[KP]:"fire-app-check-compat",[XP]:"fire-auth",[YP]:"fire-auth-compat",[JP]:"fire-rtdb",[ZP]:"fire-data-connect",[ej]:"fire-rtdb-compat",[tj]:"fire-fn",[rj]:"fire-fn-compat",[nj]:"fire-iid",[sj]:"fire-iid-compat",[aj]:"fire-fcm",[ij]:"fire-fcm-compat",[oj]:"fire-perf",[lj]:"fire-perf-compat",[cj]:"fire-rc",[uj]:"fire-rc-compat",[dj]:"fire-gcs",[fj]:"fire-gcs-compat",[hj]:"fire-fst",[pj]:"fire-fst-compat",[mj]:"fire-vertex","fire-js":"fire-js",[gj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah=new Map,yj=new Map,xx=new Map;function n2(t,e){try{t.container.addComponent(e)}catch(r){Yi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function ti(t){const e=t.name;if(xx.has(e))return Yi.debug(`There were multiple attempts to register component ${e}.`),!1;xx.set(e,t);for(const r of Ah.values())n2(r,t);for(const r of yj.values())n2(r,t);return!0}function sl(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function oa(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Uo=new Jl("app","Firebase",wj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ca("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Uo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zl=xj;function UT(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:gx,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw Uo.create("bad-app-name",{appName:String(s)});if(r||(r=RT()),!r)throw Uo.create("no-options");const a=Ah.get(s);if(a){if(Go(r,a.options)&&Go(n,a.config))return a;throw Uo.create("duplicate-app",{appName:s})}const i=new IP(s);for(const c of xx.values())i.addComponent(c);const o=new bj(r,n,i);return Ah.set(s,o),o}function Rm(t=gx){const e=Ah.get(t);if(!e&&t===gx&&RT())return UT();if(!e)throw Uo.create("no-app",{appName:t});return e}function ea(t,e,r){let n=vj[t]??t;r&&(n+=`-${r}`);const s=n.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const i=[`Unable to register library "${n}" with version "${e}":`];s&&i.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&a&&i.push("and"),a&&i.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Yi.warn(i.join(" "));return}ti(new Ca(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _j="firebase-heartbeat-database",Sj=1,ef="firebase-heartbeat-store";let Hp=null;function VT(){return Hp||(Hp=$T(_j,Sj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ef)}catch(r){console.warn(r)}}}}).catch(t=>{throw Uo.create("idb-open",{originalErrorMessage:t.message})})),Hp}async function Ej(t){try{const r=(await VT()).transaction(ef),n=await r.objectStore(ef).get(BT(t));return await r.done,n}catch(e){if(e instanceof Ra)Yi.warn(e.message);else{const r=Uo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Yi.warn(r.message)}}}async function s2(t,e){try{const n=(await VT()).transaction(ef,"readwrite");await n.objectStore(ef).put(e,BT(t)),await n.done}catch(r){if(r instanceof Ra)Yi.warn(r.message);else{const n=Uo.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Yi.warn(n.message)}}}function BT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tj=1024,kj=30;class Aj{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Cj(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=a2();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(i=>i.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats.length>kj){const i=Nj(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Yi.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=a2(),{heartbeatsToSend:n,unsentEntries:s}=Ij(this._heartbeatsCache.heartbeats),a=kh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return Yi.warn(r),""}}}function a2(){return new Date().toISOString().substring(0,10)}function Ij(t,e=Tj){const r=[];let n=t.slice();for(const s of t){const a=r.find(i=>i.agent===s.agent);if(a){if(a.dates.push(s.date),i2(r)>e){a.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),i2(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Cj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return FT()?LT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Ej(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return s2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return s2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function i2(t){return kh(JSON.stringify({version:2,heartbeats:t})).length}function Nj(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rj(t){ti(new Ca("platform-logger",e=>new zP(e),"PRIVATE")),ti(new Ca("heartbeat",e=>new Aj(e),"PRIVATE")),ea(px,r2,t),ea(px,r2,"esm2020"),ea("fire-js","")}Rj("");var Pj="firebase",jj="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ea(Pj,jj,"app");const zT="@firebase/installations",J1="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT=1e4,HT=`w:${J1}`,GT="FIS_v2",Dj="https://firebaseinstallations.googleapis.com/v1",Fj=60*60*1e3,Lj="installations",Oj="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mj={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},$l=new Jl(Lj,Oj,Mj);function qT(t){return t instanceof Ra&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KT({projectId:t}){return`${Dj}/projects/${t}/installations`}function QT(t){return{token:t.token,requestStatus:2,expiresIn:Uj(t.expiresIn),creationTime:Date.now()}}async function XT(t,e){const n=(await e.json()).error;return $l.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function YT({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function $j(t,{refreshToken:e}){const r=YT(t);return r.append("Authorization",Vj(e)),r}async function JT(t){const e=await t();return e.status>=500&&e.status<600?t():e}function Uj(t){return Number(t.replace("s","000"))}function Vj(t){return`${GT} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bj({appConfig:t,heartbeatServiceProvider:e},{fid:r}){const n=KT(t),s=YT(t),a=e.getImmediate({optional:!0});if(a){const u=await a.getHeartbeatsHeader();u&&s.append("x-firebase-client",u)}const i={fid:r,authVersion:GT,appId:t.appId,sdkVersion:HT},o={method:"POST",headers:s,body:JSON.stringify(i)},c=await JT(()=>fetch(n,o));if(c.ok){const u=await c.json();return{fid:u.fid||r,registrationStatus:2,refreshToken:u.refreshToken,authToken:QT(u.authToken)}}else throw await XT("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZT(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zj(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wj=/^[cdef][\w-]{21}$/,vx="";function Hj(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const r=Gj(t);return Wj.test(r)?r:vx}catch{return vx}}function Gj(t){return zj(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4=new Map;function t4(t,e){const r=Pm(t);r4(r,e),qj(r,e)}function r4(t,e){const r=e4.get(t);if(r)for(const n of r)n(e)}function qj(t,e){const r=Kj();r&&r.postMessage({key:t,fid:e}),Qj()}let _l=null;function Kj(){return!_l&&"BroadcastChannel"in self&&(_l=new BroadcastChannel("[Firebase] FID Change"),_l.onmessage=t=>{r4(t.data.key,t.data.fid)}),_l}function Qj(){e4.size===0&&_l&&(_l.close(),_l=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xj="firebase-installations-database",Yj=1,Ul="firebase-installations-store";let Gp=null;function Z1(){return Gp||(Gp=$T(Xj,Yj,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ul)}}})),Gp}async function Ih(t,e){const r=Pm(t),s=(await Z1()).transaction(Ul,"readwrite"),a=s.objectStore(Ul),i=await a.get(r);return await a.put(e,r),await s.done,(!i||i.fid!==e.fid)&&t4(t,e.fid),e}async function n4(t){const e=Pm(t),n=(await Z1()).transaction(Ul,"readwrite");await n.objectStore(Ul).delete(e),await n.done}async function jm(t,e){const r=Pm(t),s=(await Z1()).transaction(Ul,"readwrite"),a=s.objectStore(Ul),i=await a.get(r),o=e(i);return o===void 0?await a.delete(r):await a.put(o,r),await s.done,o&&(!i||i.fid!==o.fid)&&t4(t,o.fid),o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ev(t){let e;const r=await jm(t.appConfig,n=>{const s=Jj(n),a=Zj(t,s);return e=a.registrationPromise,a.installationEntry});return r.fid===vx?{installationEntry:await e}:{installationEntry:r,registrationPromise:e}}function Jj(t){const e=t||{fid:Hj(),registrationStatus:0};return s4(e)}function Zj(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject($l.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=e6(t,r);return{installationEntry:r,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:t6(t)}:{installationEntry:e}}async function e6(t,e){try{const r=await Bj(t,e);return Ih(t.appConfig,r)}catch(r){throw qT(r)&&r.customData.serverCode===409?await n4(t.appConfig):await Ih(t.appConfig,{fid:e.fid,registrationStatus:0}),r}}async function t6(t){let e=await o2(t.appConfig);for(;e.registrationStatus===1;)await ZT(100),e=await o2(t.appConfig);if(e.registrationStatus===0){const{installationEntry:r,registrationPromise:n}=await ev(t);return n||r}return e}function o2(t){return jm(t,e=>{if(!e)throw $l.create("installation-not-found");return s4(e)})}function s4(t){return r6(t)?{fid:t.fid,registrationStatus:0}:t}function r6(t){return t.registrationStatus===1&&t.registrationTime+WT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n6({appConfig:t,heartbeatServiceProvider:e},r){const n=s6(t,r),s=$j(t,r),a=e.getImmediate({optional:!0});if(a){const u=await a.getHeartbeatsHeader();u&&s.append("x-firebase-client",u)}const i={installation:{sdkVersion:HT,appId:t.appId}},o={method:"POST",headers:s,body:JSON.stringify(i)},c=await JT(()=>fetch(n,o));if(c.ok){const u=await c.json();return QT(u)}else throw await XT("Generate Auth Token",c)}function s6(t,{fid:e}){return`${KT(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tv(t,e=!1){let r;const n=await jm(t.appConfig,a=>{if(!a4(a))throw $l.create("not-registered");const i=a.authToken;if(!e&&o6(i))return a;if(i.requestStatus===1)return r=a6(t,e),a;{if(!navigator.onLine)throw $l.create("app-offline");const o=c6(a);return r=i6(t,o),o}});return r?await r:n.authToken}async function a6(t,e){let r=await l2(t.appConfig);for(;r.authToken.requestStatus===1;)await ZT(100),r=await l2(t.appConfig);const n=r.authToken;return n.requestStatus===0?tv(t,e):n}function l2(t){return jm(t,e=>{if(!a4(e))throw $l.create("not-registered");const r=e.authToken;return u6(r)?{...e,authToken:{requestStatus:0}}:e})}async function i6(t,e){try{const r=await n6(t,e),n={...e,authToken:r};return await Ih(t.appConfig,n),r}catch(r){if(qT(r)&&(r.customData.serverCode===401||r.customData.serverCode===404))await n4(t.appConfig);else{const n={...e,authToken:{requestStatus:0}};await Ih(t.appConfig,n)}throw r}}function a4(t){return t!==void 0&&t.registrationStatus===2}function o6(t){return t.requestStatus===2&&!l6(t)}function l6(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+Fj}function c6(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function u6(t){return t.requestStatus===1&&t.requestTime+WT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d6(t){const e=t,{installationEntry:r,registrationPromise:n}=await ev(e);return n?n.catch(console.error):tv(e).catch(console.error),r.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f6(t,e=!1){const r=t;return await h6(r),(await tv(r,e)).token}async function h6(t){const{registrationPromise:e}=await ev(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m6(t){if(!t||!t.options)throw qp("App Configuration");if(!t.name)throw qp("App Name");const e=["projectId","apiKey","appId"];for(const r of e)if(!t.options[r])throw qp(r);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function qp(t){return $l.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4="installations",p6="installations-internal",g6=t=>{const e=t.getProvider("app").getImmediate(),r=m6(e),n=sl(e,"heartbeat");return{app:e,appConfig:r,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},x6=t=>{const e=t.getProvider("app").getImmediate(),r=sl(e,i4).getImmediate();return{getId:()=>d6(r),getToken:s=>f6(r,s)}};function v6(){ti(new Ca(i4,g6,"PUBLIC")),ti(new Ca(p6,x6,"PRIVATE"))}v6();ea(zT,J1);ea(zT,J1,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ch="analytics",y6="firebase_id",w6="origin",b6=60*1e3,_6="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",rv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ls=new Nm("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S6={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},fa=new Jl("analytics","Analytics",S6);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E6(t){if(!t.startsWith(rv)){const e=fa.create("invalid-gtag-resource",{gtagURL:t});return Ls.warn(e.message),""}return t}function o4(t){return Promise.all(t.map(e=>e.catch(r=>r)))}function T6(t,e){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(t,e)),r}function k6(t,e){const r=T6("firebase-js-sdk-policy",{createScriptURL:E6}),n=document.createElement("script"),s=`${rv}?l=${t}&id=${e}`;n.src=r?r==null?void 0:r.createScriptURL(s):s,n.async=!0,document.head.appendChild(n)}function A6(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function I6(t,e,r,n,s,a){const i=n[s];try{if(i)await e[i];else{const c=(await o4(r)).find(u=>u.measurementId===s);c&&await e[c.appId]}}catch(o){Ls.error(o)}t("config",s,a)}async function C6(t,e,r,n,s){try{let a=[];if(s&&s.send_to){let i=s.send_to;Array.isArray(i)||(i=[i]);const o=await o4(r);for(const c of i){const u=o.find(h=>h.measurementId===c),d=u&&e[u.appId];if(d)a.push(d);else{a=[];break}}}a.length===0&&(a=Object.values(e)),await Promise.all(a),t("event",n,s||{})}catch(a){Ls.error(a)}}function N6(t,e,r,n){async function s(a,...i){try{if(a==="event"){const[o,c]=i;await C6(t,e,r,o,c)}else if(a==="config"){const[o,c]=i;await I6(t,e,r,n,o,c)}else if(a==="consent"){const[o,c]=i;t("consent",o,c)}else if(a==="get"){const[o,c,u]=i;t("get",o,c,u)}else if(a==="set"){const[o]=i;t("set",o)}else t(a,...i)}catch(o){Ls.error(o)}}return s}function R6(t,e,r,n,s){let a=function(...i){window[n].push(arguments)};return window[s]&&typeof window[s]=="function"&&(a=window[s]),window[s]=N6(a,t,e,r),{gtagCore:a,wrappedGtag:window[s]}}function P6(t){const e=window.document.getElementsByTagName("script");for(const r of Object.values(e))if(r.src&&r.src.includes(rv)&&r.src.includes(t))return r;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j6=30,D6=1e3;class F6{constructor(e={},r=D6){this.throttleMetadata=e,this.intervalMillis=r}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,r){this.throttleMetadata[e]=r}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const l4=new F6;function L6(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function O6(t){var i;const{appId:e,apiKey:r}=t,n={method:"GET",headers:L6(r)},s=_6.replace("{app-id}",e),a=await fetch(s,n);if(a.status!==200&&a.status!==304){let o="";try{const c=await a.json();(i=c.error)!=null&&i.message&&(o=c.error.message)}catch{}throw fa.create("config-fetch-failed",{httpStatus:a.status,responseMessage:o})}return a.json()}async function M6(t,e=l4,r){const{appId:n,apiKey:s,measurementId:a}=t.options;if(!n)throw fa.create("no-app-id");if(!s){if(a)return{measurementId:a,appId:n};throw fa.create("no-api-key")}const i=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new V6;return setTimeout(async()=>{o.abort()},b6),c4({appId:n,apiKey:s,measurementId:a},i,o,e)}async function c4(t,{throttleEndTimeMillis:e,backoffCount:r},n,s=l4){var o;const{appId:a,measurementId:i}=t;try{await $6(n,e)}catch(c){if(i)return Ls.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${i} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:a,measurementId:i};throw c}try{const c=await O6(t);return s.deleteThrottleMetadata(a),c}catch(c){const u=c;if(!U6(u)){if(s.deleteThrottleMetadata(a),i)return Ls.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${i} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:a,measurementId:i};throw c}const d=Number((o=u==null?void 0:u.customData)==null?void 0:o.httpStatus)===503?Jw(r,s.intervalMillis,j6):Jw(r,s.intervalMillis),h={throttleEndTimeMillis:Date.now()+d,backoffCount:r+1};return s.setThrottleMetadata(a,h),Ls.debug(`Calling attemptFetch again in ${d} millis`),c4(t,h,n,s)}}function $6(t,e){return new Promise((r,n)=>{const s=Math.max(e-Date.now(),0),a=setTimeout(r,s);t.addEventListener(()=>{clearTimeout(a),n(fa.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function U6(t){if(!(t instanceof Ra)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class V6{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function B6(t,e,r,n,s){if(s&&s.global){t("event",r,n);return}else{const a=await e,i={...n,send_to:a};t("event",r,i)}}async function z6(t,e,r,n){if(n&&n.global){const s={};for(const a of Object.keys(r))s[`user_properties.${a}`]=r[a];return t("set",s),Promise.resolve()}else{const s=await e;t("config",s,{update:!0,user_properties:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W6(){if(FT())try{await LT()}catch(t){return Ls.warn(fa.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return Ls.warn(fa.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function H6(t,e,r,n,s,a,i){const o=M6(t);o.then(m=>{r[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&Ls.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>Ls.error(m)),e.push(o);const c=W6().then(m=>{if(m)return n.getId()}),[u,d]=await Promise.all([o,c]);P6(a)||k6(a,u.measurementId),s("js",new Date);const h=(i==null?void 0:i.config)??{};return h[w6]="firebase",h.update=!0,d!=null&&(h[y6]=d),s("config",u.measurementId,h),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G6{constructor(e){this.app=e}_delete(){return delete Hc[this.app.options.appId],Promise.resolve()}}let Hc={},c2=[];const u2={};let Kp="dataLayer",q6="gtag",d2,nv,f2=!1;function K6(){const t=[];if(DT()&&t.push("This is a browser extension environment."),hP()||t.push("Cookies are not available."),t.length>0){const e=t.map((n,s)=>`(${s+1}) ${n}`).join(" "),r=fa.create("invalid-analytics-context",{errorInfo:e});Ls.warn(r.message)}}function Q6(t,e,r){K6();const n=t.options.appId;if(!n)throw fa.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Ls.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw fa.create("no-api-key");if(Hc[n]!=null)throw fa.create("already-exists",{id:n});if(!f2){A6(Kp);const{wrappedGtag:a,gtagCore:i}=R6(Hc,c2,u2,Kp,q6);nv=a,d2=i,f2=!0}return Hc[n]=H6(t,c2,u2,e,d2,Kp,r),new G6(t)}function X6(t=Rm()){t=hn(t);const e=sl(t,Ch);return e.isInitialized()?e.getImmediate():Y6(t)}function Y6(t,e={}){const r=sl(t,Ch);if(r.isInitialized()){const s=r.getImmediate();if(Go(e,r.getOptions()))return s;throw fa.create("already-initialized")}return r.initialize({options:e})}function J6(t,e,r){t=hn(t),z6(nv,Hc[t.app.options.appId],e,r).catch(n=>Ls.error(n))}function Z6(t,e,r,n){t=hn(t),B6(nv,Hc[t.app.options.appId],e,r,n).catch(s=>Ls.error(s))}const h2="@firebase/analytics",m2="0.10.19";function eD(){ti(new Ca(Ch,(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return Q6(n,s,r)},"PUBLIC")),ti(new Ca("analytics-internal",t,"PRIVATE")),ea(h2,m2),ea(h2,m2,"esm2020");function t(e){try{const r=e.getProvider(Ch).getImmediate();return{logEvent:(n,s,a)=>Z6(r,n,s,a),setUserProperties:(n,s)=>J6(r,n,s)}}catch(r){throw fa.create("interop-component-reg-failed",{reason:r})}}}eD();function u4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const tD=u4,d4=new Jl("auth","Firebase",u4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nh=new Nm("@firebase/auth");function rD(t,...e){Nh.logLevel<=mr.WARN&&Nh.warn(`Auth (${Zl}): ${t}`,...e)}function G0(t,...e){Nh.logLevel<=mr.ERROR&&Nh.error(`Auth (${Zl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ri(t,...e){throw sv(t,...e)}function yi(t,...e){return sv(t,...e)}function f4(t,e,r){const n={...tD(),[e]:r};return new Jl("auth","Firebase",n).create(e,{appName:t.name})}function Wi(t){return f4(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function sv(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return d4.create(t,...e)}function Gt(t,e,...r){if(!t)throw sv(e,...r)}function Ui(t){const e="INTERNAL ASSERTION FAILED: "+t;throw G0(e),new Error(e)}function Ji(t,e){t||Ui(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yx(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function nD(){return p2()==="http:"||p2()==="https:"}function p2(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nD()||DT()||"connection"in navigator)?navigator.onLine:!0}function aD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ji(r>e,"Short delay should be less than long delay!"),this.isMobile=oP()||uP()}get(){return sD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function av(t,e){Ji(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h4{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ui("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ui("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ui("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],lD=new If(3e4,6e4);function no(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function so(t,e,r,n,s={}){return m4(t,s,async()=>{let a={},i={};n&&(e==="GET"?i=n:a={body:JSON.stringify(n)});const o=Af({key:t.config.apiKey,...i}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...a};return cP()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Yl(t.emulatorConfig.host)&&(u.credentials="include"),h4.fetch()(await p4(t,t.config.apiHost,r,o),u)})}async function m4(t,e,r){t._canInitEmulator=!1;const n={...iD,...e};try{const s=new uD(t),a=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw m0(t,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const o=a.ok?i.errorMessage:i.error.message,[c,u]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw m0(t,"credential-already-in-use",i);if(c==="EMAIL_EXISTS")throw m0(t,"email-already-in-use",i);if(c==="USER_DISABLED")throw m0(t,"user-disabled",i);const d=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw f4(t,d,u);ri(t,d)}}catch(s){if(s instanceof Ra)throw s;ri(t,"network-request-failed",{message:String(s)})}}async function Cf(t,e,r,n,s={}){const a=await so(t,e,r,n,s);return"mfaPendingCredential"in a&&ri(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function p4(t,e,r,n){const s=`${e}${r}?${n}`,a=t,i=a.config.emulator?av(t.config,s):`${t.config.apiScheme}://${s}`;return oD.includes(r)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(i).toString():i}function cD(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class uD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(yi(this.auth,"network-request-failed")),lD.get())})}}function m0(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=yi(t,e,n);return s.customData._tokenResponse=r,s}function g2(t){return t!==void 0&&t.enterprise!==void 0}class dD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return cD(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function fD(t,e){return so(t,"GET","/v2/recaptchaConfig",no(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hD(t,e){return so(t,"POST","/v1/accounts:delete",e)}async function Rh(t,e){return so(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wd(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function mD(t,e=!1){const r=hn(t),n=await r.getIdToken(e),s=iv(n);Gt(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,i=a==null?void 0:a.sign_in_provider;return{claims:s,token:n,authTime:wd(Qp(s.auth_time)),issuedAtTime:wd(Qp(s.iat)),expirationTime:wd(Qp(s.exp)),signInProvider:i||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Qp(t){return Number(t)*1e3}function iv(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return G0("JWT malformed, contained fewer than 3 sections"),null;try{const s=IT(r);return s?JSON.parse(s):(G0("Failed to decode base64 JWT payload"),null)}catch(s){return G0("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function x2(t){const e=iv(t);return Gt(e,"internal-error"),Gt(typeof e.exp<"u","internal-error"),Gt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tf(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ra&&pD(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function pD({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=wd(this.lastLoginAt),this.creationTime=wd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ph(t){var h;const e=t.auth,r=await t.getIdToken(),n=await tf(t,Rh(e,{idToken:r}));Gt(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];t._notifyReloadListener(s);const a=(h=s.providerUserInfo)!=null&&h.length?g4(s.providerUserInfo):[],i=vD(t.providerData,a),o=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(i!=null&&i.length),u=o?c:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new wx(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,d)}async function xD(t){const e=hn(t);await Ph(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function vD(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function g4(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yD(t,e){const r=await m4(t,{},async()=>{const n=Af({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=t.config,i=await p4(t,s,"/v1/token",`key=${a}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:o,body:n};return t.emulatorConfig&&Yl(t.emulatorConfig.host)&&(c.credentials="include"),h4.fetch()(i,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function wD(t,e){return so(t,"POST","/v2/accounts:revokeToken",no(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Gt(e.idToken,"internal-error"),Gt(typeof e.idToken<"u","internal-error"),Gt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):x2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Gt(e.length!==0,"internal-error");const r=x2(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Gt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:a}=await yD(e,r);this.updateTokensAndExpiration(n,s,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:a}=r,i=new Gc;return n&&(Gt(typeof n=="string","internal-error",{appName:e}),i.refreshToken=n),s&&(Gt(typeof s=="string","internal-error",{appName:e}),i.accessToken=s),a&&(Gt(typeof a=="number","internal-error",{appName:e}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Gc,this.toJSON())}_performRefresh(){return Ui("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ho(t,e){Gt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class qa{constructor({uid:e,auth:r,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new gD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new wx(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await tf(this,this.stsTokenManager.getToken(this.auth,e));return Gt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return mD(this,e)}reload(){return xD(this)}_assign(e){this!==e&&(Gt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new qa({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Gt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Ph(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(oa(this.auth.app))return Promise.reject(Wi(this.auth));const e=await this.getIdToken();return await tf(this,hD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,s=r.email??void 0,a=r.phoneNumber??void 0,i=r.photoURL??void 0,o=r.tenantId??void 0,c=r._redirectEventId??void 0,u=r.createdAt??void 0,d=r.lastLoginAt??void 0,{uid:h,emailVerified:m,isAnonymous:p,providerData:y,stsTokenManager:v}=r;Gt(h&&v,e,"internal-error");const b=Gc.fromJSON(this.name,v);Gt(typeof h=="string",e,"internal-error"),ho(n,e.name),ho(s,e.name),Gt(typeof m=="boolean",e,"internal-error"),Gt(typeof p=="boolean",e,"internal-error"),ho(a,e.name),ho(i,e.name),ho(o,e.name),ho(c,e.name),ho(u,e.name),ho(d,e.name);const E=new qa({uid:h,auth:e,email:s,emailVerified:m,displayName:n,isAnonymous:p,photoURL:i,phoneNumber:a,tenantId:o,stsTokenManager:b,createdAt:u,lastLoginAt:d});return y&&Array.isArray(y)&&(E.providerData=y.map(T=>({...T}))),c&&(E._redirectEventId=c),E}static async _fromIdTokenResponse(e,r,n=!1){const s=new Gc;s.updateFromServerResponse(r);const a=new qa({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Ph(a),a}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];Gt(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?g4(s.providerUserInfo):[],i=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),o=new Gc;o.updateFromIdToken(n);const c=new qa({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:i}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new wx(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v2=new Map;function Vi(t){Ji(t instanceof Function,"Expected a class definition");let e=v2.get(t);return e?(Ji(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,v2.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}x4.type="NONE";const y2=x4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(t,e,r){return`firebase:${t}:${e}:${r}`}class qc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:a}=this.auth;this.fullUserKey=q0(this.userKey,s.apiKey,a),this.fullPersistenceKey=q0("persistence",s.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Rh(this.auth,{idToken:e}).catch(()=>{});return r?qa._fromGetAccountInfoResponse(this.auth,r,e):null}return qa._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new qc(Vi(y2),e,n);const s=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let a=s[0]||Vi(y2);const i=q0(n,e.config.apiKey,e.name);let o=null;for(const u of r)try{const d=await u._get(i);if(d){let h;if(typeof d=="string"){const m=await Rh(e,{idToken:d}).catch(()=>{});if(!m)break;h=await qa._fromGetAccountInfoResponse(e,m,d)}else h=qa._fromJSON(e,d);u!==a&&(o=h),a=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!a._shouldAllowMigration||!c.length?new qc(a,e,n):(a=c[0],o&&await a._set(i,o.toJSON()),await Promise.all(r.map(async u=>{if(u!==a)try{await u._remove(i)}catch{}})),new qc(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w2(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(b4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(v4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(S4(e))return"Blackberry";if(E4(e))return"Webos";if(y4(e))return"Safari";if((e.includes("chrome/")||w4(e))&&!e.includes("edge/"))return"Chrome";if(_4(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function v4(t=Ss()){return/firefox\//i.test(t)}function y4(t=Ss()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function w4(t=Ss()){return/crios\//i.test(t)}function b4(t=Ss()){return/iemobile/i.test(t)}function _4(t=Ss()){return/android/i.test(t)}function S4(t=Ss()){return/blackberry/i.test(t)}function E4(t=Ss()){return/webos/i.test(t)}function ov(t=Ss()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function bD(t=Ss()){var e;return ov(t)&&!!((e=window.navigator)!=null&&e.standalone)}function _D(){return dP()&&document.documentMode===10}function T4(t=Ss()){return ov(t)||_4(t)||E4(t)||S4(t)||/windows phone/i.test(t)||b4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k4(t,e=[]){let r;switch(t){case"Browser":r=w2(Ss());break;case"Worker":r=`${w2(Ss())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Zl}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((i,o)=>{try{const c=e(a);i(c)}catch(c){o(c)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ED(t,e={}){return so(t,"GET","/v2/passwordPolicy",no(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD=6;class kD{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??TD,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new b2(this),this.idTokenSubscription=new b2(this),this.beforeStateQueue=new SD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=d4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Vi(r)),this._initializationPromise=this.queue(async()=>{var n,s,a;if(!this._deleted&&(this.persistenceManager=await qc.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((a=this.currentUser)==null?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Rh(this,{idToken:e}),n=await qa._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var a;if(oa(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=(a=this.redirectUser)==null?void 0:a._redirectEventId,o=n==null?void 0:n._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===o)&&(c!=null&&c.user)&&(n=c.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(i){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Gt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Ph(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=aD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(oa(this.app))return Promise.reject(Wi(this));const r=e?hn(e):null;return r&&Gt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Gt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return oa(this.app)?Promise.reject(Wi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return oa(this.app)?Promise.reject(Wi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ED(this),r=new kD(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Jl("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await wD(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Vi(e)||this._popupRedirectResolver;Gt(r,this,"argument-error"),this.redirectPersistenceManager=await qc.create(this,[Vi(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let i=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Gt(o,this,"internal-error"),o.then(()=>{i||a(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,s);return()=>{i=!0,c()}}else{const c=e.addObserver(r);return()=>{i=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Gt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=k4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var r;if(oa(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return e!=null&&e.error&&rD(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function al(t){return hn(t)}class b2{constructor(e){this.auth=e,this.observer=null,this.addObserver=vP(r=>this.observer=r)}get next(){return Gt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ID(t){Dm=t}function A4(t){return Dm.loadJS(t)}function CD(){return Dm.recaptchaEnterpriseScript}function ND(){return Dm.gapiScript}function RD(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class PD{constructor(){this.enterprise=new jD}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class jD{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const DD="recaptcha-enterprise",I4="NO_RECAPTCHA";class FD{constructor(e){this.type=DD,this.auth=al(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(i,o)=>{fD(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const u=new dD(c);return a.tenantId==null?a._agentRecaptchaConfig=u:a._tenantRecaptchaConfigs[a.tenantId]=u,i(u.siteKey)}}).catch(c=>{o(c)})})}function s(a,i,o){const c=window.grecaptcha;g2(c)?c.enterprise.ready(()=>{c.enterprise.execute(a,{action:e}).then(u=>{i(u)}).catch(()=>{i(I4)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new PD().execute("siteKey",{action:"verify"}):new Promise((a,i)=>{n(this.auth).then(o=>{if(!r&&g2(window.grecaptcha))s(o,a,i);else{if(typeof window>"u"){i(new Error("RecaptchaVerifier is only supported in browser"));return}let c=CD();c.length!==0&&(c+=o),A4(c).then(()=>{s(o,a,i)}).catch(u=>{i(u)})}}).catch(o=>{i(o)})})}}async function _2(t,e,r,n=!1,s=!1){const a=new FD(t);let i;if(s)i=I4;else try{i=await a.verify(r)}catch{i=await a.verify(r,!0)}const o={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const c=o.phoneEnrollmentInfo.phoneNumber,u=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:i,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const c=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:i,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function jh(t,e,r,n,s){var a;if((a=t._getRecaptchaConfig())!=null&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await _2(t,e,r,r==="getOobCode");return n(t,i)}else return n(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await _2(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LD(t,e){const r=sl(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),a=r.getOptions();if(Go(a,e??{}))return s;ri(s,"already-initialized")}return r.initialize({options:e})}function OD(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Vi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function MD(t,e,r){const n=al(t);Gt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,a=C4(e),{host:i,port:o}=$D(e),c=o===null?"":`:${o}`,u={url:`${a}//${i}${c}/`},d=Object.freeze({host:i,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){Gt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Gt(Go(u,n.config.emulator)&&Go(d,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=u,n.emulatorConfig=d,n.settings.appVerificationDisabledForTesting=!0,Yl(i)?(Q1(`${a}//${i}${c}`),X1("Auth",!0)):UD()}function C4(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function $D(t){const e=C4(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const a=s[1];return{host:a,port:S2(n.substr(a.length+1))}}else{const[a,i]=n.split(":");return{host:a,port:S2(i)}}}function S2(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function UD(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ui("not implemented")}_getIdTokenResponse(e){return Ui("not implemented")}_linkToIdToken(e,r){return Ui("not implemented")}_getReauthenticationResolver(e){return Ui("not implemented")}}async function VD(t,e){return so(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BD(t,e){return Cf(t,"POST","/v1/accounts:signInWithPassword",no(t,e))}async function zD(t,e){return so(t,"POST","/v1/accounts:sendOobCode",no(t,e))}async function WD(t,e){return zD(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HD(t,e){return Cf(t,"POST","/v1/accounts:signInWithEmailLink",no(t,e))}async function GD(t,e){return Cf(t,"POST","/v1/accounts:signInWithEmailLink",no(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf extends lv{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new rf(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new rf(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jh(e,r,"signInWithPassword",BD);case"emailLink":return HD(e,{email:this._email,oobCode:this._password});default:ri(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jh(e,n,"signUpPassword",VD);case"emailLink":return GD(e,{idToken:r,email:this._email,oobCode:this._password});default:ri(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kc(t,e){return Cf(t,"POST","/v1/accounts:signInWithIdp",no(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qD="http://localhost";class Vl extends lv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Vl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ri("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...a}=r;if(!n||!s)return null;const i=new Vl(n,s);return i.idToken=a.idToken||void 0,i.accessToken=a.accessToken||void 0,i.secret=a.secret,i.nonce=a.nonce,i.pendingToken=a.pendingToken||null,i}_getIdTokenResponse(e){const r=this.buildRequest();return Kc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Kc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Kc(e,r)}buildRequest(){const e={requestUri:qD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Af(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KD(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function QD(t){const e=Zu(ed(t)).link,r=e?Zu(ed(e)).deep_link_id:null,n=Zu(ed(t)).deep_link_id;return(n?Zu(ed(n)).link:null)||n||r||e||t}class cv{constructor(e){const r=Zu(ed(e)),n=r.apiKey??null,s=r.oobCode??null,a=KD(r.mode??null);Gt(n&&s&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=s,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=QD(e);try{return new cv(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(){this.providerId=bu.PROVIDER_ID}static credential(e,r){return rf._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=cv.parseLink(r);return Gt(n,"argument-error"),rf._fromEmailAndCode(e,n.code,n.tenantId)}}bu.PROVIDER_ID="password";bu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";bu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf extends N4{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo extends Nf{constructor(){super("facebook.com")}static credential(e){return Vl._fromParams({providerId:wo.PROVIDER_ID,signInMethod:wo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wo.credentialFromTaggedObject(e)}static credentialFromError(e){return wo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wo.credential(e.oauthAccessToken)}catch{return null}}}wo.FACEBOOK_SIGN_IN_METHOD="facebook.com";wo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo extends Nf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Vl._fromParams({providerId:bo.PROVIDER_ID,signInMethod:bo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return bo.credentialFromTaggedObject(e)}static credentialFromError(e){return bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return bo.credential(r,n)}catch{return null}}}bo.GOOGLE_SIGN_IN_METHOD="google.com";bo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o extends Nf{constructor(){super("github.com")}static credential(e){return Vl._fromParams({providerId:_o.PROVIDER_ID,signInMethod:_o.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _o.credentialFromTaggedObject(e)}static credentialFromError(e){return _o.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _o.credential(e.oauthAccessToken)}catch{return null}}}_o.GITHUB_SIGN_IN_METHOD="github.com";_o.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So extends Nf{constructor(){super("twitter.com")}static credential(e,r){return Vl._fromParams({providerId:So.PROVIDER_ID,signInMethod:So.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return So.credentialFromTaggedObject(e)}static credentialFromError(e){return So.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return So.credential(r,n)}catch{return null}}}So.TWITTER_SIGN_IN_METHOD="twitter.com";So.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XD(t,e){return Cf(t,"POST","/v1/accounts:signUp",no(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const a=await qa._fromIdTokenResponse(e,n,s),i=E2(n);return new Bl({user:a,providerId:i,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=E2(n);return new Bl({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function E2(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh extends Ra{constructor(e,r,n,s){super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Dh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new Dh(e,r,n,s)}}function R4(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Dh._fromErrorAndOperation(t,a,e,n):a})}async function YD(t,e,r=!1){const n=await tf(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Bl._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JD(t,e,r=!1){const{auth:n}=t;if(oa(n.app))return Promise.reject(Wi(n));const s="reauthenticate";try{const a=await tf(t,R4(n,s,e,t),r);Gt(a.idToken,n,"internal-error");const i=iv(a.idToken);Gt(i,n,"internal-error");const{sub:o}=i;return Gt(t.uid===o,n,"user-mismatch"),Bl._forOperation(t,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&ri(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P4(t,e,r=!1){if(oa(t.app))return Promise.reject(Wi(t));const n="signIn",s=await R4(t,n,e),a=await Bl._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(a.user),a}async function ZD(t,e){return P4(al(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j4(t){const e=al(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function eF(t,e,r){const n=al(t);await jh(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",WD)}async function tF(t,e,r){if(oa(t.app))return Promise.reject(Wi(t));const n=al(t),i=await jh(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",XD).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&j4(t),c}),o=await Bl._fromIdTokenResponse(n,"signIn",i);return await n._updateCurrentUser(o.user),o}function rF(t,e,r){return oa(t.app)?Promise.reject(Wi(t)):ZD(hn(t),bu.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&j4(t),n})}function nF(t,e,r,n){return hn(t).onIdTokenChanged(e,r,n)}function sF(t,e,r){return hn(t).beforeAuthStateChanged(e,r)}function aF(t,e,r,n){return hn(t).onAuthStateChanged(e,r,n)}function iF(t){return hn(t).signOut()}const Fh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D4{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Fh,"1"),this.storage.removeItem(Fh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF=1e3,lF=10;class F4 extends D4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=T4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((i,o,c)=>{this.notifyListeners(i,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const i=this.storage.getItem(n);!r&&this.localCache[n]===i||this.notifyListeners(n,i)},a=this.storage.getItem(n);_D()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,lF):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},oF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}F4.type="LOCAL";const cF=F4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4 extends D4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}L4.type="SESSION";const O4=L4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new Fm(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:a}=r.data,i=this.handlersMap[s];if(!(i!=null&&i.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(i).map(async u=>u(r.origin,a)),c=await uF(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Fm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uv(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,i;return new Promise((o,c)=>{const u=uv("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},n);i={messageChannel:s,onMessage(h){const m=h;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(d),a=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(m.data.response);break;default:clearTimeout(d),clearTimeout(a),c(new Error("invalid_response"));break}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wi(){return window}function fF(t){wi().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M4(){return typeof wi().WorkerGlobalScope<"u"&&typeof wi().importScripts=="function"}async function hF(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function mF(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function pF(){return M4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $4="firebaseLocalStorageDb",gF=1,Lh="firebaseLocalStorage",U4="fbase_key";class Rf{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Lm(t,e){return t.transaction([Lh],e?"readwrite":"readonly").objectStore(Lh)}function xF(){const t=indexedDB.deleteDatabase($4);return new Rf(t).toPromise()}function bx(){const t=indexedDB.open($4,gF);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Lh,{keyPath:U4})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Lh)?e(n):(n.close(),await xF(),e(await bx()))})})}async function T2(t,e,r){const n=Lm(t,!0).put({[U4]:e,value:r});return new Rf(n).toPromise()}async function vF(t,e){const r=Lm(t,!1).get(e),n=await new Rf(r).toPromise();return n===void 0?null:n.value}function k2(t,e){const r=Lm(t,!0).delete(e);return new Rf(r).toPromise()}const yF=800,wF=3;class V4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await bx(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>wF)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return M4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Fm._getInstance(pF()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var r,n;if(this.activeServiceWorker=await hF(),!this.activeServiceWorker)return;this.sender=new dF(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(r=e[0])!=null&&r.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||mF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await bx();return await T2(e,Fh,"1"),await k2(e,Fh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>T2(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>vF(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>k2(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=Lm(s,!1).getAll();return new Rf(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),yF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}V4.type="LOCAL";const bF=V4;new If(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _F(t,e){return e?Vi(e):(Gt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv extends lv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Kc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Kc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Kc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function SF(t){return P4(t.auth,new dv(t),t.bypassAuthState)}function EF(t){const{auth:e,user:r}=t;return Gt(r,e,"internal-error"),JD(r,new dv(t),t.bypassAuthState)}async function TF(t){const{auth:e,user:r}=t;return Gt(r,e,"internal-error"),YD(r,new dv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{constructor(e,r,n,s,a=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:a,error:i,type:o}=e;if(i){this.reject(i);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return SF;case"linkViaPopup":case"linkViaRedirect":return TF;case"reauthViaPopup":case"reauthViaRedirect":return EF;default:ri(this.auth,"internal-error")}}resolve(e){Ji(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ji(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kF=new If(2e3,1e4);class Lc extends B4{constructor(e,r,n,s,a){super(e,r,s,a),this.provider=n,this.authWindow=null,this.pollId=null,Lc.currentPopupAction&&Lc.currentPopupAction.cancel(),Lc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Gt(e,this.auth,"internal-error"),e}async onExecution(){Ji(this.filter.length===1,"Popup operations only handle one event");const e=uv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(yi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(yi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Lc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if((n=(r=this.authWindow)==null?void 0:r.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(yi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,kF.get())};e()}}Lc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AF="pendingRedirect",K0=new Map;class IF extends B4{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=K0.get(this.auth._key());if(!e){try{const n=await CF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}K0.set(this.auth._key(),e)}return this.bypassAuthState||K0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function CF(t,e){const r=PF(e),n=RF(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function NF(t,e){K0.set(t._key(),e)}function RF(t){return Vi(t._redirectPersistence)}function PF(t){return q0(AF,t.config.apiKey,t.name)}async function jF(t,e,r=!1){if(oa(t.app))return Promise.reject(Wi(t));const n=al(t),s=_F(n,e),i=await new IF(n,s,r).execute();return i&&!r&&(delete i.user._redirectEventId,await n._persistUserIfCurrent(i.user),await n._setRedirectUser(null,e)),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DF=10*60*1e3;class FF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!LF(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!z4(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";r.onError(yi(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=DF&&this.cachedEventUids.clear(),this.cachedEventUids.has(A2(e))}saveEventToCache(e){this.cachedEventUids.add(A2(e)),this.lastProcessedEventTime=Date.now()}}function A2(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function z4({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function LF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return z4(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OF(t,e={}){return so(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$F=/^https?/;async function UF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await OF(t);for(const r of e)try{if(VF(r))return}catch{}ri(t,"unauthorized-domain")}function VF(t){const e=yx(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const i=new URL(t);return i.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&i.hostname===n}if(!$F.test(r))return!1;if(MF.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BF=new If(3e4,6e4);function I2(){const t=wi().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function zF(t){return new Promise((e,r)=>{var s,a,i;function n(){I2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{I2(),r(yi(t,"network-request-failed"))},timeout:BF.get()})}if((a=(s=wi().gapi)==null?void 0:s.iframes)!=null&&a.Iframe)e(gapi.iframes.getContext());else if((i=wi().gapi)!=null&&i.load)n();else{const o=RD("iframefcb");return wi()[o]=()=>{gapi.load?n():r(yi(t,"network-request-failed"))},A4(`${ND()}?onload=${o}`).catch(c=>r(c))}}).catch(e=>{throw Q0=null,e})}let Q0=null;function WF(t){return Q0=Q0||zF(t),Q0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HF=new If(5e3,15e3),GF="__/auth/iframe",qF="emulator/auth/iframe",KF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},QF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function XF(t){const e=t.config;Gt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?av(e,qF):`https://${t.config.authDomain}/${GF}`,n={apiKey:e.apiKey,appName:t.name,v:Zl},s=QF.get(t.config.apiHost);s&&(n.eid=s);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${Af(n).slice(1)}`}async function YF(t){const e=await WF(t),r=wi().gapi;return Gt(r,t,"internal-error"),e.open({where:document.body,url:XF(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:KF,dontclear:!0},n=>new Promise(async(s,a)=>{await n.restyle({setHideOnLeave:!1});const i=yi(t,"network-request-failed"),o=wi().setTimeout(()=>{a(i)},HF.get());function c(){wi().clearTimeout(o),s(n)}n.ping(c).then(c,()=>{a(i)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ZF=500,e8=600,t8="_blank",r8="http://localhost";class C2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function n8(t,e,r,n=ZF,s=e8){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const c={...JF,width:n.toString(),height:s.toString(),top:a,left:i},u=Ss().toLowerCase();r&&(o=w4(u)?t8:r),v4(u)&&(e=e||r8,c.scrollbars="yes");const d=Object.entries(c).reduce((m,[p,y])=>`${m}${p}=${y},`,"");if(bD(u)&&o!=="_self")return s8(e||"",o),new C2(null);const h=window.open(e||"",o,d);Gt(h,t,"popup-blocked");try{h.focus()}catch{}return new C2(h)}function s8(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a8="__/auth/handler",i8="emulator/auth/handler",o8=encodeURIComponent("fac");async function N2(t,e,r,n,s,a){Gt(t.config.authDomain,t,"auth-domain-config-required"),Gt(t.config.apiKey,t,"invalid-api-key");const i={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Zl,eventId:s};if(e instanceof N4){e.setDefaultLanguage(t.languageCode),i.providerId=e.providerId||"",xP(e.getCustomParameters())||(i.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))i[d]=h}if(e instanceof Nf){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(i.scopes=d.join(","))}t.tenantId&&(i.tid=t.tenantId);const o=i;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const c=await t._getAppCheckToken(),u=c?`#${o8}=${encodeURIComponent(c)}`:"";return`${l8(t)}?${Af(o).slice(1)}${u}`}function l8({config:t}){return t.emulator?av(t,i8):`https://${t.authDomain}/${a8}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xp="webStorageSupport";class c8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=O4,this._completeRedirectFn=jF,this._overrideRedirectResult=NF}async _openPopup(e,r,n,s){var i;Ji((i=this.eventManagers[e._key()])==null?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await N2(e,r,n,yx(),s);return n8(e,a,uv())}async _openRedirect(e,r,n,s){await this._originValidation(e);const a=await N2(e,r,n,yx(),s);return fF(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:a}=this.eventManagers[r];return s?Promise.resolve(s):(Ji(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await YF(e),n=new FF(e);return r.register("authEvent",s=>(Gt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Xp,{type:Xp},s=>{var i;const a=(i=s==null?void 0:s[0])==null?void 0:i[Xp];a!==void 0&&r(!!a),ri(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=UF(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return T4()||y4()||ov()}}const u8=c8;var R2="@firebase/auth",P2="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Gt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f8(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function h8(t){ti(new Ca("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=n.options;Gt(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:i,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:k4(t)},u=new AD(n,s,a,c);return OD(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),ti(new Ca("auth-internal",e=>{const r=al(e.getProvider("auth").getImmediate());return(n=>new d8(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),ea(R2,P2,f8(t)),ea(R2,P2,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m8=5*60,p8=PT("authIdTokenMaxAge")||m8;let j2=null;const g8=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>p8)return;const s=r==null?void 0:r.token;j2!==s&&(j2=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function x8(t=Rm()){const e=sl(t,"auth");if(e.isInitialized())return e.getImmediate();const r=LD(t,{popupRedirectResolver:u8,persistence:[bF,cF,O4]}),n=PT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const i=g8(a.toString());sF(r,i,()=>i(r.currentUser)),nF(r,o=>i(o))}}const s=CT("auth");return s&&MD(r,`http://${s}`),r}function v8(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}ID({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const a=yi("internal-error");a.customData=s,r(a)},n.type="text/javascript",n.charset="UTF-8",v8().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});h8("Browser");var D2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vo,W4;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(_,I){function C(){}C.prototype=I.prototype,_.F=I.prototype,_.prototype=new C,_.prototype.constructor=_,_.D=function(L,F,V){for(var O=Array(arguments.length-2),ct=2;ct<arguments.length;ct++)O[ct-2]=arguments[ct];return I.prototype[F].apply(L,O)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(_,I,C){C||(C=0);const L=Array(16);if(typeof I=="string")for(var F=0;F<16;++F)L[F]=I.charCodeAt(C++)|I.charCodeAt(C++)<<8|I.charCodeAt(C++)<<16|I.charCodeAt(C++)<<24;else for(F=0;F<16;++F)L[F]=I[C++]|I[C++]<<8|I[C++]<<16|I[C++]<<24;I=_.g[0],C=_.g[1],F=_.g[2];let V=_.g[3],O;O=I+(V^C&(F^V))+L[0]+3614090360&4294967295,I=C+(O<<7&4294967295|O>>>25),O=V+(F^I&(C^F))+L[1]+3905402710&4294967295,V=I+(O<<12&4294967295|O>>>20),O=F+(C^V&(I^C))+L[2]+606105819&4294967295,F=V+(O<<17&4294967295|O>>>15),O=C+(I^F&(V^I))+L[3]+3250441966&4294967295,C=F+(O<<22&4294967295|O>>>10),O=I+(V^C&(F^V))+L[4]+4118548399&4294967295,I=C+(O<<7&4294967295|O>>>25),O=V+(F^I&(C^F))+L[5]+1200080426&4294967295,V=I+(O<<12&4294967295|O>>>20),O=F+(C^V&(I^C))+L[6]+2821735955&4294967295,F=V+(O<<17&4294967295|O>>>15),O=C+(I^F&(V^I))+L[7]+4249261313&4294967295,C=F+(O<<22&4294967295|O>>>10),O=I+(V^C&(F^V))+L[8]+1770035416&4294967295,I=C+(O<<7&4294967295|O>>>25),O=V+(F^I&(C^F))+L[9]+2336552879&4294967295,V=I+(O<<12&4294967295|O>>>20),O=F+(C^V&(I^C))+L[10]+4294925233&4294967295,F=V+(O<<17&4294967295|O>>>15),O=C+(I^F&(V^I))+L[11]+2304563134&4294967295,C=F+(O<<22&4294967295|O>>>10),O=I+(V^C&(F^V))+L[12]+1804603682&4294967295,I=C+(O<<7&4294967295|O>>>25),O=V+(F^I&(C^F))+L[13]+4254626195&4294967295,V=I+(O<<12&4294967295|O>>>20),O=F+(C^V&(I^C))+L[14]+2792965006&4294967295,F=V+(O<<17&4294967295|O>>>15),O=C+(I^F&(V^I))+L[15]+1236535329&4294967295,C=F+(O<<22&4294967295|O>>>10),O=I+(F^V&(C^F))+L[1]+4129170786&4294967295,I=C+(O<<5&4294967295|O>>>27),O=V+(C^F&(I^C))+L[6]+3225465664&4294967295,V=I+(O<<9&4294967295|O>>>23),O=F+(I^C&(V^I))+L[11]+643717713&4294967295,F=V+(O<<14&4294967295|O>>>18),O=C+(V^I&(F^V))+L[0]+3921069994&4294967295,C=F+(O<<20&4294967295|O>>>12),O=I+(F^V&(C^F))+L[5]+3593408605&4294967295,I=C+(O<<5&4294967295|O>>>27),O=V+(C^F&(I^C))+L[10]+38016083&4294967295,V=I+(O<<9&4294967295|O>>>23),O=F+(I^C&(V^I))+L[15]+3634488961&4294967295,F=V+(O<<14&4294967295|O>>>18),O=C+(V^I&(F^V))+L[4]+3889429448&4294967295,C=F+(O<<20&4294967295|O>>>12),O=I+(F^V&(C^F))+L[9]+568446438&4294967295,I=C+(O<<5&4294967295|O>>>27),O=V+(C^F&(I^C))+L[14]+3275163606&4294967295,V=I+(O<<9&4294967295|O>>>23),O=F+(I^C&(V^I))+L[3]+4107603335&4294967295,F=V+(O<<14&4294967295|O>>>18),O=C+(V^I&(F^V))+L[8]+1163531501&4294967295,C=F+(O<<20&4294967295|O>>>12),O=I+(F^V&(C^F))+L[13]+2850285829&4294967295,I=C+(O<<5&4294967295|O>>>27),O=V+(C^F&(I^C))+L[2]+4243563512&4294967295,V=I+(O<<9&4294967295|O>>>23),O=F+(I^C&(V^I))+L[7]+1735328473&4294967295,F=V+(O<<14&4294967295|O>>>18),O=C+(V^I&(F^V))+L[12]+2368359562&4294967295,C=F+(O<<20&4294967295|O>>>12),O=I+(C^F^V)+L[5]+4294588738&4294967295,I=C+(O<<4&4294967295|O>>>28),O=V+(I^C^F)+L[8]+2272392833&4294967295,V=I+(O<<11&4294967295|O>>>21),O=F+(V^I^C)+L[11]+1839030562&4294967295,F=V+(O<<16&4294967295|O>>>16),O=C+(F^V^I)+L[14]+4259657740&4294967295,C=F+(O<<23&4294967295|O>>>9),O=I+(C^F^V)+L[1]+2763975236&4294967295,I=C+(O<<4&4294967295|O>>>28),O=V+(I^C^F)+L[4]+1272893353&4294967295,V=I+(O<<11&4294967295|O>>>21),O=F+(V^I^C)+L[7]+4139469664&4294967295,F=V+(O<<16&4294967295|O>>>16),O=C+(F^V^I)+L[10]+3200236656&4294967295,C=F+(O<<23&4294967295|O>>>9),O=I+(C^F^V)+L[13]+681279174&4294967295,I=C+(O<<4&4294967295|O>>>28),O=V+(I^C^F)+L[0]+3936430074&4294967295,V=I+(O<<11&4294967295|O>>>21),O=F+(V^I^C)+L[3]+3572445317&4294967295,F=V+(O<<16&4294967295|O>>>16),O=C+(F^V^I)+L[6]+76029189&4294967295,C=F+(O<<23&4294967295|O>>>9),O=I+(C^F^V)+L[9]+3654602809&4294967295,I=C+(O<<4&4294967295|O>>>28),O=V+(I^C^F)+L[12]+3873151461&4294967295,V=I+(O<<11&4294967295|O>>>21),O=F+(V^I^C)+L[15]+530742520&4294967295,F=V+(O<<16&4294967295|O>>>16),O=C+(F^V^I)+L[2]+3299628645&4294967295,C=F+(O<<23&4294967295|O>>>9),O=I+(F^(C|~V))+L[0]+4096336452&4294967295,I=C+(O<<6&4294967295|O>>>26),O=V+(C^(I|~F))+L[7]+1126891415&4294967295,V=I+(O<<10&4294967295|O>>>22),O=F+(I^(V|~C))+L[14]+2878612391&4294967295,F=V+(O<<15&4294967295|O>>>17),O=C+(V^(F|~I))+L[5]+4237533241&4294967295,C=F+(O<<21&4294967295|O>>>11),O=I+(F^(C|~V))+L[12]+1700485571&4294967295,I=C+(O<<6&4294967295|O>>>26),O=V+(C^(I|~F))+L[3]+2399980690&4294967295,V=I+(O<<10&4294967295|O>>>22),O=F+(I^(V|~C))+L[10]+4293915773&4294967295,F=V+(O<<15&4294967295|O>>>17),O=C+(V^(F|~I))+L[1]+2240044497&4294967295,C=F+(O<<21&4294967295|O>>>11),O=I+(F^(C|~V))+L[8]+1873313359&4294967295,I=C+(O<<6&4294967295|O>>>26),O=V+(C^(I|~F))+L[15]+4264355552&4294967295,V=I+(O<<10&4294967295|O>>>22),O=F+(I^(V|~C))+L[6]+2734768916&4294967295,F=V+(O<<15&4294967295|O>>>17),O=C+(V^(F|~I))+L[13]+1309151649&4294967295,C=F+(O<<21&4294967295|O>>>11),O=I+(F^(C|~V))+L[4]+4149444226&4294967295,I=C+(O<<6&4294967295|O>>>26),O=V+(C^(I|~F))+L[11]+3174756917&4294967295,V=I+(O<<10&4294967295|O>>>22),O=F+(I^(V|~C))+L[2]+718787259&4294967295,F=V+(O<<15&4294967295|O>>>17),O=C+(V^(F|~I))+L[9]+3951481745&4294967295,_.g[0]=_.g[0]+I&4294967295,_.g[1]=_.g[1]+(F+(O<<21&4294967295|O>>>11))&4294967295,_.g[2]=_.g[2]+F&4294967295,_.g[3]=_.g[3]+V&4294967295}n.prototype.v=function(_,I){I===void 0&&(I=_.length);const C=I-this.blockSize,L=this.C;let F=this.h,V=0;for(;V<I;){if(F==0)for(;V<=C;)s(this,_,V),V+=this.blockSize;if(typeof _=="string"){for(;V<I;)if(L[F++]=_.charCodeAt(V++),F==this.blockSize){s(this,L),F=0;break}}else for(;V<I;)if(L[F++]=_[V++],F==this.blockSize){s(this,L),F=0;break}}this.h=F,this.o+=I},n.prototype.A=function(){var _=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);_[0]=128;for(var I=1;I<_.length-8;++I)_[I]=0;I=this.o*8;for(var C=_.length-8;C<_.length;++C)_[C]=I&255,I/=256;for(this.v(_),_=Array(16),I=0,C=0;C<4;++C)for(let L=0;L<32;L+=8)_[I++]=this.g[C]>>>L&255;return _};function a(_,I){var C=o;return Object.prototype.hasOwnProperty.call(C,_)?C[_]:C[_]=I(_)}function i(_,I){this.h=I;const C=[];let L=!0;for(let F=_.length-1;F>=0;F--){const V=_[F]|0;L&&V==I||(C[F]=V,L=!1)}this.g=C}var o={};function c(_){return-128<=_&&_<128?a(_,function(I){return new i([I|0],I<0?-1:0)}):new i([_|0],_<0?-1:0)}function u(_){if(isNaN(_)||!isFinite(_))return h;if(_<0)return b(u(-_));const I=[];let C=1;for(let L=0;_>=C;L++)I[L]=_/C|0,C*=4294967296;return new i(I,0)}function d(_,I){if(_.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(_.charAt(0)=="-")return b(d(_.substring(1),I));if(_.indexOf("-")>=0)throw Error('number format error: interior "-" character');const C=u(Math.pow(I,8));let L=h;for(let V=0;V<_.length;V+=8){var F=Math.min(8,_.length-V);const O=parseInt(_.substring(V,V+F),I);F<8?(F=u(Math.pow(I,F)),L=L.j(F).add(u(O))):(L=L.j(C),L=L.add(u(O)))}return L}var h=c(0),m=c(1),p=c(16777216);t=i.prototype,t.m=function(){if(v(this))return-b(this).m();let _=0,I=1;for(let C=0;C<this.g.length;C++){const L=this.i(C);_+=(L>=0?L:4294967296+L)*I,I*=4294967296}return _},t.toString=function(_){if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(y(this))return"0";if(v(this))return"-"+b(this).toString(_);const I=u(Math.pow(_,6));var C=this;let L="";for(;;){const F=B(C,I).g;C=E(C,F.j(I));let V=((C.g.length>0?C.g[0]:C.h)>>>0).toString(_);if(C=F,y(C))return V+L;for(;V.length<6;)V="0"+V;L=V+L}},t.i=function(_){return _<0?0:_<this.g.length?this.g[_]:this.h};function y(_){if(_.h!=0)return!1;for(let I=0;I<_.g.length;I++)if(_.g[I]!=0)return!1;return!0}function v(_){return _.h==-1}t.l=function(_){return _=E(this,_),v(_)?-1:y(_)?0:1};function b(_){const I=_.g.length,C=[];for(let L=0;L<I;L++)C[L]=~_.g[L];return new i(C,~_.h).add(m)}t.abs=function(){return v(this)?b(this):this},t.add=function(_){const I=Math.max(this.g.length,_.g.length),C=[];let L=0;for(let F=0;F<=I;F++){let V=L+(this.i(F)&65535)+(_.i(F)&65535),O=(V>>>16)+(this.i(F)>>>16)+(_.i(F)>>>16);L=O>>>16,V&=65535,O&=65535,C[F]=O<<16|V}return new i(C,C[C.length-1]&-2147483648?-1:0)};function E(_,I){return _.add(b(I))}t.j=function(_){if(y(this)||y(_))return h;if(v(this))return v(_)?b(this).j(b(_)):b(b(this).j(_));if(v(_))return b(this.j(b(_)));if(this.l(p)<0&&_.l(p)<0)return u(this.m()*_.m());const I=this.g.length+_.g.length,C=[];for(var L=0;L<2*I;L++)C[L]=0;for(L=0;L<this.g.length;L++)for(let F=0;F<_.g.length;F++){const V=this.i(L)>>>16,O=this.i(L)&65535,ct=_.i(F)>>>16,me=_.i(F)&65535;C[2*L+2*F]+=O*me,T(C,2*L+2*F),C[2*L+2*F+1]+=V*me,T(C,2*L+2*F+1),C[2*L+2*F+1]+=O*ct,T(C,2*L+2*F+1),C[2*L+2*F+2]+=V*ct,T(C,2*L+2*F+2)}for(_=0;_<I;_++)C[_]=C[2*_+1]<<16|C[2*_];for(_=I;_<2*I;_++)C[_]=0;return new i(C,0)};function T(_,I){for(;(_[I]&65535)!=_[I];)_[I+1]+=_[I]>>>16,_[I]&=65535,I++}function w(_,I){this.g=_,this.h=I}function B(_,I){if(y(I))throw Error("division by zero");if(y(_))return new w(h,h);if(v(_))return I=B(b(_),I),new w(b(I.g),b(I.h));if(v(I))return I=B(_,b(I)),new w(b(I.g),I.h);if(_.g.length>30){if(v(_)||v(I))throw Error("slowDivide_ only works with positive integers.");for(var C=m,L=I;L.l(_)<=0;)C=J(C),L=J(L);var F=Z(C,1),V=Z(L,1);for(L=Z(L,2),C=Z(C,2);!y(L);){var O=V.add(L);O.l(_)<=0&&(F=F.add(C),V=O),L=Z(L,1),C=Z(C,1)}return I=E(_,F.j(I)),new w(F,I)}for(F=h;_.l(I)>=0;){for(C=Math.max(1,Math.floor(_.m()/I.m())),L=Math.ceil(Math.log(C)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),V=u(C),O=V.j(I);v(O)||O.l(_)>0;)C-=L,V=u(C),O=V.j(I);y(V)&&(V=m),F=F.add(V),_=E(_,O)}return new w(F,_)}t.B=function(_){return B(this,_).h},t.and=function(_){const I=Math.max(this.g.length,_.g.length),C=[];for(let L=0;L<I;L++)C[L]=this.i(L)&_.i(L);return new i(C,this.h&_.h)},t.or=function(_){const I=Math.max(this.g.length,_.g.length),C=[];for(let L=0;L<I;L++)C[L]=this.i(L)|_.i(L);return new i(C,this.h|_.h)},t.xor=function(_){const I=Math.max(this.g.length,_.g.length),C=[];for(let L=0;L<I;L++)C[L]=this.i(L)^_.i(L);return new i(C,this.h^_.h)};function J(_){const I=_.g.length+1,C=[];for(let L=0;L<I;L++)C[L]=_.i(L)<<1|_.i(L-1)>>>31;return new i(C,_.h)}function Z(_,I){const C=I>>5;I%=32;const L=_.g.length-C,F=[];for(let V=0;V<L;V++)F[V]=I>0?_.i(V+C)>>>I|_.i(V+C+1)<<32-I:_.i(V+C);return new i(F,_.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,W4=n,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.B,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=u,i.fromString=d,Vo=i}).apply(typeof D2<"u"?D2:typeof self<"u"?self:typeof window<"u"?window:{});var p0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var H4,td,G4,X0,_x,q4,K4,Q4;(function(){var t,e=Object.defineProperty;function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof p0=="object"&&p0];for(var x=0;x<f.length;++x){var S=f[x];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var n=r(this);function s(f,x){if(x)e:{var S=n;f=f.split(".");for(var H=0;H<f.length-1;H++){var he=f[H];if(!(he in S))break e;S=S[he]}f=f[f.length-1],H=S[f],x=x(H),x!=H&&x!=null&&e(S,f,{configurable:!0,writable:!0,value:x})}}s("Symbol.dispose",function(f){return f||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(f){return f||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(f){return f||function(x){var S=[],H;for(H in x)Object.prototype.hasOwnProperty.call(x,H)&&S.push([H,x[H]]);return S}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},i=this||self;function o(f){var x=typeof f;return x=="object"&&f!=null||x=="function"}function c(f,x,S){return f.call.apply(f.bind,arguments)}function u(f,x,S){return u=c,u.apply(null,arguments)}function d(f,x){var S=Array.prototype.slice.call(arguments,1);return function(){var H=S.slice();return H.push.apply(H,arguments),f.apply(this,H)}}function h(f,x){function S(){}S.prototype=x.prototype,f.Z=x.prototype,f.prototype=new S,f.prototype.constructor=f,f.Ob=function(H,he,Ce){for(var mt=Array(arguments.length-2),tr=2;tr<arguments.length;tr++)mt[tr-2]=arguments[tr];return x.prototype[he].apply(H,mt)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?f=>f&&AsyncContext.Snapshot.wrap(f):f=>f;function p(f){const x=f.length;if(x>0){const S=Array(x);for(let H=0;H<x;H++)S[H]=f[H];return S}return[]}function y(f,x){for(let H=1;H<arguments.length;H++){const he=arguments[H];var S=typeof he;if(S=S!="object"?S:he?Array.isArray(he)?"array":S:"null",S=="array"||S=="object"&&typeof he.length=="number"){S=f.length||0;const Ce=he.length||0;f.length=S+Ce;for(let mt=0;mt<Ce;mt++)f[S+mt]=he[mt]}else f.push(he)}}class v{constructor(x,S){this.i=x,this.j=S,this.h=0,this.g=null}get(){let x;return this.h>0?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function b(f){i.setTimeout(()=>{throw f},0)}function E(){var f=_;let x=null;return f.g&&(x=f.g,f.g=f.g.next,f.g||(f.h=null),x.next=null),x}class T{constructor(){this.h=this.g=null}add(x,S){const H=w.get();H.set(x,S),this.h?this.h.next=H:this.g=H,this.h=H}}var w=new v(()=>new B,f=>f.reset());class B{constructor(){this.next=this.g=this.h=null}set(x,S){this.h=x,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let J,Z=!1,_=new T,I=()=>{const f=Promise.resolve(void 0);J=()=>{f.then(C)}};function C(){for(var f;f=E();){try{f.h.call(f.g)}catch(S){b(S)}var x=w;x.j(f),x.h<100&&(x.h++,f.next=x.g,x.g=f)}Z=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(f,x){this.type=f,this.g=this.target=x,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var V=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var f=!1,x=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const S=()=>{};i.addEventListener("test",S,x),i.removeEventListener("test",S,x)}catch{}return f}();function O(f){return/^[\s\xa0]*$/.test(f)}function ct(f,x){F.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f&&this.init(f,x)}h(ct,F),ct.prototype.init=function(f,x){const S=this.type=f.type,H=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;this.target=f.target||f.srcElement,this.g=x,x=f.relatedTarget,x||(S=="mouseover"?x=f.fromElement:S=="mouseout"&&(x=f.toElement)),this.relatedTarget=x,H?(this.clientX=H.clientX!==void 0?H.clientX:H.pageX,this.clientY=H.clientY!==void 0?H.clientY:H.pageY,this.screenX=H.screenX||0,this.screenY=H.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=f.pointerType,this.state=f.state,this.i=f,f.defaultPrevented&&ct.Z.h.call(this)},ct.prototype.h=function(){ct.Z.h.call(this);const f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var me="closure_listenable_"+(Math.random()*1e6|0),ft=0;function rt(f,x,S,H,he){this.listener=f,this.proxy=null,this.src=x,this.type=S,this.capture=!!H,this.ha=he,this.key=++ft,this.da=this.fa=!1}function ze(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function ie(f,x,S){for(const H in f)x.call(S,f[H],H,f)}function Ye(f,x){for(const S in f)x.call(void 0,f[S],S,f)}function _e(f){const x={};for(const S in f)x[S]=f[S];return x}const Q="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ae(f,x){let S,H;for(let he=1;he<arguments.length;he++){H=arguments[he];for(S in H)f[S]=H[S];for(let Ce=0;Ce<Q.length;Ce++)S=Q[Ce],Object.prototype.hasOwnProperty.call(H,S)&&(f[S]=H[S])}}function le(f){this.src=f,this.g={},this.h=0}le.prototype.add=function(f,x,S,H,he){const Ce=f.toString();f=this.g[Ce],f||(f=this.g[Ce]=[],this.h++);const mt=Ae(f,x,H,he);return mt>-1?(x=f[mt],S||(x.fa=!1)):(x=new rt(x,this.src,Ce,!!H,he),x.fa=S,f.push(x)),x};function ne(f,x){const S=x.type;if(S in f.g){var H=f.g[S],he=Array.prototype.indexOf.call(H,x,void 0),Ce;(Ce=he>=0)&&Array.prototype.splice.call(H,he,1),Ce&&(ze(x),f.g[S].length==0&&(delete f.g[S],f.h--))}}function Ae(f,x,S,H){for(let he=0;he<f.length;++he){const Ce=f[he];if(!Ce.da&&Ce.listener==x&&Ce.capture==!!S&&Ce.ha==H)return he}return-1}var st="closure_lm_"+(Math.random()*1e6|0),ot={};function Ne(f,x,S,H,he){if(Array.isArray(x)){for(let Ce=0;Ce<x.length;Ce++)Ne(f,x[Ce],S,H,he);return null}return S=Ft(S),f&&f[me]?f.J(x,S,o(H)?!!H.capture:!1,he):Ve(f,x,S,!1,H,he)}function Ve(f,x,S,H,he,Ce){if(!x)throw Error("Invalid event type");const mt=o(he)?!!he.capture:!!he;let tr=Qe(f);if(tr||(f[st]=tr=new le(f)),S=tr.add(x,S,H,mt,Ce),S.proxy)return S;if(H=ge(),S.proxy=H,H.src=f,H.listener=S,f.addEventListener)V||(he=mt),he===void 0&&(he=!1),f.addEventListener(x.toString(),H,he);else if(f.attachEvent)f.attachEvent(et(x.toString()),H);else if(f.addListener&&f.removeListener)f.addListener(H);else throw Error("addEventListener and attachEvent are unavailable.");return S}function ge(){function f(S){return x.call(f.src,f.listener,S)}const x=ht;return f}function W(f,x,S,H,he){if(Array.isArray(x))for(var Ce=0;Ce<x.length;Ce++)W(f,x[Ce],S,H,he);else H=o(H)?!!H.capture:!!H,S=Ft(S),f&&f[me]?(f=f.i,Ce=String(x).toString(),Ce in f.g&&(x=f.g[Ce],S=Ae(x,S,H,he),S>-1&&(ze(x[S]),Array.prototype.splice.call(x,S,1),x.length==0&&(delete f.g[Ce],f.h--)))):f&&(f=Qe(f))&&(x=f.g[x.toString()],f=-1,x&&(f=Ae(x,S,H,he)),(S=f>-1?x[f]:null)&&we(S))}function we(f){if(typeof f!="number"&&f&&!f.da){var x=f.src;if(x&&x[me])ne(x.i,f);else{var S=f.type,H=f.proxy;x.removeEventListener?x.removeEventListener(S,H,f.capture):x.detachEvent?x.detachEvent(et(S),H):x.addListener&&x.removeListener&&x.removeListener(H),(S=Qe(x))?(ne(S,f),S.h==0&&(S.src=null,x[st]=null)):ze(f)}}}function et(f){return f in ot?ot[f]:ot[f]="on"+f}function ht(f,x){if(f.da)f=!0;else{x=new ct(x,this);const S=f.listener,H=f.ha||f.src;f.fa&&we(f),f=S.call(H,x)}return f}function Qe(f){return f=f[st],f instanceof le?f:null}var qe="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ft(f){return typeof f=="function"?f:(f[qe]||(f[qe]=function(x){return f.handleEvent(x)}),f[qe])}function Mt(){L.call(this),this.i=new le(this),this.M=this,this.G=null}h(Mt,L),Mt.prototype[me]=!0,Mt.prototype.removeEventListener=function(f,x,S,H){W(this,f,x,S,H)};function Ot(f,x){var S,H=f.G;if(H)for(S=[];H;H=H.G)S.push(H);if(f=f.M,H=x.type||x,typeof x=="string")x=new F(x,f);else if(x instanceof F)x.target=x.target||f;else{var he=x;x=new F(H,f),ae(x,he)}he=!0;let Ce,mt;if(S)for(mt=S.length-1;mt>=0;mt--)Ce=x.g=S[mt],he=er(Ce,H,!0,x)&&he;if(Ce=x.g=f,he=er(Ce,H,!0,x)&&he,he=er(Ce,H,!1,x)&&he,S)for(mt=0;mt<S.length;mt++)Ce=x.g=S[mt],he=er(Ce,H,!1,x)&&he}Mt.prototype.N=function(){if(Mt.Z.N.call(this),this.i){var f=this.i;for(const x in f.g){const S=f.g[x];for(let H=0;H<S.length;H++)ze(S[H]);delete f.g[x],f.h--}}this.G=null},Mt.prototype.J=function(f,x,S,H){return this.i.add(String(f),x,!1,S,H)},Mt.prototype.K=function(f,x,S,H){return this.i.add(String(f),x,!0,S,H)};function er(f,x,S,H){if(x=f.i.g[String(x)],!x)return!0;x=x.concat();let he=!0;for(let Ce=0;Ce<x.length;++Ce){const mt=x[Ce];if(mt&&!mt.da&&mt.capture==S){const tr=mt.listener,Vr=mt.ha||mt.src;mt.fa&&ne(f.i,mt),he=tr.call(Vr,H)!==!1&&he}}return he&&!H.defaultPrevented}function jt(f,x){if(typeof f!="function")if(f&&typeof f.handleEvent=="function")f=u(f.handleEvent,f);else throw Error("Invalid listener argument");return Number(x)>2147483647?-1:i.setTimeout(f,x||0)}function lr(f){f.g=jt(()=>{f.g=null,f.i&&(f.i=!1,lr(f))},f.l);const x=f.h;f.h=null,f.m.apply(null,x)}class Nr extends L{constructor(x,S){super(),this.m=x,this.l=S,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:lr(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Rr(f){L.call(this),this.h=f,this.g={}}h(Rr,L);var ls=[];function mn(f){ie(f.g,function(x,S){this.g.hasOwnProperty(S)&&we(x)},f),f.g={}}Rr.prototype.N=function(){Rr.Z.N.call(this),mn(this)},Rr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Dr=i.JSON.stringify,Lr=i.JSON.parse,Bt=class{stringify(f){return i.JSON.stringify(f,void 0)}parse(f){return i.JSON.parse(f,void 0)}};function Qt(){}function ir(){}var cr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function An(){F.call(this,"d")}h(An,F);function ta(){F.call(this,"c")}h(ta,F);var cs={},ja=null;function Gn(){return ja=ja||new Mt}cs.Ia="serverreachability";function $n(f){F.call(this,cs.Ia,f)}h($n,F);function In(f){const x=Gn();Ot(x,new $n(x))}cs.STAT_EVENT="statevent";function ra(f,x){F.call(this,cs.STAT_EVENT,f),this.stat=x}h(ra,F);function Fr(f){const x=Gn();Ot(x,new ra(x,f))}cs.Ja="timingevent";function Cn(f,x){F.call(this,cs.Ja,f),this.size=x}h(Cn,F);function ks(f,x){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return i.setTimeout(function(){f()},x)}function qn(){this.g=!0}qn.prototype.ua=function(){this.g=!1};function Da(f,x,S,H,he,Ce){f.info(function(){if(f.g)if(Ce){var mt="",tr=Ce.split("&");for(let vr=0;vr<tr.length;vr++){var Vr=tr[vr].split("=");if(Vr.length>1){const Xr=Vr[0];Vr=Vr[1];const yr=Xr.split("_");mt=yr.length>=2&&yr[1]=="type"?mt+(Xr+"="+Vr+"&"):mt+(Xr+"=redacted&")}}}else mt=null;else mt=Ce;return"XMLHTTP REQ ("+H+") [attempt "+he+"]: "+x+`
`+S+`
`+mt})}function pn(f,x,S,H,he,Ce,mt){f.info(function(){return"XMLHTTP RESP ("+H+") [ attempt "+he+"]: "+x+`
`+S+`
`+Ce+" "+mt})}function ue(f,x,S,H){f.info(function(){return"XMLHTTP TEXT ("+x+"): "+ut(f,S)+(H?" "+H:"")})}function ni(f,x){f.info(function(){return"TIMEOUT: "+x})}qn.prototype.info=function(){};function ut(f,x){if(!f.g)return x;if(!x)return null;try{const Ce=JSON.parse(x);if(Ce){for(f=0;f<Ce.length;f++)if(Array.isArray(Ce[f])){var S=Ce[f];if(!(S.length<2)){var H=S[1];if(Array.isArray(H)&&!(H.length<1)){var he=H[0];if(he!="noop"&&he!="stop"&&he!="close")for(let mt=1;mt<H.length;mt++)H[mt]=""}}}}return Dr(Ce)}catch{return x}}var Vs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},si={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},io;function hr(){}h(hr,Qt),hr.prototype.g=function(){return new XMLHttpRequest},io=new hr;function gn(f){return encodeURIComponent(String(f))}function R(f){var x=1;f=f.split(":");const S=[];for(;x>0&&f.length;)S.push(f.shift()),x--;return f.length&&S.push(f.join(":")),S}function X(f,x,S,H){this.j=f,this.i=x,this.l=S,this.S=H||1,this.V=new Rr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new z}function z(){this.i=null,this.g="",this.h=!1}var K={},Y={};function ee(f,x,S){f.M=1,f.A=Oe(Ie(x)),f.u=S,f.R=!0,Ee(f,null)}function Ee(f,x){f.F=Date.now(),Te(f),f.B=Ie(f.A);var S=f.B,H=f.S;Array.isArray(H)||(H=[String(H)]),Zt(S.i,"t",H),f.C=0,S=f.j.L,f.h=new z,f.g=Du(f.j,S?x:null,!f.u),f.P>0&&(f.O=new Nr(u(f.Y,f,f.g),f.P)),x=f.V,S=f.g,H=f.ba;var he="readystatechange";Array.isArray(he)||(he&&(ls[0]=he.toString()),he=ls);for(let Ce=0;Ce<he.length;Ce++){const mt=Ne(S,he[Ce],H||x.handleEvent,!1,x.h||x);if(!mt)break;x.g[mt.key]=mt}x=f.J?_e(f.J):{},f.u?(f.v||(f.v="POST"),x["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.B,f.v,f.u,x)):(f.v="GET",f.g.ea(f.B,f.v,null,x)),In(),Da(f.i,f.v,f.B,f.l,f.S,f.u)}X.prototype.ba=function(f){f=f.target;const x=this.O;x&&ai(f)==3?x.j():this.Y(f)},X.prototype.Y=function(f){try{if(f==this.g)e:{const tr=ai(this.g),Vr=this.g.ya(),vr=this.g.ca();if(!(tr<3)&&(tr!=3||this.g&&(this.h.h||this.g.la()||lo(this.g)))){this.K||tr!=4||Vr==7||(Vr==8||vr<=0?In(3):In(2)),at(this);var x=this.g.ca();this.X=x;var S=De(this);if(this.o=x==200,pn(this.i,this.v,this.B,this.l,this.S,tr,x),this.o){if(this.U&&!this.L){t:{if(this.g){var H,he=this.g;if((H=he.g?he.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(H)){var Ce=H;break t}}Ce=null}if(f=Ce)ue(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,pt(this,f);else{this.o=!1,this.m=3,Fr(12),nt(this),wt(this);break e}}if(this.R){f=!0;let Xr;for(;!this.K&&this.C<S.length;)if(Xr=be(this,S),Xr==Y){tr==4&&(this.m=4,Fr(14),f=!1),ue(this.i,this.l,null,"[Incomplete Response]");break}else if(Xr==K){this.m=4,Fr(15),ue(this.i,this.l,S,"[Invalid Chunk]"),f=!1;break}else ue(this.i,this.l,Xr,null),pt(this,Xr);if(xe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),tr!=4||S.length!=0||this.h.h||(this.m=1,Fr(16),f=!1),this.o=this.o&&f,!f)ue(this.i,this.l,S,"[Invalid Chunked Response]"),nt(this),wt(this);else if(S.length>0&&!this.W){this.W=!0;var mt=this.j;mt.g==this&&mt.aa&&!mt.P&&(mt.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),cn(mt),mt.P=!0,Fr(11))}}else ue(this.i,this.l,S,null),pt(this,S);tr==4&&nt(this),this.o&&!this.K&&(tr==4?La(this.j,this):(this.o=!1,Te(this)))}else Wf(this.g),x==400&&S.indexOf("Unknown SID")>0?(this.m=3,Fr(12)):(this.m=0,Fr(13)),nt(this),wt(this)}}}catch{}finally{}};function De(f){if(!xe(f))return f.g.la();const x=lo(f.g);if(x==="")return"";let S="";const H=x.length,he=ai(f.g)==4;if(!f.h.i){if(typeof TextDecoder>"u")return nt(f),wt(f),"";f.h.i=new i.TextDecoder}for(let Ce=0;Ce<H;Ce++)f.h.h=!0,S+=f.h.i.decode(x[Ce],{stream:!(he&&Ce==H-1)});return x.length=0,f.h.g+=S,f.C=0,f.h.g}function xe(f){return f.g?f.v=="GET"&&f.M!=2&&f.j.Aa:!1}function be(f,x){var S=f.C,H=x.indexOf(`
`,S);return H==-1?Y:(S=Number(x.substring(S,H)),isNaN(S)?K:(H+=1,H+S>x.length?Y:(x=x.slice(H,H+S),f.C=H+S,x)))}X.prototype.cancel=function(){this.K=!0,nt(this)};function Te(f){f.T=Date.now()+f.H,We(f,f.H)}function We(f,x){if(f.D!=null)throw Error("WatchDog timer not null");f.D=ks(u(f.aa,f),x)}function at(f){f.D&&(i.clearTimeout(f.D),f.D=null)}X.prototype.aa=function(){this.D=null;const f=Date.now();f-this.T>=0?(ni(this.i,this.B),this.M!=2&&(In(),Fr(17)),nt(this),this.m=2,wt(this)):We(this,this.T-f)};function wt(f){f.j.I==0||f.K||La(f.j,f)}function nt(f){at(f);var x=f.O;x&&typeof x.dispose=="function"&&x.dispose(),f.O=null,mn(f.V),f.g&&(x=f.g,f.g=null,x.abort(),x.dispose())}function pt(f,x){try{var S=f.j;if(S.I!=0&&(S.g==f||Ur(S.h,f))){if(!f.L&&Ur(S.h,f)&&S.I==3){try{var H=S.Ba.g.parse(x)}catch{H=null}if(Array.isArray(H)&&H.length==3){var he=H;if(he[0]==0){e:if(!S.v){if(S.g)if(S.g.F+3e3<f.F)Kn(S),Pu(S);else break e;Is(S),Fr(18)}}else S.xa=he[1],0<S.xa-S.K&&he[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=ks(u(S.Va,S),6e3));kr(S.h)<=1&&S.ta&&(S.ta=void 0)}else na(S,11)}else if((f.L||S.g==f)&&Kn(S),!O(x))for(he=S.Ba.g.parse(x),x=0;x<he.length;x++){let vr=he[x];const Xr=vr[0];if(!(Xr<=S.K))if(S.K=Xr,vr=vr[1],S.I==2)if(vr[0]=="c"){S.M=vr[1],S.ba=vr[2];const yr=vr[3];yr!=null&&(S.ka=yr,S.j.info("VER="+S.ka));const li=vr[4];li!=null&&(S.za=li,S.j.info("SVER="+S.za));const A=vr[5];A!=null&&typeof A=="number"&&A>0&&(H=1.5*A,S.O=H,S.j.info("backChannelRequestTimeoutMs_="+H)),H=S;const ci=f.g;if(ci){const xn=ci.g?ci.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xn){var Ce=H.h;Ce.g||xn.indexOf("spdy")==-1&&xn.indexOf("quic")==-1&&xn.indexOf("h2")==-1||(Ce.j=Ce.l,Ce.g=new Set,Ce.h&&(ve(Ce,Ce.h),Ce.h=null))}if(H.G){const Fu=ci.g?ci.g.getResponseHeader("X-HTTP-Session-Id"):null;Fu&&(H.wa=Fu,He(H.J,H.G,Fu))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-f.F,S.j.info("Handshake RTT: "+S.T+"ms")),H=S;var mt=f;if(H.na=ju(H,H.L?H.ba:null,H.W),mt.L){Le(H.h,mt);var tr=mt,Vr=H.O;Vr&&(tr.H=Vr),tr.D&&(at(tr),Te(tr)),H.g=mt}else qf(H);S.i.length>0&&ii(S)}else vr[0]!="stop"&&vr[0]!="close"||na(S,7);else S.I==3&&(vr[0]=="stop"||vr[0]=="close"?vr[0]=="stop"?na(S,7):Hf(S):vr[0]!="noop"&&S.l&&S.l.qa(vr),S.A=0)}}In(4)}catch{}}var Ut=class{constructor(f,x){this.g=f,this.map=x}};function sr(f){this.l=f||10,i.PerformanceNavigationTiming?(f=i.performance.getEntriesByType("navigation"),f=f.length>0&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ur(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function kr(f){return f.h?1:f.g?f.g.size:0}function Ur(f,x){return f.h?f.h==x:f.g?f.g.has(x):!1}function ve(f,x){f.g?f.g.add(x):f.h=x}function Le(f,x){f.h&&f.h==x?f.h=null:f.g&&f.g.has(x)&&f.g.delete(x)}sr.prototype.cancel=function(){if(this.i=Ke(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Ke(f){if(f.h!=null)return f.i.concat(f.h.G);if(f.g!=null&&f.g.size!==0){let x=f.i;for(const S of f.g.values())x=x.concat(S.G);return x}return p(f.i)}var Je=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Se(f,x){if(f){f=f.split("&");for(let S=0;S<f.length;S++){const H=f[S].indexOf("=");let he,Ce=null;H>=0?(he=f[S].substring(0,H),Ce=f[S].substring(H+1)):he=f[S],x(he,Ce?decodeURIComponent(Ce.replace(/\+/g," ")):"")}}}function Pe(f){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let x;f instanceof Pe?(this.l=f.l,de(this,f.j),this.o=f.o,this.g=f.g,Fe(this,f.u),this.h=f.h,xt(this,Wt(f.i)),this.m=f.m):f&&(x=String(f).match(Je))?(this.l=!1,de(this,x[1]||"",!0),this.o=Be(x[2]||""),this.g=Be(x[3]||"",!0),Fe(this,x[4]),this.h=Be(x[5]||"",!0),xt(this,x[6]||"",!0),this.m=Be(x[7]||"")):(this.l=!1,this.i=new Qr(null,this.l))}Pe.prototype.toString=function(){const f=[];var x=this.j;x&&f.push(it(x,zt,!0),":");var S=this.g;return(S||x=="file")&&(f.push("//"),(x=this.o)&&f.push(it(x,zt,!0),"@"),f.push(gn(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&f.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&f.push("/"),f.push(it(S,S.charAt(0)=="/"?Tt:Dt,!0))),(S=this.i.toString())&&f.push("?",S),(S=this.m)&&f.push("#",it(S,jr)),f.join("")},Pe.prototype.resolve=function(f){const x=Ie(this);let S=!!f.j;S?de(x,f.j):S=!!f.o,S?x.o=f.o:S=!!f.g,S?x.g=f.g:S=f.u!=null;var H=f.h;if(S)Fe(x,f.u);else if(S=!!f.h){if(H.charAt(0)!="/")if(this.g&&!this.h)H="/"+H;else{var he=x.h.lastIndexOf("/");he!=-1&&(H=x.h.slice(0,he+1)+H)}if(he=H,he==".."||he==".")H="";else if(he.indexOf("./")!=-1||he.indexOf("/.")!=-1){H=he.lastIndexOf("/",0)==0,he=he.split("/");const Ce=[];for(let mt=0;mt<he.length;){const tr=he[mt++];tr=="."?H&&mt==he.length&&Ce.push(""):tr==".."?((Ce.length>1||Ce.length==1&&Ce[0]!="")&&Ce.pop(),H&&mt==he.length&&Ce.push("")):(Ce.push(tr),H=!0)}H=Ce.join("/")}else H=he}return S?x.h=H:S=f.i.toString()!=="",S?xt(x,Wt(f.i)):S=!!f.m,S&&(x.m=f.m),x};function Ie(f){return new Pe(f)}function de(f,x,S){f.j=S?Be(x,!0):x,f.j&&(f.j=f.j.replace(/:$/,""))}function Fe(f,x){if(x){if(x=Number(x),isNaN(x)||x<0)throw Error("Bad port number "+x);f.u=x}else f.u=null}function xt(f,x,S){x instanceof Qr?(f.i=x,kt(f.i,f.l)):(S||(x=it(x,dr)),f.i=new Qr(x,f.l))}function He(f,x,S){f.i.set(x,S)}function Oe(f){return He(f,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),f}function Be(f,x){return f?x?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function it(f,x,S){return typeof f=="string"?(f=encodeURI(f).replace(x,$t),S&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function $t(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var zt=/[#\/\?@]/g,Dt=/[#\?:]/g,Tt=/[#\?]/g,dr=/[#\?@]/g,jr=/#/g;function Qr(f,x){this.h=this.g=null,this.i=f||null,this.j=!!x}function Un(f){f.g||(f.g=new Map,f.h=0,f.i&&Se(f.i,function(x,S){f.add(decodeURIComponent(x.replace(/\+/g," ")),S)}))}t=Qr.prototype,t.add=function(f,x){Un(this),this.i=null,f=or(this,f);let S=this.g.get(f);return S||this.g.set(f,S=[]),S.push(x),this.h+=1,this};function Nn(f,x){Un(f),x=or(f,x),f.g.has(x)&&(f.i=null,f.h-=f.g.get(x).length,f.g.delete(x))}function Me(f,x){return Un(f),x=or(f,x),f.g.has(x)}t.forEach=function(f,x){Un(this),this.g.forEach(function(S,H){S.forEach(function(he){f.call(x,he,H,this)},this)},this)};function $e(f,x){Un(f);let S=[];if(typeof x=="string")Me(f,x)&&(S=S.concat(f.g.get(or(f,x))));else for(f=Array.from(f.g.values()),x=0;x<f.length;x++)S=S.concat(f[x]);return S}t.set=function(f,x){return Un(this),this.i=null,f=or(this,f),Me(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[x]),this.h+=1,this},t.get=function(f,x){return f?(f=$e(this,f),f.length>0?String(f[0]):x):x};function Zt(f,x,S){Nn(f,x),S.length>0&&(f.i=null,f.g.set(or(f,x),p(S)),f.h+=S.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],x=Array.from(this.g.keys());for(let H=0;H<x.length;H++){var S=x[H];const he=gn(S);S=$e(this,S);for(let Ce=0;Ce<S.length;Ce++){let mt=he;S[Ce]!==""&&(mt+="="+gn(S[Ce])),f.push(mt)}}return this.i=f.join("&")};function Wt(f){const x=new Qr;return x.i=f.i,f.g&&(x.g=new Map(f.g),x.h=f.h),x}function or(f,x){return x=String(x),f.j&&(x=x.toLowerCase()),x}function kt(f,x){x&&!f.j&&(Un(f),f.i=null,f.g.forEach(function(S,H){const he=H.toLowerCase();H!=he&&(Nn(this,H),Zt(this,he,S))},f)),f.j=x}function vt(f,x){const S=new qn;if(i.Image){const H=new Image;H.onload=d(Gr,S,"TestLoadImage: loaded",!0,x,H),H.onerror=d(Gr,S,"TestLoadImage: error",!1,x,H),H.onabort=d(Gr,S,"TestLoadImage: abort",!1,x,H),H.ontimeout=d(Gr,S,"TestLoadImage: timeout",!1,x,H),i.setTimeout(function(){H.ontimeout&&H.ontimeout()},1e4),H.src=f}else x(!1)}function Hr(f,x){const S=new qn,H=new AbortController,he=setTimeout(()=>{H.abort(),Gr(S,"TestPingServer: timeout",!1,x)},1e4);fetch(f,{signal:H.signal}).then(Ce=>{clearTimeout(he),Ce.ok?Gr(S,"TestPingServer: ok",!0,x):Gr(S,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(he),Gr(S,"TestPingServer: error",!1,x)})}function Gr(f,x,S,H,he){try{he&&(he.onload=null,he.onerror=null,he.onabort=null,he.ontimeout=null),H(S)}catch{}}function Di(){this.g=new Bt}function Rn(f){this.i=f.Sb||null,this.h=f.ab||!1}h(Rn,Qt),Rn.prototype.g=function(){return new As(this.i,this.h)};function As(f,x){Mt.call(this),this.H=f,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(As,Mt),t=As.prototype,t.open=function(f,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=f,this.D=x,this.readyState=1,xa(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const x={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};f&&(x.body=f),(this.H||i).fetch(new Request(this.D,x)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Rt(this)),this.readyState=0},t.Pa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,xa(this)),this.g&&(this.readyState=3,xa(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof i.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Bs(this)}else f.text().then(this.Oa.bind(this),this.ga.bind(this))};function Bs(f){f.j.read().then(f.Ma.bind(f)).catch(f.ga.bind(f))}t.Ma=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var x=f.value?f.value:new Uint8Array(0);(x=this.B.decode(x,{stream:!f.done}))&&(this.response=this.responseText+=x)}f.done?Rt(this):xa(this),this.readyState==3&&Bs(this)}},t.Oa=function(f){this.g&&(this.response=this.responseText=f,Rt(this))},t.Na=function(f){this.g&&(this.response=f,Rt(this))},t.ga=function(){this.g&&Rt(this)};function Rt(f){f.readyState=4,f.l=null,f.j=null,f.B=null,xa(f)}t.setRequestHeader=function(f,x){this.A.append(f,x)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],x=this.h.entries();for(var S=x.next();!S.done;)S=S.value,f.push(S[0]+": "+S[1]),S=x.next();return f.join(`\r
`)};function xa(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(As.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Nu(f){let x="";return ie(f,function(S,H){x+=H,x+=":",x+=S,x+=`\r
`}),x}function oo(f,x,S){e:{for(H in S){var H=!1;break e}H=!0}H||(S=Nu(S),typeof f=="string"?S!=null&&gn(S):He(f,x,S))}function Or(f){Mt.call(this),this.headers=new Map,this.L=f||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(Or,Mt);var ul=/^https?$/i,cc=["POST","PUT"];t=Or.prototype,t.Fa=function(f){this.H=f},t.ea=function(f,x,S,H){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);x=x?x.toUpperCase():"GET",this.D=f,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():io.g(),this.g.onreadystatechange=m(u(this.Ca,this));try{this.B=!0,this.g.open(x,String(f),!0),this.B=!1}catch(Ce){Fa(this,Ce);return}if(f=S||"",S=new Map(this.headers),H)if(Object.getPrototypeOf(H)===Object.prototype)for(var he in H)S.set(he,H[he]);else if(typeof H.keys=="function"&&typeof H.get=="function")for(const Ce of H.keys())S.set(Ce,H.get(Ce));else throw Error("Unknown input type for opt_headers: "+String(H));H=Array.from(S.keys()).find(Ce=>Ce.toLowerCase()=="content-type"),he=i.FormData&&f instanceof i.FormData,!(Array.prototype.indexOf.call(cc,x,void 0)>=0)||H||he||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ce,mt]of S)this.g.setRequestHeader(Ce,mt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(f),this.v=!1}catch(Ce){Fa(this,Ce)}};function Fa(f,x){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=x,f.o=5,op(f),bt(f)}function op(f){f.A||(f.A=!0,Ot(f,"complete"),Ot(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=f||7,Ot(this,"complete"),Ot(this,"abort"),bt(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bt(this,!0)),Or.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Ru(this):this.Xa())},t.Xa=function(){Ru(this)};function Ru(f){if(f.h&&typeof a<"u"){if(f.v&&ai(f)==4)setTimeout(f.Ca.bind(f),0);else if(Ot(f,"readystatechange"),ai(f)==4){f.h=!1;try{const Ce=f.ca();e:switch(Ce){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var S;if(!(S=x)){var H;if(H=Ce===0){let mt=String(f.D).match(Je)[1]||null;!mt&&i.self&&i.self.location&&(mt=i.self.location.protocol.slice(0,-1)),H=!ul.test(mt?mt.toLowerCase():"")}S=H}if(S)Ot(f,"complete"),Ot(f,"success");else{f.o=6;try{var he=ai(f)>2?f.g.statusText:""}catch{he=""}f.l=he+" ["+f.ca()+"]",op(f)}}finally{bt(f)}}}}function bt(f,x){if(f.g){f.m&&(clearTimeout(f.m),f.m=null);const S=f.g;f.g=null,x||Ot(f,"ready");try{S.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function ai(f){return f.g?f.g.readyState:0}t.ca=function(){try{return ai(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(f){if(this.g){var x=this.g.responseText;return f&&x.indexOf(f)==0&&(x=x.substring(f.length)),Lr(x)}};function lo(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.F){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function Wf(f){const x={};f=(f.g&&ai(f)>=2&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let H=0;H<f.length;H++){if(O(f[H]))continue;var S=R(f[H]);const he=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const Ce=x[he]||[];x[he]=Ce,Ce.push(S)}Ye(x,function(H){return H.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function nn(f,x,S){return S&&S.internalChannelParams&&S.internalChannelParams[f]||x}function uc(f){this.za=0,this.i=[],this.j=new qn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=nn("failFast",!1,f),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=nn("baseRetryDelayMs",5e3,f),this.Za=nn("retryDelaySeedMs",1e4,f),this.Ta=nn("forwardChannelMaxRetries",2,f),this.va=nn("forwardChannelRequestTimeoutMs",2e4,f),this.ma=f&&f.xmlHttpFactory||void 0,this.Ua=f&&f.Rb||void 0,this.Aa=f&&f.useFetchStreams||!1,this.O=void 0,this.L=f&&f.supportsCrossDomainXhr||!1,this.M="",this.h=new sr(f&&f.concurrentRequestLimit),this.Ba=new Di,this.S=f&&f.fastHandshake||!1,this.R=f&&f.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=f&&f.Pb||!1,f&&f.ua&&this.j.ua(),f&&f.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&f&&f.detectBufferingProxy||!1,this.ia=void 0,f&&f.longPollingTimeout&&f.longPollingTimeout>0&&(this.ia=f.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=uc.prototype,t.ka=8,t.I=1,t.connect=function(f,x,S,H){Fr(0),this.W=f,this.H=x||{},S&&H!==void 0&&(this.H.OSID=S,this.H.OAID=H),this.F=this.X,this.J=ju(this,null,this.W),ii(this)};function Hf(f){if(dl(f),f.I==3){var x=f.V++,S=Ie(f.J);if(He(S,"SID",f.M),He(S,"RID",x),He(S,"TYPE","terminate"),hl(f,S),x=new X(f,f.j,x),x.M=2,x.A=Oe(Ie(S)),S=!1,i.navigator&&i.navigator.sendBeacon)try{S=i.navigator.sendBeacon(x.A.toString(),"")}catch{}!S&&i.Image&&(new Image().src=x.A,S=!0),S||(x.g=Du(x.j,null),x.g.ea(x.A)),x.F=Date.now(),Te(x)}oi(f)}function Pu(f){f.g&&(cn(f),f.g.cancel(),f.g=null)}function dl(f){Pu(f),f.v&&(i.clearTimeout(f.v),f.v=null),Kn(f),f.h.cancel(),f.m&&(typeof f.m=="number"&&i.clearTimeout(f.m),f.m=null)}function ii(f){if(!ur(f.h)&&!f.m){f.m=!0;var x=f.Ea;J||I(),Z||(J(),Z=!0),_.add(x,f),f.D=0}}function co(f,x){return kr(f.h)>=f.h.j-(f.m?1:0)?!1:f.m?(f.i=x.G.concat(f.i),!0):f.I==1||f.I==2||f.D>=(f.Sa?0:f.Ta)?!1:(f.m=ks(u(f.Ea,f,x),Ws(f,f.D)),f.D++,!0)}t.Ea=function(f){if(this.m)if(this.m=null,this.I==1){if(!f){this.V=Math.floor(Math.random()*1e5),f=this.V++;const he=new X(this,this.j,f);let Ce=this.o;if(this.U&&(Ce?(Ce=_e(Ce),ae(Ce,this.U)):Ce=this.U),this.u!==null||this.R||(he.J=Ce,Ce=null),this.S)e:{for(var x=0,S=0;S<this.i.length;S++){t:{var H=this.i[S];if("__data__"in H.map&&(H=H.map.__data__,typeof H=="string")){H=H.length;break t}H=void 0}if(H===void 0)break;if(x+=H,x>4096){x=S;break e}if(x===4096||S===this.i.length-1){x=S+1;break e}}x=1e3}else x=1e3;x=Gf(this,he,x),S=Ie(this.J),He(S,"RID",f),He(S,"CVER",22),this.G&&He(S,"X-HTTP-Session-Id",this.G),hl(this,S),Ce&&(this.R?x="headers="+gn(Nu(Ce))+"&"+x:this.u&&oo(S,this.u,Ce)),ve(this.h,he),this.Ra&&He(S,"TYPE","init"),this.S?(He(S,"$req",x),He(S,"SID","null"),he.U=!0,ee(he,S,null)):ee(he,S,x),this.I=2}}else this.I==3&&(f?fl(this,f):this.i.length==0||ur(this.h)||fl(this))};function fl(f,x){var S;x?S=x.l:S=f.V++;const H=Ie(f.J);He(H,"SID",f.M),He(H,"RID",S),He(H,"AID",f.K),hl(f,H),f.u&&f.o&&oo(H,f.u,f.o),S=new X(f,f.j,S,f.D+1),f.u===null&&(S.J=f.o),x&&(f.i=x.G.concat(f.i)),x=Gf(f,S,1e3),S.H=Math.round(f.va*.5)+Math.round(f.va*.5*Math.random()),ve(f.h,S),ee(S,H,x)}function hl(f,x){f.H&&ie(f.H,function(S,H){He(x,H,S)}),f.l&&ie({},function(S,H){He(x,H,S)})}function Gf(f,x,S){S=Math.min(f.i.length,S);const H=f.l?u(f.l.Ka,f.l,f):null;e:{var he=f.i;let tr=-1;for(;;){const Vr=["count="+S];tr==-1?S>0?(tr=he[0].g,Vr.push("ofs="+tr)):tr=0:Vr.push("ofs="+tr);let vr=!0;for(let Xr=0;Xr<S;Xr++){var Ce=he[Xr].g;const yr=he[Xr].map;if(Ce-=tr,Ce<0)tr=Math.max(0,he[Xr].g-100),vr=!1;else try{Ce="req"+Ce+"_"||"";try{var mt=yr instanceof Map?yr:Object.entries(yr);for(const[li,A]of mt){let ci=A;o(A)&&(ci=Dr(A)),Vr.push(Ce+li+"="+encodeURIComponent(ci))}}catch(li){throw Vr.push(Ce+"type="+encodeURIComponent("_badmap")),li}}catch{H&&H(yr)}}if(vr){mt=Vr.join("&");break e}}mt=void 0}return f=f.i.splice(0,S),x.G=f,mt}function qf(f){if(!f.g&&!f.v){f.Y=1;var x=f.Da;J||I(),Z||(J(),Z=!0),_.add(x,f),f.A=0}}function Is(f){return f.g||f.v||f.A>=3?!1:(f.Y++,f.v=ks(u(f.Da,f),Ws(f,f.A)),f.A++,!0)}t.Da=function(){if(this.v=null,zs(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var f=4*this.T;this.j.info("BP detection timer enabled: "+f),this.B=ks(u(this.Wa,this),f)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Fr(10),Pu(this),zs(this))};function cn(f){f.B!=null&&(i.clearTimeout(f.B),f.B=null)}function zs(f){f.g=new X(f,f.j,"rpc",f.Y),f.u===null&&(f.g.J=f.o),f.g.P=0;var x=Ie(f.na);He(x,"RID","rpc"),He(x,"SID",f.M),He(x,"AID",f.K),He(x,"CI",f.F?"0":"1"),!f.F&&f.ia&&He(x,"TO",f.ia),He(x,"TYPE","xmlhttp"),hl(f,x),f.u&&f.o&&oo(x,f.u,f.o),f.O&&(f.g.H=f.O);var S=f.g;f=f.ba,S.M=1,S.A=Oe(Ie(x)),S.u=null,S.R=!0,Ee(S,f)}t.Va=function(){this.C!=null&&(this.C=null,Pu(this),Is(this),Fr(19))};function Kn(f){f.C!=null&&(i.clearTimeout(f.C),f.C=null)}function La(f,x){var S=null;if(f.g==x){Kn(f),cn(f),f.g=null;var H=2}else if(Ur(f.h,x))S=x.G,Le(f.h,x),H=1;else return;if(f.I!=0){if(x.o)if(H==1){S=x.u?x.u.length:0,x=Date.now()-x.F;var he=f.D;H=Gn(),Ot(H,new Cn(H,S)),ii(f)}else qf(f);else if(he=x.m,he==3||he==0&&x.X>0||!(H==1&&co(f,x)||H==2&&Is(f)))switch(S&&S.length>0&&(x=f.h,x.i=x.i.concat(S)),he){case 1:na(f,5);break;case 4:na(f,10);break;case 3:na(f,6);break;default:na(f,2)}}}function Ws(f,x){let S=f.Qa+Math.floor(Math.random()*f.Za);return f.isActive()||(S*=2),S*x}function na(f,x){if(f.j.info("Error code "+x),x==2){var S=u(f.bb,f),H=f.Ua;const he=!H;H=new Pe(H||"//www.google.com/images/cleardot.gif"),i.location&&i.location.protocol=="http"||de(H,"https"),Oe(H),he?vt(H.toString(),S):Hr(H.toString(),S)}else Fr(2);f.I=0,f.l&&f.l.pa(x),oi(f),dl(f)}t.bb=function(f){f?(this.j.info("Successfully pinged google.com"),Fr(2)):(this.j.info("Failed to ping google.com"),Fr(1))};function oi(f){if(f.I=0,f.ja=[],f.l){const x=Ke(f.h);(x.length!=0||f.i.length!=0)&&(y(f.ja,x),y(f.ja,f.i),f.h.i.length=0,p(f.i),f.i.length=0),f.l.oa()}}function ju(f,x,S){var H=S instanceof Pe?Ie(S):new Pe(S);if(H.g!="")x&&(H.g=x+"."+H.g),Fe(H,H.u);else{var he=i.location;H=he.protocol,x=x?x+"."+he.hostname:he.hostname,he=+he.port;const Ce=new Pe(null);H&&de(Ce,H),x&&(Ce.g=x),he&&Fe(Ce,he),S&&(Ce.h=S),H=Ce}return S=f.G,x=f.wa,S&&x&&He(H,S,x),He(H,"VER",f.ka),hl(f,H),H}function Du(f,x,S){if(x&&!f.L)throw Error("Can't create secondary domain capable XhrIo object.");return x=f.Aa&&!f.ma?new Or(new Rn({ab:S})):new Or(f.ma),x.Fa(f.L),x}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function dc(){}t=dc.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function ml(){}ml.prototype.g=function(f,x){return new Qn(f,x)};function Qn(f,x){Mt.call(this),this.g=new uc(x),this.l=f,this.h=x&&x.messageUrlParams||null,f=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(f?f["X-WebChannel-Content-Type"]=x.messageContentType:f={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.sa&&(f?f["X-WebChannel-Client-Profile"]=x.sa:f={"X-WebChannel-Client-Profile":x.sa}),this.g.U=f,(f=x&&x.Qb)&&!O(f)&&(this.g.u=f),this.A=x&&x.supportsCrossDomainXhr||!1,this.v=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!O(x)&&(this.g.G=x,f=this.h,f!==null&&x in f&&(f=this.h,x in f&&delete f[x])),this.j=new Oa(this)}h(Qn,Mt),Qn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Qn.prototype.close=function(){Hf(this.g)},Qn.prototype.o=function(f){var x=this.g;if(typeof f=="string"){var S={};S.__data__=f,f=S}else this.v&&(S={},S.__data__=Dr(f),f=S);x.i.push(new Ut(x.Ya++,f)),x.I==3&&ii(x)},Qn.prototype.N=function(){this.g.l=null,delete this.j,Hf(this.g),delete this.g,Qn.Z.N.call(this)};function fc(f){An.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var x=f.__sm__;if(x){e:{for(const S in x){f=S;break e}f=void 0}(this.i=f)&&(f=this.i,x=x!==null&&f in x?x[f]:void 0),this.data=x}else this.data=f}h(fc,An);function hc(){ta.call(this),this.status=1}h(hc,ta);function Oa(f){this.g=f}h(Oa,dc),Oa.prototype.ra=function(){Ot(this.g,"a")},Oa.prototype.qa=function(f){Ot(this.g,new fc(f))},Oa.prototype.pa=function(f){Ot(this.g,new hc)},Oa.prototype.oa=function(){Ot(this.g,"b")},ml.prototype.createWebChannel=ml.prototype.g,Qn.prototype.send=Qn.prototype.o,Qn.prototype.open=Qn.prototype.m,Qn.prototype.close=Qn.prototype.close,Q4=function(){return new ml},K4=function(){return Gn()},q4=cs,_x={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Vs.NO_ERROR=0,Vs.TIMEOUT=8,Vs.HTTP_ERROR=6,X0=Vs,si.COMPLETE="complete",G4=si,ir.EventType=cr,cr.OPEN="a",cr.CLOSE="b",cr.ERROR="c",cr.MESSAGE="d",Mt.prototype.listen=Mt.prototype.J,td=ir,Or.prototype.listenOnce=Or.prototype.K,Or.prototype.getLastError=Or.prototype.Ha,Or.prototype.getLastErrorCode=Or.prototype.ya,Or.prototype.getStatus=Or.prototype.ca,Or.prototype.getResponseJson=Or.prototype.La,Or.prototype.getResponseText=Or.prototype.la,Or.prototype.send=Or.prototype.ea,Or.prototype.setWithCredentials=Or.prototype.Fa,H4=Or}).apply(typeof p0<"u"?p0:typeof self<"u"?self:typeof window<"u"?window:{});const F2="@firebase/firestore",L2="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ps.UNAUTHENTICATED=new ps(null),ps.GOOGLE_CREDENTIALS=new ps("google-credentials-uid"),ps.FIRST_PARTY=new ps("first-party-uid"),ps.MOCK_USER=new ps("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _u="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zl=new Nm("@firebase/firestore");function yc(){return zl.logLevel}function It(t,...e){if(zl.logLevel<=mr.DEBUG){const r=e.map(fv);zl.debug(`Firestore (${_u}): ${t}`,...r)}}function Zi(t,...e){if(zl.logLevel<=mr.ERROR){const r=e.map(fv);zl.error(`Firestore (${_u}): ${t}`,...r)}}function lu(t,...e){if(zl.logLevel<=mr.WARN){const r=e.map(fv);zl.warn(`Firestore (${_u}): ${t}`,...r)}}function fv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qt(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,X4(t,n,r)}function X4(t,e,r){let n=`FIRESTORE (${_u}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Zi(n),new Error(n)}function Cr(t,e,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,t||X4(e,s,n)}function Jt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ze={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Lt extends Ra{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class y8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(ps.UNAUTHENTICATED))}shutdown(){}}class w8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class b8{constructor(e){this.t=e,this.currentUser=ps.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Cr(this.o===void 0,42304);let n=this.i;const s=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let a=new Bo;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Bo,e.enqueueRetryable(()=>s(this.currentUser))};const i=()=>{const c=a;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},o=c=>{It("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?o(c):(It("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Bo)}},0),i()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(It("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Cr(typeof n.accessToken=="string",31837,{l:n}),new Y4(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Cr(e===null||typeof e=="string",2055,{h:e}),new ps(e)}}class _8{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=ps.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class S8{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new _8(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(ps.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class O2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class E8{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,oa(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Cr(this.o===void 0,3512);const n=a=>{a.error!=null&&It("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const i=a.token!==this.m;return this.m=a.token,It("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const s=a=>{It("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):It("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new O2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Cr(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new O2(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T8(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=T8(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<r&&(n+=e.charAt(s[a]%62))}return n}}function pr(t,e){return t<e?-1:t>e?1:0}function Sx(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const s=t.charAt(n),a=e.charAt(n);if(s!==a)return Yp(s)===Yp(a)?pr(s,a):Yp(s)?1:-1}return pr(t.length,e.length)}const k8=55296,A8=57343;function Yp(t){const e=t.charCodeAt(0);return e>=k8&&e<=A8}function cu(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M2="__name__";class pi{constructor(e,r,n){r===void 0?r=0:r>e.length&&qt(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&qt(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return pi.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof pi?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const a=pi.compareSegments(e.get(s),r.get(s));if(a!==0)return a}return pr(e.length,r.length)}static compareSegments(e,r){const n=pi.isNumericId(e),s=pi.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?pi.extractNumericId(e).compare(pi.extractNumericId(r)):Sx(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Vo.fromString(e.substring(4,e.length-2))}}class Zr extends pi{construct(e,r,n){return new Zr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Lt(Ze.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new Zr(r)}static emptyPath(){return new Zr([])}}const I8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class rs extends pi{construct(e,r,n){return new rs(e,r,n)}static isValidIdentifier(e){return I8.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),rs.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===M2}static keyField(){return new rs([M2])}static fromServerFormat(e){const r=[];let n="",s=0;const a=()=>{if(n.length===0)throw new Lt(Ze.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let i=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new Lt(Ze.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Lt(Ze.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,s+=2}else o==="`"?(i=!i,s++):o!=="."||i?(n+=o,s++):(a(),s++)}if(a(),i)throw new Lt(Ze.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new rs(r)}static emptyPath(){return new rs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.path=e}static fromPath(e){return new Vt(Zr.fromString(e))}static fromName(e){return new Vt(Zr.fromString(e).popFirst(5))}static empty(){return new Vt(Zr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Zr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Zr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Vt(new Zr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C8(t,e,r){if(!r)throw new Lt(Ze.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function N8(t,e,r,n){if(e===!0&&n===!0)throw new Lt(Ze.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function $2(t){if(!Vt.isDocumentKey(t))throw new Lt(Ze.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function J4(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function mv(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":qt(12329,{type:typeof t})}function bi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Lt(Ze.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=mv(t);throw new Lt(Ze.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(t,e){const r={typeString:t};return e&&(r.value=e),r}function Pf(t,e){if(!J4(t))throw new Lt(Ze.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const s=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const i=t[n];if(s&&typeof i!==s){r=`JSON field '${n}' must be a ${s}.`;break}if(a!==void 0&&i!==a.value){r=`Expected '${n}' field to equal '${a.value}'`;break}}if(r)throw new Lt(Ze.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U2=-62135596800,V2=1e6;class zr{static now(){return zr.fromMillis(Date.now())}static fromDate(e){return zr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*V2);return new zr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Lt(Ze.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Lt(Ze.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<U2)throw new Lt(Ze.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Lt(Ze.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/V2}_compareTo(e){return this.seconds===e.seconds?pr(this.nanoseconds,e.nanoseconds):pr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:zr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Pf(e,zr._jsonSchema))return new zr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-U2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}zr._jsonSchemaVersion="firestore/timestamp/1.0",zr._jsonSchema={type:En("string",zr._jsonSchemaVersion),seconds:En("number"),nanoseconds:En("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{static fromTimestamp(e){return new Xt(e)}static min(){return new Xt(new zr(0,0))}static max(){return new Xt(new zr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nf=-1;function R8(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Xt.fromTimestamp(n===1e9?new zr(r+1,0):new zr(r,n));return new qo(s,Vt.empty(),e)}function P8(t){return new qo(t.readTime,t.key,nf)}class qo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new qo(Xt.min(),Vt.empty(),nf)}static max(){return new qo(Xt.max(),Vt.empty(),nf)}}function j8(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Vt.comparator(t.documentKey,e.documentKey),r!==0?r:pr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D8="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class F8{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Su(t){if(t.code!==Ze.FAILED_PRECONDITION||t.message!==D8)throw t;It("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&qt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Ge((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Ge?r:Ge.resolve(r)}catch(r){return Ge.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Ge.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Ge.reject(r)}static resolve(e){return new Ge((r,n)=>{r(e)})}static reject(e){return new Ge((r,n)=>{n(e)})}static waitFor(e){return new Ge((r,n)=>{let s=0,a=0,i=!1;e.forEach(o=>{++s,o.next(()=>{++a,i&&a===s&&r()},c=>n(c))}),i=!0,a===s&&r()})}static or(e){let r=Ge.resolve(!1);for(const n of e)r=r.next(s=>s?Ge.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,a)=>{n.push(r.call(this,s,a))}),this.waitFor(n)}static mapArray(e,r){return new Ge((n,s)=>{const a=e.length,i=new Array(a);let o=0;for(let c=0;c<a;c++){const u=c;r(e[u]).next(d=>{i[u]=d,++o,o===a&&n(i)},d=>s(d))}})}static doWhile(e,r){return new Ge((n,s)=>{const a=()=>{e()===!0?r().next(()=>{a()},s):n()};a()})}}function L8(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Eu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Om.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pv=-1;function Mm(t){return t==null}function Oh(t){return t===0&&1/t==-1/0}function O8(t){return typeof t=="number"&&Number.isInteger(t)&&!Oh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z4="";function M8(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=B2(e)),e=$8(t.get(r),e);return B2(e)}function $8(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const a=t.charAt(s);switch(a){case"\0":r+="";break;case Z4:r+="";break;default:r+=a}}return r}function B2(t){return t+Z4+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z2(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function il(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function ek(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,r){this.comparator=e,this.root=r||es.EMPTY}insert(e,r){return new rn(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,es.BLACK,null,null))}remove(e){return new rn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,es.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new g0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new g0(this.root,e,this.comparator,!1)}getReverseIterator(){return new g0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new g0(this.root,e,this.comparator,!0)}}class g0{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class es{constructor(e,r,n,s,a){this.key=e,this.value=r,this.color=n??es.RED,this.left=s??es.EMPTY,this.right=a??es.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,a){return new es(e??this.key,r??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const a=n(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,r,n),null):a===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return es.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return es.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,es.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,es.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw qt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw qt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw qt(27949);return e+(this.isRed()?0:1)}}es.EMPTY=null,es.RED=!0,es.BLACK=!1;es.EMPTY=new class{constructor(){this.size=0}get key(){throw qt(57766)}get value(){throw qt(16141)}get color(){throw qt(16727)}get left(){throw qt(29726)}get right(){throw qt(36894)}copy(e,r,n,s,a){return this}insert(e,r,n){return new es(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this.comparator=e,this.data=new rn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new W2(this.data.getIterator())}getIteratorFrom(e){return new W2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof On)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new On(this.comparator);return r.data=e,r}}class W2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(e){this.fields=e,e.sort(rs.comparator)}static empty(){return new ua([])}unionWith(e){let r=new On(rs.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new ua(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return cu(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new tk("Invalid base64 string: "+a):a}}(e);return new os(r)}static fromUint8Array(e){const r=function(s){let a="";for(let i=0;i<s.length;++i)a+=String.fromCharCode(s[i]);return a}(e);return new os(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return pr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}os.EMPTY_BYTE_STRING=new os("");const U8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ko(t){if(Cr(!!t,39018),typeof t=="string"){let e=0;const r=U8.exec(t);if(Cr(!!r,46558,{timestamp:t}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:dn(t.seconds),nanos:dn(t.nanos)}}function dn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Qo(t){return typeof t=="string"?os.fromBase64String(t):os.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rk="server_timestamp",nk="__type__",sk="__previous_value__",ak="__local_write_time__";function gv(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[nk])==null?void 0:n.stringValue)===rk}function $m(t){const e=t.mapValue.fields[sk];return gv(e)?$m(e):e}function sf(t){const e=Ko(t.mapValue.fields[ak].timestampValue);return new zr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V8{constructor(e,r,n,s,a,i,o,c,u,d){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=d}}const Mh="(default)";class af{constructor(e,r){this.projectId=e,this.database=r||Mh}static empty(){return new af("","")}get isDefaultDatabase(){return this.database===Mh}isEqual(e){return e instanceof af&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ik="__type__",B8="__max__",x0={mapValue:{}},ok="__vector__",$h="value";function Xo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?gv(t)?4:W8(t)?9007199254740991:z8(t)?10:11:qt(28295,{value:t})}function Ai(t,e){if(t===e)return!0;const r=Xo(t);if(r!==Xo(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return sf(t).isEqual(sf(e));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const i=Ko(s.timestampValue),o=Ko(a.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,a){return Qo(s.bytesValue).isEqual(Qo(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,a){return dn(s.geoPointValue.latitude)===dn(a.geoPointValue.latitude)&&dn(s.geoPointValue.longitude)===dn(a.geoPointValue.longitude)}(t,e);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return dn(s.integerValue)===dn(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const i=dn(s.doubleValue),o=dn(a.doubleValue);return i===o?Oh(i)===Oh(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return cu(t.arrayValue.values||[],e.arrayValue.values||[],Ai);case 10:case 11:return function(s,a){const i=s.mapValue.fields||{},o=a.mapValue.fields||{};if(z2(i)!==z2(o))return!1;for(const c in i)if(i.hasOwnProperty(c)&&(o[c]===void 0||!Ai(i[c],o[c])))return!1;return!0}(t,e);default:return qt(52216,{left:t})}}function of(t,e){return(t.values||[]).find(r=>Ai(r,e))!==void 0}function uu(t,e){if(t===e)return 0;const r=Xo(t),n=Xo(e);if(r!==n)return pr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return pr(t.booleanValue,e.booleanValue);case 2:return function(a,i){const o=dn(a.integerValue||a.doubleValue),c=dn(i.integerValue||i.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(t,e);case 3:return H2(t.timestampValue,e.timestampValue);case 4:return H2(sf(t),sf(e));case 5:return Sx(t.stringValue,e.stringValue);case 6:return function(a,i){const o=Qo(a),c=Qo(i);return o.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(a,i){const o=a.split("/"),c=i.split("/");for(let u=0;u<o.length&&u<c.length;u++){const d=pr(o[u],c[u]);if(d!==0)return d}return pr(o.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,i){const o=pr(dn(a.latitude),dn(i.latitude));return o!==0?o:pr(dn(a.longitude),dn(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return G2(t.arrayValue,e.arrayValue);case 10:return function(a,i){var m,p,y,v;const o=a.fields||{},c=i.fields||{},u=(m=o[$h])==null?void 0:m.arrayValue,d=(p=c[$h])==null?void 0:p.arrayValue,h=pr(((y=u==null?void 0:u.values)==null?void 0:y.length)||0,((v=d==null?void 0:d.values)==null?void 0:v.length)||0);return h!==0?h:G2(u,d)}(t.mapValue,e.mapValue);case 11:return function(a,i){if(a===x0.mapValue&&i===x0.mapValue)return 0;if(a===x0.mapValue)return 1;if(i===x0.mapValue)return-1;const o=a.fields||{},c=Object.keys(o),u=i.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){const m=Sx(c[h],d[h]);if(m!==0)return m;const p=uu(o[c[h]],u[d[h]]);if(p!==0)return p}return pr(c.length,d.length)}(t.mapValue,e.mapValue);default:throw qt(23264,{he:r})}}function H2(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return pr(t,e);const r=Ko(t),n=Ko(e),s=pr(r.seconds,n.seconds);return s!==0?s:pr(r.nanos,n.nanos)}function G2(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const a=uu(r[s],n[s]);if(a)return a}return pr(r.length,n.length)}function du(t){return Ex(t)}function Ex(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Ko(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Qo(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Vt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const a of r.values||[])s?s=!1:n+=",",n+=Ex(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const i of n)a?a=!1:s+=",",s+=`${i}:${Ex(r.fields[i])}`;return s+"}"}(t.mapValue):qt(61005,{value:t})}function Y0(t){switch(Xo(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$m(t);return e?16+Y0(e):16;case 5:return 2*t.stringValue.length;case 6:return Qo(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((s,a)=>s+Y0(a),0)}(t.arrayValue);case 10:case 11:return function(n){let s=0;return il(n.fields,(a,i)=>{s+=a.length+Y0(i)}),s}(t.mapValue);default:throw qt(13486,{value:t})}}function Tx(t){return!!t&&"integerValue"in t}function xv(t){return!!t&&"arrayValue"in t}function q2(t){return!!t&&"nullValue"in t}function K2(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function J0(t){return!!t&&"mapValue"in t}function z8(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[ik])==null?void 0:n.stringValue)===ok}function bd(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return il(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=bd(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=bd(t.arrayValue.values[r]);return e}return{...t}}function W8(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===B8}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e){this.value=e}static empty(){return new Qs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!J0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=bd(r)}setAll(e){let r=rs.emptyPath(),n={},s=[];e.forEach((i,o)=>{if(!r.isImmediateParentOf(o)){const c=this.getFieldsMap(r);this.applyChanges(c,n,s),n={},s=[],r=o.popLast()}i?n[o.lastSegment()]=bd(i):s.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,s)}delete(e){const r=this.field(e.popLast());J0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ai(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];J0(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){il(r,(s,a)=>e[s]=a);for(const s of n)delete e[s]}clone(){return new Qs(bd(this.value))}}function lk(t){const e=[];return il(t.fields,(r,n)=>{const s=new rs([r]);if(J0(n)){const a=lk(n.mapValue).fields;if(a.length===0)e.push(s);else for(const i of a)e.push(s.child(i))}else e.push(s)}),new ua(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e,r,n,s,a,i,o){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=a,this.data=i,this.documentState=o}static newInvalidDocument(e){return new vs(e,0,Xt.min(),Xt.min(),Xt.min(),Qs.empty(),0)}static newFoundDocument(e,r,n,s){return new vs(e,1,r,Xt.min(),n,s,0)}static newNoDocument(e,r){return new vs(e,2,r,Xt.min(),Xt.min(),Qs.empty(),0)}static newUnknownDocument(e,r){return new vs(e,3,r,Xt.min(),Xt.min(),Qs.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Xt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Qs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Qs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Xt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof vs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new vs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,r){this.position=e,this.inclusive=r}}function Q2(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const a=e[s],i=t.position[s];if(a.field.isKeyField()?n=Vt.comparator(Vt.fromName(i.referenceValue),r.key):n=uu(i,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function X2(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ai(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(e,r="asc"){this.field=e,this.dir=r}}function H8(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{}class Dn extends ck{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new q8(e,r,n):r==="array-contains"?new X8(e,n):r==="in"?new Y8(e,n):r==="not-in"?new J8(e,n):r==="array-contains-any"?new Z8(e,n):new Dn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new K8(e,n):new Q8(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(uu(r,this.value)):r!==null&&Xo(this.value)===Xo(r)&&this.matchesComparison(uu(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return qt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ii extends ck{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Ii(e,r)}matches(e){return uk(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function uk(t){return t.op==="and"}function dk(t){return G8(t)&&uk(t)}function G8(t){for(const e of t.filters)if(e instanceof Ii)return!1;return!0}function kx(t){if(t instanceof Dn)return t.field.canonicalString()+t.op.toString()+du(t.value);if(dk(t))return t.filters.map(e=>kx(e)).join(",");{const e=t.filters.map(r=>kx(r)).join(",");return`${t.op}(${e})`}}function fk(t,e){return t instanceof Dn?function(n,s){return s instanceof Dn&&n.op===s.op&&n.field.isEqual(s.field)&&Ai(n.value,s.value)}(t,e):t instanceof Ii?function(n,s){return s instanceof Ii&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((a,i,o)=>a&&fk(i,s.filters[o]),!0):!1}(t,e):void qt(19439)}function hk(t){return t instanceof Dn?function(r){return`${r.field.canonicalString()} ${r.op} ${du(r.value)}`}(t):t instanceof Ii?function(r){return r.op.toString()+" {"+r.getFilters().map(hk).join(" ,")+"}"}(t):"Filter"}class q8 extends Dn{constructor(e,r,n){super(e,r,n),this.key=Vt.fromName(n.referenceValue)}matches(e){const r=Vt.comparator(e.key,this.key);return this.matchesComparison(r)}}class K8 extends Dn{constructor(e,r){super(e,"in",r),this.keys=mk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class Q8 extends Dn{constructor(e,r){super(e,"not-in",r),this.keys=mk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function mk(t,e){var r;return(((r=e.arrayValue)==null?void 0:r.values)||[]).map(n=>Vt.fromName(n.referenceValue))}class X8 extends Dn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return xv(r)&&of(r.arrayValue,this.value)}}class Y8 extends Dn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&of(this.value.arrayValue,r)}}class J8 extends Dn{constructor(e,r){super(e,"not-in",r)}matches(e){if(of(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!of(this.value.arrayValue,r)}}class Z8 extends Dn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!xv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>of(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(e,r=null,n=[],s=[],a=null,i=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=i,this.endAt=o,this.Te=null}}function Y2(t,e=null,r=[],n=[],s=null,a=null,i=null){return new eL(t,e,r,n,s,a,i)}function vv(t){const e=Jt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>kx(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Mm(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>du(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>du(n)).join(",")),e.Te=r}return e.Te}function yv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!H8(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!fk(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!X2(t.startAt,e.startAt)&&X2(t.endAt,e.endAt)}function Ax(t){return Vt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Um{constructor(e,r=null,n=[],s=[],a=null,i="F",o=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=i,this.startAt=o,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function tL(t,e,r,n,s,a,i,o){return new Um(t,e,r,n,s,a,i,o)}function Vm(t){return new Um(t)}function J2(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function rL(t){return t.collectionGroup!==null}function _d(t){const e=Jt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(i){let o=new On(rs.comparator);return i.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Vh(a,n))}),r.has(rs.keyField().canonicalString())||e.Ie.push(new Vh(rs.keyField(),n))}return e.Ie}function _i(t){const e=Jt(t);return e.Ee||(e.Ee=nL(e,_d(t))),e.Ee}function nL(t,e){if(t.limitType==="F")return Y2(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new Vh(s.field,a)});const r=t.endAt?new Uh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Uh(t.startAt.position,t.startAt.inclusive):null;return Y2(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Ix(t,e,r){return new Um(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Bm(t,e){return yv(_i(t),_i(e))&&t.limitType===e.limitType}function pk(t){return`${vv(_i(t))}|lt:${t.limitType}`}function wc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>hk(s)).join(", ")}]`),Mm(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>du(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>du(s)).join(",")),`Target(${n})`}(_i(t))}; limitType=${t.limitType})`}function zm(t,e){return e.isFoundDocument()&&function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):Vt.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,s){for(const a of _d(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(i,o,c){const u=Q2(i,o,c);return i.inclusive?u<=0:u<0}(n.startAt,_d(n),s)||n.endAt&&!function(i,o,c){const u=Q2(i,o,c);return i.inclusive?u>=0:u>0}(n.endAt,_d(n),s))}(t,e)}function sL(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function gk(t){return(e,r)=>{let n=!1;for(const s of _d(t)){const a=aL(s,e,r);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function aL(t,e,r){const n=t.field.isKeyField()?Vt.comparator(e.key,r.key):function(a,i,o){const c=i.data.field(a),u=o.data.field(a);return c!==null&&u!==null?uu(c,u):qt(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return qt(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){il(this.inner,(r,n)=>{for(const[s,a]of n)e(s,a)})}isEmpty(){return ek(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iL=new rn(Vt.comparator);function eo(){return iL}const xk=new rn(Vt.comparator);function rd(...t){let e=xk;for(const r of t)e=e.insert(r.key,r);return e}function vk(t){let e=xk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Sl(){return Sd()}function yk(){return Sd()}function Sd(){return new ec(t=>t.toString(),(t,e)=>t.isEqual(e))}const oL=new rn(Vt.comparator),lL=new On(Vt.comparator);function gr(...t){let e=lL;for(const r of t)e=e.add(r);return e}const cL=new On(pr);function uL(){return cL}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Oh(e)?"-0":e}}function wk(t){return{integerValue:""+t}}function dL(t,e){return O8(e)?wk(e):wv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(){this._=void 0}}function fL(t,e,r){return t instanceof Bh?function(s,a){const i={fields:{[nk]:{stringValue:rk},[ak]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&gv(a)&&(a=$m(a)),a&&(i.fields[sk]=a),{mapValue:i}}(r,e):t instanceof lf?_k(t,e):t instanceof cf?Sk(t,e):function(s,a){const i=bk(s,a),o=Z2(i)+Z2(s.Ae);return Tx(i)&&Tx(s.Ae)?wk(o):wv(s.serializer,o)}(t,e)}function hL(t,e,r){return t instanceof lf?_k(t,e):t instanceof cf?Sk(t,e):r}function bk(t,e){return t instanceof zh?function(n){return Tx(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class Bh extends Wm{}class lf extends Wm{constructor(e){super(),this.elements=e}}function _k(t,e){const r=Ek(e);for(const n of t.elements)r.some(s=>Ai(s,n))||r.push(n);return{arrayValue:{values:r}}}class cf extends Wm{constructor(e){super(),this.elements=e}}function Sk(t,e){let r=Ek(e);for(const n of t.elements)r=r.filter(s=>!Ai(s,n));return{arrayValue:{values:r}}}class zh extends Wm{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Z2(t){return dn(t.integerValue||t.doubleValue)}function Ek(t){return xv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function mL(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof lf&&s instanceof lf||n instanceof cf&&s instanceof cf?cu(n.elements,s.elements,Ai):n instanceof zh&&s instanceof zh?Ai(n.Ae,s.Ae):n instanceof Bh&&s instanceof Bh}(t.transform,e.transform)}class pL{constructor(e,r){this.version=e,this.transformResults=r}}class Si{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Si}static exists(e){return new Si(void 0,e)}static updateTime(e){return new Si(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Z0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Hm{}function Tk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ak(t.key,Si.none()):new jf(t.key,t.data,Si.none());{const r=t.data,n=Qs.empty();let s=new On(rs.comparator);for(let a of e.fields)if(!s.has(a)){let i=r.field(a);i===null&&a.length>1&&(a=a.popLast(),i=r.field(a)),i===null?n.delete(a):n.set(a,i),s=s.add(a)}return new ol(t.key,n,new ua(s.toArray()),Si.none())}}function gL(t,e,r){t instanceof jf?function(s,a,i){const o=s.value.clone(),c=tb(s.fieldTransforms,a,i.transformResults);o.setAll(c),a.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,r):t instanceof ol?function(s,a,i){if(!Z0(s.precondition,a))return void a.convertToUnknownDocument(i.version);const o=tb(s.fieldTransforms,a,i.transformResults),c=a.data;c.setAll(kk(s)),c.setAll(o),a.convertToFoundDocument(i.version,c).setHasCommittedMutations()}(t,e,r):function(s,a,i){a.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,r)}function Ed(t,e,r,n){return t instanceof jf?function(a,i,o,c){if(!Z0(a.precondition,i))return o;const u=a.value.clone(),d=rb(a.fieldTransforms,c,i);return u.setAll(d),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof ol?function(a,i,o,c){if(!Z0(a.precondition,i))return o;const u=rb(a.fieldTransforms,c,i),d=i.data;return d.setAll(kk(a)),d.setAll(u),i.convertToFoundDocument(i.version,d).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(a,i,o){return Z0(a.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,r)}function xL(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),a=bk(n.transform,s||null);a!=null&&(r===null&&(r=Qs.empty()),r.set(n.field,a))}return r||null}function eb(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&cu(n,s,(a,i)=>mL(a,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class jf extends Hm{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ol extends Hm{constructor(e,r,n,s,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function kk(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function tb(t,e,r){const n=new Map;Cr(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let s=0;s<r.length;s++){const a=t[s],i=a.transform,o=e.data.field(a.field);n.set(a.field,hL(i,o,r[s]))}return n}function rb(t,e,r){const n=new Map;for(const s of t){const a=s.transform,i=r.data.field(s.field);n.set(s.field,fL(a,i,e))}return n}class Ak extends Hm{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class vL extends Hm{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&gL(a,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Ed(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Ed(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=yk();return this.mutations.forEach(s=>{const a=e.get(s.key),i=a.overlayedDocument;let o=this.applyToLocalView(i,a.mutatedFields);o=r.has(s.key)?null:o;const c=Tk(i,o);c!==null&&n.set(s.key,c),i.isValidDocument()||i.convertToNoDocument(Xt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),gr())}isEqual(e){return this.batchId===e.batchId&&cu(this.mutations,e.mutations,(r,n)=>eb(r,n))&&cu(this.baseMutations,e.baseMutations,(r,n)=>eb(r,n))}}class bv{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){Cr(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=function(){return oL}();const a=e.mutations;for(let i=0;i<a.length;i++)s=s.insert(a[i].key,n[i].version);return new bv(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wL{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wn,wr;function _L(t){switch(t){case Ze.OK:return qt(64938);case Ze.CANCELLED:case Ze.UNKNOWN:case Ze.DEADLINE_EXCEEDED:case Ze.RESOURCE_EXHAUSTED:case Ze.INTERNAL:case Ze.UNAVAILABLE:case Ze.UNAUTHENTICATED:return!1;case Ze.INVALID_ARGUMENT:case Ze.NOT_FOUND:case Ze.ALREADY_EXISTS:case Ze.PERMISSION_DENIED:case Ze.FAILED_PRECONDITION:case Ze.ABORTED:case Ze.OUT_OF_RANGE:case Ze.UNIMPLEMENTED:case Ze.DATA_LOSS:return!0;default:return qt(15467,{code:t})}}function Ik(t){if(t===void 0)return Zi("GRPC error has no .code"),Ze.UNKNOWN;switch(t){case wn.OK:return Ze.OK;case wn.CANCELLED:return Ze.CANCELLED;case wn.UNKNOWN:return Ze.UNKNOWN;case wn.DEADLINE_EXCEEDED:return Ze.DEADLINE_EXCEEDED;case wn.RESOURCE_EXHAUSTED:return Ze.RESOURCE_EXHAUSTED;case wn.INTERNAL:return Ze.INTERNAL;case wn.UNAVAILABLE:return Ze.UNAVAILABLE;case wn.UNAUTHENTICATED:return Ze.UNAUTHENTICATED;case wn.INVALID_ARGUMENT:return Ze.INVALID_ARGUMENT;case wn.NOT_FOUND:return Ze.NOT_FOUND;case wn.ALREADY_EXISTS:return Ze.ALREADY_EXISTS;case wn.PERMISSION_DENIED:return Ze.PERMISSION_DENIED;case wn.FAILED_PRECONDITION:return Ze.FAILED_PRECONDITION;case wn.ABORTED:return Ze.ABORTED;case wn.OUT_OF_RANGE:return Ze.OUT_OF_RANGE;case wn.UNIMPLEMENTED:return Ze.UNIMPLEMENTED;case wn.DATA_LOSS:return Ze.DATA_LOSS;default:return qt(39323,{code:t})}}(wr=wn||(wn={}))[wr.OK=0]="OK",wr[wr.CANCELLED=1]="CANCELLED",wr[wr.UNKNOWN=2]="UNKNOWN",wr[wr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wr[wr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wr[wr.NOT_FOUND=5]="NOT_FOUND",wr[wr.ALREADY_EXISTS=6]="ALREADY_EXISTS",wr[wr.PERMISSION_DENIED=7]="PERMISSION_DENIED",wr[wr.UNAUTHENTICATED=16]="UNAUTHENTICATED",wr[wr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wr[wr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wr[wr.ABORTED=10]="ABORTED",wr[wr.OUT_OF_RANGE=11]="OUT_OF_RANGE",wr[wr.UNIMPLEMENTED=12]="UNIMPLEMENTED",wr[wr.INTERNAL=13]="INTERNAL",wr[wr.UNAVAILABLE=14]="UNAVAILABLE",wr[wr.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SL(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EL=new Vo([4294967295,4294967295],0);function nb(t){const e=SL().encode(t),r=new W4;return r.update(e),new Uint8Array(r.digest())}function sb(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Vo([r,n],0),new Vo([s,a],0)]}class _v{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new nd(`Invalid padding: ${r}`);if(n<0)throw new nd(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new nd(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new nd(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Vo.fromNumber(this.ge)}ye(e,r,n){let s=e.add(r.multiply(Vo.fromNumber(n)));return s.compare(EL)===1&&(s=new Vo([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=nb(e),[n,s]=sb(r);for(let a=0;a<this.hashCount;a++){const i=this.ye(n,s,a);if(!this.we(i))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),i=new _v(a,s,r);return n.forEach(o=>i.insert(o)),i}insert(e){if(this.ge===0)return;const r=nb(e),[n,s]=sb(r);for(let a=0;a<this.hashCount;a++){const i=this.ye(n,s,a);this.Se(i)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class nd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(e,r,n,s,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Df.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Gm(Xt.min(),s,new rn(pr),eo(),gr())}}class Df{constructor(e,r,n,s,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Df(n,r,gr(),gr(),gr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(e,r,n,s){this.be=e,this.removedTargetIds=r,this.key=n,this.De=s}}class Ck{constructor(e,r){this.targetId=e,this.Ce=r}}class Nk{constructor(e,r,n=os.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class ab{constructor(){this.ve=0,this.Fe=ib(),this.Me=os.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=gr(),r=gr(),n=gr();return this.Fe.forEach((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:qt(38017,{changeType:a})}}),new Df(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=ib()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Cr(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class TL{constructor(e){this.Ge=e,this.ze=new Map,this.je=eo(),this.Je=v0(),this.He=v0(),this.Ye=new rn(pr)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:qt(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,s)=>{this.rt(s)&&r(s)})}st(e){const r=e.targetId,n=e.Ce.count,s=this.ot(r);if(s){const a=s.target;if(Ax(a))if(n===0){const i=new Vt(a.path);this.et(r,i,vs.newNoDocument(i,Xt.min()))}else Cr(n===1,20013,{expectedCount:n});else{const i=this._t(r);if(i!==n){const o=this.ut(e),c=o?this.ct(o,e,i):1;if(c!==0){this.it(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,u)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=r;let i,o;try{i=Qo(n).toUint8Array()}catch(c){if(c instanceof tk)return lu("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{o=new _v(i,s,a)}catch(c){return lu(c instanceof nd?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return o.ge===0?null:o}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let s=0;return n.forEach(a=>{const i=this.Ge.ht(),o=`projects/${i.projectId}/databases/${i.database}/documents/${a.path.canonicalString()}`;e.mightContain(o)||(this.et(r,a,null),s++)}),s}Tt(e){const r=new Map;this.ze.forEach((a,i)=>{const o=this.ot(i);if(o){if(a.current&&Ax(o.target)){const c=new Vt(o.target.path);this.It(c).has(i)||this.Et(i,c)||this.et(i,c,vs.newNoDocument(c,e))}a.Be&&(r.set(i,a.ke()),a.qe())}});let n=gr();this.He.forEach((a,i)=>{let o=!0;i.forEachWhile(c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.je.forEach((a,i)=>i.setReadTime(e));const s=new Gm(e,r,this.Ye,this.je,n);return this.je=eo(),this.Je=v0(),this.He=v0(),this.Ye=new rn(pr),s}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,r)?s.Qe(r,1):s.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new ab,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new On(pr),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new On(pr),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||It("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ab),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function v0(){return new rn(Vt.comparator)}function ib(){return new rn(Vt.comparator)}const kL={asc:"ASCENDING",desc:"DESCENDING"},AL={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},IL={and:"AND",or:"OR"};class CL{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Cx(t,e){return t.useProto3Json||Mm(e)?e:{value:e}}function Wh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Rk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function NL(t,e){return Wh(t,e.toTimestamp())}function Ei(t){return Cr(!!t,49232),Xt.fromTimestamp(function(r){const n=Ko(r);return new zr(n.seconds,n.nanos)}(t))}function Sv(t,e){return Nx(t,e).canonicalString()}function Nx(t,e){const r=function(s){return new Zr(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Pk(t){const e=Zr.fromString(t);return Cr(Ok(e),10190,{key:e.toString()}),e}function Rx(t,e){return Sv(t.databaseId,e.path)}function Jp(t,e){const r=Pk(e);if(r.get(1)!==t.databaseId.projectId)throw new Lt(Ze.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Lt(Ze.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Vt(Dk(r))}function jk(t,e){return Sv(t.databaseId,e)}function RL(t){const e=Pk(t);return e.length===4?Zr.emptyPath():Dk(e)}function Px(t){return new Zr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Dk(t){return Cr(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function ob(t,e,r){return{name:Rx(t,e),fields:r.value.mapValue.fields}}function PL(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:qt(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=function(u,d){return u.useProto3Json?(Cr(d===void 0||typeof d=="string",58123),os.fromBase64String(d||"")):(Cr(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),os.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),i=e.targetChange.cause,o=i&&function(u){const d=u.code===void 0?Ze.UNKNOWN:Ik(u.code);return new Lt(d,u.message||"")}(i);r=new Nk(n,s,a,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Jp(t,n.document.name),a=Ei(n.document.updateTime),i=n.document.createTime?Ei(n.document.createTime):Xt.min(),o=new Qs({mapValue:{fields:n.document.fields}}),c=vs.newFoundDocument(s,a,i,o),u=n.targetIds||[],d=n.removedTargetIds||[];r=new eh(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Jp(t,n.document),a=n.readTime?Ei(n.readTime):Xt.min(),i=vs.newNoDocument(s,a),o=n.removedTargetIds||[];r=new eh([],o,i.key,i)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Jp(t,n.document),a=n.removedTargetIds||[];r=new eh([],a,s,null)}else{if(!("filter"in e))return qt(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,i=new bL(s,a),o=n.targetId;r=new Ck(o,i)}}return r}function jL(t,e){let r;if(e instanceof jf)r={update:ob(t,e.key,e.value)};else if(e instanceof Ak)r={delete:Rx(t,e.key)};else if(e instanceof ol)r={update:ob(t,e.key,e.data),updateMask:BL(e.fieldMask)};else{if(!(e instanceof vL))return qt(16599,{Vt:e.type});r={verify:Rx(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,i){const o=i.transform;if(o instanceof Bh)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof lf)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof cf)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof zh)return{fieldPath:i.field.canonicalString(),increment:o.Ae};throw qt(20930,{transform:i.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:NL(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:qt(27497)}(t,e.precondition)),r}function DL(t,e){return t&&t.length>0?(Cr(e!==void 0,14353),t.map(r=>function(s,a){let i=s.updateTime?Ei(s.updateTime):Ei(a);return i.isEqual(Xt.min())&&(i=Ei(a)),new pL(i,s.transformResults||[])}(r,e))):[]}function FL(t,e){return{documents:[jk(t,e.path)]}}function LL(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=jk(t,s);const a=function(u){if(u.length!==0)return Lk(Ii.create(u,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const i=function(u){if(u.length!==0)return u.map(d=>function(m){return{field:bc(m.field),direction:$L(m.dir)}}(d))}(e.orderBy);i&&(r.structuredQuery.orderBy=i);const o=Cx(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:r,parent:s}}function OL(t){let e=RL(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){Cr(n===1,65062);const d=r.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let a=[];r.where&&(a=function(h){const m=Fk(h);return m instanceof Ii&&dk(m)?m.getFilters():[m]}(r.where));let i=[];r.orderBy&&(i=function(h){return h.map(m=>function(y){return new Vh(_c(y.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(m))}(r.orderBy));let o=null;r.limit&&(o=function(h){let m;return m=typeof h=="object"?h.value:h,Mm(m)?null:m}(r.limit));let c=null;r.startAt&&(c=function(h){const m=!!h.before,p=h.values||[];return new Uh(p,m)}(r.startAt));let u=null;return r.endAt&&(u=function(h){const m=!h.before,p=h.values||[];return new Uh(p,m)}(r.endAt)),tL(e,s,i,a,o,"F",c,u)}function ML(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return qt(28987,{purpose:s})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Fk(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=_c(r.unaryFilter.field);return Dn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=_c(r.unaryFilter.field);return Dn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=_c(r.unaryFilter.field);return Dn.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=_c(r.unaryFilter.field);return Dn.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return qt(61313);default:return qt(60726)}}(t):t.fieldFilter!==void 0?function(r){return Dn.create(_c(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return qt(58110);default:return qt(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Ii.create(r.compositeFilter.filters.map(n=>Fk(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return qt(1026)}}(r.compositeFilter.op))}(t):qt(30097,{filter:t})}function $L(t){return kL[t]}function UL(t){return AL[t]}function VL(t){return IL[t]}function bc(t){return{fieldPath:t.canonicalString()}}function _c(t){return rs.fromServerFormat(t.fieldPath)}function Lk(t){return t instanceof Dn?function(r){if(r.op==="=="){if(K2(r.value))return{unaryFilter:{field:bc(r.field),op:"IS_NAN"}};if(q2(r.value))return{unaryFilter:{field:bc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(K2(r.value))return{unaryFilter:{field:bc(r.field),op:"IS_NOT_NAN"}};if(q2(r.value))return{unaryFilter:{field:bc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:bc(r.field),op:UL(r.op),value:r.value}}}(t):t instanceof Ii?function(r){const n=r.getFilters().map(s=>Lk(s));return n.length===1?n[0]:{compositeFilter:{op:VL(r.op),filters:n}}}(t):qt(54877,{filter:t})}function BL(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Ok(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e,r,n,s,a=Xt.min(),i=Xt.min(),o=os.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=c}withSequenceNumber(e){return new Io(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Io(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Io(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Io(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zL{constructor(e){this.yt=e}}function WL(t){const e=OL({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ix(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HL{constructor(){this.Cn=new GL}addToCollectionParentIndex(e,r){return this.Cn.add(r),Ge.resolve()}getCollectionParents(e,r){return Ge.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Ge.resolve()}deleteFieldIndex(e,r){return Ge.resolve()}deleteAllFieldIndexes(e){return Ge.resolve()}createTargetIndexes(e,r){return Ge.resolve()}getDocumentsMatchingTarget(e,r){return Ge.resolve(null)}getIndexType(e,r){return Ge.resolve(0)}getFieldIndexes(e,r){return Ge.resolve([])}getNextCollectionGroupToUpdate(e){return Ge.resolve(null)}getMinOffset(e,r){return Ge.resolve(qo.min())}getMinOffsetFromCollectionGroup(e,r){return Ge.resolve(qo.min())}updateCollectionGroup(e,r,n){return Ge.resolve()}updateIndexEntries(e,r){return Ge.resolve()}}class GL{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new On(Zr.comparator),a=!s.has(n);return this.index[r]=s.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new On(Zr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lb={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Mk=41943040;class qs{static withCacheSize(e){return new qs(e,qs.DEFAULT_COLLECTION_PERCENTILE,qs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qs.DEFAULT_COLLECTION_PERCENTILE=10,qs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qs.DEFAULT=new qs(Mk,qs.DEFAULT_COLLECTION_PERCENTILE,qs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qs.DISABLED=new qs(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new fu(0)}static cr(){return new fu(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb="LruGarbageCollector",qL=1048576;function ub([t,e],[r,n]){const s=pr(t,r);return s===0?pr(e,n):s}class KL{constructor(e){this.Ir=e,this.buffer=new On(ub),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();ub(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class QL{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){It(cb,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Eu(r)?It(cb,"Ignoring IndexedDB error during garbage collection: ",r):await Su(r)}await this.Vr(3e5)})}}class XL{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Ge.resolve(Om.ce);const n=new KL(r);return this.mr.forEachTarget(e,s=>n.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>n.Ar(s))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(It("LruGarbageCollector","Garbage collection skipped; disabled"),Ge.resolve(lb)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(It("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),lb):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,s,a,i,o,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(It("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,i=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,r))).next(h=>(a=h,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(u=Date.now(),yc()<=mr.DEBUG&&It("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${i-d}ms
	Determined least recently used ${s} in `+(o-i)+`ms
	Removed ${a} targets in `+(c-o)+`ms
	Removed ${h} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),Ge.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:h})))}}function YL(t,e){return new XL(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JL{constructor(){this.changes=new ec(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,vs.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Ge.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZL{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&Ed(n.mutation,s,ua.empty(),zr.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,gr()).next(()=>n))}getLocalViewOfDocuments(e,r,n=gr()){const s=Sl();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(a=>{let i=rd();return a.forEach((o,c)=>{i=i.insert(o,c.overlayedDocument)}),i}))}getOverlayedDocuments(e,r){const n=Sl();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,gr()))}populateOverlays(e,r,n){const s=[];return n.forEach(a=>{r.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(e,s).next(a=>{a.forEach((i,o)=>{r.set(i,o)})})}computeViews(e,r,n,s){let a=eo();const i=Sd(),o=function(){return Sd()}();return r.forEach((c,u)=>{const d=n.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof ol)?a=a.insert(u.key,u):d!==void 0?(i.set(u.key,d.mutation.getFieldMask()),Ed(d.mutation,u,d.mutation.getFieldMask(),zr.now())):i.set(u.key,ua.empty())}),this.recalculateAndSaveOverlays(e,a).next(c=>(c.forEach((u,d)=>i.set(u,d)),r.forEach((u,d)=>o.set(u,new ZL(d,i.get(u)??null))),o))}recalculateAndSaveOverlays(e,r){const n=Sd();let s=new rn((i,o)=>i-o),a=gr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(i=>{for(const o of i)o.keys().forEach(c=>{const u=r.get(c);if(u===null)return;let d=n.get(c)||ua.empty();d=o.applyToLocalView(u,d),n.set(c,d);const h=(s.get(o.batchId)||gr()).add(c);s=s.insert(o.batchId,h)})}).next(()=>{const i=[],o=s.getReverseIterator();for(;o.hasNext();){const c=o.getNext(),u=c.key,d=c.value,h=yk();d.forEach(m=>{if(!a.has(m)){const p=Tk(r.get(m),n.get(m));p!==null&&h.set(m,p),a=a.add(m)}}),i.push(this.documentOverlayCache.saveOverlays(e,u,h))}return Ge.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(i){return Vt.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):rL(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(a=>{const i=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-a.size):Ge.resolve(Sl());let o=nf,c=a;return i.next(u=>Ge.forEach(u,(d,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),a.get(d)?Ge.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{c=c.insert(d,m)}))).next(()=>this.populateOverlays(e,u,a)).next(()=>this.computeViews(e,c,u,gr())).next(d=>({batchId:o,changes:vk(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Vt(r)).next(n=>{let s=rd();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const a=r.collectionGroup;let i=rd();return this.indexManager.getCollectionParents(e,a).next(o=>Ge.forEach(o,c=>{const u=function(h,m){return new Um(m,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,c.child(a));return this.getDocumentsMatchingCollectionQuery(e,u,n,s).next(d=>{d.forEach((h,m)=>{i=i.insert(h,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,r,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,s))).next(i=>{a.forEach((c,u)=>{const d=u.getKey();i.get(d)===null&&(i=i.insert(d,vs.newInvalidDocument(d)))});let o=rd();return i.forEach((c,u)=>{const d=a.get(c);d!==void 0&&Ed(d.mutation,u,ua.empty(),zr.now()),zm(r,u)&&(o=o.insert(c,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tO{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Ge.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Ei(s.createTime)}}(r)),Ge.resolve()}getNamedQuery(e,r){return Ge.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(s){return{name:s.name,query:WL(s.bundledQuery),readTime:Ei(s.readTime)}}(r)),Ge.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(){this.overlays=new rn(Vt.comparator),this.qr=new Map}getOverlay(e,r){return Ge.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Sl();return Ge.forEach(r,s=>this.getOverlay(e,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,a)=>{this.St(e,r,a)}),Ge.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.qr.delete(n)),Ge.resolve()}getOverlaysForCollection(e,r,n){const s=Sl(),a=r.length+1,i=new Vt(r.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const c=o.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===a&&c.largestBatchId>n&&s.set(c.getKey(),c)}return Ge.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let a=new rn((u,d)=>u-d);const i=this.overlays.getIterator();for(;i.hasNext();){const u=i.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let d=a.get(u.largestBatchId);d===null&&(d=Sl(),a=a.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const o=Sl(),c=a.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>o.set(u,d)),!(o.size()>=s)););return Ge.resolve(o)}St(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const i=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new wL(r,n));let a=this.qr.get(r);a===void 0&&(a=gr(),this.qr.set(r,a)),this.qr.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(){this.sessionToken=os.EMPTY_BYTE_STRING}getSessionToken(e){return Ge.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Ge.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(){this.Qr=new On(Vn.$r),this.Ur=new On(Vn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new Vn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new Vn(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new Vt(new Zr([])),n=new Vn(r,e),s=new Vn(r,e+1),a=[];return this.Ur.forEachInRange([n,s],i=>{this.Gr(i),a.push(i.key)}),a}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new Vt(new Zr([])),n=new Vn(r,e),s=new Vn(r,e+1);let a=gr();return this.Ur.forEachInRange([n,s],i=>{a=a.add(i.key)}),a}containsKey(e){const r=new Vn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Vn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return Vt.comparator(e.key,r.key)||pr(e.Yr,r.Yr)}static Kr(e,r){return pr(e.Yr,r.Yr)||Vt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new On(Vn.$r)}checkEmpty(e){return Ge.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new yL(a,r,n,s);this.mutationQueue.push(i);for(const o of s)this.Zr=this.Zr.add(new Vn(o.key,a)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Ge.resolve(i)}lookupMutationBatch(e,r){return Ge.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.ei(n),a=s<0?0:s;return Ge.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return Ge.resolve(this.mutationQueue.length===0?pv:this.tr-1)}getAllMutationBatches(e){return Ge.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Vn(r,0),s=new Vn(r,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,s],i=>{const o=this.Xr(i.Yr);a.push(o)}),Ge.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new On(pr);return r.forEach(s=>{const a=new Vn(s,0),i=new Vn(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,i],o=>{n=n.add(o.Yr)})}),Ge.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let a=n;Vt.isDocumentKey(a)||(a=a.child(""));const i=new Vn(new Vt(a),0);let o=new On(pr);return this.Zr.forEachWhile(c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===s&&(o=o.add(c.Yr)),!0)},i),Ge.resolve(this.ti(o))}ti(e){const r=[];return e.forEach(n=>{const s=this.Xr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){Cr(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Ge.forEach(r.mutations,s=>{const a=new Vn(s.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new Vn(r,0),s=this.Zr.firstAfterOrEqual(n);return Ge.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ge.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(e){this.ri=e,this.docs=function(){return new rn(Vt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),a=s?s.size:0,i=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Ge.resolve(n?n.document.mutableCopy():vs.newInvalidDocument(r))}getEntries(e,r){let n=eo();return r.forEach(s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():vs.newInvalidDocument(s))}),Ge.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let a=eo();const i=r.path,o=new Vt(i.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!i.isPrefixOf(u.path))break;u.path.length>i.length+1||j8(P8(d),n)<=0||(s.has(d.key)||zm(r,d))&&(a=a.insert(d.key,d.mutableCopy()))}return Ge.resolve(a)}getAllFromCollectionGroup(e,r,n,s){qt(9500)}ii(e,r){return Ge.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new iO(this)}getSize(e){return Ge.resolve(this.size)}}class iO extends JL{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)}),Ge.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO{constructor(e){this.persistence=e,this.si=new ec(r=>vv(r),yv),this.lastRemoteSnapshotVersion=Xt.min(),this.highestTargetId=0,this.oi=0,this._i=new Ev,this.targetCount=0,this.ai=fu.ur()}forEachTarget(e,r){return this.si.forEach((n,s)=>r(s)),Ge.resolve()}getLastRemoteSnapshotVersion(e){return Ge.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ge.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Ge.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Ge.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new fu(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Ge.resolve()}updateTargetData(e,r){return this.Pr(r),Ge.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Ge.resolve()}removeTargets(e,r,n){let s=0;const a=[];return this.si.forEach((i,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(i),a.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),Ge.waitFor(a).next(()=>s)}getTargetCount(e){return Ge.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Ge.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Ge.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const s=this.persistence.referenceDelegate,a=[];return s&&r.forEach(i=>{a.push(s.markPotentiallyOrphaned(e,i))}),Ge.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Ge.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Ge.resolve(n)}containsKey(e,r){return Ge.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $k{constructor(e,r){this.ui={},this.overlays={},this.ci=new Om(0),this.li=!1,this.li=!0,this.hi=new nO,this.referenceDelegate=e(this),this.Pi=new oO(this),this.indexManager=new HL,this.remoteDocumentCache=function(s){return new aO(s)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new zL(r),this.Ii=new tO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new rO,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new sO(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){It("MemoryPersistence","Starting transaction:",e);const s=new lO(this.ci.next());return this.referenceDelegate.Ei(),n(s).next(a=>this.referenceDelegate.di(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Ai(e,r){return Ge.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class lO extends F8{constructor(e){super(),this.currentSequenceNumber=e}}class Tv{constructor(e){this.persistence=e,this.Ri=new Ev,this.Vi=null}static mi(e){return new Tv(e)}get fi(){if(this.Vi)return this.Vi;throw qt(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Ge.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Ge.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Ge.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(s=>this.fi.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(a=>this.fi.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ge.forEach(this.fi,n=>{const s=Vt.fromPath(n);return this.gi(e,s).next(a=>{a||r.removeEntry(s,Xt.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return Ge.or([()=>Ge.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Hh{constructor(e,r){this.persistence=e,this.pi=new ec(n=>M8(n.path),(n,s)=>n.isEqual(s)),this.garbageCollector=YL(this,r)}static mi(e,r){return new Hh(e,r)}Ei(){}di(e){return Ge.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(s=>n+s))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return Ge.forEach(this.pi,(n,s)=>this.br(e,n,s).next(a=>a?Ge.resolve():r(s)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ii(e,i=>this.br(e,i,r).next(o=>{o||(n++,a.removeEntry(i,Xt.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Ge.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Ge.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Ge.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Ge.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Y0(e.data.value)),r}br(e,r,n){return Ge.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const s=this.pi.get(r);return Ge.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=s}static As(e,r){let n=gr(),s=gr();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new kv(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return fP()?8:L8(Ss())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,s){const a={result:null};return this.ys(e,r).next(i=>{a.result=i}).next(()=>{if(!a.result)return this.ws(e,r,s,n).next(i=>{a.result=i})}).next(()=>{if(a.result)return;const i=new cO;return this.Ss(e,r,i).next(o=>{if(a.result=o,this.Vs)return this.bs(e,r,i,o.size)})}).next(()=>a.result)}bs(e,r,n,s){return n.documentReadCount<this.fs?(yc()<=mr.DEBUG&&It("QueryEngine","SDK will not create cache indexes for query:",wc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Ge.resolve()):(yc()<=mr.DEBUG&&It("QueryEngine","Query:",wc(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(yc()<=mr.DEBUG&&It("QueryEngine","The SDK decides to create cache indexes for query:",wc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,_i(r))):Ge.resolve())}ys(e,r){if(J2(r))return Ge.resolve(null);let n=_i(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=Ix(r,null,"F"),n=_i(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const i=gr(...a);return this.ps.getDocuments(e,i).next(o=>this.indexManager.getMinOffset(e,n).next(c=>{const u=this.Ds(r,o);return this.Cs(r,u,i,c.readTime)?this.ys(e,Ix(r,null,"F")):this.vs(e,u,r,c)}))})))}ws(e,r,n,s){return J2(r)||s.isEqual(Xt.min())?Ge.resolve(null):this.ps.getDocuments(e,n).next(a=>{const i=this.Ds(r,a);return this.Cs(r,i,n,s)?Ge.resolve(null):(yc()<=mr.DEBUG&&It("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),wc(r)),this.vs(e,i,r,R8(s,nf)).next(o=>o))})}Ds(e,r){let n=new On(gk(e));return r.forEach((s,a)=>{zm(e,a)&&(n=n.add(a))}),n}Cs(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Ss(e,r,n){return yc()<=mr.DEBUG&&It("QueryEngine","Using full collection scan to execute query:",wc(r)),this.ps.getDocumentsMatchingQuery(e,r,qo.min(),n)}vs(e,r,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next(a=>(r.forEach(i=>{a=a.insert(i.key,i)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Av="LocalStore",dO=3e8;class fO{constructor(e,r,n,s){this.persistence=e,this.Fs=r,this.serializer=s,this.Ms=new rn(pr),this.xs=new ec(a=>vv(a),yv),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new eO(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function hO(t,e,r,n){return new fO(t,e,r,n)}async function Uk(t,e){const r=Jt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(a=>(s=a,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const i=[],o=[];let c=gr();for(const u of s){i.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of a){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return r.localDocuments.getDocuments(n,c).next(u=>({Ls:u,removedBatchIds:i,addedBatchIds:o}))})})}function mO(t,e){const r=Jt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),a=r.Ns.newChangeBuffer({trackRemovals:!0});return function(o,c,u,d){const h=u.batch,m=h.keys();let p=Ge.resolve();return m.forEach(y=>{p=p.next(()=>d.getEntry(c,y)).next(v=>{const b=u.docVersions.get(y);Cr(b!==null,48541),v.version.compareTo(b)<0&&(h.applyToRemoteDocument(v,u),v.isValidDocument()&&(v.setReadTime(u.commitVersion),d.addEntry(v)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(c,h))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=gr();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(c=c.add(o.batch.mutations[u].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function Vk(t){const e=Jt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function pO(t,e){const r=Jt(t),n=e.snapshotVersion;let s=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const i=r.Ns.newChangeBuffer({trackRemovals:!0});s=r.Ms;const o=[];e.targetChanges.forEach((d,h)=>{const m=s.get(h);if(!m)return;o.push(r.Pi.removeMatchingKeys(a,d.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(a,d.addedDocuments,h)));let p=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(os.EMPTY_BYTE_STRING,Xt.min()).withLastLimboFreeSnapshotVersion(Xt.min()):d.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(d.resumeToken,n)),s=s.insert(h,p),function(v,b,E){return v.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=dO?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(m,p,d)&&o.push(r.Pi.updateTargetData(a,p))});let c=eo(),u=gr();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,d))}),o.push(gO(a,i,e.documentUpdates).next(d=>{c=d.ks,u=d.qs})),!n.isEqual(Xt.min())){const d=r.Pi.getLastRemoteSnapshotVersion(a).next(h=>r.Pi.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(d)}return Ge.waitFor(o).next(()=>i.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,c,u)).next(()=>c)}).then(a=>(r.Ms=s,a))}function gO(t,e,r){let n=gr(),s=gr();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let i=eo();return r.forEach((o,c)=>{const u=a.get(o);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(o)),c.isNoDocument()&&c.version.isEqual(Xt.min())?(e.removeEntry(o,c.readTime),i=i.insert(o,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),i=i.insert(o,c)):It(Av,"Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",c.version)}),{ks:i,qs:s}})}function xO(t,e){const r=Jt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=pv),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function vO(t,e){const r=Jt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Pi.getTargetData(n,e).next(a=>a?(s=a,Ge.resolve(s)):r.Pi.allocateTargetId(n).next(i=>(s=new Io(e,i,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function jx(t,e,r){const n=Jt(t),s=n.Ms.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,i=>n.persistence.referenceDelegate.removeTarget(i,s))}catch(i){if(!Eu(i))throw i;It(Av,`Failed to update sequence numbers for target ${e}: ${i}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function db(t,e,r){const n=Jt(t);let s=Xt.min(),a=gr();return n.persistence.runTransaction("Execute query","readwrite",i=>function(c,u,d){const h=Jt(c),m=h.xs.get(d);return m!==void 0?Ge.resolve(h.Ms.get(m)):h.Pi.getTargetData(u,d)}(n,i,_i(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(i,o.targetId).next(c=>{a=c})}).next(()=>n.Fs.getDocumentsMatchingQuery(i,e,r?s:Xt.min(),r?a:gr())).next(o=>(yO(n,sL(e),o),{documents:o,Qs:a})))}function yO(t,e,r){let n=t.Os.get(e)||Xt.min();r.forEach((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.Os.set(e,n)}class fb{constructor(){this.activeTargetIds=uL()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class wO{constructor(){this.Mo=new fb,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new fb,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hb="ConnectivityMonitor";class mb{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){It(hb,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){It(hb,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let y0=null;function Dx(){return y0===null?y0=function(){return 268435456+Math.round(2147483648*Math.random())}():y0++,"0x"+y0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zp="RestConnection",_O={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class SO{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===Mh?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,r,n,s,a){const i=Dx(),o=this.zo(e,r.toUriEncodedString());It(Zp,`Sending RPC '${e}' ${i}:`,o,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,s,a);const{host:u}=new URL(o),d=Yl(u);return this.Jo(e,o,c,n,d).then(h=>(It(Zp,`Received RPC '${e}' ${i}: `,h),h),h=>{throw lu(Zp,`RPC '${e}' ${i} failed with error: `,h,"url: ",o,"request:",n),h})}Ho(e,r,n,s,a,i){return this.Go(e,r,n,s,a)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+_u}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>e[a]=s),n&&n.headers.forEach((s,a)=>e[a]=s)}zo(e,r){const n=_O[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fs="WebChannelConnection";class TO extends SO{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,s,a){const i=Dx();return new Promise((o,c)=>{const u=new H4;u.setWithCredentials(!0),u.listenOnce(G4.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case X0.NO_ERROR:const h=u.getResponseJson();It(fs,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),o(h);break;case X0.TIMEOUT:It(fs,`RPC '${e}' ${i} timed out`),c(new Lt(Ze.DEADLINE_EXCEEDED,"Request time out"));break;case X0.HTTP_ERROR:const m=u.getStatus();if(It(fs,`RPC '${e}' ${i} failed with status:`,m,"response text:",u.getResponseText()),m>0){let p=u.getResponseJson();Array.isArray(p)&&(p=p[0]);const y=p==null?void 0:p.error;if(y&&y.status&&y.message){const v=function(E){const T=E.toLowerCase().replace(/_/g,"-");return Object.values(Ze).indexOf(T)>=0?T:Ze.UNKNOWN}(y.status);c(new Lt(v,y.message))}else c(new Lt(Ze.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new Lt(Ze.UNAVAILABLE,"Connection failed."));break;default:qt(9055,{l_:e,streamId:i,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{It(fs,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);It(fs,`RPC '${e}' ${i} sending request:`,s),u.send(r,"POST",d,n,15)})}T_(e,r,n){const s=Dx(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Q4(),o=K4(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const d=a.join("");It(fs,`Creating RPC '${e}' stream ${s}: ${d}`,c);const h=i.createWebChannel(d,c);this.I_(h);let m=!1,p=!1;const y=new EO({Yo:b=>{p?It(fs,`Not sending because RPC '${e}' stream ${s} is closed:`,b):(m||(It(fs,`Opening RPC '${e}' stream ${s} transport.`),h.open(),m=!0),It(fs,`RPC '${e}' stream ${s} sending:`,b),h.send(b))},Zo:()=>h.close()}),v=(b,E,T)=>{b.listen(E,w=>{try{T(w)}catch(B){setTimeout(()=>{throw B},0)}})};return v(h,td.EventType.OPEN,()=>{p||(It(fs,`RPC '${e}' stream ${s} transport opened.`),y.o_())}),v(h,td.EventType.CLOSE,()=>{p||(p=!0,It(fs,`RPC '${e}' stream ${s} transport closed`),y.a_(),this.E_(h))}),v(h,td.EventType.ERROR,b=>{p||(p=!0,lu(fs,`RPC '${e}' stream ${s} transport errored. Name:`,b.name,"Message:",b.message),y.a_(new Lt(Ze.UNAVAILABLE,"The operation could not be completed")))}),v(h,td.EventType.MESSAGE,b=>{var E;if(!p){const T=b.data[0];Cr(!!T,16349);const w=T,B=(w==null?void 0:w.error)||((E=w[0])==null?void 0:E.error);if(B){It(fs,`RPC '${e}' stream ${s} received error:`,B);const J=B.status;let Z=function(C){const L=wn[C];if(L!==void 0)return Ik(L)}(J),_=B.message;Z===void 0&&(Z=Ze.INTERNAL,_="Unknown error status: "+J+" with message "+B.message),p=!0,y.a_(new Lt(Z,_)),h.close()}else It(fs,`RPC '${e}' stream ${s} received:`,T),y.u_(T)}}),v(o,q4.STAT_EVENT,b=>{b.stat===_x.PROXY?It(fs,`RPC '${e}' stream ${s} detected buffering proxy`):b.stat===_x.NOPROXY&&It(fs,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{y.__()},0),y}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function eg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qm(t){return new CL(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(e,r,n=1e3,s=1.5,a=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=s,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,r-n);s>0&&It("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb="PersistentStream";class zk{constructor(e,r,n,s,a,i,o,c){this.Mi=e,this.S_=n,this.b_=s,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Bk(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Ze.RESOURCE_EXHAUSTED?(Zi(r.toString()),Zi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Ze.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.D_===r&&this.G_(n,s)},n=>{e(()=>{const s=new Lt(Ze.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{n(()=>this.z_(s))}),this.stream.onMessage(s=>{n(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return It(pb,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(It(pb,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class kO extends zk{constructor(e,r,n,s,a,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=PL(this.serializer,e),n=function(a){if(!("targetChange"in a))return Xt.min();const i=a.targetChange;return i.targetIds&&i.targetIds.length?Xt.min():i.readTime?Ei(i.readTime):Xt.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=Px(this.serializer),r.addTarget=function(a,i){let o;const c=i.target;if(o=Ax(c)?{documents:FL(a,c)}:{query:LL(a,c).ft},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=Rk(a,i.resumeToken);const u=Cx(a,i.expectedCount);u!==null&&(o.expectedCount=u)}else if(i.snapshotVersion.compareTo(Xt.min())>0){o.readTime=Wh(a,i.snapshotVersion.toTimestamp());const u=Cx(a,i.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const n=ML(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=Px(this.serializer),r.removeTarget=e,this.q_(r)}}class AO extends zk{constructor(e,r,n,s,a,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Cr(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Cr(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Cr(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=DL(e.writeResults,e.commitTime),n=Ei(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=Px(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>jL(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IO{}class CO extends IO{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Lt(Ze.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,i])=>this.connection.Go(e,Nx(r,n),s,a,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Ze.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Lt(Ze.UNKNOWN,a.toString())})}Ho(e,r,n,s,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Ho(e,Nx(r,n),s,i,o,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Ze.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Lt(Ze.UNKNOWN,i.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class NO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Zi(r),this.aa=!1):It("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wl="RemoteStore";class RO{constructor(e,r,n,s,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(i=>{n.enqueueAndForget(async()=>{tc(this)&&(It(Wl,"Restarting streams for network reachability change."),await async function(c){const u=Jt(c);u.Ea.add(4),await Ff(u),u.Ra.set("Unknown"),u.Ea.delete(4),await Km(u)}(this))})}),this.Ra=new NO(n,s)}}async function Km(t){if(tc(t))for(const e of t.da)await e(!0)}async function Ff(t){for(const e of t.da)await e(!1)}function Wk(t,e){const r=Jt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Rv(r)?Nv(r):Tu(r).O_()&&Cv(r,e))}function Iv(t,e){const r=Jt(t),n=Tu(r);r.Ia.delete(e),n.O_()&&Hk(r,e),r.Ia.size===0&&(n.O_()?n.L_():tc(r)&&r.Ra.set("Unknown"))}function Cv(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Xt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Tu(t).Y_(e)}function Hk(t,e){t.Va.Ue(e),Tu(t).Z_(e)}function Nv(t){t.Va=new TL({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Tu(t).start(),t.Ra.ua()}function Rv(t){return tc(t)&&!Tu(t).x_()&&t.Ia.size>0}function tc(t){return Jt(t).Ea.size===0}function Gk(t){t.Va=void 0}async function PO(t){t.Ra.set("Online")}async function jO(t){t.Ia.forEach((e,r)=>{Cv(t,e)})}async function DO(t,e){Gk(t),Rv(t)?(t.Ra.ha(e),Nv(t)):t.Ra.set("Unknown")}async function FO(t,e,r){if(t.Ra.set("Online"),e instanceof Nk&&e.state===2&&e.cause)try{await async function(s,a){const i=a.cause;for(const o of a.targetIds)s.Ia.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.Ia.delete(o),s.Va.removeTarget(o))}(t,e)}catch(n){It(Wl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Gh(t,n)}else if(e instanceof eh?t.Va.Ze(e):e instanceof Ck?t.Va.st(e):t.Va.tt(e),!r.isEqual(Xt.min()))try{const n=await Vk(t.localStore);r.compareTo(n)>=0&&await function(a,i){const o=a.Va.Tt(i);return o.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=a.Ia.get(u);d&&a.Ia.set(u,d.withResumeToken(c.resumeToken,i))}}),o.targetMismatches.forEach((c,u)=>{const d=a.Ia.get(c);if(!d)return;a.Ia.set(c,d.withResumeToken(os.EMPTY_BYTE_STRING,d.snapshotVersion)),Hk(a,c);const h=new Io(d.target,c,u,d.sequenceNumber);Cv(a,h)}),a.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){It(Wl,"Failed to raise snapshot:",n),await Gh(t,n)}}async function Gh(t,e,r){if(!Eu(e))throw e;t.Ea.add(1),await Ff(t),t.Ra.set("Offline"),r||(r=()=>Vk(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{It(Wl,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Km(t)})}function qk(t,e){return e().catch(r=>Gh(t,r,e))}async function Qm(t){const e=Jt(t),r=Yo(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:pv;for(;LO(e);)try{const s=await xO(e.localStore,n);if(s===null){e.Ta.length===0&&r.L_();break}n=s.batchId,OO(e,s)}catch(s){await Gh(e,s)}Kk(e)&&Qk(e)}function LO(t){return tc(t)&&t.Ta.length<10}function OO(t,e){t.Ta.push(e);const r=Yo(t);r.O_()&&r.X_&&r.ea(e.mutations)}function Kk(t){return tc(t)&&!Yo(t).x_()&&t.Ta.length>0}function Qk(t){Yo(t).start()}async function MO(t){Yo(t).ra()}async function $O(t){const e=Yo(t);for(const r of t.Ta)e.ea(r.mutations)}async function UO(t,e,r){const n=t.Ta.shift(),s=bv.from(n,e,r);await qk(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Qm(t)}async function VO(t,e){e&&Yo(t).X_&&await async function(n,s){if(function(i){return _L(i)&&i!==Ze.ABORTED}(s.code)){const a=n.Ta.shift();Yo(n).B_(),await qk(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s)),await Qm(n)}}(t,e),Kk(t)&&Qk(t)}async function gb(t,e){const r=Jt(t);r.asyncQueue.verifyOperationInProgress(),It(Wl,"RemoteStore received new credentials");const n=tc(r);r.Ea.add(3),await Ff(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Km(r)}async function BO(t,e){const r=Jt(t);e?(r.Ea.delete(2),await Km(r)):e||(r.Ea.add(2),await Ff(r),r.Ra.set("Unknown"))}function Tu(t){return t.ma||(t.ma=function(r,n,s){const a=Jt(r);return a.sa(),new kO(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Xo:PO.bind(null,t),t_:jO.bind(null,t),r_:DO.bind(null,t),H_:FO.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Rv(t)?Nv(t):t.Ra.set("Unknown")):(await t.ma.stop(),Gk(t))})),t.ma}function Yo(t){return t.fa||(t.fa=function(r,n,s){const a=Jt(r);return a.sa(),new AO(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:MO.bind(null,t),r_:VO.bind(null,t),ta:$O.bind(null,t),na:UO.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Qm(t)):(await t.fa.stop(),t.Ta.length>0&&(It(Wl,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(e,r,n,s,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new Bo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,a){const i=Date.now()+n,o=new Pv(e,r,i,s,a);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Lt(Ze.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jv(t,e){if(Zi("AsyncQueue",`${e}: ${t}`),Eu(t))return new Lt(Ze.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{static emptySet(e){return new Qc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Vt.comparator(r.key,n.key):(r,n)=>Vt.comparator(r.key,n.key),this.keyedMap=rd(),this.sortedSet=new rn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Qc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Qc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{constructor(){this.ga=new rn(Vt.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):qt(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class hu{constructor(e,r,n,s,a,i,o,c,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,s,a){const i=[];return r.forEach(o=>{i.push({type:0,doc:o})}),new hu(e,r,Qc.emptySet(r),i,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Bm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class WO{constructor(){this.queries=vb(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const s=Jt(r),a=s.queries;s.queries=vb(),a.forEach((i,o)=>{for(const c of o.Sa)c.onError(n)})})(this,new Lt(Ze.ABORTED,"Firestore shutting down"))}}function vb(){return new ec(t=>pk(t),Bm)}async function Xk(t,e){const r=Jt(t);let n=3;const s=e.query;let a=r.queries.get(s);a?!a.ba()&&e.Da()&&(n=2):(a=new zO,n=e.Da()?0:1);try{switch(n){case 0:a.wa=await r.onListen(s,!0);break;case 1:a.wa=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(i){const o=jv(i,`Initialization of query '${wc(e.query)}' failed`);return void e.onError(o)}r.queries.set(s,a),a.Sa.push(e),e.va(r.onlineState),a.wa&&e.Fa(a.wa)&&Dv(r)}async function Yk(t,e){const r=Jt(t),n=e.query;let s=3;const a=r.queries.get(n);if(a){const i=a.Sa.indexOf(e);i>=0&&(a.Sa.splice(i,1),a.Sa.length===0?s=e.Da()?0:1:!a.ba()&&e.Da()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function HO(t,e){const r=Jt(t);let n=!1;for(const s of e){const a=s.query,i=r.queries.get(a);if(i){for(const o of i.Sa)o.Fa(s)&&(n=!0);i.wa=s}}n&&Dv(r)}function GO(t,e,r){const n=Jt(t),s=n.queries.get(e);if(s)for(const a of s.Sa)a.onError(r);n.queries.delete(e)}function Dv(t){t.Ca.forEach(e=>{e.next()})}var Fx,yb;(yb=Fx||(Fx={})).Ma="default",yb.Cache="cache";class Jk{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new hu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=hu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Fx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zk{constructor(e){this.key=e}}class eA{constructor(e){this.key=e}}class qO{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=gr(),this.mutatedKeys=gr(),this.eu=gk(e),this.tu=new Qc(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new xb,s=r?r.tu:this.tu;let a=r?r.mutatedKeys:this.mutatedKeys,i=s,o=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,h)=>{const m=s.get(d),p=zm(this.query,h)?h:null,y=!!m&&this.mutatedKeys.has(m.key),v=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let b=!1;m&&p?m.data.isEqual(p.data)?y!==v&&(n.track({type:3,doc:p}),b=!0):this.su(m,p)||(n.track({type:2,doc:p}),b=!0,(c&&this.eu(p,c)>0||u&&this.eu(p,u)<0)&&(o=!0)):!m&&p?(n.track({type:0,doc:p}),b=!0):m&&!p&&(n.track({type:1,doc:m}),b=!0,(c||u)&&(o=!0)),b&&(p?(i=i.add(p),a=v?a.add(d):a.delete(d)):(i=i.delete(d),a=a.delete(d)))}),this.query.limit!==null)for(;i.size>this.query.limit;){const d=this.query.limitType==="F"?i.last():i.first();i=i.delete(d.key),a=a.delete(d.key),n.track({type:1,doc:d})}return{tu:i,iu:n,Cs:o,mutatedKeys:a}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const i=e.iu.ya();i.sort((d,h)=>function(p,y){const v=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return qt(20277,{Rt:b})}};return v(p)-v(y)}(d.type,h.type)||this.eu(d.doc,h.doc)),this.ou(n),s=s??!1;const o=r&&!s?this._u():[],c=this.Xa.size===0&&this.current&&!s?1:0,u=c!==this.Za;return this.Za=c,i.length!==0||u?{snapshot:new hu(this.query,e.tu,a,i,e.mutatedKeys,c===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new xb,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=gr(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new eA(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new Zk(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=gr();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return hu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Fv="SyncEngine";class KO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class QO{constructor(e){this.key=e,this.hu=!1}}class XO{constructor(e,r,n,s,a,i){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.Pu={},this.Tu=new ec(o=>pk(o),Bm),this.Iu=new Map,this.Eu=new Set,this.du=new rn(Vt.comparator),this.Au=new Map,this.Ru=new Ev,this.Vu={},this.mu=new Map,this.fu=fu.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function YO(t,e,r=!0){const n=iA(t);let s;const a=n.Tu.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.lu()):s=await tA(n,e,r,!0),s}async function JO(t,e){const r=iA(t);await tA(r,e,!0,!1)}async function tA(t,e,r,n){const s=await vO(t.localStore,_i(e)),a=s.targetId,i=t.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await ZO(t,e,a,i==="current",s.resumeToken)),t.isPrimaryClient&&r&&Wk(t.remoteStore,s),o}async function ZO(t,e,r,n,s){t.pu=(h,m,p)=>async function(v,b,E,T){let w=b.view.ru(E);w.Cs&&(w=await db(v.localStore,b.query,!1).then(({documents:_})=>b.view.ru(_,w)));const B=T&&T.targetChanges.get(b.targetId),J=T&&T.targetMismatches.get(b.targetId)!=null,Z=b.view.applyChanges(w,v.isPrimaryClient,B,J);return bb(v,b.targetId,Z.au),Z.snapshot}(t,h,m,p);const a=await db(t.localStore,e,!0),i=new qO(e,a.Qs),o=i.ru(a.documents),c=Df.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),u=i.applyChanges(o,t.isPrimaryClient,c);bb(t,r,u.au);const d=new KO(e,r,i);return t.Tu.set(e,d),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),u.snapshot}async function eM(t,e,r){const n=Jt(t),s=n.Tu.get(e),a=n.Iu.get(s.targetId);if(a.length>1)return n.Iu.set(s.targetId,a.filter(i=>!Bm(i,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await jx(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&Iv(n.remoteStore,s.targetId),Lx(n,s.targetId)}).catch(Su)):(Lx(n,s.targetId),await jx(n.localStore,s.targetId,!0))}async function tM(t,e){const r=Jt(t),n=r.Tu.get(e),s=r.Iu.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Iv(r.remoteStore,n.targetId))}async function rM(t,e,r){const n=cM(t);try{const s=await function(i,o){const c=Jt(i),u=zr.now(),d=o.reduce((p,y)=>p.add(y.key),gr());let h,m;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let y=eo(),v=gr();return c.Ns.getEntries(p,d).next(b=>{y=b,y.forEach((E,T)=>{T.isValidDocument()||(v=v.add(E))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,y)).next(b=>{h=b;const E=[];for(const T of o){const w=xL(T,h.get(T.key).overlayedDocument);w!=null&&E.push(new ol(T.key,w,lk(w.value.mapValue),Si.exists(!0)))}return c.mutationQueue.addMutationBatch(p,u,E,o)}).next(b=>{m=b;const E=b.applyToLocalDocumentSet(h,v);return c.documentOverlayCache.saveOverlays(p,b.batchId,E)})}).then(()=>({batchId:m.batchId,changes:vk(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(i,o,c){let u=i.Vu[i.currentUser.toKey()];u||(u=new rn(pr)),u=u.insert(o,c),i.Vu[i.currentUser.toKey()]=u}(n,s.batchId,r),await Lf(n,s.changes),await Qm(n.remoteStore)}catch(s){const a=jv(s,"Failed to persist write");r.reject(a)}}async function rA(t,e){const r=Jt(t);try{const n=await pO(r.localStore,e);e.targetChanges.forEach((s,a)=>{const i=r.Au.get(a);i&&(Cr(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?i.hu=!0:s.modifiedDocuments.size>0?Cr(i.hu,14607):s.removedDocuments.size>0&&(Cr(i.hu,42227),i.hu=!1))}),await Lf(r,n,e)}catch(n){await Su(n)}}function wb(t,e,r){const n=Jt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Tu.forEach((a,i)=>{const o=i.view.va(e);o.snapshot&&s.push(o.snapshot)}),function(i,o){const c=Jt(i);c.onlineState=o;let u=!1;c.queries.forEach((d,h)=>{for(const m of h.Sa)m.va(o)&&(u=!0)}),u&&Dv(c)}(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function nM(t,e,r){const n=Jt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Au.get(e),a=s&&s.key;if(a){let i=new rn(Vt.comparator);i=i.insert(a,vs.newNoDocument(a,Xt.min()));const o=gr().add(a),c=new Gm(Xt.min(),new Map,new rn(pr),i,o);await rA(n,c),n.du=n.du.remove(a),n.Au.delete(e),Lv(n)}else await jx(n.localStore,e,!1).then(()=>Lx(n,e,r)).catch(Su)}async function sM(t,e){const r=Jt(t),n=e.batch.batchId;try{const s=await mO(r.localStore,e);sA(r,n,null),nA(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Lf(r,s)}catch(s){await Su(s)}}async function aM(t,e,r){const n=Jt(t);try{const s=await function(i,o){const c=Jt(i);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,o).next(h=>(Cr(h!==null,37113),d=h.keys(),c.mutationQueue.removeMutationBatch(u,h))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(n.localStore,e);sA(n,e,r),nA(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Lf(n,s)}catch(s){await Su(s)}}function nA(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function sA(t,e,r){const n=Jt(t);let s=n.Vu[n.currentUser.toKey()];if(s){const a=s.get(e);a&&(r?a.reject(r):a.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function Lx(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||aA(t,n)})}function aA(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Iv(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),Lv(t))}function bb(t,e,r){for(const n of r)n instanceof Zk?(t.Ru.addReference(n.key,e),iM(t,n)):n instanceof eA?(It(Fv,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||aA(t,n.key)):qt(19791,{wu:n})}function iM(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(It(Fv,"New document in limbo: "+r),t.Eu.add(n),Lv(t))}function Lv(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new Vt(Zr.fromString(e)),n=t.fu.next();t.Au.set(n,new QO(r)),t.du=t.du.insert(r,n),Wk(t.remoteStore,new Io(_i(Vm(r.path)),n,"TargetPurposeLimboResolution",Om.ce))}}async function Lf(t,e,r){const n=Jt(t),s=[],a=[],i=[];n.Tu.isEmpty()||(n.Tu.forEach((o,c)=>{i.push(n.pu(c,e,r).then(u=>{var d;if((u||r)&&n.isPrimaryClient){const h=u?!u.fromCache:(d=r==null?void 0:r.targetChanges.get(c.targetId))==null?void 0:d.current;n.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){s.push(u);const h=kv.As(c.targetId,u);a.push(h)}}))}),await Promise.all(i),n.Pu.H_(s),await async function(c,u){const d=Jt(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>Ge.forEach(u,m=>Ge.forEach(m.Es,p=>d.persistence.referenceDelegate.addReference(h,m.targetId,p)).next(()=>Ge.forEach(m.ds,p=>d.persistence.referenceDelegate.removeReference(h,m.targetId,p)))))}catch(h){if(!Eu(h))throw h;It(Av,"Failed to update sequence numbers: "+h)}for(const h of u){const m=h.targetId;if(!h.fromCache){const p=d.Ms.get(m),y=p.snapshotVersion,v=p.withLastLimboFreeSnapshotVersion(y);d.Ms=d.Ms.insert(m,v)}}}(n.localStore,a))}async function oM(t,e){const r=Jt(t);if(!r.currentUser.isEqual(e)){It(Fv,"User change. New user:",e.toKey());const n=await Uk(r.localStore,e);r.currentUser=e,function(a,i){a.mu.forEach(o=>{o.forEach(c=>{c.reject(new Lt(Ze.CANCELLED,i))})}),a.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Lf(r,n.Ls)}}function lM(t,e){const r=Jt(t),n=r.Au.get(e);if(n&&n.hu)return gr().add(n.key);{let s=gr();const a=r.Iu.get(e);if(!a)return s;for(const i of a){const o=r.Tu.get(i);s=s.unionWith(o.view.nu)}return s}}function iA(t){const e=Jt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=rA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nM.bind(null,e),e.Pu.H_=HO.bind(null,e.eventManager),e.Pu.yu=GO.bind(null,e.eventManager),e}function cM(t){const e=Jt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=sM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=aM.bind(null,e),e}class qh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=qm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return hO(this.persistence,new uO,e.initialUser,this.serializer)}Cu(e){return new $k(Tv.mi,this.serializer)}Du(e){return new wO}async terminate(){var e,r;(e=this.gcScheduler)==null||e.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}qh.provider={build:()=>new qh};class uM extends qh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Cr(this.persistence.referenceDelegate instanceof Hh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new QL(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?qs.withCacheSize(this.cacheSizeBytes):qs.DEFAULT;return new $k(n=>Hh.mi(n,r),this.serializer)}}class Ox{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>wb(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=oM.bind(null,this.syncEngine),await BO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new WO}()}createDatastore(e){const r=qm(e.databaseInfo.databaseId),n=function(a){return new TO(a)}(e.databaseInfo);return function(a,i,o,c){return new CO(a,i,o,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,a,i,o){return new RO(n,s,a,i,o)}(this.localStore,this.datastore,e.asyncQueue,r=>wb(this.syncEngine,r,0),function(){return mb.v()?new mb:new bO}())}createSyncEngine(e,r){return function(s,a,i,o,c,u,d){const h=new XO(s,a,i,o,c,u);return d&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const a=Jt(s);It(Wl,"RemoteStore shutting down."),a.Ea.add(5),await Ff(a),a.Aa.shutdown(),a.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(r=this.eventManager)==null||r.terminate()}}Ox.provider={build:()=>new Ox};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Zi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jo="FirestoreClient";class dM{constructor(e,r,n,s,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=ps.UNAUTHENTICATED,this.clientId=hv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async i=>{It(Jo,"Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(n,i=>(It(Jo,"Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Bo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=jv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function tg(t,e){t.asyncQueue.verifyOperationInProgress(),It(Jo,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await Uk(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function _b(t,e){t.asyncQueue.verifyOperationInProgress();const r=await fM(t);It(Jo,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>gb(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>gb(e.remoteStore,s)),t._onlineComponents=e}async function fM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){It(Jo,"Using user provided OfflineComponentProvider");try{await tg(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===Ze.FAILED_PRECONDITION||s.code===Ze.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;lu("Error using user provided cache. Falling back to memory cache: "+r),await tg(t,new qh)}}else It(Jo,"Using default OfflineComponentProvider"),await tg(t,new uM(void 0));return t._offlineComponents}async function lA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(It(Jo,"Using user provided OnlineComponentProvider"),await _b(t,t._uninitializedComponentsProvider._online)):(It(Jo,"Using default OnlineComponentProvider"),await _b(t,new Ox))),t._onlineComponents}function hM(t){return lA(t).then(e=>e.syncEngine)}async function Mx(t){const e=await lA(t),r=e.eventManager;return r.onListen=YO.bind(null,e.syncEngine),r.onUnlisten=eM.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=JO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=tM.bind(null,e.syncEngine),r}function mM(t,e,r={}){const n=new Bo;return t.asyncQueue.enqueueAndForget(async()=>function(a,i,o,c,u){const d=new oA({next:m=>{d.Nu(),i.enqueueAndForget(()=>Yk(a,h));const p=m.docs.has(o);!p&&m.fromCache?u.reject(new Lt(Ze.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&c&&c.source==="server"?u.reject(new Lt(Ze.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),h=new Jk(Vm(o.path),d,{includeMetadataChanges:!0,qa:!0});return Xk(a,h)}(await Mx(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sb=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA="firestore.googleapis.com",Eb=!0;class Tb{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Lt(Ze.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=uA,this.ssl=Eb}else this.host=e.host,this.ssl=e.ssl??Eb;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Mk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<qL)throw new Lt(Ze.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}N8("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=cA(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Lt(Ze.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Lt(Ze.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Lt(Ze.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ov{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Tb({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Lt(Ze.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Lt(Ze.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Tb(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new y8;switch(n.type){case"firstParty":return new S8(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Lt(Ze.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Sb.get(r);n&&(It("ComponentProvider","Removing Datastore"),Sb.delete(r),n.terminate())}(this),Promise.resolve()}}function pM(t,e,r,n={}){var u;t=bi(t,Ov);const s=Yl(e),a=t._getSettings(),i={...a,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${r}`;s&&(Q1(`https://${o}`),X1("Firestore",!0)),a.host!==uA&&a.host!==o&&lu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...a,host:o,ssl:s,emulatorOptions:n};if(!Go(c,i)&&(t._setSettings(c),n.mockUserToken)){let d,h;if(typeof n.mockUserToken=="string")d=n.mockUserToken,h=ps.MOCK_USER;else{d=jT(n.mockUserToken,(u=t._app)==null?void 0:u.options.projectId);const m=n.mockUserToken.sub||n.mockUserToken.user_id;if(!m)throw new Lt(Ze.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new ps(m)}t._authCredentials=new w8(new Y4(d,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xm{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Xm(this.firestore,e,this._query)}}class Tn{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new uf(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tn(this.firestore,e,this._key)}toJSON(){return{type:Tn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Pf(r,Tn._jsonSchema))return new Tn(e,n||null,new Vt(Zr.fromString(r.referencePath)))}}Tn._jsonSchemaVersion="firestore/documentReference/1.0",Tn._jsonSchema={type:En("string",Tn._jsonSchemaVersion),referencePath:En("string")};class uf extends Xm{constructor(e,r,n){super(e,r,Vm(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tn(this.firestore,null,new Vt(e))}withConverter(e){return new uf(this.firestore,e,this._path)}}function rc(t,e,...r){if(t=hn(t),arguments.length===1&&(e=hv.newId()),C8("doc","path",e),t instanceof Ov){const n=Zr.fromString(e,...r);return $2(n),new Tn(t,null,new Vt(n))}{if(!(t instanceof Tn||t instanceof uf))throw new Lt(Ze.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Zr.fromString(e,...r));return $2(n),new Tn(t.firestore,t instanceof uf?t.converter:null,new Vt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kb="AsyncQueue";class Ab{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Bk(this,"async_queue_retry"),this._c=()=>{const n=eg();n&&It(kb,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=eg();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=eg();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Bo;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Eu(e))throw e;It(kb,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Zi("INTERNAL UNHANDLED ERROR: ",Ib(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const s=Pv.createAndSchedule(this,e,r,n,a=>this.hc(a));return this.tc.push(s),s}uc(){this.nc&&qt(47125,{Pc:Ib(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function Ib(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cb(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const a of n)if(a in s&&typeof s[a]=="function")return!0;return!1}(t,["next","error","complete"])}class mu extends Ov{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new Ab,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Ab(e),this._firestoreClient=void 0,await e}}}function gM(t,e){const r=typeof t=="object"?t:Rm(),n=typeof t=="string"?t:Mh,s=sl(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=NT("firestore");a&&pM(s,...a)}return s}function Mv(t){if(t._terminated)throw new Lt(Ze.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||xM(t),t._firestoreClient}function xM(t){var n,s,a;const e=t._freezeSettings(),r=function(o,c,u,d){return new V8(o,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,cA(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((a=e.localCache)!=null&&a._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new dM(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(o){const c=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ea(os.fromBase64String(e))}catch(r){throw new Lt(Ze.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Ea(os.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ea._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Pf(e,Ea._jsonSchema))return Ea.fromBase64String(e.bytes)}}Ea._jsonSchemaVersion="firestore/bytes/1.0",Ea._jsonSchema={type:En("string",Ea._jsonSchemaVersion),bytes:En("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Lt(Ze.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new rs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Lt(Ze.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Lt(Ze.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return pr(this._lat,e._lat)||pr(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ti._jsonSchemaVersion}}static fromJSON(e){if(Pf(e,Ti._jsonSchema))return new Ti(e.latitude,e.longitude)}}Ti._jsonSchemaVersion="firestore/geoPoint/1.0",Ti._jsonSchema={type:En("string",Ti._jsonSchemaVersion),latitude:En("number"),longitude:En("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ki._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Pf(e,ki._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new ki(e.vectorValues);throw new Lt(Ze.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ki._jsonSchemaVersion="firestore/vectorValue/1.0",ki._jsonSchema={type:En("string",ki._jsonSchemaVersion),vectorValues:En("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vM=/^__.*__$/;class yM{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new ol(e,this.data,this.fieldMask,r,this.fieldTransforms):new jf(e,this.data,r,this.fieldTransforms)}}class dA{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new ol(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function fA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw qt(40011,{Ac:t})}}class Uv{constructor(e,r,n,s,a,i){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Uv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Kh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(fA(this.Ac)&&vM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class wM{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||qm(e)}Cc(e,r,n,s=!1){return new Uv({Ac:e,methodName:r,Dc:n,path:rs.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function hA(t){const e=t._freezeSettings(),r=qm(t._databaseId);return new wM(t._databaseId,!!e.ignoreUndefinedProperties,r)}function bM(t,e,r,n,s,a={}){const i=t.Cc(a.merge||a.mergeFields?2:0,e,r,s);Vv("Data must be an object, but it was:",i,n);const o=mA(n,i);let c,u;if(a.merge)c=new ua(i.fieldMask),u=i.fieldTransforms;else if(a.mergeFields){const d=[];for(const h of a.mergeFields){const m=$x(e,h,r);if(!i.contains(m))throw new Lt(Ze.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);gA(d,m)||d.push(m)}c=new ua(d),u=i.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=i.fieldTransforms;return new yM(new Qs(o),c,u)}class Jm extends $v{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Jm}}function _M(t,e,r,n){const s=t.Cc(1,e,r);Vv("Data must be an object, but it was:",s,n);const a=[],i=Qs.empty();il(n,(c,u)=>{const d=Bv(e,c,r);u=hn(u);const h=s.yc(d);if(u instanceof Jm)a.push(d);else{const m=Zm(u,h);m!=null&&(a.push(d),i.set(d,m))}});const o=new ua(a);return new dA(i,o,s.fieldTransforms)}function SM(t,e,r,n,s,a){const i=t.Cc(1,e,r),o=[$x(e,n,r)],c=[s];if(a.length%2!=0)throw new Lt(Ze.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)o.push($x(e,a[m])),c.push(a[m+1]);const u=[],d=Qs.empty();for(let m=o.length-1;m>=0;--m)if(!gA(u,o[m])){const p=o[m];let y=c[m];y=hn(y);const v=i.yc(p);if(y instanceof Jm)u.push(p);else{const b=Zm(y,v);b!=null&&(u.push(p),d.set(p,b))}}const h=new ua(u);return new dA(d,h,i.fieldTransforms)}function Zm(t,e){if(pA(t=hn(t)))return Vv("Unsupported field value:",e,t),mA(t,e);if(t instanceof $v)return function(n,s){if(!fA(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,s){const a=[];let i=0;for(const o of n){let c=Zm(o,s.wc(i));c==null&&(c={nullValue:"NULL_VALUE"}),a.push(c),i++}return{arrayValue:{values:a}}}(t,e)}return function(n,s){if((n=hn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return dL(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=zr.fromDate(n);return{timestampValue:Wh(s.serializer,a)}}if(n instanceof zr){const a=new zr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Wh(s.serializer,a)}}if(n instanceof Ti)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ea)return{bytesValue:Rk(s.serializer,n._byteString)};if(n instanceof Tn){const a=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(a))throw s.Sc(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Sv(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof ki)return function(i,o){return{mapValue:{fields:{[ik]:{stringValue:ok},[$h]:{arrayValue:{values:i.toArray().map(u=>{if(typeof u!="number")throw o.Sc("VectorValues must only contain numeric values.");return wv(o.serializer,u)})}}}}}}(n,s);throw s.Sc(`Unsupported field value: ${mv(n)}`)}(t,e)}function mA(t,e){const r={};return ek(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):il(t,(n,s)=>{const a=Zm(s,e.mc(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function pA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof zr||t instanceof Ti||t instanceof Ea||t instanceof Tn||t instanceof $v||t instanceof ki)}function Vv(t,e,r){if(!pA(r)||!J4(r)){const n=mv(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function $x(t,e,r){if((e=hn(e))instanceof Ym)return e._internalPath;if(typeof e=="string")return Bv(t,e);throw Kh("Field path arguments must be of type string or ",t,!1,void 0,r)}const EM=new RegExp("[~\\*/\\[\\]]");function Bv(t,e,r){if(e.search(EM)>=0)throw Kh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Ym(...e.split("."))._internalPath}catch{throw Kh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Kh(t,e,r,n,s){const a=n&&!n.isEmpty(),i=s!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(a||i)&&(c+=" (found",a&&(c+=` in field ${n}`),i&&(c+=` in document ${s}`),c+=")"),new Lt(Ze.INVALID_ARGUMENT,o+t+c)}function gA(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(e,r,n,s,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Tn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new TM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(vA("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class TM extends xA{data(){return super.data()}}function vA(t,e){return typeof e=="string"?Bv(t,e):e instanceof Ym?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kM(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Lt(Ze.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class AM{convertValue(e,r="none"){switch(Xo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Qo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw qt(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return il(e,(s,a)=>{n[s]=this.convertValue(a,r)}),n}convertVectorValue(e){var n,s,a;const r=(a=(s=(n=e.fields)==null?void 0:n[$h].arrayValue)==null?void 0:s.values)==null?void 0:a.map(i=>dn(i.doubleValue));return new ki(r)}convertGeoPoint(e){return new Ti(dn(e.latitude),dn(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=$m(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(sf(e));default:return null}}convertTimestamp(e){const r=Ko(e);return new zr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Zr.fromString(e);Cr(Ok(n),9688,{name:e});const s=new af(n.get(1),n.get(3)),a=new Vt(n.popFirst(5));return s.isEqual(r)||Zi(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IM(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class sd{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Nl extends xA{constructor(e,r,n,s,a,i){super(e,r,n,s,i),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new th(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(vA("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Lt(Ze.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Nl._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Nl._jsonSchemaVersion="firestore/documentSnapshot/1.0",Nl._jsonSchema={type:En("string",Nl._jsonSchemaVersion),bundleSource:En("string","DocumentSnapshot"),bundleName:En("string"),bundle:En("string")};class th extends Nl{data(e={}){return super.data(e)}}class Xc{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new sd(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new th(this._firestore,this._userDataWriter,n.key,n,new sd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Lt(Ze.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>{const c=new th(s._firestore,s._userDataWriter,o.doc.key,o.doc,new sd(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:c,oldIndex:-1,newIndex:i++}})}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const c=new th(s._firestore,s._userDataWriter,o.doc.key,o.doc,new sd(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return o.type!==0&&(u=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),d=i.indexOf(o.doc.key)),{type:CM(o.type),doc:c,oldIndex:u,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Lt(Ze.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Xc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=hv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],s=[];return this.docs.forEach(a=>{a._document!==null&&(r.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function CM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return qt(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Of(t){t=bi(t,Tn);const e=bi(t.firestore,mu);return mM(Mv(e),t._key).then(r=>bA(e,t,r))}Xc._jsonSchemaVersion="firestore/querySnapshot/1.0",Xc._jsonSchema={type:En("string",Xc._jsonSchemaVersion),bundleSource:En("string","QuerySnapshot"),bundleName:En("string"),bundle:En("string")};class yA extends AM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ea(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Tn(this.firestore,null,r)}}function zv(t,e,r){t=bi(t,Tn);const n=bi(t.firestore,mu),s=IM(t.converter,e,r);return wA(n,[bM(hA(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,Si.none())])}function NM(t,e,r,...n){t=bi(t,Tn);const s=bi(t.firestore,mu),a=hA(s);let i;return i=typeof(e=hn(e))=="string"||e instanceof Ym?SM(a,"updateDoc",t._key,e,r,n):_M(a,"updateDoc",t._key,e),wA(s,[i.toMutation(t._key,Si.exists(!0))])}function RM(t,...e){var c,u,d;t=hn(t);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||Cb(e[n])||(r=e[n++]);const s={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(Cb(e[n])){const h=e[n];e[n]=(c=h.next)==null?void 0:c.bind(h),e[n+1]=(u=h.error)==null?void 0:u.bind(h),e[n+2]=(d=h.complete)==null?void 0:d.bind(h)}let a,i,o;if(t instanceof Tn)i=bi(t.firestore,mu),o=Vm(t._key.path),a={next:h=>{e[n]&&e[n](bA(i,t,h))},error:e[n+1],complete:e[n+2]};else{const h=bi(t,Xm);i=bi(h.firestore,mu),o=h._query;const m=new yA(i);a={next:p=>{e[n]&&e[n](new Xc(i,m,h,p))},error:e[n+1],complete:e[n+2]},kM(t._query)}return function(m,p,y,v){const b=new oA(v),E=new Jk(p,b,y);return m.asyncQueue.enqueueAndForget(async()=>Xk(await Mx(m),E)),()=>{b.Nu(),m.asyncQueue.enqueueAndForget(async()=>Yk(await Mx(m),E))}}(Mv(i),o,s,a)}function wA(t,e){return function(n,s){const a=new Bo;return n.asyncQueue.enqueueAndForget(async()=>rM(await hM(n),s,a)),a.promise}(Mv(t),e)}function bA(t,e,r){const n=r.docs.get(e._key),s=new yA(t);return new Nl(t,s,e._key,n,new sd(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(s){_u=s})(Zl),ti(new Ca("firestore",(n,{instanceIdentifier:s,options:a})=>{const i=n.getProvider("app").getImmediate(),o=new mu(new b8(n.getProvider("auth-internal")),new E8(i,n.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Lt(Ze.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new af(u.options.projectId,d)}(i,s),i);return a={useFetchStreams:r,...a},o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),ea(F2,L2,e),ea(F2,L2,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _A="firebasestorage.googleapis.com",PM="storageBucket",jM=2*60*1e3,DM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri extends Ra{constructor(e,r,n=0){super(rg(e),`Firebase Storage: ${r} (${rg(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ri.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return rg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ci;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ci||(Ci={}));function rg(t){return"storage/"+t}function FM(){const t="An unknown error occurred, please check the error payload for server response.";return new Ri(Ci.UNKNOWN,t)}function LM(){return new Ri(Ci.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function OM(){return new Ri(Ci.CANCELED,"User canceled the upload/download.")}function MM(t){return new Ri(Ci.INVALID_URL,"Invalid URL '"+t+"'.")}function $M(t){return new Ri(Ci.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Nb(t){return new Ri(Ci.INVALID_ARGUMENT,t)}function SA(){return new Ri(Ci.APP_DELETED,"The Firebase app was deleted.")}function UM(t){return new Ri(Ci.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Ka.makeFromUrl(e,r)}catch{return new Ka(e,"")}if(n.path==="")return n;throw $M(e)}static makeFromUrl(e,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function a(B){B.path.charAt(B.path.length-1)==="/"&&(B.path_=B.path_.slice(0,-1))}const i="(/(.*))?$",o=new RegExp("^gs://"+s+i,"i"),c={bucket:1,path:3};function u(B){B.path_=decodeURIComponent(B.path)}const d="v[A-Za-z0-9_]+",h=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${d}/b/${s}/o${m}`,"i"),y={bucket:1,path:3},v=r===_A?"(?:storage.googleapis.com|storage.cloud.google.com)":r,b="([^?#]*)",E=new RegExp(`^https?://${v}/${s}/${b}`,"i"),w=[{regex:o,indices:c,postModify:a},{regex:p,indices:y,postModify:u},{regex:E,indices:{bucket:1,path:2},postModify:u}];for(let B=0;B<w.length;B++){const J=w[B],Z=J.regex.exec(e);if(Z){const _=Z[J.indices.bucket];let I=Z[J.indices.path];I||(I=""),n=new Ka(_,I),J.postModify(n);break}}if(n==null)throw MM(e);return n}}class VM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BM(t,e,r){let n=1,s=null,a=null,i=!1,o=0;function c(){return o===2}let u=!1;function d(...b){u||(u=!0,e.apply(null,b))}function h(b){s=setTimeout(()=>{s=null,t(p,c())},b)}function m(){a&&clearTimeout(a)}function p(b,...E){if(u){m();return}if(b){m(),d.call(null,b,...E);return}if(c()||i){m(),d.call(null,b,...E);return}n<64&&(n*=2);let w;o===1?(o=2,w=0):w=(n+Math.random())*1e3,h(w)}let y=!1;function v(b){y||(y=!0,m(),!u&&(s!==null?(b||(o=2),clearTimeout(s),h(0)):b||(o=1)))}return h(0),a=setTimeout(()=>{i=!0,v(!0)},r),v}function zM(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WM(t){return t!==void 0}function Rb(t,e,r,n){if(n<e)throw Nb(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw Nb(`Invalid value for '${t}'. Expected ${r} or less.`)}function HM(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const s=e(n)+"="+e(t[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var Qh;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Qh||(Qh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GM(t,e){const r=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,a=e.indexOf(t)!==-1;return r||s||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qM{constructor(e,r,n,s,a,i,o,c,u,d,h,m=!0,p=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=a,this.additionalRetryCodes_=i,this.callback_=o,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=h,this.retry=m,this.isUsingEmulator=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,v)=>{this.resolve_=y,this.reject_=v,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new w0(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const i=o=>{const c=o.loaded,u=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&a.addUploadProgressListener(i),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(i),this.pendingConnection_=null;const o=a.getErrorCode()===Qh.NO_ERROR,c=a.getStatus();if(!o||GM(c,this.additionalRetryCodes_)&&this.retry){const d=a.getErrorCode()===Qh.ABORT;n(!1,new w0(!1,null,d));return}const u=this.successCodes_.indexOf(c)!==-1;n(!0,new w0(u,a))})},r=(n,s)=>{const a=this.resolve_,i=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(o,o.getResponse());WM(c)?a(c):a()}catch(c){i(c)}else if(o!==null){const c=FM();c.serverResponse=o.getErrorText(),this.errorCallback_?i(this.errorCallback_(o,c)):i(c)}else if(s.canceled){const c=this.appDelete_?SA():OM();i(c)}else{const c=LM();i(c)}};this.canceled_?r(!1,new w0(!1,null,!0)):this.backoffId_=BM(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&zM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class w0{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function KM(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function QM(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function XM(t,e){e&&(t["X-Firebase-GMPID"]=e)}function YM(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function JM(t,e,r,n,s,a,i=!0,o=!1){const c=HM(t.urlParams),u=t.url+c,d=Object.assign({},t.headers);return XM(d,e),KM(d,r),QM(d,a),YM(d,n),new qM(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZM(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function e7(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e,r){this._service=e,r instanceof Ka?this._location=r:this._location=Ka.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Xh(e,r)}get root(){const e=new Ka(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return e7(this._location.path)}get storage(){return this._service}get parent(){const e=ZM(this._location.path);if(e===null)return null;const r=new Ka(this._location.bucket,e);return new Xh(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw UM(e)}}function Pb(t,e){const r=e==null?void 0:e[PM];return r==null?null:Ka.makeFromBucketSpec(r,t)}function t7(t,e,r,n={}){t.host=`${e}:${r}`;const s=Yl(e);s&&(Q1(`https://${t.host}/b`),X1("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:a}=n;a&&(t._overrideAuthToken=typeof a=="string"?a:jT(a,t.app.options.projectId))}class r7{constructor(e,r,n,s,a,i=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=a,this._isUsingEmulator=i,this._bucket=null,this._host=_A,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=jM,this._maxUploadRetryTime=DM,this._requests=new Set,s!=null?this._bucket=Ka.makeFromBucketSpec(s,this._host):this._bucket=Pb(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ka.makeFromBucketSpec(this._url,e):this._bucket=Pb(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Rb("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Rb("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(oa(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xh(this,e)}_makeRequest(e,r,n,s,a=!0){if(this._deleted)return new VM(SA());{const i=JM(e,this._appId,n,s,r,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(e,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,s).getPromise()}}const jb="@firebase/storage",Db="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EA="storage";function n7(t=Rm(),e){t=hn(t);const n=sl(t,EA).getImmediate({identifier:e}),s=NT("storage");return s&&s7(n,...s),n}function s7(t,e,r,n={}){t7(t,e,r,n)}function a7(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new r7(r,n,s,e,Zl)}function i7(){ti(new Ca(EA,a7,"PUBLIC").setMultipleInstances(!0)),ea(jb,Db,""),ea(jb,Db,"esm2020")}i7();const o7={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:"http://localhost:5000/api",VITE_CSRF_TOKEN:"super-strong-secret-change-me",VITE_FIREBASE_API_KEY:"AIzaSyD-n0r_yIMMBfTsa2kahr5_xV1iLNvUgHY",VITE_FIREBASE_APP_ID:"1:825538308202:web:5a84a9f2b4f2169b9f0213",VITE_FIREBASE_AUTH_DOMAIN:"studitrack-54f69.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-3NHL0FSD9D",VITE_FIREBASE_MESSAGING_SENDER_ID:"825538308202",VITE_FIREBASE_PROJECT_ID:"studitrack-54f69",VITE_FIREBASE_STORAGE_BUCKET:"studitrack-54f69.firebasestorage.app"},l7={apiKey:"AIzaSyD-n0r_yIMMBfTsa2kahr5_xV1iLNvUgHY",authDomain:"studitrack-54f69.firebaseapp.com",projectId:"studitrack-54f69",storageBucket:"studitrack-54f69.firebasestorage.app",messagingSenderId:"825538308202",appId:"1:825538308202:web:5a84a9f2b4f2169b9f0213",measurementId:"G-3NHL0FSD9D"},c7=["VITE_FIREBASE_API_KEY","VITE_FIREBASE_AUTH_DOMAIN","VITE_FIREBASE_PROJECT_ID","VITE_FIREBASE_STORAGE_BUCKET","VITE_FIREBASE_MESSAGING_SENDER_ID","VITE_FIREBASE_APP_ID"],Fb=c7.filter(t=>!o7[t]);Fb.length>0&&(console.error(" Missing Firebase environment variables:",Fb.join(", ")),console.error(" Please check your .env file in react-app/ directory"));let ku;try{ku=UT(l7),console.log(" Firebase initialized successfully")}catch(t){throw console.error(" Firebase initialization failed:",t),t}let Ux=null;try{typeof window<"u"&&(Ux=X6(ku))}catch{Ux=null}const Zn=x8(ku),ll=gM(ku);n7(ku);async function TA(t,e){return tF(Zn,t,e)}async function kA(t,e){return rF(Zn,t,e)}async function Vx(){return iF(Zn)}async function AA(t){return eF(Zn,t)}function ep(t){return aF(Zn,t)}async function Yh(t,e){const r=rc(ll,"users",t);return await zv(r,{...e,updatedAt:new Date().toISOString()},{merge:!0}),(await Of(r)).data()}async function IA(t){const e=rc(ll,"users",t),r=await Of(e);return r.exists()?r.data():null}const u7=Object.freeze(Object.defineProperty({__proto__:null,get analytics(){return Ux},get app(){return ku},auth:Zn,db:ll,getUserProfile:IA,onAuthStateChanged:ep,registerWithEmail:TA,resetPassword:AA,saveUserProfile:Yh,signIn:kA,signOutUser:Vx},Symbol.toStringTag,{value:"Module"})),d7="modulepreload",f7=function(t){return"/"+t},Lb={},h7=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=f7(c),c in Lb)return;Lb[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":d7,u||(h.as="script"),h.crossOrigin="",h.href=c,o&&h.setAttribute("nonce",o),document.head.appendChild(h),u)return new Promise((m,p)=>{h.addEventListener("load",m),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})},b0="http://localhost:5000/api",Ob="super-strong-secret-change-me";async function m7(){try{const{auth:t}=await h7(async()=>{const{auth:r}=await Promise.resolve().then(()=>u7);return{auth:r}},void 0),e=t.currentUser;if(!e)throw new Error("No authenticated user");return await e.getIdToken()}catch(t){throw console.error("Error getting auth token:",t),t}}async function tp(t,e={}){try{let r=null;try{r=await m7()}catch{console.warn("No auth token available, proceeding without Authorization header")}const n={"Content-Type":"application/json",...e.headers};r&&(n.Authorization=`Bearer ${r}`),Ob&&(n["x-csrf-token"]=Ob);const s=await fetch(`${b0}${t}`,{...e,headers:n});if(!s.ok){const a=await s.json().catch(()=>({error:"Unknown error"}));let i=a.error||a.message||`HTTP ${s.status}`;if(a.errors&&Array.isArray(a.errors)){const o=a.errors.map(c=>`${c.param||c.field}: ${c.msg||c.message}`).join(", ");o&&(i+=` (${o})`)}throw s.status===500?new Error(`Server error (500): ${i}. Please check the backend logs.`):s.status===403?new Error(`Access denied (403): ${i}`):s.status===401?new Error(`Authentication failed (401): ${i}`):s.status===400?new Error(`Bad request (400): ${i}`):new Error(i)}return s.json()}catch(r){if(r.message==="Failed to fetch"||r.name==="TypeError"||r.message.includes("fetch")){const n=`${b0}${t}`;throw console.error(" Network error connecting to:",n),console.error(" Error details:",{message:r.message,name:r.name,stack:r.stack,apiBaseUrl:b0,endpoint:t,fullUrl:n}),new Error(`Cannot connect to server at ${n}. Please ensure the backend server is running on ${b0.replace("/api","")}`)}throw r}}async function p7(t){return tp(t,{method:"GET"})}async function g7(t,e){return tp(t,{method:"POST",body:JSON.stringify(e)})}async function x7(t,e){return tp(t,{method:"PUT",body:JSON.stringify(e)})}async function v7(t){return tp(t,{method:"DELETE"})}const Tr={get:p7,post:g7,put:x7,delete:v7};async function CA(t){try{return await Tr.get(`/professors/firebase/${t}`)}catch(e){if(e.message.includes("404")||e.message.includes("not found"))return null;throw e}}async function y7(t){return Tr.post("/professors",{firebase_uid:t.firebase_uid||t.uid,name:t.name,email:t.email,department:t.department,photoUrl:t.photoUrl||t.photo_url||t.photoURL||null})}async function w7(t,e){return Tr.put(`/professors/${t}`,{name:e.name,email:e.email,department:e.department,photoUrl:e.photoUrl||e.photo_url||e.photoURL||null})}async function b7(t,e){let r=await CA(t).catch(()=>null);return r?w7(r.id,{...e}):y7({...e,firebase_uid:t})}async function Yc(t,e){const r=await b7(t,e);return r?{...r,role:"Professor"}:null}async function Yn(t){const e=await CA(t);return e?{...e,role:"Professor"}:null}async function NA(t){try{return await Tr.get(`/students/firebase/${t}`)}catch(e){if(e.message.includes("404")||e.message.includes("not found"))return null;throw e}}async function _7(t){try{return await Tr.get(`/students/email/${encodeURIComponent(t)}`)}catch(e){if(e.message.includes("404")||e.message.includes("not found"))return null;throw e}}async function S7(t){try{return await Tr.get(`/students/student-id/${t}`)}catch(e){if(e.message.includes("404")||e.message.includes("not found"))return null;throw e}}async function RA(t){return Tr.post("/students",{firebase_uid:t.firebase_uid||t.uid,name:t.name,email:t.email,studentId:t.studentId||t.student_id,department:t.department,photoUrl:t.photoUrl||t.photo_url})}async function PA(t,e){return Tr.put(`/students/${t}`,{firebase_uid:e.firebase_uid||e.firebaseUid,name:e.name,email:e.email,studentId:e.studentId||e.student_id,department:e.department,photoUrl:e.photoUrl||e.photo_url})}async function E7(t={}){const e=new URLSearchParams;t.department&&e.append("department",t.department);const r=e.toString()?`/students?${e.toString()}`:"/students";return Tr.get(r)}async function T7(t,e){let r=await NA(t).catch(()=>null);if(r){if(!r.id||isNaN(r.id))throw new Error("Invalid student ID. Please refresh the page and try again.");const n={name:e.name,email:e.email,studentId:e.studentId||e.student_id,department:e.department,photoUrl:e.photoURL||e.photoUrl||e.photo_url};return Object.keys(n).forEach(s=>{n[s]===void 0&&delete n[s]}),PA(r.id,n)}else return RA({...e,firebase_uid:t})}async function Mb(t){try{const e=await RA(t);if(!e||!e.id)throw console.error(" addStudent: Invalid response from API:",e),new Error("Failed to create student: Invalid response from server");return e.id}catch(e){throw console.error(" addStudent error:",e),e}}async function Rl(t,e){const r=await T7(t,e);return r?{...r,role:"Student",studentId:r.student_id||r.studentId,photoURL:r.photo_url||r.photoURL}:null}async function El(t){const e=await NA(t);return e?{...e,role:"Student",studentId:e.student_id||e.studentId,photoURL:e.photo_url||e.photoURL}:null}async function Oc(t){const e=await _7(t);return e?{...e,role:"Student",studentId:e.student_id||e.studentId,photoURL:e.photo_url||e.photoURL}:null}async function ms(t){if(!t||!/^\d+$/.test(t))return null;const e=await S7(t);return e?{...e,role:"Student",studentId:e.student_id||e.studentId,photoURL:e.photo_url||e.photoURL}:null}async function $b(t={}){return(await E7(t)).map(r=>({...r,role:"Student",studentId:r.student_id||r.studentId,photoURL:r.photo_url||r.photoURL}))}async function Ub(t,e){let r=t;if(t&&typeof t!="number"&&!/^\d+$/.test(String(t))){const s=await El(t);if(!s)return null;r=s.id}const n=await PA(r,e);return n?{...n,role:"Student",studentId:n.student_id||n.studentId,photoURL:n.photo_url||n.photoURL}:null}function k7(t,e){const n=(m=>{if(!m||!m.trim())return"U";const p=m.trim().split(/\s+/).filter(Boolean);return p.length===0?"U":p.length===1?p[0][0].toUpperCase():(p[0][0]+p[p.length-1][0]).toUpperCase().slice(0,2)})(t),s=e.split("").reduce((m,p)=>(m<<5)-m+p.charCodeAt(0),0),a=Math.abs(s)%360,i=60+Math.abs(s)%20,o=45+Math.abs(s)%15,c=`hsl(${a}, ${i}%, ${o}%)`,u=o<50?"#FFFFFF":"#1F2937",d=document.createElement("canvas");d.width=200,d.height=200;const h=d.getContext("2d");return h.fillStyle=c,h.beginPath(),h.arc(100,100,100,0,2*Math.PI),h.fill(),h.fillStyle=u,h.font="bold 80px Arial, sans-serif",h.textAlign="center",h.textBaseline="middle",h.fillText(n,100,100),d.toDataURL("image/png")}function Td(t,e){return k7(t,e)}const Xn={PASSWORD_MIN_LENGTH:6,PASSWORD_STRENGTH_MIN_LENGTH:8,STUDENT_EMAIL_REGEX:/^[a-z]+(\.[a-z]+)+\.\d+\.tc@umindanao\.edu\.ph$/i,PROFESSOR_EMAIL_REGEX:/^[a-z0-9]+@umindanao\.edu\.ph$/i,USER_TYPES:{PROFESSOR:"Professor",STUDENT:"Student"},DEPARTMENTS:["Department of Computing Education","Department of Engineering Education"]};function A7(){const t=Am(),{isDarkMode:e}=Im(),[r,n]=G.useState("professor"),[s,a]=G.useState(!1),[i,o]=G.useState(!1),[c,u]=G.useState({}),[d,h]=G.useState({professor:"",student:""}),[m,p]=G.useState({professor:"",student:""}),[y,v]=G.useState({email:"",password:""}),[b,E]=G.useState({email:"",password:""}),[T,w]=G.useState({name:"",email:"",department:"",password:"",confirmPassword:""}),[B,J]=G.useState({name:"",studentId:"",email:"",department:"",password:"",confirmPassword:""}),[Z,_]=G.useState(!1),[I,C]=G.useState(!1),[L,F]=G.useState(""),[V,O]=G.useState(""),[ct,me]=G.useState(""),[ft,rt]=G.useState(!1),[ze,ie]=G.useState(!1),[Ye,_e]=G.useState("");G.useEffect(()=>{localStorage.getItem("react_rememberMe")==="true"&&_(!0)},[]),G.useEffect(()=>{const ge=ep(we=>{if(we){const et=sessionStorage.getItem("currentUser");if(et)try{const ht=JSON.parse(et);ht.type==="Professor"?t("/prof",{replace:!0}):ht.type==="Student"&&t("/student",{replace:!0})}catch(ht){console.warn("Failed to parse current user",ht)}}}),W=we=>{const et=sessionStorage.getItem("currentUser");if(et)try{const ht=JSON.parse(et);window.location.pathname==="/login"&&(we.preventDefault(),window.history.pushState(null,"",window.location.pathname),ht.type==="Professor"?t("/prof",{replace:!0}):ht.type==="Student"&&t("/student",{replace:!0}))}catch(ht){console.warn("Failed to parse current user in popstate",ht)}};return window.addEventListener("popstate",W),window.history.pushState(null,"",window.location.pathname),()=>{ge(),window.removeEventListener("popstate",W)}},[t]);const Q=(ge,W=!1)=>{if(!ge)return!1;const we=ge.trim();return W?Xn.STUDENT_EMAIL_REGEX.test(we):Xn.PROFESSOR_EMAIL_REGEX.test(we)},ae=ge=>ge.length<Xn.PASSWORD_STRENGTH_MIN_LENGTH?!1:/[A-Z]/.test(ge)&&/[a-z]/.test(ge)&&/\d/.test(ge)&&/[^A-Za-z0-9]/.test(ge),le=ge=>{let W=0;return ge.length>=Xn.PASSWORD_STRENGTH_MIN_LENGTH&&W++,/[a-z]/.test(ge)&&W++,/[A-Z]/.test(ge)&&W++,/[0-9]/.test(ge)&&W++,/[^A-Za-z0-9]/.test(ge)&&W++,["weak","weak","fair","good","strong"][W-1]||"weak"},ne=(ge,W)=>{let we="";ge.length>0&&ge.length<Xn.PASSWORD_STRENGTH_MIN_LENGTH&&(we=`Password must be at least ${Xn.PASSWORD_STRENGTH_MIN_LENGTH} characters long`),W==="professor"?(w(et=>({...et,password:ge})),h(et=>({...et,professor:le(ge)})),p(et=>({...et,professor:we}))):(J(et=>({...et,password:ge})),h(et=>({...et,student:le(ge)})),p(et=>({...et,student:we})))},Ae=ge=>{u(W=>({...W,[ge]:!W[ge]}))},st=ge=>{sessionStorage.setItem("currentUser",JSON.stringify(ge))},ot=async ge=>{ge.preventDefault(),O(""),me("");const W=r==="professor",we=W?y:b;if(!we.email||!we.password){O("Please fill in all fields");return}const et=we.email.trim();if(!et||!et.includes("@")||et.length<5){O("Please enter a valid email address");return}Q(et,!W)||console.warn(` Email format doesn't match expected ${W?"professor":"student"} pattern, but attempting login anyway:`,et);try{rt(!0),O(""),me("");const ht=we.password.trim();console.log(" Attempting login:",{email:et,emailLength:et.length,passwordLength:ht.length,userType:W?"professor":"student"});const Qe=await kA(et,ht),{user:qe}=Qe,Ft=W?Yn(qe.uid):El(qe.uid),Mt=qe.displayName||we.email.split("@")[0];let Ot=null;try{Ot=await Ft}catch(lr){console.warn("Unable to load profile from Firestore",lr)}if(Ot){if(!Ot.photoURL){const lr=Td(Ot.name||Mt,qe.uid);Ot.photoURL=lr,(W?Yc(qe.uid,{...Ot,photoURL:lr}):Rl(qe.uid,{...Ot,photoURL:lr})).catch(Rr=>console.warn("Background avatar update failed",Rr))}}else{const lr=Td(Mt,qe.uid);Ot={name:Mt,email:qe.email,role:Xn.USER_TYPES[W?"PROFESSOR":"STUDENT"],...W?{department:"",photoURL:lr}:{studentId:"",department:"",photoURL:lr}},(W?Yc(qe.uid,Ot):Rl(qe.uid,Ot)).catch(Rr=>console.warn("Background profile save failed",Rr))}const er=(Ot==null?void 0:Ot.name)||Mt,jt={uid:qe.uid,type:Xn.USER_TYPES[W?"PROFESSOR":"STUDENT"],email:qe.email,name:er,...W?{department:(Ot==null?void 0:Ot.department)||""}:{studentId:(Ot==null?void 0:Ot.studentId)||"",department:(Ot==null?void 0:Ot.department)||""}};Yh(qe.uid,Ot).catch(lr=>console.warn("Background user profile save failed",lr)),st(jt),t(W?"/prof":"/student",{replace:!0})}catch(ht){console.error("Login error:",ht),console.error("Error code:",ht.code),console.error("Error message:",ht.message),console.error("Login attempt with email:",et,"userType:",W?"professor":"student");let Qe="Unable to sign in. Please try again.",qe=!1;switch(ht.code){case"auth/user-not-found":Qe='Account not found. Please create an account first using the "Sign Up" button.',a(!0);break;case"auth/wrong-password":Qe='Incorrect password. Click "Forgot Password?" below to reset your password.',qe=!0;break;case"auth/invalid-credential":case"auth/invalid-email":Qe=`Invalid email or password. This could mean:

 The account doesn't exist in Firebase Auth (only in database)
 The password is incorrect
 The account needs to be created through Sign Up

Click "Forgot Password?" to reset your password or create a new account using "Sign Up".`,qe=!0,console.warn(" Login failed - possible causes:",{email:et,emailFormatValid:et.includes("@"),passwordProvided:trimmedPassword.length>0,errorCode:ht.code,suggestion:`If this account exists in MySQL but not in Firebase Auth, you need to either:
1. Use "Forgot Password?" to create/reset the Firebase Auth account
2. Create a new account through Sign Up
3. Contact support to migrate the account`});break;case"auth/too-many-requests":Qe="Too many login attempts. Please wait a few minutes and try again.";break;case"auth/network-request-failed":Qe="Network error. Please check your internet connection and try again.";break;case"auth/user-disabled":Qe="This account has been disabled. Please contact support.";break;default:ht.message&&ht.message.includes("Failed to fetch")?Qe="Cannot connect to server. Please ensure the backend server is running on http://localhost:5000":ht.message&&(Qe=ht.message);break}O(Qe),qe&&(ht.code==="auth/invalid-credential"||ht.code==="auth/wrong-password")&&setTimeout(()=>{const Ft=r==="professor";ie(!0),_e(Ft?y.email:b.email)},500)}finally{rt(!1)}},Ne=async ge=>{if(ge.preventDefault(),O(""),me(""),!Ye){O("Please enter your email address");return}const W=r==="professor";if(!Q(Ye,!W)){O(`Please enter a valid ${Xn.USER_TYPES[W?"PROFESSOR":"STUDENT"]} email address`);return}try{rt(!0),await AA(Ye.trim()),me(`Password reset email sent to ${Ye}. Please check your inbox and follow the instructions to reset your password.`),ie(!1),_e("")}catch(we){console.error("Password reset error",we);let et="Failed to send password reset email. Please try again.";switch(we.code){case"auth/user-not-found":et="No account found with this email address. Please create an account first.";break;case"auth/invalid-email":et="Invalid email address. Please check and try again.";break;case"auth/too-many-requests":et="Too many password reset attempts. Please wait a few minutes and try again.";break;default:et=we.message||et}O(et)}finally{rt(!1)}},Ve=async ge=>{if(ge.preventDefault(),O(""),me(""),p({professor:"",student:""}),!I){F(" You must accept the Terms and Conditions to create your account.");return}F("");const W=r==="professor",we=W?T:B;if(!we.name||!we.email||!we.password||!we.confirmPassword){O("Please fill in all required fields");return}if(W&&!we.department){O("Please select a department");return}if(!W&&!we.studentId){O("Please enter your Student ID");return}if(!W&&!/^\d+$/.test(we.studentId)){O("Student ID must be numerical only");return}if(!Q(we.email,!W)){O(`Invalid ${W?"professor":"student"} email format`);return}if(we.password.length<Xn.PASSWORD_STRENGTH_MIN_LENGTH){O(`Password must be at least ${Xn.PASSWORD_STRENGTH_MIN_LENGTH} characters long`),p(W?et=>({...et,professor:`Password must be at least ${Xn.PASSWORD_STRENGTH_MIN_LENGTH} characters long`}):et=>({...et,student:`Password must be at least ${Xn.PASSWORD_STRENGTH_MIN_LENGTH} characters long`}));return}if(!ae(we.password)){O("Password must contain uppercase, lowercase, numbers, and symbols");return}if(we.password!==we.confirmPassword){O("Passwords do not match");return}try{rt(!0),O(""),me("");const et=await TA(we.email.trim(),we.password),{user:ht}=et,Qe=Td(we.name,ht.uid),qe=W?{name:we.name,email:we.email.trim(),department:we.department,role:Xn.USER_TYPES.PROFESSOR,photoURL:Qe}:{name:we.name,email:we.email.trim(),studentId:we.studentId,department:we.department,role:Xn.USER_TYPES.STUDENT,photoURL:Qe};try{if(W){const Ft=await Yc(ht.uid,qe);if(!Ft)throw new Error("Failed to create professor profile in database");console.log(" Professor profile created:",{name:Ft.name,email:Ft.email})}else{const Ft=await Rl(ht.uid,qe);if(!Ft)throw new Error("Failed to create student profile in database");console.log(" Student profile created:",{name:Ft.name,email:Ft.email})}}catch(Ft){console.error("Database error during registration:",Ft);try{await Vx(),await ht.delete()}catch(Mt){console.error("Failed to cleanup Firebase user:",Mt)}throw Ft.message&&(Ft.message.includes("Network")||Ft.message.includes("Failed to fetch"))?new Error("Cannot connect to server. Please ensure the backend server is running on http://localhost:5000"):Ft.message&&Ft.message.includes("500")?new Error("Server error. Please try again later or contact support."):new Error(Ft.message||"Failed to create profile in database. Please try again.")}try{await Yh(ht.uid,qe)}catch(Ft){console.warn("Failed to save to Firestore (non-critical):",Ft)}try{await Vx()}catch(Ft){console.warn("Sign out error (non-critical):",Ft)}sessionStorage.removeItem("currentUser"),W?w({name:"",email:"",department:"",password:"",confirmPassword:""}):J({name:"",studentId:"",email:"",department:"",password:"",confirmPassword:""}),v({email:"",password:""}),E({email:"",password:""}),rt(!1),a(!1),C(!1),O(""),F(""),me(" Account created successfully. Please sign in with your email and password to access your dashboard.")}catch(et){console.error("Sign up error",et);let ht="Unable to create account. Please try again.";et.code==="auth/email-already-in-use"?ht="An account with this email already exists. Please sign in instead.":et.code==="auth/invalid-email"?ht="Invalid email address.":et.code==="auth/weak-password"?ht="Password is too weak. Please choose a stronger password.":et.code==="auth/network-request-failed"?ht="Network error. Please check your connection and try again.":et.message&&(et.message.includes("Network")||et.message.includes("Failed to fetch"))?ht="Cannot connect to server. Please ensure the backend server is running on http://localhost:5000":et.message&&et.message.includes("500")?ht="Server error. Please try again later or contact support.":et.message&&et.message.includes("400")?ht=et.message||"Invalid data provided. Please check your information.":et.message&&(ht=et.message),O(ht)}finally{rt(!1)}};return new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),l.jsxs("div",{className:"application-background min-h-screen relative",children:[l.jsx("img",{src:"/assets/logos/um logo.png",alt:"UM Logo",className:"background-logo-decoration w-96 h-auto"}),l.jsx("nav",{className:"application-header fixed top-0 w-full bg-white/90 backdrop-blur-md shadow-md z-20",children:l.jsx("div",{className:"header-content-container max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsx("div",{className:"header-navigation-content flex justify-between items-center h-16",children:l.jsxs("div",{className:"university-branding-section flex items-center space-x-3",children:[l.jsx("img",{src:"/assets/logos/um logo.png",alt:"UM Logo",className:"university-logo-image h-12 w-auto"}),l.jsxs("div",{children:[l.jsx("h1",{className:"application-title text-xl font-bold leading-tight navigation-text text-[#7A1315]",children:"Student iTrack"}),l.jsx("p",{className:"university-info-text text-sm navigation-text",children:"University of Mindanao Tagum College - Visayan Campus"})]})]})})})}),l.jsx("div",{className:"authentication-container relative z-10",children:l.jsxs("div",{className:"authentication-card max-w-md w-full space-y-8 p-8",children:[l.jsxs("div",{className:"authentication-header text-center",children:[l.jsx("div",{className:"authentication-logo mx-auto w-24 h-24 flex items-center justify-center mb-6",children:l.jsx("img",{src:"/assets/logos/um logo.png",alt:"UM Logo",className:"authentication-logo-image w-24 h-auto"})}),l.jsx("h2",{className:"welcome-title text-[1.75rem] sm:text-[1.75rem] font-bold text-[#7A1315] mb-3 text-center whitespace-nowrap",children:"Welcome to Student iTrack"}),l.jsx("p",{className:"system-subtitle text-gray-800 text-sm mb-6 text-center",children:"Smart Academic Monitoring System"})]}),l.jsxs("div",{className:"user-type-selection mb-6",children:[l.jsx("label",{className:`selection-label block text-sm font-medium mb-3 ${e?"text-white":"text-gray-800"}`,children:"Login As"}),l.jsxs("div",{className:"selection-buttons-container flex space-x-4 w-full",children:[l.jsx("button",{onClick:()=>n("professor"),className:`user-type-button flex-1 primary-action-button ${r==="professor"?"primary-filled-button":"primary-outline-button"}`,children:"Professor"}),l.jsx("button",{onClick:()=>n("student"),className:`user-type-button flex-1 primary-action-button ${r==="student"?"primary-filled-button":"primary-outline-button"}`,children:"Student"})]})]}),ct&&l.jsx("div",{className:"auth-success-message",children:ct}),V&&l.jsx("div",{className:"auth-error-message",children:V}),!s&&l.jsx("div",{className:"auth-form-section",children:l.jsxs("form",{onSubmit:ot,className:"authentication-form space-y-6 w-full",children:[r==="professor"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"form-field-group",children:[l.jsx("label",{className:`form-label block text-sm font-medium ${e?"text-white":"text-gray-800"}`,children:"Email"}),l.jsx("input",{type:"email",autoComplete:"off",name:"professor-login-email",value:y.email,onChange:ge=>v(W=>({...W,email:ge.target.value})),className:`form-input-field professor-field w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] ${e?"bg-[#2c2c2c] text-white border-slate-600":"bg-white text-gray-800 border-slate-300"}`,placeholder:"Enter your institutional email"})]}),l.jsxs("div",{className:"form-field-group mt-4",children:[l.jsx("label",{className:`form-label block text-sm font-medium ${e?"text-white":"text-gray-800"}`,children:"Password"}),l.jsxs("div",{className:"password-input-container",children:[l.jsx("input",{type:c.professorLogin?"text":"password",autoComplete:"new-password",name:"professor-login-password",value:y.password,onChange:ge=>v(W=>({...W,password:ge.target.value})),className:`form-input-field professor-field w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] pr-10 ${e?"bg-[#2c2c2c] text-white border-slate-600":"bg-white text-gray-800 border-slate-300"}`,placeholder:"Enter password"}),l.jsxs("button",{type:"button",onClick:()=>Ae("professorLogin"),className:"password-toggle","aria-label":"Toggle password visibility",children:[l.jsxs("svg",{className:`eye-icon w-5 h-5 ${c.professorLogin?"hidden":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),l.jsx("svg",{className:`eye-off-icon w-5 h-5 ${c.professorLogin?"":"hidden"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})]})]})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"form-field-group",children:[l.jsx("label",{className:`form-label block text-sm font-medium ${e?"text-white":"text-gray-800"}`,children:"Student Email"}),l.jsx("input",{type:"email",autoComplete:"off",name:"student-login-email",value:b.email,onChange:ge=>E(W=>({...W,email:ge.target.value})),className:`form-input-field student-field w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] ${e?"bg-[#2c2c2c] text-white border-slate-600":"bg-white text-gray-800 border-slate-300"}`,placeholder:"Enter your institutional email"})]}),l.jsxs("div",{className:"form-field-group mt-4",children:[l.jsx("label",{className:`form-label block text-sm font-medium ${e?"text-white":"text-gray-800"}`,children:"Password"}),l.jsxs("div",{className:"password-input-container",children:[l.jsx("input",{type:c.studentLogin?"text":"password",autoComplete:"new-password",name:"student-login-password",value:b.password,onChange:ge=>E(W=>({...W,password:ge.target.value})),className:`form-input-field student-field w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] pr-10 ${e?"bg-[#2c2c2c] text-white border-slate-600":"bg-white text-gray-800 border-slate-300"}`,placeholder:"Enter password"}),l.jsxs("button",{type:"button",onClick:()=>Ae("studentLogin"),className:"password-toggle","aria-label":"Toggle password visibility",children:[l.jsxs("svg",{className:`eye-icon w-5 h-5 ${c.studentLogin?"hidden":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),l.jsx("svg",{className:`eye-off-icon w-5 h-5 ${c.studentLogin?"":"hidden"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})]})]})]})]}),l.jsxs("div",{className:"form-options-container",children:[l.jsxs("label",{className:"remember-me-option",children:[l.jsx("input",{type:"checkbox",checked:Z,onChange:ge=>{_(ge.target.checked),localStorage.setItem("react_rememberMe",ge.target.checked?"true":"false")},className:"remember-me-checkbox h-4 w-4 text-[#7A1315] border-gray-300 rounded"}),l.jsx("span",{className:"remember-me-text text-sm",children:"Remember Me"})]}),l.jsx("a",{href:"#",onClick:ge=>{ge.preventDefault(),ie(!0),_e(isProfessor?y.email:b.email)},className:"password-recovery-link text-sm font-medium",children:"Forgot Password?"})]}),l.jsx("button",{type:"submit",disabled:ft,className:"authentication-submit-button w-full primary-action-button primary-filled-button",children:ft?"Please wait...":"Sign In"}),l.jsxs("div",{className:"auth-switch-link",children:["Don't have an account? ",l.jsx("a",{href:"#",onClick:ge=>{ge.preventDefault(),a(!0)},children:"Sign Up"})]})]})}),s&&l.jsx("div",{className:"auth-form-section",children:l.jsxs("form",{onSubmit:Ve,className:"registration-form space-y-6",children:[r==="professor"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"form-field-group",children:[l.jsx("label",{className:`form-label block text-sm font-medium ${e?"text-white":"text-gray-800"}`,children:"Full Name"}),l.jsx("input",{type:"text",autoComplete:"off",name:"professor-signup-name",value:T.name,onChange:ge=>w(W=>({...W,name:ge.target.value})),className:`form-input-field professor-field w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] ${e?"bg-[#2c2c2c] text-white border-slate-600":"bg-white text-gray-800 border-slate-300"}`,placeholder:"Enter your full name"})]}),l.jsxs("div",{className:"form-field-group mt-4",children:[l.jsx("label",{className:`form-label block text-sm font-medium ${e?"text-white":"text-gray-800"}`,children:"Email"}),l.jsx("input",{type:"email",autoComplete:"off",name:"professor-signup-email",value:T.email,onChange:ge=>w(W=>({...W,email:ge.target.value})),className:`form-input-field professor-field w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] ${e?"bg-[#2c2c2c] text-white border-slate-600":"bg-white text-gray-800 border-slate-300"}`,placeholder:"initials@umindanao.edu.ph"})]}),l.jsxs("div",{className:"form-field-group mt-4",children:[l.jsx("label",{className:`form-label block text-sm font-medium ${e?"text-white":"text-gray-800"}`,children:"Department"}),l.jsxs("select",{value:T.department,onChange:ge=>w(W=>({...W,department:ge.target.value})),className:`form-input-field form-select-field professor-field w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] ${e?"bg-[#2c2c2c] text-white border-slate-600":"bg-white text-gray-800 border-slate-300"}`,required:!0,children:[l.jsx("option",{value:"",children:"Select your department"}),Xn.DEPARTMENTS.map(ge=>l.jsx("option",{value:ge,children:ge},ge))]})]}),l.jsxs("div",{className:"form-field-group mt-4",children:[l.jsx("label",{className:`form-label block text-sm font-medium ${e?"text-white":"text-gray-800"}`,children:"Password"}),l.jsxs("div",{className:"password-input-container",children:[l.jsx("input",{type:c.professorSignUpPassword?"text":"password",autoComplete:"new-password",name:"professor-signup-password",value:T.password,onChange:ge=>ne(ge.target.value,"professor"),className:`form-input-field professor-field w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] pr-10 ${e?"bg-[#2c2c2c] text-white border-slate-600":"bg-white text-gray-800 border-slate-300"}`,placeholder:"Create a secure password"}),l.jsxs("button",{type:"button",onClick:()=>Ae("professorSignUpPassword"),className:"password-toggle","aria-label":"Toggle password visibility",children:[l.jsxs("svg",{className:`eye-icon w-5 h-5 ${c.professorSignUpPassword?"hidden":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),l.jsx("svg",{className:`eye-off-icon w-5 h-5 ${c.professorSignUpPassword?"":"hidden"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})]})]}),m.professor&&l.jsx("div",{className:`mt-2 p-2 rounded-lg text-sm ${e?"bg-red-900/30 border border-red-700 text-red-200":"bg-red-50 border border-red-200 text-red-700"}`,children:m.professor}),l.jsx("div",{className:`password-strength ${d.professor}`}),l.jsx("p",{className:`text-xs mt-1 ${e?"text-gray-400":"text-gray-500"}`,children:"Must be at least 8 characters with uppercase, lowercase, numbers, and symbols"})]}),l.jsxs("div",{className:"form-field-group mt-4",children:[l.jsx("label",{className:`form-label block text-sm font-medium ${e?"text-white":"text-gray-800"}`,children:"Confirm Password"}),l.jsxs("div",{className:"password-input-container",children:[l.jsx("input",{type:c.professorSignUpConfirmPassword?"text":"password",autoComplete:"new-password",name:"professor-signup-password-confirm",value:T.confirmPassword,onChange:ge=>w(W=>({...W,confirmPassword:ge.target.value})),className:`form-input-field professor-field w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] pr-10 ${e?"bg-[#2c2c2c] text-white border-slate-600":"bg-white text-gray-800 border-slate-300"}`,placeholder:"Confirm your password"}),l.jsxs("button",{type:"button",onClick:()=>Ae("professorSignUpConfirmPassword"),className:"password-toggle","aria-label":"Toggle password visibility",children:[l.jsxs("svg",{className:`eye-icon w-5 h-5 ${c.professorSignUpConfirmPassword?"hidden":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),l.jsx("svg",{className:`eye-off-icon w-5 h-5 ${c.professorSignUpConfirmPassword?"":"hidden"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})]})]})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"form-field-group",children:[l.jsx("label",{className:`form-label block text-sm font-medium ${e?"text-white":"text-gray-800"}`,children:"Full Name"}),l.jsx("input",{type:"text",autoComplete:"off",name:"student-signup-name",value:B.name,onChange:ge=>J(W=>({...W,name:ge.target.value})),className:`form-input-field student-field w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] ${e?"bg-[#2c2c2c] text-white border-slate-600":"bg-white text-gray-800 border-slate-300"}`,placeholder:"Enter your full name"})]}),l.jsxs("div",{className:"form-field-group mt-4",children:[l.jsx("label",{className:`form-label block text-sm font-medium ${e?"text-white":"text-gray-800"}`,children:"Student ID"}),l.jsx("input",{type:"text",autoComplete:"off",name:"student-signup-id",value:B.studentId,onChange:ge=>{const W=ge.target.value.replace(/\D/g,"");J(we=>({...we,studentId:W}))},className:`form-input-field student-field w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] ${e?"bg-[#2c2c2c] text-white border-slate-600":"bg-white text-gray-800 border-slate-300"}`,placeholder:"Enter your student ID",pattern:"[0-9]*",inputMode:"numeric"})]}),l.jsxs("div",{className:"form-field-group mt-4",children:[l.jsx("label",{className:`form-label block text-sm font-medium ${e?"text-white":"text-gray-800"}`,children:"Email"}),l.jsx("input",{type:"email",autoComplete:"off",name:"student-signup-email",value:B.email,onChange:ge=>J(W=>({...W,email:ge.target.value})),className:`form-input-field student-field w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] ${e?"bg-[#2c2c2c] text-white border-slate-600":"bg-white text-gray-800 border-slate-300"}`,placeholder:"initials@umindanao.edu.ph"})]}),l.jsxs("div",{className:"form-field-group mt-4",children:[l.jsx("label",{className:`form-label block text-sm font-medium ${e?"text-white":"text-gray-800"}`,children:"Department"}),l.jsxs("select",{value:B.department,onChange:ge=>J(W=>({...W,department:ge.target.value})),className:`form-input-field form-select-field student-field w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] ${e?"bg-[#2c2c2c] text-white border-slate-600":"bg-white text-gray-800 border-slate-300"}`,required:!0,children:[l.jsx("option",{value:"",children:"Select your department"}),Xn.DEPARTMENTS.map(ge=>l.jsx("option",{value:ge,children:ge},ge))]})]}),l.jsxs("div",{className:"form-field-group mt-4",children:[l.jsx("label",{className:`form-label block text-sm font-medium ${e?"text-white":"text-gray-800"}`,children:"Password"}),l.jsxs("div",{className:"password-input-container",children:[l.jsx("input",{type:c.studentSignUpPassword?"text":"password",autoComplete:"new-password",name:"student-signup-password",value:B.password,onChange:ge=>ne(ge.target.value,"student"),className:`form-input-field student-field w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] pr-10 ${e?"bg-[#2c2c2c] text-white border-slate-600":"bg-white text-gray-800 border-slate-300"}`,placeholder:"Create a secure password"}),l.jsxs("button",{type:"button",onClick:()=>Ae("studentSignUpPassword"),className:"password-toggle","aria-label":"Toggle password visibility",children:[l.jsxs("svg",{className:`eye-icon w-5 h-5 ${c.studentSignUpPassword?"hidden":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),l.jsx("svg",{className:`eye-off-icon w-5 h-5 ${c.studentSignUpPassword?"":"hidden"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})]})]}),m.student&&l.jsx("div",{className:`mt-2 p-2 rounded-lg text-sm ${e?"bg-red-900/30 border border-red-700 text-red-200":"bg-red-50 border border-red-200 text-red-700"}`,children:m.student}),l.jsx("div",{className:`password-strength ${d.student}`}),l.jsx("p",{className:`text-xs mt-1 ${e?"text-gray-400":"text-gray-500"}`,children:"Must be at least 8 characters with uppercase, lowercase, numbers, and symbols"})]}),l.jsxs("div",{className:"form-field-group mt-4",children:[l.jsx("label",{className:`form-label block text-sm font-medium ${e?"text-white":"text-gray-800"}`,children:"Confirm Password"}),l.jsxs("div",{className:"password-input-container",children:[l.jsx("input",{type:c.studentSignUpConfirmPassword?"text":"password",autoComplete:"new-password",name:"student-signup-password-confirm",value:B.confirmPassword,onChange:ge=>J(W=>({...W,confirmPassword:ge.target.value})),className:`form-input-field student-field w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] pr-10 ${e?"bg-[#2c2c2c] text-white border-slate-600":"bg-white text-gray-800 border-slate-300"}`,placeholder:"Confirm your password"}),l.jsxs("button",{type:"button",onClick:()=>Ae("studentSignUpConfirmPassword"),className:"password-toggle","aria-label":"Toggle password visibility",children:[l.jsxs("svg",{className:`eye-icon w-5 h-5 ${c.studentSignUpConfirmPassword?"hidden":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),l.jsx("svg",{className:`eye-off-icon w-5 h-5 ${c.studentSignUpConfirmPassword?"":"hidden"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})]})]})]})]}),l.jsx("div",{className:"form-options-container flex items-center mt-6",children:l.jsxs("label",{className:"remember-me-option flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",checked:I,onChange:ge=>{C(ge.target.checked),F("")},className:`terms-checkbox h-4 w-4 text-[#7A1315] border-gray-300 rounded ${L?"terms-error-highlight":""}`}),l.jsxs("span",{className:`remember-me-text text-sm ${L?"terms-label-error":""}`,children:["I agree to the ",l.jsx("a",{href:"#",onClick:ge=>{ge.preventDefault(),o(!0)},className:"terms-link text-[#7A1315] hover:underline",children:"Terms and Conditions"})]})]})}),L&&l.jsx("div",{className:"terms-error-message",children:L}),l.jsx("button",{type:"submit",disabled:ft,className:"registration-submit-button w-full primary-action-button primary-filled-button",children:ft?"Please wait...":"Create Account"}),l.jsxs("div",{className:"auth-switch-link",children:["Already have an account? ",l.jsx("a",{href:"#",onClick:ge=>{ge.preventDefault(),a(!1)},children:"Sign In"})]})]})})]})}),l.jsx(QR,{}),i&&l.jsxs("div",{className:"terms-modal",children:[l.jsx("div",{className:"terms-modal-overlay",onClick:()=>o(!1)}),l.jsxs("div",{className:"terms-modal-container",children:[l.jsxs("div",{className:"terms-modal-header",children:[l.jsx("h2",{className:"terms-modal-title",children:"Terms and Conditions"}),l.jsx("button",{onClick:()=>o(!1),className:"terms-modal-close","aria-label":"Close Terms and Conditions",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),l.jsx("div",{className:"terms-modal-content",children:l.jsxs("div",{className:"terms-content",children:[l.jsxs("div",{className:"terms-header",children:[l.jsx("h3",{children:"University of Mindanao Tagum College - Visayan Campus"}),l.jsx("h4",{children:"Student iTrack - Terms and Conditions of Use"})]}),l.jsxs("section",{className:"terms-section",children:[l.jsx("h5",{children:"1. Acceptance of Terms"}),l.jsx("p",{children:'By accessing and using the Student iTrack Smart Academic Monitoring System ("the System"), you acknowledge that you have read, understood, and agree to be bound by these Terms and Conditions. If you do not agree to these terms, you must not use the System.'})]}),l.jsxs("section",{className:"terms-section",children:[l.jsx("h5",{children:"2. Eligibility"}),l.jsx("p",{children:"This System is exclusively available to:"}),l.jsxs("ul",{children:[l.jsx("li",{children:"Registered students of University of Mindanao Tagum College - Visayan Campus"}),l.jsx("li",{children:"Faculty members and professors of the institution"}),l.jsx("li",{children:"Authorized administrative personnel"})]}),l.jsx("p",{children:"You must use your official institutional email address (@umindanao.edu.ph) to access the System."})]}),l.jsxs("section",{className:"terms-section",children:[l.jsx("h5",{children:"3. Account Registration and Security"}),l.jsx("p",{children:"3.1. You are responsible for maintaining the confidentiality of your account credentials."}),l.jsx("p",{children:"3.2. You agree to provide accurate, current, and complete information during registration."}),l.jsx("p",{children:"3.3. You are responsible for all activities that occur under your account."}),l.jsx("p",{children:"3.4. You must immediately notify the institution of any unauthorized use of your account."}),l.jsx("p",{children:"3.5. The institution reserves the right to suspend or terminate accounts that violate these terms."})]}),l.jsxs("section",{className:"terms-section",children:[l.jsx("h5",{children:"4. Acceptable Use"}),l.jsx("p",{children:"You agree to use the System only for lawful purposes and in accordance with these Terms. You agree NOT to:"}),l.jsxs("ul",{children:[l.jsx("li",{children:"Use the System for any illegal or unauthorized purpose"}),l.jsx("li",{children:"Attempt to gain unauthorized access to any part of the System"}),l.jsx("li",{children:"Interfere with or disrupt the System or servers connected to the System"}),l.jsx("li",{children:"Share your account credentials with others"}),l.jsx("li",{children:"Use automated systems to access the System without permission"}),l.jsx("li",{children:"Upload or transmit any malicious code, viruses, or harmful data"}),l.jsx("li",{children:"Impersonate any person or entity or misrepresent your affiliation"})]})]}),l.jsxs("section",{className:"terms-section",children:[l.jsx("h5",{children:"5. Academic Integrity"}),l.jsx("p",{children:"5.1. All academic information displayed in the System is official and binding."}),l.jsx("p",{children:"5.2. You are responsible for verifying the accuracy of your academic records."}),l.jsx("p",{children:"5.3. Any discrepancies must be reported to the Registrar's Office immediately."}),l.jsx("p",{children:"5.4. The institution maintains the right to correct any errors in academic records."})]}),l.jsxs("section",{className:"terms-section",children:[l.jsx("h5",{children:"6. Privacy and Data Protection"}),l.jsx("p",{children:"6.1. Your personal and academic information will be handled in accordance with the Data Privacy Act of 2012 (Republic Act No. 10173)."}),l.jsx("p",{children:"6.2. The institution collects and processes your data for academic and administrative purposes."}),l.jsx("p",{children:"6.3. Your information will not be shared with third parties without your consent, except as required by law."}),l.jsx("p",{children:"6.4. You have the right to access, correct, and request deletion of your personal data."})]}),l.jsxs("section",{className:"terms-section",children:[l.jsx("h5",{children:"7. Intellectual Property"}),l.jsx("p",{children:"7.1. All content, features, and functionality of the System are owned by the University of Mindanao."}),l.jsx("p",{children:"7.2. You may not reproduce, distribute, or create derivative works from the System without written permission."}),l.jsx("p",{children:"7.3. The System's design, logos, and trademarks are proprietary to the institution."})]}),l.jsxs("section",{className:"terms-section",children:[l.jsx("h5",{children:"8. System Availability"}),l.jsx("p",{children:"8.1. The institution strives to ensure the System is available 24/7 but does not guarantee uninterrupted access."}),l.jsx("p",{children:"8.2. The institution reserves the right to perform maintenance, updates, or modifications that may temporarily affect System availability."}),l.jsx("p",{children:"8.3. The institution is not liable for any loss or inconvenience resulting from System unavailability."})]}),l.jsxs("section",{className:"terms-section",children:[l.jsx("h5",{children:"9. Limitation of Liability"}),l.jsx("p",{children:'9.1. The System is provided "as is" without warranties of any kind.'}),l.jsx("p",{children:"9.2. The institution shall not be liable for any indirect, incidental, or consequential damages arising from the use of the System."}),l.jsx("p",{children:"9.3. The institution's total liability shall not exceed the amount you paid (if any) for using the System."})]}),l.jsxs("section",{className:"terms-section",children:[l.jsx("h5",{children:"10. Changes to Terms"}),l.jsx("p",{children:"The institution reserves the right to modify these Terms and Conditions at any time. Changes will be effective immediately upon posting. Your continued use of the System after changes are posted constitutes acceptance of the modified terms."})]}),l.jsxs("section",{className:"terms-section",children:[l.jsx("h5",{children:"11. Termination"}),l.jsx("p",{children:"The institution may terminate or suspend your access to the System immediately, without prior notice, for any violation of these Terms and Conditions or for any other reason deemed necessary by the institution."})]}),l.jsxs("section",{className:"terms-section",children:[l.jsx("h5",{children:"12. Governing Law"}),l.jsx("p",{children:"These Terms and Conditions shall be governed by and construed in accordance with the laws of the Republic of the Philippines. Any disputes arising from these terms shall be subject to the exclusive jurisdiction of the courts of Davao del Norte, Philippines."})]}),l.jsxs("section",{className:"terms-section",children:[l.jsx("h5",{children:"13. Contact Information"}),l.jsx("p",{children:"If you have questions about these Terms and Conditions of Use, you may contact:"}),l.jsxs("div",{className:"terms-contact",children:[l.jsx("p",{children:l.jsx("strong",{children:"The Data Protection Officer"})}),l.jsx("p",{children:l.jsx("strong",{children:"Internal Audit Office"})}),l.jsx("p",{children:l.jsx("strong",{children:"University of Mindanao"})}),l.jsx("p",{children:"Phone: (+6382) 2275456"})]})]}),l.jsxs("section",{className:"terms-section",children:[l.jsx("h5",{children:"14. Acknowledgment"}),l.jsx("p",{children:'By checking the "I agree to the Terms and Conditions" checkbox and creating an account, you acknowledge that you have read, understood, and agree to be bound by all the terms and conditions stated above.'})]}),l.jsxs("section",{className:"terms-section",style:{marginTop:"2rem",paddingTop:"2rem",borderTop:"2px solid #7A1315"},children:[l.jsx("h3",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#7A1315",marginBottom:"1rem"},children:"UM WEBSITE TERMS AND CONDITIONS OF USE"}),l.jsx("p",{children:"These Terms and Conditions of Use, as may be updated from time to time, apply to this website which is published by the University of Mindanao. You should carefully read these terms and conditions of use before using the website. This is a legally binding agreement. If you do not agree with any of these terms and conditions, do not use our website. By using our website, you accept these terms and conditions in full and without any qualification."}),l.jsx("p",{children:'Access to certain portions of this website ("Password-Protected Areas") may require login and password information. You must have this information in order to access these areas.'}),l.jsxs("p",{children:["The use of your personally identifying and non-personal information will be governed by the Privacy Statement found at ",l.jsx("a",{href:"https://umindanao.edu.ph",target:"_blank",rel:"noopener noreferrer",className:"terms-link",children:"https://umindanao.edu.ph"}),"."]}),l.jsx("p",{children:"Your use of this website indicates that you have read and agree to the Privacy Statement."}),l.jsx("p",{children:"You are responsible for your behavior in your use of this website and for respecting The University of Mindanao's and third parties' (person or entity) rights in connection with the website and its content."}),l.jsx("p",{children:"You are not allowed to use this website for any purpose or in any manner that violates any local, or national law or regulations or the laws or regulations of any foreign government."}),l.jsx("p",{children:"You are not allowed to copy, screenshot, or download any material from the website, unless expressly permitted, as the case may be."}),l.jsx("p",{children:"You are not allowed to modify the website or its content, nor redistribute any of the content thereof."}),l.jsx("p",{children:"You are not allowed to use the website for emailing, transmitting messages, unless you are expressly permitted as the case may be;"}),l.jsx("p",{children:"You are not allowed to use this website to post or send any infringing, threatening, defamatory, libelous, obscene, or pornographic material."}),l.jsx("p",{children:'You are not allowed to use or exploit any portion of this website to distribute commercial messages, "spam," or other unsolicited communications.'}),l.jsx("p",{children:"You are not allowed to directly or indirectly, intentionally reverse-engineer, disrupt or interfere with this website, or that of any third party, in any manner, as it may disrupt its infrastructure and operation."}),l.jsx("p",{children:"You may not sidestep or circumvent any measure The University of Mindanao may use to prevent or restrict access to this website."}),l.jsx("p",{children:"These negative obligations are not exclusive. The University of Mindanao reserves its right to prohibit any act or block you or any user as it may deem proper based on its sole judgment."}),l.jsx("p",{children:"The University of Mindanao does not warrant the currency and accuracy of the content of the website. The use of this website shall be the sole responsibility of the user. The University of Mindanao disclaims all warranties, as may be permitted by laws, whether express or implied, including, implied warranties of merchantability, fitness for a particular purpose and non-infringement. The University of Mindanao expressly disclaims any liability arising out of the use of the website, and that of any third party associated with the website, such as, but not limited to payments using third party credit cards and other payment options, as the case may be."}),l.jsx("p",{children:"The University of Mindanao makes no warranty that this website will meet the user's requirements, or will be uninterrupted, timely, secure, complete or error-free."}),l.jsx("p",{children:"You acknowledge that your remedy with respect to any defect in or dissatisfaction with the website is to cease to use the same."}),l.jsx("p",{children:"You expressly understand and Agree that The University of Mindanao shall not be liable for any direct, indirect, incidental, special, consequential, or exemplary damages, including without limitation, damages for loss of profits, goodwill, use, data loss, that may result from any matter related to your use of this website."}),l.jsx("p",{children:"This website and its contents are owned by The University of Mindanao or third parties associated with it, and are protected by laws, including but not limited to copyright and trademark law. Certain content, such as copyrighted materials and trademarks, are used by permission of third parties. Except as allowed by law (such as fair use) or as expressly permitted in connection with specific content, this website and its contents may not be reproduced, modified, distributed, displayed, performed, or used in any way without the prior written permission of the University of Mindanao or the third-party owner."}),l.jsx("p",{children:"This website may include links to other websites. You acknowledge and agree that such links are provided for your convenience and do not reflect any endorsement by the University of Mindanao with respect to the linked site or its provider. The University of Mindanao makes no representations or warranties with respect to any linked website: Your use of any linked website is solely at your own risk."}),l.jsx("p",{children:"This Agreement and the relationship between you and the University of Mindanao will be governed by the laws of the Republic of the Philippines, without respect to its conflict of law provisions. You agree that venue with respect to any dispute between you and The University of Mindanao will rest exclusively in the City of Davao, Philippines."}),l.jsx("p",{children:"From time to time, The University of Mindanao may change this website and/or these Terms and Conditions of Use. If a change to these Website Terms and Conditions of Use is made, The University of Mindanao will post the revised Terms and Conditions of Use on this website. The University of Mindanao reserves the right to add to or change this website or cease offering this website at any time and without liability. The University of Mindanao reserves the right to refuse to offer access to this website and/or its content to anyone at any time without notice."}),l.jsx("p",{children:"If any provision of the provisions of these Terms and Conditions of Use is found to be invalid by any court having competent jurisdiction, the invalidity of such provision shall not affect the validity of the remaining provisions of these Terms and Conditions of Use, which shall remain in full force. The failure of The University of Mindanao to exercise or enforce any right or provision of these Terms and Conditions of Use shall not constitute a waiver of such right or condition. Any claim or cause of action arising out of or related to the website or these Terms and Conditions of Use must be filed within one year after such claim or cause of action arose. The section titles of these Terms and Conditions of Use are merely for convenience and will not have any effect on the substantive meaning of this agreement."}),l.jsx("p",{children:"The Internet is a valuable tool for The University of Mindanao's education, research, and services. The University of Mindanao encourages you to be mindful of the intent and purpose of its websites and be responsible for safeguarding your personally identifiable information."}),l.jsx("p",{children:"If you are a minor (below 18 years old), you may be required to secure your parents' consent or permission, before you provide any information. In such case, it shall be your responsibility to secure your parents' consent or permission."}),l.jsx("p",{children:"Parents and or legal guardians are encourage to take an active role in their children's use of the internet and this website by talking with their children about safe and responsible computing before sending any information about themselves over the internet. The University of Mindanao requests that parents review this website and guide their minor children in submitting personally identifiable information, in accordance with the Data Privacy Act. It is understood that parents' have assisted their children of their privacy rights under the law."}),l.jsx("p",{children:"The University of Mindanao may block, suspend, or terminate your use of the website at any time for any reason, without notice. The reasons that The University of Mindanao might do so include, but are not limited to, the following: (a) your breach of this agreement; (b) The University of Mindanao is unable to verify or authenticate any information you provide to us; or (c) The University of Mindanao believes that your actions could cause financial loss or legal liability to The University of Mindanao or other users of this website; (d) routine network maintenance affecting all users; or (e) your use of this website or service violates the law or policies of The University of Mindanao."}),l.jsx("p",{children:"If you have questions about these Terms and Conditions of Use, you may contact:"}),l.jsxs("div",{className:"terms-contact",children:[l.jsx("p",{children:l.jsx("strong",{children:"The Data Protection Officer, Internal Audit Office, University of Mindanao"})}),l.jsx("p",{children:"Phone: (+6382) 2275456"})]})]})]})}),l.jsx("div",{className:"terms-modal-footer",children:l.jsx("button",{onClick:()=>{C(!0),o(!1),F("")},className:"terms-accept-button primary-action-button primary-filled-button",children:"I Understand and Accept"})})]})]}),ze&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 backdrop-blur-sm",onClick:ge=>{ge.target===ge.currentTarget&&(ie(!1),_e(""),O(""),me(""))},style:{pointerEvents:"auto"},children:l.jsxs("div",{className:`rounded-lg p-6 max-w-md w-full mx-4 shadow-2xl ${e?"bg-[#2c2c2c]":"bg-white"}`,onClick:ge=>ge.stopPropagation(),style:{pointerEvents:"auto"},children:[l.jsx("h3",{className:`text-xl font-bold mb-4 ${e?"text-white":"text-[#7A1315]"}`,children:"Reset Password"}),l.jsxs("form",{onSubmit:Ne,children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:`block text-sm font-medium mb-2 ${e?"text-white":"text-gray-800"}`,children:r==="professor"?"Professor Email":"Student Email"}),l.jsx("input",{type:"email",value:Ye,onChange:ge=>_e(ge.target.value),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] ${e?"bg-[#1a1a1a] text-white border-slate-600":"bg-white text-gray-800 border-slate-300"}`,placeholder:r==="professor"?"initials@umindanao.edu.ph":"firstname.lastname.studentid.tc@umindanao.edu.ph",required:!0,autoFocus:!0})]}),V&&l.jsx("div",{className:`mb-4 p-3 border rounded text-sm ${e?"bg-red-900/30 border-red-700 text-red-200":"bg-red-50 border-red-200 text-red-700"}`,children:V}),ct&&l.jsx("div",{className:`mb-4 p-3 border rounded text-sm ${e?"bg-green-900/30 border-green-700 text-green-200":"bg-green-50 border-green-200 text-green-700"}`,children:ct}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{type:"button",onClick:()=>{ie(!1),_e(""),O(""),me("")},className:`flex-1 px-4 py-2 border rounded-lg transition-colors ${e?"border-slate-600 text-white hover:bg-slate-700 bg-slate-800":"border-gray-300 text-gray-700 hover:bg-gray-50 bg-white"}`,children:"Cancel"}),l.jsx("button",{type:"submit",disabled:ft,className:"flex-1 px-4 py-2 rounded-lg transition-colors disabled:opacity-50 bg-[#7A1315] text-white hover:bg-[#5a0e10] disabled:bg-[#7A1315]/50",children:ft?"Sending...":"Send Reset Email"})]})]})]})})]})}async function I7(t,e,r={}){return Tr.post("/enrollments",{studentId:t,courseId:e})}async function jA(t,e){try{return(await Tr.get(`/enrollments/student/${t}`)).find(n=>n.course_id===e)||null}catch(r){throw r}}async function DA(t){return t?Tr.get(`/enrollments/student/${t}`):Tr.get("/enrollments/student")}async function C7(t){return Tr.get(`/enrollments/course/${t}`)}async function N7(t){return Tr.delete(`/enrollments/${t}`)}async function R7(t,e){const r=await jA(t,e);return r?Tr.delete(`/enrollments/${r.id}`):!1}function P7(t,e){let r=null;const n=async()=>{try{const s=await DA(t);e(s)}catch(s){console.error("Error polling enrollments:",s),e([])}};return n(),r=setInterval(n,5e3),()=>{r&&clearInterval(r)}}async function _0(t,e,r={}){if(!t||!e)throw new Error("studentId and courseId are required");const n=await ad(t,e);return n?n.id.toString():(await I7(t,e,r)).id.toString()}async function ad(t,e){return!t||!e?null:await jA(t,e)}async function Vb(t){return t?await DA(t):[]}async function Bb(t){return t?await C7(t):[]}async function j7(t){return t?(await N7(t),!0):!1}async function D7(t,e){return await R7(t,e),!0}function F7(t,e){return P7(t,e)}async function L7(t){return Tr.post("/grades",{studentId:t.studentId||t.student_id,courseId:t.courseId||t.course_id,assessmentType:t.assessmentType||t.assessment_type,assessmentTitle:t.assessmentTitle||t.assessment_title,score:t.score,maxPoints:t.maxPoints||t.max_points,date:t.date||null})}async function FA(t){return Tr.get(`/grades/student/${t}`)}function O7(t,e){let r=null;const n=async()=>{var s,a;try{console.log(` Polling grades for student ID: ${t} (type: ${typeof t})`);const i=await FA(t);console.log(` Polled ${i.length} grades for student ${t}`),e(i)}catch(i){console.error(` Error polling grades for student ${t}:`,i),console.error("Error details:",{message:i.message,response:(s=i.response)==null?void 0:s.data,status:(a=i.response)==null?void 0:a.status}),e([])}};return n(),r=setInterval(n,5e3),()=>{r&&clearInterval(r)}}async function M7(t){return(await L7(t)).id.toString()}async function zb(t){return t?await FA(t):[]}function $7(t,e){return O7(t,e)}async function U7(t){return Tr.post("/attendance",{studentId:t.studentId||t.student_id,courseId:t.courseId||t.course_id,date:t.date,status:t.status||"absent"})}async function V7(t,e){return Tr.put(`/attendance/${t}`,{status:e.status,date:e.date})}async function B7(t,e,r,n){try{const s=await z7(t,e,r);if(s)return V7(s.id,{status:n})}catch{}return U7({studentId:t,courseId:e,date:r,status:n})}async function z7(t,e,r){try{return(await Tr.get(`/attendance?studentId=${t}&courseId=${e}`)).find(s=>s.date===r)||null}catch{return null}}async function LA(t){return Tr.get(`/attendance/student/${t}`)}function W7(t,e){let r=null;const n=async()=>{try{const s=await LA(t);e(s)}catch(s){console.error("Error polling attendance:",s),e([])}};return n(),r=setInterval(n,5e3),()=>{r&&clearInterval(r)}}async function H7(t,e,r,n){if(!t||!e||!r||!n)throw new Error("studentId, courseId, date, and status are required");return(await B7(t,e,r,n)).id.toString()}async function Wb(t){return t?await LA(t):[]}function G7(t,e){return W7(t,e)}async function OA(t={}){const e=new URLSearchParams;t.limit&&e.append("limit",t.limit),t.offset&&e.append("offset",t.offset),t.unreadOnly&&e.append("unreadOnly","true");const r=e.toString()?`/notifications?${e.toString()}`:"/notifications",n="http://localhost:5000/api",s=`${n}${r}`;console.log(" Fetching notifications from:",s),console.log(" API configuration:",{apiBaseUrl:n,endpoint:r,fullUrl:s,envVar:"http://localhost:5000/api"});try{const a=await Tr.get(r);if(console.log(" Notifications API response (raw):",{type:typeof a,isArray:Array.isArray(a),length:Array.isArray(a)?a.length:"N/A",hasData:!!a,dataType:a?typeof a:"null",isObject:a&&typeof a=="object"&&!Array.isArray(a),keys:a&&typeof a=="object"&&!Array.isArray(a)?Object.keys(a):null,fullResponse:a,stringified:JSON.stringify(a).substring(0,500)}),Array.isArray(a))return console.log(" Response is direct array, returning",a.length,"notifications"),a;if(a&&typeof a=="object"&&!Array.isArray(a)){const i=Object.keys(a);console.log(" Response is object with keys:",i);for(const o of["data","notifications","items","results","list","array"])if(Array.isArray(a[o]))return console.log(` Found notifications in result.${o}, returning`,a[o].length,"notifications"),a[o];for(const o of i)if(Array.isArray(a[o]))return console.log(` Found array in result.${o}, returning`,a[o].length,"items"),a[o];if(i.every(o=>!isNaN(parseInt(o)))){const o=Object.values(a);if(o.length>0)return console.log(" Converted object with numeric keys to array, returning",o.length,"items"),o}if(i.length===1&&Array.isArray(a[i[0]]))return console.log(` Found single array property ${i[0]}, returning`,a[i[0]].length,"items"),a[i[0]];console.error(" Response is object but no array found in any property!"),console.error(" Object keys:",i),console.error(" Object values:",Object.values(a).map(o=>({type:typeof o,isArray:Array.isArray(o)}))),console.error(" Full response:",JSON.stringify(a,null,2))}if(console.error(" Unexpected notifications response format!"),console.error(" Response type:",typeof a),console.error(" Response value:",a),console.error(" Full response stringified:",JSON.stringify(a,null,2).substring(0,1e3)),a&&typeof a=="object"&&a.error)throw console.error(" API returned error:",a.error),new Error(a.error);return[]}catch(a){throw console.error(" Error fetching notifications:",a),console.error(" Error details:",{message:a.message,endpoint:r,fullUrl:s,apiBaseUrl:n,stack:a.stack}),a.message.includes("Cannot connect to server")&&(console.error(" Troubleshooting tips:"),console.error("   1. Check if backend server is running: cd server && npm start"),console.error("   2. Verify API URL in .env file: VITE_API_URL=http://localhost:5000/api"),console.error("   3. Check CORS settings in server/src/server.js"),console.error("   4. Verify server is listening on port 5000")),a}}async function q7(){const t=await Tr.get("/notifications/unread/count");return typeof t=="number"?t:t&&typeof t=="object"&&(t.count||t.unreadCount||t.total)||0}async function K7(t){return Tr.put(`/notifications/${t}/read`)}async function Q7(){return Tr.put("/notifications/read-all")}async function X7(t){return Tr.delete(`/notifications/${t}`)}function Y7(t,e={}){let r=null,n=[];const s=async()=>{var a,i,o,c,u;try{const d=await OA(e);if(Array.isArray(d))n=d,d.length>0,t(d);else if(d&&typeof d=="object"){const h=d.data||d.notifications||[];Array.isArray(h)?(n=h,h.length>0,t(h)):(console.warn(" Notifications API returned object but no array found:",d),n.length>0&&t(n))}else console.warn(" Notifications API returned non-array:",d),n.length>0&&t(n)}catch(d){console.error(" Error polling notifications:",d),console.error(" Error details:",{message:d.message,status:(a=d.response)==null?void 0:a.status,statusText:(i=d.response)==null?void 0:i.statusText,data:(o=d.response)==null?void 0:o.data,url:(c=d.config)==null?void 0:c.url}),n.length>0?(console.log(` Using cached notifications (${n.length} items) due to error`),t(n)):((u=d.response)==null?void 0:u.status)===404?(console.warn(" Student profile not found (404) - cannot load notifications"),t([])):console.warn(" Notification polling error, but no cached data available. Will retry on next poll.")}};return s(),r=setInterval(s,5e3),()=>{r&&clearInterval(r)}}async function ng(t={}){return await OA(t)}async function S0(){return await q7()}async function J7(t){return await K7(t)}async function MA(){return await Q7()}async function Z7(t){return await X7(t)}function e9(t,e={}){return Y7(t,e)}async function t9(t){try{return await Tr.get(`/courses/${t}`)}catch(e){if(e.message.includes("404")||e.message.includes("not found"))return null;throw e}}async function r9(t,e=null){try{let n=`/courses/code/${encodeURIComponent(t)}`;return e&&(n+=`?professorId=${e}`),await Tr.get(n)}catch(r){if(r.message.includes("404")||r.message.includes("not found"))return null;throw r}}async function n9(t){return Tr.get(`/courses/professor/${t}`)}async function s9(t){return Tr.post("/courses",{code:t.code,name:t.name,credits:t.credits||0,professorId:t.professorId||t.professor_id,term:t.term||"first"})}async function a9(t,e){const r={};return e.code!==void 0&&(r.code=e.code),e.name!==void 0&&(r.name=e.name),e.credits!==void 0&&(r.credits=e.credits),(e.professorId!==void 0||e.professor_id!==void 0)&&(r.professorId=e.professorId||e.professor_id),e.term!==void 0&&(r.term=e.term),Tr.put(`/courses/${t}`,r)}async function i9(t){return Tr.delete(`/courses/${t}`)}async function gc(t){return(await s9(t)).id.toString()}async function sg(t){return t?await t9(t):null}async function o9(t){return t?await n9(t):[]}async function Cs(t,e=null){return t?await r9(t,e):null}async function l9(t,e){return t?await a9(t,e):null}async function Hb(t){return t?(await i9(t),!0):!1}const c9={id:"default",name:"Student",abs:0,examTaken:0,examTotal:0,attRate:0,avgGrade:0,firstTerm:[],secondTerm:[],notifs:[]};function u9(){const t=Am(),[e,r]=G.useState(c9),[n,s]=G.useState("all"),[a,i]=G.useState("none"),[o,c]=G.useState(!1),[u,d]=G.useState(null),[h,m]=G.useState(""),[p,y]=G.useState("all"),[v,b]=G.useState("name"),[E,T]=G.useState("asc"),[w,B]=G.useState(1),[J,Z]=G.useState(12),[_,I]=G.useState(!1),[C,L]=G.useState("all"),[F,V]=G.useState(""),[O,ct]=G.useState("date"),[me,ft]=G.useState("desc"),[rt,ze]=G.useState(1),[ie]=G.useState(5),[Ye,_e]=G.useState({}),[Q,ae]=G.useState(!1),[le,ne]=G.useState(!1),[Ae,st]=G.useState(!1),[ot,Ne]=G.useState("Student"),[Ve,ge]=G.useState("/assets/images/trisha.jpg"),[W,we]=G.useState(null),[et,ht]=G.useState(""),[Qe,qe]=G.useState(null),[Ft,Mt]=G.useState({name:"",pic:null,removePhoto:!1}),[Ot,er]=G.useState(null),[jt,lr]=G.useState([]),[Nr,Rr]=G.useState(!1),[ls,mn]=G.useState(""),[Dr,Lr]=G.useState("account"),Bt=G.useRef(null);G.useRef(null);const Qt=G.useRef(null),[ir,cr]=G.useState(null),[An,ta]=G.useState([]),[cs,ja]=G.useState([]),[Gn,$n]=G.useState([]),[In,ra]=G.useState([]),Fr=G.useRef(null),Cn=G.useRef(null),ks=G.useRef(null),qn=G.useRef(null),[Da,pn]=G.useState(0),{isDarkMode:ue,toggleTheme:ni}=Im(),[ut,Vs]=G.useState(!1);G.useEffect(()=>{const ve=Le=>{sessionStorage.getItem("currentUser")&&window.location.pathname==="/login"&&(Le.preventDefault(),window.history.pushState(null,"","/student"),t("/student",{replace:!0}))};return window.addEventListener("popstate",ve),window.history.pushState(null,"",window.location.pathname),()=>{window.removeEventListener("popstate",ve)}},[t]),G.useEffect(()=>{if(sessionStorage.getItem("studentProfileProcessing")==="true"){console.log(" Profile processing already in progress, skipping...");return}return(async()=>{var Pe,Ie,de,Fe,xt,He;const Ke=sessionStorage.getItem("currentUser");if(!Ke){t("/login",{replace:!0});return}let Je=null;try{Je=JSON.parse(Ke)}catch(Oe){console.warn("Failed to parse current user from session",Oe)}we((Je==null?void 0:Je.uid)||null),Je!=null&&Je.email&&ht(Je.email);const Se=((Pe=Je==null?void 0:Je.name)==null?void 0:Pe.trim())||((Ie=Je==null?void 0:Je.email)==null?void 0:Ie.split("@")[0])||"Student";if(Ne(Se),Je!=null&&Je.uid)try{const Oe=await El(Je.uid).catch(Be=>(console.warn("Failed to load student profile:",Be),null));if(Oe){if(qe(Oe),cr(Oe.id),console.log(" Student profile found in MySQL:",{mysqlId:Oe.id,firebaseUid:Je.uid,studentId:Oe.student_id,name:Oe.name,email:Oe.email}),Oe.name&&Ne(Oe.name),Oe.photo_url||Oe.photoURL){const vt=Oe.photo_url||Oe.photoURL;ge(vt),er(vt)}else er(null);Oe.email&&ht(Oe.email);const Be=sessionStorage.getItem("currentUser");if(Be)try{const vt=JSON.parse(Be);vt.name=Oe.name||vt.name,vt.email=Oe.email||vt.email,(Oe.photo_url||Oe.photoURL)&&(vt.photoURL=Oe.photo_url||Oe.photoURL),sessionStorage.setItem("currentUser",JSON.stringify(vt))}catch(vt){console.warn("Failed to update session storage",vt)}console.log(" Loading student data for MySQL ID:",Oe.id,"(type:",typeof Oe.id,")");const[it,$t,zt,Dt,Tt]=await Promise.all([Vb(Oe.id).catch(vt=>(console.error(" Enrollments error:",vt),console.error(" Enrollment error details:",{studentMySQLId:Oe.id,errorMessage:vt.message,errorStack:vt.stack}),[])),zb(Oe.id).catch(vt=>(console.error(" Grades error:",vt),[])),Wb(Oe.id).catch(vt=>(console.error(" Attendance error:",vt),[])),ng({limit:50}).catch(vt=>{var Hr,Gr;return console.error(" Notifications error:",vt),console.error(" Notifications error details:",{message:vt.message,response:vt.response,status:(Hr=vt.response)==null?void 0:Hr.status,data:(Gr=vt.response)==null?void 0:Gr.data,studentMySQLId:Oe.id}),[]}),S0().catch(vt=>(console.error(" Unread count error:",vt),0))]);let dr=[];Array.isArray(Dt)?dr=Dt:Dt&&typeof Dt=="object"&&(Array.isArray(Dt.data)?dr=Dt.data:Array.isArray(Dt.notifications)&&(dr=Dt.notifications)),console.log(" Loaded data:",{enrollments:it.length,grades:$t.length,attendance:zt.length,notifications:dr.length,notificationsIsArray:Array.isArray(Dt),unreadCount:Tt,notificationsRaw:Dt,notificationsArray:dr}),console.log(" Enrollments details:",it),console.log(" Enrollment course IDs:",it.map(vt=>vt.course_id)),console.log(" Notifications sample:",dr.slice(0,3)),console.log(" Full notifications data type check:",{rawType:typeof Dt,rawIsArray:Array.isArray(Dt),arrayLength:dr.length,firstNotification:dr[0]||null}),ta(it),$n($t),ra(zt);const jr=Array.isArray(dr)?dr:[];console.log(" Setting notifications state with",jr.length,"notifications"),lr(jr),pn(Tt),console.log(" Loading course details for",it.length,"enrollments..."),console.log(" Enrollment course IDs:",it.map(vt=>({enrollmentId:vt.id,courseId:vt.course_id,courseIdType:typeof vt.course_id,courseCode:vt.code,courseName:vt.course_name})));const Qr=it.filter(vt=>vt.code&&vt.course_name),Un=it.filter(vt=>!vt.code||!vt.course_name);console.log(" Enrollments with course data:",Qr.length),console.log(" Enrollments needing course load:",Un.length);const Nn=Un.map(vt=>(console.log("   Loading course ID:",vt.course_id,"(type:",typeof vt.course_id,")"),sg(vt.course_id).catch(Hr=>(console.error("   Failed to load course ID:",vt.course_id,Hr),console.error("   Error details:",{courseId:vt.course_id,courseIdType:typeof vt.course_id,errorMessage:Hr.message}),null)))),$e=(await Promise.all(Nn)).filter(Boolean),Wt=[...Qr.map(vt=>({id:vt.course_id,code:vt.code,name:vt.course_name,credits:vt.credits||0})),...$e],or=Array.from(new Map(Wt.map(vt=>[vt.id,vt])).values());console.log(" Total courses loaded:",or.length,":",or.map(vt=>({id:vt.id,code:vt.code,name:vt.name}))),ja(or);const kt=z(it,or,$t,zt,Oe.name||Se);r(kt),console.log(" Student dashboard data loaded from MySQL:",{enrollments:it.length,courses:or.length,grades:$t.length,attendance:zt.length,notifications:Dt.length,unreadCount:Tt,firstTermSubjects:((de=kt.firstTerm)==null?void 0:de.length)||0,secondTermSubjects:((Fe=kt.secondTerm)==null?void 0:Fe.length)||0})}else{if(console.warn(" Student profile not found in MySQL. Firebase UID:",Je.uid),console.warn(" Attempting to find or create student profile..."),Je!=null&&Je.email){console.log(" Trying to find student by email:",Je.email);try{let Be=await Oc(Je.email);if(Be)if(console.log(" Found student by email:",{mysqlId:Be.id,firebaseUid:Be.firebase_uid,studentId:Be.student_id,name:Be.name}),(!Be.firebase_uid||Be.firebase_uid.startsWith("temp_"))&&Je.uid){console.log(" Linking Firebase UID to student MySQL record...");try{sessionStorage.setItem("studentProfileProcessing","true"),await Ub(Be.id,{firebase_uid:Je.uid,name:Be.name,email:Be.email,studentId:Be.student_id||Be.studentId});const it=await El(Je.uid);it?(console.log(" Successfully linked Firebase UID to MySQL record"),qe(it),cr(it.id),sessionStorage.removeItem("studentProfileProcessing"),Oe=it):sessionStorage.removeItem("studentProfileProcessing")}catch(it){console.error(" Error linking Firebase UID:",it),sessionStorage.removeItem("studentProfileProcessing"),Oe=Be}}else Be.firebase_uid===Je.uid?(console.log(" Firebase UID matches, using student found by email"),qe(Be),cr(Be.id),Oe=Be):(!Be.firebase_uid||Be.firebase_uid.startsWith("temp_"))&&(console.log(" Student found but Firebase UID not linked, using student data anyway"),qe(Be),cr(Be.id),Oe=Be);else{console.log(" Student not found in MySQL by email, trying to find by student ID from email...");const $t=Je.email.split("@")[0],zt=$t.split(".");let Dt=null;if(zt.length>=2){for(let Tt=zt.length-1;Tt>=0;Tt--)if(/^\d+$/.test(zt[Tt])){Dt=zt[Tt];break}}if(Dt){console.log(" Trying to find student by extracted ID:",Dt);try{const Tt=await ms(Dt);if(Tt){console.log(" Found student by numerical ID! Linking Firebase UID...",{mysqlId:Tt.id,studentId:Tt.student_id,currentFirebaseUid:Tt.firebase_uid}),sessionStorage.setItem("studentProfileProcessing","true"),await Ub(Tt.id,{firebase_uid:Je.uid,name:Tt.name,email:Je.email,studentId:Tt.student_id});const dr=await El(Je.uid);dr?(console.log(" Successfully linked Firebase UID to existing MySQL record"),qe(dr),cr(dr.id),sessionStorage.removeItem("studentProfileProcessing"),Oe=dr):sessionStorage.removeItem("studentProfileProcessing")}else{console.log(" Student not found by ID either, creating new profile..."),sessionStorage.setItem("studentProfileProcessing","true"),await Rl(Je.uid,{name:Je.name||$t.split(".")[0]||"Student",email:Je.email,studentId:Dt});const dr=await El(Je.uid);dr?(console.log(" Created new student profile in MySQL"),qe(dr),cr(dr.id),sessionStorage.removeItem("studentProfileProcessing"),Oe=dr):sessionStorage.removeItem("studentProfileProcessing")}}catch(Tt){console.error(" Error finding/creating student by ID:",Tt)}}else console.warn(" Could not extract student ID from email. Student may need to be enrolled by professor first.")}}catch(Be){console.error(" Error finding/creating student:",Be)}}if(Oe&&Oe.id){console.log(" Loading data for profile found via fallback logic..."),console.log(" Loading student data for MySQL ID:",Oe.id,"(type:",typeof Oe.id,")");const[Be,it,$t,zt,Dt]=await Promise.all([Vb(Oe.id).catch(kt=>(console.error(" Enrollments error:",kt),console.error(" Enrollment error details:",{studentMySQLId:Oe.id,errorMessage:kt.message,errorStack:kt.stack}),[])),zb(Oe.id).catch(kt=>(console.error(" Grades error:",kt),[])),Wb(Oe.id).catch(kt=>(console.error(" Attendance error:",kt),[])),ng({limit:50}).catch(kt=>{var vt,Hr,Gr,Di;return console.error(" Notifications error:",kt),console.error(" Notifications error details:",{message:kt.message,response:kt.response,status:(vt=kt.response)==null?void 0:vt.status,data:(Hr=kt.response)==null?void 0:Hr.data,stack:kt.stack}),((Gr=kt.response)==null?void 0:Gr.status)===404?console.warn(" Student profile not found - notifications cannot be loaded"):((Di=kt.response)==null?void 0:Di.status)===403?console.warn(" Access denied - invalid user role"):console.error(" Unexpected error loading notifications"),[]}),S0().catch(kt=>(console.error(" Unread count error:",kt),0))]);console.log(" Loaded data:",{enrollments:Be.length,grades:it.length,attendance:$t.length,notifications:(zt==null?void 0:zt.length)||0}),console.log(" Notifications data type:",typeof zt,Array.isArray(zt)),console.log(" Notifications data:",zt),console.log(" Enrollments details:",Be),console.log(" Enrollment course IDs:",Be.map(kt=>kt.course_id)),ta(Be),$n(it),ra($t);const Tt=Array.isArray(zt)?zt:[];console.log(" Setting notifications state:",{count:Tt.length,isArray:Array.isArray(zt),originalData:zt});const dr=Array.isArray(Tt)?Tt:[];lr(dr),pn(Dt),console.log(" Loading course details for",Be.length,"enrollments..."),console.log(" Enrollment course IDs:",Be.map(kt=>({enrollmentId:kt.id,courseId:kt.course_id,courseIdType:typeof kt.course_id,courseCode:kt.code,courseName:kt.course_name})));const jr=Be.filter(kt=>kt.code&&kt.course_name),Qr=Be.filter(kt=>!kt.code||!kt.course_name);console.log(" Enrollments with course data:",jr.length),console.log(" Enrollments needing course load:",Qr.length);const Un=Qr.map(kt=>(console.log("   Loading course ID:",kt.course_id,"(type:",typeof kt.course_id,")"),sg(kt.course_id).catch(vt=>(console.error("   Failed to load course ID:",kt.course_id,vt),console.error("   Error details:",{courseId:kt.course_id,courseIdType:typeof kt.course_id,errorMessage:vt.message}),null)))),Me=(await Promise.all(Un)).filter(Boolean),Zt=[...jr.map(kt=>({id:kt.course_id,code:kt.code,name:kt.course_name,credits:kt.credits||0,term:kt.term||"first"})),...Me],Wt=Array.from(new Map(Zt.map(kt=>[kt.id,kt])).values());console.log(" Total courses loaded:",Wt.length,":",Wt.map(kt=>({id:kt.id,code:kt.code,name:kt.name}))),ja(Wt);const or=z(Be,Wt,it,$t,Oe.name||Se);r(or),console.log(" Student dashboard data loaded from MySQL:",{enrollments:Be.length,courses:Wt.length,grades:it.length,attendance:$t.length,notifications:zt.length,unreadCount:Dt,firstTermSubjects:((xt=or.firstTerm)==null?void 0:xt.length)||0,secondTermSubjects:((He=or.secondTerm)==null?void 0:He.length)||0})}else Oe||(console.error(" Could not load or create student profile"),console.warn(" Student may need to be enrolled by professor first, or their Firebase UID may not be linked to their MySQL record."))}}catch(Oe){console.error("Error loading student data:",Oe),sessionStorage.removeItem("studentProfileProcessing")}})(),()=>{Bt.current&&(Bt.current(),Bt.current=null),Fr.current&&(Fr.current(),Fr.current=null),Cn.current&&(Cn.current(),Cn.current=null)}},[t]);const si=G.useRef(An),io=G.useRef(cs),hr=G.useRef(Gn),gn=G.useRef(In),R=G.useRef(ot);G.useEffect(()=>{si.current=An},[An]),G.useEffect(()=>{io.current=cs},[cs]),G.useEffect(()=>{hr.current=Gn},[Gn]),G.useEffect(()=>{gn.current=In},[In]),G.useEffect(()=>{R.current=ot},[ot]);const X=G.useCallback(async()=>{var Le,Ke,Je;if(!ir){console.warn(" Cannot refresh notifications: studentMySQLId not set");return}console.log(" Manually refreshing notifications for student MySQL ID:",ir);const ve="http://localhost:5000/api";try{const Se=await fetch(`${ve.replace("/api","")}/api/health`);if(!Se.ok)throw new Error(`Server health check failed: ${Se.status}`);console.log(" Server is reachable")}catch(Se){console.error(" Server connection test failed:",Se),console.error(" Please ensure the backend server is running:"),console.error("   1. Open a terminal in the server directory"),console.error("   2. Run: npm start (or npm run dev)"),console.error("   3. Verify server is running on http://localhost:5000"),console.error(`   4. Check API URL: ${ve}`);return}try{console.log(" Fetching notifications and unread count for student MySQL ID:",ir),console.log(" Starting API calls for student MySQL ID:",ir);let Se=[],Pe=0;try{console.log(" Calling getNotifications API for student MySQL ID:",ir),console.log(" Note: Backend will resolve student ID from Firebase UID, which may differ from frontend studentMySQLId"),Se=await ng({limit:50}),console.log(" getNotifications returned:",{type:typeof Se,isArray:Array.isArray(Se),length:Array.isArray(Se)?Se.length:"N/A",data:Se,firstItem:Array.isArray(Se)&&Se.length>0?Se[0]:null}),Array.isArray(Se)&&Se.length===0&&console.warn(" getNotifications returned empty array. Check server logs to see which student ID was resolved.")}catch(Oe){console.error(" Error calling getNotifications:",Oe),Se=[]}try{console.log(" Calling getUnreadCount API..."),Pe=await S0(),console.log(" getUnreadCount returned:",{type:typeof Pe,value:Pe})}catch(Oe){console.error(" Error calling getUnreadCount:",Oe),Pe=0}const Ie=typeof Pe=="number"?Pe:(Pe==null?void 0:Pe.count)||0;console.log(" Raw notifications API response:",{notificationsData:Se,notificationsDataType:typeof Se,notificationsIsArray:Array.isArray(Se),notificationsLength:Array.isArray(Se)?Se.length:"N/A",notificationsDataKeys:Se&&typeof Se=="object"&&!Array.isArray(Se)?Object.keys(Se):null,notificationsDataValues:Se&&typeof Se=="object"&&!Array.isArray(Se)?Object.entries(Se).map(([Oe,Be])=>({key:Oe,valueType:typeof Be,isArray:Array.isArray(Be),sample:Array.isArray(Be)?`Array[${Be.length}]`:typeof Be=="object"&&Be!==null?Object.keys(Be).slice(0,3):String(Be).substring(0,50)})):null,fullResponseString:JSON.stringify(Se,null,2).substring(0,2e3),unreadCountResponse:Pe,unreadCount:Ie,studentMySQLId:ir});let de=[];if(Array.isArray(Se))de=Se,console.log(" Notifications is direct array, length:",de.length);else if(Se&&typeof Se=="object"){const Oe=Object.keys(Se);console.log(" Object response detected. Checking keys:",Oe);const Be=["data","notifications","items","results","list","array","notificationsList"];let it=!1;for(const $t of Be)if(Array.isArray(Se[$t])){de=Se[$t],console.log(` Found notifications in .${$t} property, length:`,de.length),it=!0;break}if(!it){for(const $t of Oe)if(Array.isArray(Se[$t])){de=Se[$t],console.log(` Found array in .${$t} property, length:`,de.length),it=!0;break}}if(!it&&Oe.length>0){const $t=Se[Oe[0]];if(Array.isArray($t))de=$t,console.log(" Found array as first property value, length:",de.length),it=!0;else if(typeof $t=="object"&&$t!==null){const zt=Object.values(Se);zt.every(Dt=>typeof Dt=="object"&&Dt!==null&&!Array.isArray(Dt))&&(de=zt,console.log(` Converted object with ${zt.length} items to array`),it=!0)}}it||(console.error(" Notifications response is object but no array found!"),console.error(" Response keys:",Oe),console.error(" Response structure:",JSON.stringify(Se,null,2).substring(0,2e3)),console.error(" All property types:",Oe.map($t=>({key:$t,type:typeof Se[$t],isArray:Array.isArray(Se[$t])}))))}else Se==null?console.error(" Notifications response is null or undefined!"):console.error(" Unexpected notifications response type:",typeof Se,Se);if(console.log(" Manually refreshed notifications:",{count:de.length,unreadCount:Ie,unreadCountType:typeof Ie,firstNotification:de[0]||null,allIds:de.map(Oe=>Oe.id).slice(0,5),studentMySQLId:ir,mismatch:Ie>0&&de.length===0?" MISMATCH DETECTED":" OK"}),Ie>0&&de.length===0){if(console.error(" CRITICAL MISMATCH: Badge shows",Ie,"unread but notifications array is empty!"),console.error(" Student MySQL ID used:",ir),console.error(" Notifications data received:",{raw:Se,type:typeof Se,isArray:Array.isArray(Se),keys:Se&&typeof Se=="object"&&!Array.isArray(Se)?Object.keys(Se):null,stringified:JSON.stringify(Se,null,2).substring(0,1e3),allValues:Se&&typeof Se=="object"&&!Array.isArray(Se)?Object.entries(Se).map(([Oe,Be])=>({key:Oe,type:typeof Be,isArray:Array.isArray(Be),sample:JSON.stringify(Be).substring(0,100)})):null}),Se&&typeof Se=="object"&&!Array.isArray(Se)){const Oe=Object.keys(Se);console.log(" Attempting to extract array from object keys:",Oe);for(const Be of Oe){const it=Se[Be];if(console.log(`  - ${Be}: type=${typeof it}, isArray=${Array.isArray(it)}`),Array.isArray(it)){console.log(` Found array in ${Be} with ${it.length} items!`),de=it;const $t=Array.isArray(de)?de:[];lr($t);const zt=$t.filter(Dt=>!Dt.read||Dt.read===0).length;pn(zt),console.log(" Fixed mismatch by extracting array from",Be);return}}}console.error(' Check server logs for: " Found X notifications for Student ID"'),console.error(" This mismatch suggests the API returned empty array despite unread count > 0"),console.error(" Check Network tab in browser DevTools to see actual API response")}const Fe=Array.isArray(de)?de:[];lr(Fe);const xt=Fe.filter(Oe=>{const Be=Oe.read;return Be===!1||Be===0||Be==="0"||Be===null||Be===void 0}).length,He=de.length>0?xt:Ie;console.log(" Unread count comparison:",{apiCount:Ie,calculatedCount:xt,using:He}),pn(He)}catch(Se){console.error(" Error manually refreshing notifications:",Se),console.error(" Error details:",{message:Se.message,status:(Le=Se.response)==null?void 0:Le.status,statusText:(Ke=Se.response)==null?void 0:Ke.statusText,data:(Je=Se.response)==null?void 0:Je.data,studentMySQLId:ir,apiUrl:ve}),Se.message.includes("Cannot connect to server")&&(console.error(" Server Connection Issue:"),console.error("   1. Make sure backend server is running: cd server && npm start"),console.error("   2. Check if server is listening on port 5000"),console.error(`   3. Verify API URL in browser console: ${ve}`),console.error("   4. Check CORS settings in server/src/server.js"))}},[ir]);G.useEffect(()=>{if(!ir){console.log(" Waiting for studentMySQLId to be set before setting up polling...");return}console.log("Setting up polling for student MySQL ID:",ir),X();const ve=()=>{const Ie=si.current,de=io.current,Fe=hr.current,xt=gn.current,He=R.current;if(Ie.length>0&&de.length>0){const Oe=z(Ie,de,Fe,xt,He);r(Oe)}},Le=$7(ir,Ie=>{console.log(" Grades polled for student MySQL ID:",ir),console.log(" Grades received:",Ie.length,"grades"),$n(Ie),setTimeout(ve,0)}),Ke=G7(ir,Ie=>{console.log(" Attendance updated:",Ie.length,"records"),ra(Ie),setTimeout(ve,0)}),Je=F7(ir,async Ie=>{var Dt;console.log(" Enrollments updated:",Ie.length,"enrollments"),console.log(" Enrollment details:",Ie.map(Tt=>({id:Tt.id,course_id:Tt.course_id,hasCode:!!Tt.code,hasCourseName:!!Tt.course_name,code:Tt.code,course_name:Tt.course_name}))),ta(Ie);const de=Ie.filter(Tt=>Tt.code&&Tt.course_name),Fe=Ie.filter(Tt=>!Tt.code||!Tt.course_name);console.log(" Enrollments with course data from JOIN:",de.length),console.log(" Enrollments needing course load:",Fe.length);const xt=Fe.map(Tt=>sg(Tt.course_id).catch(()=>null)),Oe=(await Promise.all(xt)).filter(Boolean),it=[...de.map(Tt=>({id:Tt.course_id,code:Tt.code,name:Tt.course_name,credits:Tt.credits||0,term:Tt.term||"first"})),...Oe],$t=Array.from(new Map(it.map(Tt=>[Tt.id,Tt])).values());console.log(" Total unique courses for transform:",$t.length,$t.map(Tt=>({id:Tt.id,code:Tt.code,name:Tt.name}))),ja($t);const zt=z(Ie,$t,hr.current||[],gn.current||[],R.current||"Student");console.log(" Transformed data from subscription:",{firstTermCount:((Dt=zt.firstTerm)==null?void 0:Dt.length)||0,enrollmentsCount:Ie.length,coursesCount:$t.length}),r(zt)}),Se=e9(Ie=>{console.log(" Notifications subscription callback received:",{data:Ie,type:typeof Ie,isArray:Array.isArray(Ie),length:Array.isArray(Ie)?Ie.length:"N/A",keys:Ie&&typeof Ie=="object"&&!Array.isArray(Ie)?Object.keys(Ie):null});let de=[];if(Array.isArray(Ie))de=Ie,console.log(" Subscription: Direct array, length:",de.length);else if(Ie&&typeof Ie=="object"){const He=Object.keys(Ie);console.log(" Subscription: Object with keys:",He);for(const Oe of["data","notifications","items","results","list","array"])if(Array.isArray(Ie[Oe])){de=Ie[Oe],console.log(` Subscription: Found array in .${Oe}, length:`,de.length);break}if(de.length===0){for(const Oe of He)if(Array.isArray(Ie[Oe])){de=Ie[Oe],console.log(` Subscription: Found array in .${Oe}, length:`,de.length);break}}de.length===0&&(console.error(" Subscription: Object but no array found!"),console.error(" Object keys:",He),console.error(" Object structure:",JSON.stringify(Ie).substring(0,500)),de=[])}else console.warn(" Subscription: Unexpected data type:",typeof Ie);const Fe=Array.isArray(de)?de:[];lr(Fe),console.log(" Subscription: Final notifications state set:",{count:Fe.length,isArray:Array.isArray(Fe),type:typeof Fe});const xt=de.filter(He=>{const Oe=He.read;return Oe===!1||Oe===0||Oe==="0"||Oe===null||Oe===void 0}).length;console.log(" Unread count calculation:",{total:Fe.length,unread:xt,read:Fe.length-xt,sampleReadValues:Fe.slice(0,3).map(He=>({id:He.id,read:He.read,readType:typeof He.read,isUnread:!He.read||He.read===0}))}),pn(xt),console.log(" Notifications state updated:",{notificationsCount:Fe.length,unreadCount:xt,willDisplay:Fe.length>0?"YES":"NO (empty state)"})},{limit:50}),Pe=setInterval(async()=>{try{const Ie=await S0();pn(Ie)}catch(Ie){console.error("Error fetching unread count:",Ie)}},5e3);return Fr.current=Le,Cn.current=Ke,ks.current=Je,qn.current=Se,()=>{Fr.current&&(Fr.current(),Fr.current=null),Cn.current&&(Cn.current(),Cn.current=null),ks.current&&(ks.current(),ks.current=null),qn.current&&(qn.current(),qn.current=null),Pe&&clearInterval(Pe)}},[ir]);const z=(ve,Le,Ke,Je,Se)=>{const Pe=new Map;Le.forEach(Me=>{const $e=Me.id,Zt={...Me,term:Me.term||"first",professor_name:Me.professor_name||null,professor_photo_url:Me.professor_photo_url||null};if(Pe.set($e,Zt),typeof $e=="number")Pe.set(String($e),Zt);else if(typeof $e=="string"){const Wt=Number($e);isNaN(Wt)||Pe.set(Wt,Zt)}}),ve.forEach(Me=>{if(Me.code&&Me.course_name){const $e=Me.course_id,Zt=typeof $e=="number"&&Pe.has($e),Wt=typeof $e=="string"&&Pe.has($e),or=typeof $e=="string"?Number($e):$e,kt=!isNaN(or)&&Pe.has(or)&&Pe.has(String(or));if(!Zt&&!Wt&&!kt){const vt={id:Me.course_id,code:Me.code,name:Me.course_name,credits:Me.credits||0};if(Pe.set(Me.course_id,vt),typeof Me.course_id=="number")Pe.set(String(Me.course_id),vt);else{const Hr=Number(Me.course_id);isNaN(Hr)||Pe.set(Hr,vt)}}}});const Ie=new Map;ve.forEach(Me=>{Ie.set(Me.course_id,Me)});const de=new Map;Ke.forEach(Me=>{const $e=Me.course_id;if(de.has($e)||de.set($e,[]),de.get($e).push(Me),typeof $e=="number")de.has(String($e))||de.set(String($e),[]),de.get(String($e)).push(Me);else if(typeof $e=="string"){const Zt=Number($e);isNaN(Zt)||(de.has(Zt)||de.set(Zt,[]),de.get(Zt).push(Me))}}),console.log(" Grades grouped by course:",{totalGrades:Ke.length,coursesWithGrades:de.size,gradesByCourseId:Array.from(de.entries()).map(([Me,$e])=>({courseId:Me,courseIdType:typeof Me,gradeCount:$e.length}))});const Fe=new Map;Je.forEach(Me=>{const $e=Me.course_id;if(Fe.has($e)||Fe.set($e,[]),Fe.get($e).push(Me),typeof $e=="number")Fe.has(String($e))||Fe.set(String($e),[]),Fe.get(String($e)).push(Me);else if(typeof $e=="string"){const Zt=Number($e);isNaN(Zt)||(Fe.has(Zt)||Fe.set(Zt,[]),Fe.get(Zt).push(Me))}});let xt=0,He=0,Oe=0,Be=0,it=0,$t=0,zt=0;console.log(" Transforming enrollments to subjects:",{enrollmentsCount:ve.length,coursesCount:Le.length,courseMapSize:Pe.size,enrollmentCourseIds:ve.map(Me=>Me.course_id),availableCourseIds:Array.from(Pe.keys()),enrollmentsWithCourseData:ve.filter(Me=>Me.code&&Me.course_name).length});const Dt=Me=>{let $e=Pe.get(Me.course_id);if($e||($e=Pe.get(Number(Me.course_id))||Pe.get(String(Me.course_id))),!$e&&Me.code&&Me.course_name)if($e={id:Me.course_id,code:Me.code,name:Me.course_name,credits:Me.credits||0,term:Me.term||"first",professor_id:Me.professor_id,professor_name:Me.professor_name,professor_photo_url:Me.professor_photo_url},console.log(" Using course data from enrollment JOIN:",{courseId:$e.id,code:$e.code,name:$e.name,professorName:$e.professor_name,professorPhoto:$e.professor_photo_url?"Yes":"No"}),Pe.set(Me.course_id,$e),typeof Me.course_id=="number")Pe.set(String(Me.course_id),$e);else{const Rt=Number(Me.course_id);isNaN(Rt)||Pe.set(Rt,$e)}if(!$e)return console.warn(" Course not found for enrollment:",{enrollmentId:Me.id,courseId:Me.course_id,courseIdType:typeof Me.course_id,availableCourseIds:Array.from(Pe.keys()),enrollmentHasCourseData:!!(Me.code&&Me.course_name),enrollmentData:Me}),null;console.log(" Processing enrollment:",{enrollmentId:Me.id,courseId:Me.course_id,courseCode:$e.code,courseName:$e.name,enrollmentTerm:Me.term,courseTerm:$e.term,finalTerm:$e.term||Me.term||"first"});let Zt=de.get($e.id)||[];if(Zt.length===0){if(typeof $e.id=="number")Zt=de.get(String($e.id))||[];else if(typeof $e.id=="string"){const Rt=Number($e.id);isNaN(Rt)||(Zt=de.get(Rt)||[])}}let Wt=Fe.get($e.id)||[];if(Wt.length===0){if(typeof $e.id=="number")Wt=Fe.get(String($e.id))||[];else if(typeof $e.id=="string"){const Rt=Number($e.id);isNaN(Rt)||(Wt=Fe.get(Rt)||[])}}console.log(` Course ${$e.code} (ID: ${$e.id}):`,{courseId:$e.id,courseIdType:typeof $e.id,gradesFound:Zt.length,attendanceFound:Wt.length,gradeDetails:Zt.map(Rt=>({id:Rt.id,title:Rt.assessment_title,score:Rt.score,maxPoints:Rt.max_points,courseId:Rt.course_id,courseIdType:typeof Rt.course_id}))});const or=[];let kt=0,vt=0;Zt.forEach(Rt=>{or.push({name:Rt.assessment_title,type:(Rt.assessment_type||"Assessment").charAt(0).toUpperCase()+(Rt.assessment_type||"Assessment").slice(1),status:"Taken",score:Rt.score,maxPoints:Rt.max_points,date:Rt.date||Rt.created_at||null}),kt+=Rt.score,vt+=Rt.max_points,He++,Oe++,Be+=Rt.score,it+=Rt.max_points});let Hr=0,Gr=0;const Di=[];Wt.forEach(Rt=>{Di.push({date:Rt.date,status:Rt.status,createdAt:Rt.created_at,updatedAt:Rt.updated_at}),Rt.status==="present"?(Hr++,$t++,zt++):(Rt.status==="absent"&&(Gr++,xt++),zt++)});const Rn=vt>0?Math.round(kt/vt*100):0,As=Hr+Gr>0?Math.round(Hr/(Hr+Gr)*100):0;let Bs=$e.term||Me.term||"first";return typeof Bs=="string"&&(Bs=Bs.toLowerCase().trim()),Bs!=="first"&&Bs!=="second"&&(Bs="first"),console.log(` Course ${$e.code}: course.term="${$e.term}", enrollment.term="${Me.term}", final term="${Bs}"`),{id:$e.code.split(" ")[0]||$e.code,code:$e.code,name:$e.name||$e.code,term:Bs,grade:Rn,attRate:As,present:Hr,abs:Gr,exams:or.sort((Rt,xa)=>new Date(xa.date||0)-new Date(Rt.date||0)),attendanceRecords:Di.sort((Rt,xa)=>new Date(xa.date)-new Date(Rt.date)),instructor:{name:$e.professor_name||Me.professor_name||"TBA",photo_url:$e.professor_photo_url||Me.professor_photo_url||null,email:"",schedule:"TBA"}}},Tt=ve.map(Dt).filter(Boolean);console.log(" Debug: Enrollment terms from MySQL:",ve.map(Me=>({courseCode:Me.code,term:Me.term,termType:typeof Me.term}))),console.log(" Debug: Processed subject terms:",Tt.map(Me=>({code:Me.code,term:Me.term,termType:typeof Me.term})));const dr=Tt.filter(Me=>{let $e=Me.term||"first";typeof $e=="string"&&($e=$e.toLowerCase().trim());const Zt=$e==="first"||!$e||$e===null||$e===void 0;return console.log(` Subject ${Me.code}: term="${Me.term}" (normalized: "${$e}"), isFirstTerm=${Zt}`),Zt}),jr=Tt.filter(Me=>{let $e=Me.term||"first";typeof $e=="string"&&($e=$e.toLowerCase().trim());const Zt=$e==="second";return console.log(` Subject ${Me.code}: term="${Me.term}" (normalized: "${$e}"), isSecondTerm=${Zt}`),Zt});console.log(" Term separation results:",{totalProcessed:Tt.length,firstTermCount:dr.length,secondTermCount:jr.length,firstTermCodes:dr.map(Me=>Me.code),secondTermCodes:jr.map(Me=>Me.code)}),ve.length>0&&dr.length===0&&console.warn(" WARNING: Enrollments exist but no subjects were created!",{enrollmentsCount:ve.length,enrollments:ve.map(Me=>({id:Me.id,course_id:Me.course_id,hasCode:!!Me.code,hasCourseName:!!Me.course_name,code:Me.code,course_name:Me.course_name})),coursesDataCount:Le.length,courseMapSize:Pe.size}),console.log(" Transform complete:",{firstTermSubjects:dr.length,secondTermSubjects:jr.length,enrollmentsProcessed:ve.length,totalAbsences:xt,examsTaken:Oe,totalExams:He,avgGrade:it>0?Math.round(Be/it*100):0,attRate:zt>0?Math.round($t/zt*100):0,firstTermCodes:dr.map(Me=>`${Me.code} (term: ${Me.term})`),secondTermCodes:jr.map(Me=>`${Me.code} (term: ${Me.term})`)});const Qr=it>0?Math.round(Be/it*100):0,Un=zt>0?Math.round($t/zt*100):0,Nn={id:"student",name:Se,abs:xt,examTaken:Oe,examTotal:He,attRate:Un,avgGrade:Qr,firstTerm:Array.isArray(dr)?dr:[],secondTerm:Array.isArray(jr)?jr:[],notifs:jt};return console.log(" Final transformed data:",{firstTermCount:Nn.firstTerm.length,firstTermSubjects:Nn.firstTerm.map(Me=>({code:Me.code,name:Me.name}))}),Nn},K=()=>{let ve=0,Le=0,Ke=0,Je=0,Se=0,Pe=0,Ie=0;[...Array.isArray(e.firstTerm)?e.firstTerm:[],...Array.isArray(e.secondTerm)?e.secondTerm:[]].forEach(He=>{(He.attendanceRecords||[]).forEach(it=>{it!=null&&it.status&&(Se++,it.status==="present"?Je++:it.status==="absent"&&ve++)}),(He.exams||[]).forEach(it=>{Ke++,it.status==="Taken"&&it.score!==void 0&&it.maxPoints!==void 0&&(Le++,Pe+=it.score||0,Ie+=it.maxPoints||0)})});const Fe=Se>0?Math.round(Je/Se*100):0,xt=Ie>0?Math.round(Pe/Ie*100):0;return{absences:ve,examsCompleted:Le,totalExams:Ke,attendanceRate:Fe,averageGrade:xt}},Y=()=>{if(e&&e.firstTerm&&e.firstTerm.length>0){let it=0,$t=0,zt=0,Dt=0,Tt=0,dr=0,jr=0;e.firstTerm.forEach(Nn=>{Nn.abs!==void 0&&(it+=Nn.abs||0),Nn.attendanceRecords&&Array.isArray(Nn.attendanceRecords)&&Nn.attendanceRecords.forEach(Me=>{Me.status==="present"?(dr++,jr++):Me.status==="absent"&&(it++,jr++)}),Nn.exams&&Array.isArray(Nn.exams)&&Nn.exams.forEach(Me=>{$t++,Me.status==="Taken"&&Me.score!==void 0&&Me.maxPoints!==void 0&&(zt++,Dt+=parseFloat(Me.score)||0,Tt+=parseFloat(Me.maxPoints)||0)})});const Qr=jr>0?Math.round(dr/jr*100):0,Un=Tt>0?Math.round(Dt/Tt*100):0;return{absences:it,examsCompleted:zt,totalExams:$t,attendanceRate:Qr,averageGrade:Un}}const ve=In.filter(it=>it.status==="absent").length,Le=Gn.filter(it=>it.score!==void 0&&it.score!==null&&it.max_points!==void 0&&it.max_points!==null),Ke=Le.length,Je=Gn.length,Se=In.filter(it=>it.status==="present").length,Pe=In.length,Ie=Pe>0?Math.round(Se/Pe*100):0;let de=0,Fe=0;Le.forEach(it=>{de+=parseFloat(it.score)||0,Fe+=parseFloat(it.max_points)||0});const xt=Fe>0?Math.round(de/Fe*100):0,He=K(),Oe=In.length>0,Be=Gn.length>0;return{absences:Oe?ve:He.absences,examsCompleted:Be?Ke:He.examsCompleted,totalExams:Be?Je:He.totalExams,attendanceRate:Oe?Ie:He.attendanceRate,averageGrade:Be?xt:He.averageGrade}};G.useEffect(()=>{if(Q&&ir&&(!Array.isArray(jt)||jt.length===0)){console.log(" Auto-loading notifications when dropdown opens (empty array)");const ve=setTimeout(()=>{X()},200);return()=>clearTimeout(ve)}},[Q,ir,X,jt]),G.useEffect(()=>{const ve=Le=>{Q&&!Le.target.closest(".relative")&&ae(!1),Ae&&!Le.target.closest(".relative")&&st(!1)};return document.addEventListener("mousedown",ve),()=>document.removeEventListener("mousedown",ve)},[Q,Ae]),G.useEffect(()=>{if(le){const ve=(Qe==null?void 0:Qe.photo_url)||(Qe==null?void 0:Qe.photoURL)||Ve;Qt.current=ve,Qe?(Mt({name:Qe.name||ot,pic:null,removePhoto:!1}),er(ve)):(Mt({name:ot,pic:null,removePhoto:!1}),er(Ve)),Rr(!1)}else Qt.current!==null&&(er(Qt.current),Mt(ve=>({...ve,pic:null,removePhoto:!1})))},[le,Qe,ot,Ve]);const ee=()=>{sessionStorage.removeItem("currentUser"),t("/login",{replace:!0})},Ee=()=>{Vs(!0)},De=()=>{Vs(!1)},xe=ve=>ve>=90?"text-emerald-600":ve>=85?"text-blue-600":ve>=75?"text-amber-600":"text-red-600",be=ve=>ve>=90?"bg-emerald-600":ve>=85?"bg-blue-600":ve>=75?"bg-amber-600":"bg-red-600",Te=(ve,Le)=>{d({...ve,term:Le}),c(!0),L("all"),V(""),ct("date"),ft("desc"),ze(1),_e({})},We=()=>{c(!1),d(null),L("all"),V(""),ct("date"),ft("desc"),ze(1),_e({})},at=ve=>{let Le=null;if(ve.exams&&Array.isArray(ve.exams)&&ve.exams.length>0){const Ke=ve.exams.map(Je=>{if(Je.date){const Se=new Date(Je.date);return isNaN(Se.getTime())?null:Se}return null}).filter(Je=>Je!==null);if(Ke.length>0){const Je=new Date(Math.max(...Ke.map(Se=>Se.getTime())));(!Le||Je>Le)&&(Le=Je)}}if(ve.attendanceRecords&&Array.isArray(ve.attendanceRecords)&&ve.attendanceRecords.length>0){const Ke=ve.attendanceRecords.map(Je=>{if(Je.date){const Se=new Date(Je.date);return isNaN(Se.getTime())?null:Se}return null}).filter(Je=>Je!==null);if(Ke.length>0){const Je=new Date(Math.max(...Ke.map(Se=>Se.getTime())));(!Le||Je>Le)&&(Le=Je)}}if(ve.enrolledAt){const Ke=new Date(ve.enrolledAt);isNaN(Ke.getTime())||(!Le||Ke>Le)&&(Le=Ke)}if(Le){const Ke=new Date;return Ke.setFullYear(Ke.getFullYear()-1),Le<Ke}return!1},wt=ve=>{if(!ve||!Array.isArray(ve))return[];const Le=ve.filter(Pe=>at(Pe)),Ke=ve.filter(Pe=>!at(Pe));let Se=(p==="archived"?Le:Ke).filter(Pe=>{const Ie=h.toLowerCase(),de=(Pe.name||"").toLowerCase(),Fe=(Pe.code||"").toLowerCase(),xt=(Pe.id||"").toLowerCase();return de.includes(Ie)||Fe.includes(Ie)||xt.includes(Ie)});return p!=="all"&&p!=="archived"&&(Se=Se.filter(Pe=>p==="first"?!Pe.term||Pe.term==="first":p==="second"?Pe.term==="second":!0)),Se.sort((Pe,Ie)=>{let de,Fe;switch(v){case"name":de=(Pe.name||"").toLowerCase(),Fe=(Ie.name||"").toLowerCase();break;case"code":de=(Pe.code||"").toLowerCase(),Fe=(Ie.code||"").toLowerCase();break;case"grade":de=Pe.grade||0,Fe=Ie.grade||0;break;case"attendance":de=Pe.attRate||0,Fe=Ie.attRate||0;break;default:de=(Pe.name||"").toLowerCase(),Fe=(Ie.name||"").toLowerCase()}return E==="asc"?de>Fe?1:de<Fe?-1:0:de<Fe?1:de>Fe?-1:0}),Se},nt=ve=>{const Le=(w-1)*J,Ke=Le+J;return ve.slice(Le,Ke)};G.useEffect(()=>{B(1)},[h,p,v,E]);const pt=ve=>!ve||ve==="Student"?"SU":ve.split(/\s+/).filter(Boolean).map(Le=>Le[0]).slice(0,2).join("").toUpperCase(),Ut=ve=>{if(ve){Mt(Ke=>({...Ke,pic:ve,removePhoto:!1}));const Le=new FileReader;Le.onload=Ke=>{er(Ke.target.result)},Le.readAsDataURL(ve)}else Mt(Le=>({...Le,pic:null,removePhoto:!1})),er(Ve)},sr=()=>{console.log("Removing profile picture");const ve=document.getElementById("student-profile-picture");ve&&(ve.value=""),Mt(Le=>({...Le,pic:null,removePhoto:!0})),er(null),ge(null),console.log("Profile picture removed - avatar updated immediately")},ur=ve=>new Promise((Le,Ke)=>{const Je=new FileReader;Je.onload=Se=>{const Pe=new Image;Pe.onload=()=>{const Ie=document.createElement("canvas"),de=800,Fe=800;let xt=Pe.width,He=Pe.height;xt>He?xt>de&&(He=He*de/xt,xt=de):He>Fe&&(xt=xt*Fe/He,He=Fe),Ie.width=xt,Ie.height=He,Ie.getContext("2d").drawImage(Pe,0,0,xt,He);const Be=Ie.toDataURL("image/jpeg",.8);Le(Be)},Pe.onerror=Ke,Pe.src=Se.target.result},Je.onerror=Ke,Je.readAsDataURL(ve)}),kr=async ve=>{var Je,Se,Pe;if(ve.preventDefault(),mn(""),!W){mn("Unable to determine your account. Please sign in again.");return}const Le=((Je=Ft.name)==null?void 0:Je.trim())||"";if(!Le){mn("Please enter your name.");return}if(Le.length<2){mn("Name must be at least 2 characters long.");return}if(Le.length>100){mn("Name must be less than 100 characters.");return}let Ke=Ve;if(Ft.removePhoto||Ot===null&&Ve&&!Ft.pic)Ke=null;else if(Ft.pic){const Ie=Ft.pic;if(!Ie.type.startsWith("image/")){mn("Please select a valid image file.");return}const de=10*1024*1024;if(Ie.size>de){mn("Image file size must be less than 10MB. Please choose a smaller image.");return}try{Ke=await ur(Ie)}catch(Fe){console.error("Failed to process image file",Fe),mn("Unable to process the selected image. Please try a different file.");return}}try{const Ie={...Qe||{},name:Le,email:et||(Qe==null?void 0:Qe.email)||"",studentId:(Qe==null?void 0:Qe.studentId)||(Qe==null?void 0:Qe.student_id)||"",department:(Qe==null?void 0:Qe.department)||"",photoURL:Ke||null},de=await Rl(W,Ie);if(!de)throw new Error("Failed to save profile to database");Ne(de.name||Le);const Fe=de.photoURL||de.photo_url||Ke;ge(Fe||null),qe(de),er(Fe||null);const xt=sessionStorage.getItem("currentUser");if(xt)try{const He=JSON.parse(xt);He.name=de.name||Le,Fe&&(He.photoURL=Fe),sessionStorage.setItem("currentUser",JSON.stringify(He))}catch(He){console.warn("Failed to update session storage",He)}Rr(!0),setTimeout(()=>{ne(!1),Rr(!1),Mt({name:de.name||ot,pic:null,removePhoto:!1}),er(Fe||null),Qt.current=Fe||null},1500)}catch(Ie){console.error("Failed to save student profile",Ie);let de="Unable to save profile changes right now. Please try again.";Ie.message?Ie.message.includes("Failed to fetch")||Ie.message.includes("NetworkError")?de="Cannot connect to server. Please ensure the backend server is running on http://localhost:5000":Ie.message.includes("401")||Ie.message.includes("Unauthorized")?de="Session expired. Please sign in again.":Ie.message.includes("403")||Ie.message.includes("Forbidden")?de="You do not have permission to perform this action.":Ie.message.includes("404")?de="Profile not found. Please try refreshing the page.":Ie.message.includes("500")?de="Server error. Please try again later.":de=Ie.message:(Pe=(Se=Ie.response)==null?void 0:Se.data)!=null&&Pe.error&&(de=Ie.response.data.error),mn(de),Rr(!1)}},Ur=!Array.isArray(jt)||jt.length===0?Da:jt.filter(Le=>{const Ke=Le.read;return Ke===!1||Ke===0||Ke==="0"||Ke===null||Ke===void 0}).length;return l.jsxs("div",{className:`min-h-screen ${ue?"bg-[#000000]":"bg-white"}`,children:[l.jsx("header",{className:`glass shadow-xl border-b sticky top-0 z-40 ${ue?"bg-[#1a1a1a] border-slate-700":"border-white/20"}`,children:l.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-start sm:items-center py-3 sm:py-4 md:py-6 gap-2 sm:gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 md:space-x-4 min-w-0 flex-shrink",children:[l.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-xl flex items-center justify-center shadowLg overflow-hidden flex-shrink-0",children:l.jsx("img",{src:"/assets/logos/um logo.png",alt:"UM Logo",className:"w-full h-full object-contain"})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("h1",{className:"text-base sm:text-lg md:text-xl lg:text-2xl xl:text-3xl font-bold textGrad",children:"Student iTrack"}),l.jsx("p",{className:`text-[10px] sm:text-xs md:text-sm font-medium ${ue?"text-slate-300":"text-slate-600"}`,children:"Smart Academic Monitoring System"})]})]}),l.jsxs("div",{className:"flex items-start sm:items-center space-x-2 sm:space-x-3 md:space-x-4 lg:space-x-6 flex-shrink-0 ml-auto pt-0.5 sm:pt-0",children:[l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>{const ve=!Q;ae(ve),st(!1),ve&&Ur>0&&(!Array.isArray(jt)||jt.length===0)&&(console.log(" Auto-refreshing notifications on dropdown open (mismatch detected)"),setTimeout(()=>X(),100))},className:`icon-button relative p-2 sm:p-2.5 rounded-lg ${ue?"hover:bg-slate-800/50":"hover:bg-slate-100"}`,children:[l.jsx("svg",{className:`w-4 h-4 sm:w-5 sm:h-5 transition-colors ${ue?"text-white hover:text-slate-200":"text-slate-600"}`,fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"})}),Ur>0&&l.jsx("span",{className:"absolute -top-0.5 -right-0.5 sm:-top-1 sm:-right-1 w-4 h-4 sm:w-5 sm:h-5 bg-red-500 text-white text-[10px] sm:text-xs rounded-full flex items-center justify-center badge shadow-lg",children:Ur>9?"9+":Ur})]}),Q&&(()=>{const ve=Pe=>{const Ie=new Date,de=new Date(Pe),Fe=Ie-de,xt=Math.floor(Fe/6e4),He=Math.floor(Fe/36e5),Oe=Math.floor(Fe/864e5);return xt<1?"Just now":xt<60?`${xt} minute${xt!==1?"s":""} ago`:He<24?`${He} hour${He!==1?"s":""} ago`:Oe<7?`${Oe} day${Oe!==1?"s":""} ago`:de.toLocaleDateString("en-US",{month:"short",day:"numeric"})},Le=Array.isArray(jt)?jt:[],Ke=Le.filter(Pe=>{const Ie=Pe.read;return Ie===!1||Ie===0||Ie==="0"||Ie===null||Ie===void 0}),Je=Pe=>{const Ie=Pe.title||"",de=Pe.message||"";return Ie.includes("Due Soon")||de.includes("due soon")||de.includes("overdue")},Se=Pe=>{const Ie=Pe.title||"",de=Pe.message||"";return Ie.includes("Grade Posted")||de.includes("grade")?{text:"View Grade",action:()=>{ae(!1)}}:Ie.includes("Due Soon")||Ie.includes("Assignment")?{text:"View Assignment",action:()=>{ae(!1)}}:Ie.includes("Announcement")?{text:"Read More",action:()=>{ae(!1)}}:Ie.includes("Material")?{text:"View Materials",action:()=>{ae(!1)}}:null};return l.jsxs("div",{className:`fixed sm:absolute left-4 right-4 sm:left-auto sm:right-0 top-16 sm:top-auto mt-0 sm:mt-2 w-auto sm:w-96 md:w-[420px] max-w-[280px] sm:max-w-[420px] max-h-[calc(100vh-5rem)] sm:max-h-[600px] rounded-2xl shadow-2xl border-2 z-50 overflow-hidden flex flex-col ${ue?"bg-[#1a1a1a] border-slate-700":"bg-white border-slate-200"}`,children:[l.jsx("div",{className:`p-2.5 sm:p-4 md:p-5 border-b-2 flex-shrink-0 ${ue?"bg-gradient-to-br from-red-600 via-[#7A1315] to-red-800 border-slate-700":"border-slate-200 bg-gradient-to-br from-red-600 via-[#7A1315] to-red-800"}`,children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsxs("h3",{className:"font-bold text-white text-sm sm:text-lg md:text-xl flex items-center gap-1.5 sm:gap-2",children:[l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"})}),l.jsx("span",{className:"truncate",children:"Notifications"})]}),l.jsx("p",{className:"text-[10px] sm:text-xs text-red-100 mt-0.5 sm:mt-1 font-medium hidden sm:block",children:"Academic Updates & Reminders"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:Pe=>{Pe.stopPropagation(),X()},className:`p-1.5 rounded-lg transition-all ${ue?"hover:bg-red-700/50 text-white":"hover:bg-white/20 text-white"}`,title:"Refresh notifications",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),(()=>{const Pe=Array.isArray(jt)?jt.length:0;return Pe>0&&l.jsx("div",{className:`backdrop-blur-sm px-2 sm:px-3 py-0.5 sm:py-1 rounded-full border ${ue?"bg-yellow-500/90 border-yellow-400":"bg-white/20 border-white/30"}`,children:l.jsx("span",{className:`font-bold text-xs sm:text-sm ${ue?"text-black":"text-white"}`,children:Pe})})})()]})]})}),l.jsx("div",{className:`notification-scroll flex-1 min-h-0 overflow-y-auto max-h-[calc(100vh-20rem)] sm:max-h-[500px] ${ue?"bg-[#1a1a1a]":"bg-gradient-to-b from-slate-50 to-white"}`,style:{scrollbarWidth:"thin",scrollbarColor:ue?"#475569 #1a1a1a":"#cbd5e1 #ffffff"},children:(()=>{let Pe=[];if(Array.isArray(jt))Pe=jt;else if(jt&&typeof jt=="object"){const de=Object.keys(jt);if(console.log(" Rendering: notifications is object with keys:",de),Array.isArray(jt.data))Pe=jt.data,console.log(" Rendering: Found array in .data");else if(Array.isArray(jt.notifications))Pe=jt.notifications,console.log(" Rendering: Found array in .notifications");else if(Array.isArray(jt.items))Pe=jt.items,console.log(" Rendering: Found array in .items");else for(const Fe of de)if(Array.isArray(jt[Fe])){Pe=jt[Fe],console.log(` Rendering: Found array in .${Fe}`);break}}const Ie=Pe.length>0;return console.log(" Rendering check:",{notificationsState:jt,notificationsStateType:typeof jt,isArray:Array.isArray(jt),notificationsArrayLength:Pe.length,hasNotifications:Ie,displayUnreadCount:Ur}),!Ie&&Ur>0&&ir&&(console.warn(" MISMATCH: Badge shows",Ur,"unread but notifications array is empty!"),console.warn(" Click the refresh button () to reload notifications")),!Ie})()?l.jsxs("div",{className:"p-8 sm:p-12 text-center",children:[l.jsx("div",{className:`w-16 h-16 sm:w-20 sm:h-20 mx-auto mb-3 sm:mb-4 rounded-full flex items-center justify-center ${ue?"bg-gradient-to-br from-red-900/30 to-rose-900/30":"bg-gradient-to-br from-red-100 to-rose-100"}`,children:l.jsx("svg",{className:"w-8 h-8 sm:w-10 sm:h-10 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),l.jsx("p",{className:`text-sm sm:text-base font-medium ${ue?"text-slate-300":"text-slate-500"}`,children:"No notifications yet"}),l.jsx("p",{className:"text-xs sm:text-sm mt-1 px-2 text-slate-400",children:"You don't have any notification history at the moment."})]}):l.jsxs(l.Fragment,{children:[Ke.length===0&&l.jsxs("div",{className:"px-4 pt-4 pb-2 text-xs font-medium text-slate-500 flex items-center gap-2",children:[l.jsx("span",{className:"inline-flex w-2 h-2 rounded-full bg-emerald-500"}),l.jsx("span",{children:"No unread notifications. Showing your history."})]}),(()=>{let Pe=Le.length>0?Le:[];if(Pe.length===0){if(console.log(" Rendering: notificationsArray is empty, trying to parse notifications state"),Array.isArray(jt))Pe=jt,console.log(" Rendering: notifications state is array, length:",jt.length);else if(jt&&typeof jt=="object"){const de=Object.keys(jt);if(console.log(" Rendering: notifications is object with keys:",de),Array.isArray(jt.data))Pe=jt.data,console.log(" Rendering: Found array in .data");else if(Array.isArray(jt.notifications))Pe=jt.notifications,console.log(" Rendering: Found array in .notifications");else if(Array.isArray(jt.items))Pe=jt.items,console.log(" Rendering: Found array in .items");else for(const Fe of de)if(Array.isArray(jt[Fe])){Pe=jt[Fe],console.log(` Rendering: Found array in .${Fe}`);break}}}return console.log(" Rendering notifications:",{notificationsArrayLength:Le.length,notificationsToRenderLength:Pe.length,notificationsStateType:typeof jt,isArray:Array.isArray(jt),sample:Pe.slice(0,2).map(de=>({id:de.id,title:de.title}))}),[...Pe].sort((de,Fe)=>{const xt=de.read===!0||de.read===1||de.read==="1",He=Fe.read===!0||Fe.read===1||Fe.read==="1";if(xt!==He)return xt?1:-1;const Oe=new Date(de.created_at||de.createdAt||de.timestamp||0);return new Date(Fe.created_at||Fe.createdAt||Fe.timestamp||0)-Oe}).map(de=>{const Fe=Je(de),xt=Se(de),He=ve(de.created_at||de.createdAt||de.timestamp);return l.jsx("div",{className:`relative m-2 sm:m-3 rounded-xl shadow-md border-2 transition-all duration-200 cursor-pointer group ${ue?"bg-[#1a1a1a]":"bg-white"} ${Fe?"border-[#7A1315]":ue?"border-slate-700":"border-slate-200"} ${de.read?"hover:shadow-lg":"shadow-lg"}`,onClick:()=>{J7(de.id).catch(Be=>{console.error("Error marking notification as read:",Be)});const Oe=jt.map(Be=>Be.id===de.id?{...Be,read:!0}:Be);lr(Oe),pn(Math.max(0,Da-1))},children:l.jsxs("div",{className:"p-2.5 sm:p-4",children:[l.jsxs("div",{className:"flex items-start justify-between mb-1.5 sm:mb-2",children:[l.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[l.jsx("h4",{className:`text-xs sm:text-sm font-bold leading-tight ${ue?Fe?"text-red-400":"text-white":"text-[#7A1315]"}`,children:de.title}),!de.read&&l.jsx("div",{className:`flex-shrink-0 w-1.5 h-1.5 sm:w-2 sm:h-2 rounded-full ${ue?"bg-red-400":"bg-[#7A1315]"}`})]}),l.jsx("button",{type:"button",onClick:Oe=>{Oe.stopPropagation(),Z7(de.id).catch(it=>{console.error("Error deleting notification:",it)});const Be=jt.filter(it=>it.id!==de.id);lr(Be),de.read||pn(Math.max(0,Da-1))},className:`ml-1 sm:ml-2 rounded-full p-0.5 sm:p-1 text-[10px] sm:text-xs font-bold ${ue?"text-slate-300 hover:text-white hover:bg-slate-700":"text-slate-500 hover:text-red-700 hover:bg-red-50"}`,"aria-label":"Delete notification",children:""})]}),l.jsx("p",{className:`text-[11px] sm:text-xs leading-relaxed mb-2 sm:mb-3 ${ue?"text-white":"text-slate-700"}`,children:de.message}),l.jsxs("div",{className:`flex items-center justify-between pt-1.5 sm:pt-2 border-t ${ue?"border-slate-700":"border-slate-100"}`,children:[l.jsx("p",{className:`text-[10px] sm:text-xs font-medium ${ue?"text-slate-400":"text-slate-500"}`,children:He}),xt&&l.jsx("button",{onClick:Oe=>{Oe.stopPropagation();const Be=jt.map(it=>it.id===de.id?{...it,read:!0}:it);lr(Be),pn(Math.max(0,Da-1)),xt.action()},className:"bg-[#7A1315] hover:bg-red-800 text-white text-[10px] sm:text-xs font-semibold px-2.5 sm:px-4 py-1 sm:py-1.5 rounded-lg transition-all duration-200 shadow-sm hover:shadow-md",children:xt.text})]})]})},de.id)})})()]})}),jt.length>0&&l.jsx("div",{className:`p-4 border-t-2 ${ue?"border-slate-700 bg-[#1a1a1a]":"border-slate-200 bg-gradient-to-r from-slate-50 to-red-50"}`,children:l.jsx("button",{onClick:()=>{MA().catch(Ie=>{console.error("Error marking all notifications as read:",Ie)});const Pe=jt.map(Ie=>({...Ie,read:!0}));lr(Pe),pn(0)},className:"w-full text-center text-sm font-bold text-white hover:text-white bg-[#7A1315] hover:bg-red-800 px-4 py-2.5 rounded-lg transition-all duration-200 shadow-sm hover:shadow-md",children:"Clear All Notifications"})})]})})()]}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{type:"button",onClick:()=>{st(!Ae),ae(!1)},className:"flex items-center space-x-1 sm:space-x-2 md:space-x-3 rounded-xl sm:rounded-2xl border border-slate-200 px-2 sm:px-3 py-1.5 sm:py-2 hover:bg-white transition-all focus:outline-none focus:ring-2 focus:ring-maroon-500",children:[l.jsx("div",{className:"w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-gradient-to-r from-red-800 to-red-600 rounded-full flex items-center justify-center text-white font-semibold text-xs sm:text-sm flex-shrink-0",children:Ve&&Ve!=="/assets/images/trisha.jpg"?l.jsx("img",{src:Ve,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):pt(ot)}),l.jsxs("div",{className:"text-left min-w-0 hidden sm:block",children:[l.jsx("p",{className:`text-[10px] md:text-xs uppercase tracking-wide ${ue?"text-slate-300":"text-slate-400"}`,children:"Profile"}),l.jsx("p",{className:`text-xs md:text-sm font-semibold truncate max-w-[80px] md:max-w-none ${ue?"text-white":"text-slate-700"}`,children:ot})]}),l.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-slate-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M6 9l6 6 6-6",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})]}),Ae&&l.jsxs("div",{className:`fixed sm:absolute left-4 right-4 sm:left-auto sm:right-0 top-16 sm:top-auto mt-0 sm:mt-2 w-auto sm:w-56 max-w-[280px] sm:max-w-none rounded-xl shadow-2xl border-2 z-50 overflow-hidden ${ue?"bg-[#1a1a1a] border-slate-700":"bg-white border-slate-200"}`,children:[l.jsx("div",{className:`p-4 border-b ${ue?"border-slate-700":"border-slate-200"}`,children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-red-800 to-red-600 rounded-full flex items-center justify-center text-white font-semibold text-sm flex-shrink-0",children:Ve&&Ve!=="/assets/images/trisha.jpg"?l.jsx("img",{src:Ve,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):pt(ot)}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("p",{className:`text-sm font-semibold truncate ${ue?"text-white":"text-slate-800"}`,children:ot}),l.jsx("p",{className:`text-xs truncate ${ue?"text-slate-400":"text-slate-500"}`,children:et||"Student"})]})]})}),l.jsxs("div",{className:"py-2",children:[l.jsxs("button",{onClick:()=>{ne(!0),st(!1)},className:`w-full px-4 py-3 text-left flex items-center space-x-3 transition-colors ${ue?"hover:bg-slate-800/50 text-white":"hover:bg-slate-50 text-slate-700"}`,children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),l.jsx("span",{className:"text-sm font-medium",children:"Profile Settings"})]}),l.jsxs("button",{onClick:()=>{st(!1),Ee()},className:`w-full px-4 py-3 text-left flex items-center space-x-3 transition-colors ${ue?"hover:bg-red-900/30 text-red-400":"hover:bg-red-50 text-red-600"}`,children:[l.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M16 17v-3H9v-4h7V7l5 5-5 5M14 2a2 2 0 012 2v2h-2V4H4v16h10v-2h2v2a2 2 0 01-2 2H4a2 2 0 01-2-2V4a2 2 0 012-2h10z"})}),l.jsx("span",{className:"text-sm font-medium",children:"Logout"})]})]})]})]})]})]})})}),ut&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-sm w-full mx-4 p-6 border border-slate-200",children:[l.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-2 text-center",children:"Confirm Logout"}),l.jsx("p",{className:"text-sm text-slate-600 mb-6 text-center",children:"Are you sure you want to logout?"}),l.jsxs("div",{className:"flex items-center justify-center gap-3",children:[l.jsx("button",{type:"button",onClick:De,className:"px-4 py-2 rounded-xl text-sm font-semibold border border-slate-300 text-slate-700 bg-white hover:bg-slate-50",children:"Cancel"}),l.jsx("button",{type:"button",onClick:ee,className:"px-4 py-2 rounded-xl text-sm font-semibold text-white bg-[#7A1315] hover:bg-[#8a1a1c] shadow-md",children:"Logout"})]})]})}),l.jsxs("main",{className:"max-w-7xl mx-auto p-3 sm:p-4 md:p-6 space-y-6 sm:space-y-8 fade",children:[l.jsxs("div",{className:`rounded-2xl sm:rounded-3xl shadow-xl p-4 sm:p-6 md:p-8 slide-up ${ue?"bg-[#1a1a1a]":"bg-white"}`,children:[l.jsx("div",{className:"mb-2 sm:mb-3",children:l.jsxs("h2",{className:`text-sm sm:text-base md:text-lg font-medium ${ue?"text-slate-300":"text-slate-600"}`,children:["Welcome, ",l.jsx("span",{className:"text-[#7A1315] font-semibold",children:ot})]})}),l.jsxs("div",{className:"mb-4 sm:mb-6",children:[l.jsx("h2",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-[#7A1315]",children:"Student Academic Summary"}),l.jsx("p",{className:`mt-1 sm:mt-2 text-sm sm:text-base ${ue?"text-slate-300":"text-slate-600"}`,children:"Track assessments, attendance, and grades across all enrolled subjects."})]}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:(()=>{const ve=Y();return console.log(" Dashboard statistics for user:",{studentName:ot,studentMySQLId:ir,enrollmentsCount:An.length,coursesCount:cs.length,gradesCount:Gn.length,attendanceCount:In.length,stats:ve}),[{key:"absences",label:"Absences",value:ve.absences,description:"This semester",iconClass:"bg-rose-100 text-rose-500",iconPath:"M12 14l4-4m0 0l-4-4m4 4H8m8 0a6 6 0 11-12 0 6 6 0 0112 0z",color:"text-slate-900"},{key:"exams",label:"Total Assessments",value:ve.totalExams>0?`${ve.examsCompleted}/${ve.totalExams}`:"N/A",description:ve.totalExams>0?`${Math.round(ve.examsCompleted/ve.totalExams*100)}% completed`:"No assessments recorded",iconClass:"bg-yellow-100 text-yellow-500",iconPath:"M7 7h10M7 11h6m-2 4h6M5 3h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2z",color:"text-slate-900"},{key:"attendance",label:"Attendance Rate",value:`${ve.attendanceRate}%`,description:ve.attendanceRate>=90?"Excellent attendance":ve.attendanceRate>=75?"Good attendance":ve.attendanceRate>=50?"Fair attendance":"Needs improvement",iconClass:"bg-sky-100 text-sky-500",iconPath:"M5 13l4 4L19 7",color:"text-slate-900"},{key:"grade",label:"Average Grade",value:`${ve.averageGrade}%`,description:(ve.averageGrade>=90||ve.averageGrade>=85||ve.averageGrade>=80||ve.averageGrade>=75,"Overall performance"),iconClass:"bg-sky-100 text-sky-500",iconPath:"M12 17l-5 3 1.9-5.4L4 10h6l2-6 2 6h6l-4.9 4.6L17 20z",color:"text-slate-900"}].map(Le=>l.jsx("div",{className:`metric-card rounded-xl sm:rounded-2xl p-4 sm:p-5 shadow-sm relative overflow-hidden border ${ue?"bg-[#1a1a1a] border-slate-700":"bg-white/80 border-white/60"}`,style:{minHeight:"120px"},children:l.jsxs("div",{className:"w-full h-full p-2 sm:p-3 md:p-5 box-border flex flex-col",children:[l.jsx("div",{className:`metric-icon ${Le.iconClass} mb-2 p-1.5 sm:p-2 rounded-lg w-fit`,children:l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:Le.iconPath,strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})})}),l.jsx("p",{className:`text-xs sm:text-sm font-semibold mb-1 ${ue?"text-slate-300":"text-slate-500"}`,children:Le.label}),l.jsx("p",{className:`text-2xl sm:text-3xl md:text-4xl font-bold mb-1 break-words ${ue?"text-white":Le.color}`,children:Le.value}),l.jsx("p",{className:"text-[10px] sm:text-xs mb-1 text-slate-400",children:Le.description})]})},Le.key))})()})]}),l.jsxs("div",{className:`rounded-xl shadow-sm p-4 sm:p-5 md:p-6 slide-up ${ue?"bg-[#1a1a1a]":"bg-white"}`,children:[l.jsxs("div",{className:"mb-4 sm:mb-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 sm:gap-4 mb-4",children:[l.jsx("h2",{className:`text-lg sm:text-xl md:text-2xl font-bold ${ue?"text-white":"text-slate-800"}`,children:p==="all"?"All Subjects":p==="first"?"1st Term Subjects":p==="second"?"2nd Term Subjects":"Archived Subjects"}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[l.jsxs("div",{className:"relative flex-1 sm:min-w-[200px]",children:[l.jsx("input",{type:"text",placeholder:"Search subjects...",value:h,onChange:ve=>m(ve.target.value),className:`w-full px-3 py-2 pl-9 rounded-lg border text-sm ${ue?"bg-[#2c2c2c] border-slate-600 text-white placeholder-slate-400":"bg-white border-slate-300 text-slate-800 placeholder-slate-400"} focus:outline-none focus:ring-2 focus:ring-[#7A1315] focus:border-transparent`}),l.jsx("i",{className:`fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-sm ${ue?"text-slate-400":"text-slate-500"}`})]}),l.jsxs("select",{value:`${v}-${E}`,onChange:ve=>{const[Le,Ke]=ve.target.value.split("-");b(Le),T(Ke)},className:`px-3 py-2 rounded-lg border text-sm ${ue?"bg-[#2c2c2c] border-slate-600 text-white":"bg-white border-slate-300 text-slate-800"} focus:outline-none focus:ring-2 focus:ring-[#7A1315] focus:border-transparent`,children:[l.jsx("option",{value:"name-asc",children:"Name (A-Z)"}),l.jsx("option",{value:"name-desc",children:"Name (Z-A)"}),l.jsx("option",{value:"code-asc",children:"Code (A-Z)"}),l.jsx("option",{value:"code-desc",children:"Code (Z-A)"}),l.jsx("option",{value:"grade-desc",children:"Grade (High to Low)"}),l.jsx("option",{value:"grade-asc",children:"Grade (Low to High)"}),l.jsx("option",{value:"attendance-desc",children:"Attendance (High to Low)"}),l.jsx("option",{value:"attendance-asc",children:"Attendance (Low to High)"})]})]})]}),l.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("button",{onClick:()=>y("all"),className:`px-4 py-2 rounded-lg text-sm font-semibold transition-all ${p==="all"?"bg-[#7A1315] text-white shadow-lg":ue?"bg-[#2c2c2c] text-slate-300 border border-slate-600 hover:bg-[#3c3c3c] hover:border-slate-500":"bg-slate-100 text-slate-700 border border-slate-300 hover:bg-slate-200 hover:border-slate-400"}`,children:"All"}),l.jsx("button",{onClick:()=>y("first"),className:`px-4 py-2 rounded-lg text-sm font-semibold transition-all ${p==="first"?"bg-[#7A1315] text-white shadow-lg":ue?"bg-[#2c2c2c] text-slate-300 border border-slate-600 hover:bg-[#3c3c3c] hover:border-slate-500":"bg-slate-100 text-slate-700 border border-slate-300 hover:bg-slate-200 hover:border-slate-400"}`,children:"1st Term"}),l.jsx("button",{onClick:()=>y("second"),className:`px-4 py-2 rounded-lg text-sm font-semibold transition-all ${p==="second"?"bg-[#7A1315] text-white shadow-lg":ue?"bg-[#2c2c2c] text-slate-300 border border-slate-600 hover:bg-[#3c3c3c] hover:border-slate-500":"bg-slate-100 text-slate-700 border border-slate-300 hover:bg-slate-200 hover:border-slate-400"}`,children:"2nd Term"})]}),l.jsx("div",{className:`h-6 w-px ${ue?"bg-slate-600":"bg-slate-300"}`}),(()=>{const Le=[...(e.firstTerm||[]).map(Ke=>({...Ke,term:"first"})),...(e.secondTerm||[]).map(Ke=>({...Ke,term:"second"}))].filter(Ke=>at(Ke)).length;return l.jsxs("button",{onClick:()=>y("archived"),disabled:Le===0,className:`px-4 py-2 rounded-lg text-sm font-semibold transition-all flex items-center gap-2 ${p==="archived"?ue?"bg-amber-700 text-white shadow-lg border-2 border-amber-600":"bg-amber-600 text-white shadow-lg border-2 border-amber-500":Le===0?ue?"bg-[#2c2c2c] text-slate-600 border border-slate-600 cursor-not-allowed opacity-50":"bg-slate-100 text-slate-400 border border-slate-300 cursor-not-allowed opacity-50":ue?"bg-amber-900/30 text-amber-300 border border-amber-700 hover:bg-amber-900/50 hover:border-amber-600":"bg-amber-50 text-amber-700 border border-amber-300 hover:bg-amber-100 hover:border-amber-400"}`,title:Le===0?"No archived subjects yet":`View ${Le} archived subject${Le!==1?"s":""}`,children:[l.jsx("i",{className:`fa-solid fa-archive ${p==="archived"?"text-white":""}`}),l.jsx("span",{children:"Archived"}),Le>0&&l.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold ${p==="archived"?"bg-white/20 text-white":ue?"bg-amber-700 text-amber-200":"bg-amber-600 text-white"}`,children:Le})]})})()]}),p==="archived"&&([...(e.firstTerm||[]).map(Ke=>({...Ke,term:"first"})),...(e.secondTerm||[]).map(Ke=>({...Ke,term:"second"}))].filter(Ke=>at(Ke)).length>0?l.jsx("div",{className:`mb-4 p-3 sm:p-4 rounded-lg border ${ue?"bg-amber-900/20 border-amber-700/50":"bg-amber-50 border-amber-200"}`,children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${ue?"bg-amber-800/50":"bg-amber-100"}`,children:l.jsx("i",{className:`fa-solid fa-info-circle text-sm ${ue?"text-amber-400":"text-amber-600"}`})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h4",{className:`font-semibold text-sm mb-1 ${ue?"text-amber-300":"text-amber-800"}`,children:"Viewing Archived Subjects"}),l.jsx("p",{className:`text-xs sm:text-sm ${ue?"text-amber-200/80":"text-amber-700"}`,children:"These subjects have no activity for over 1 year. They are kept for historical records but are hidden from your main view by default."})]}),l.jsx("button",{onClick:()=>y("all"),className:`flex-shrink-0 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ${ue?"bg-amber-800/50 text-amber-300 hover:bg-amber-800/70 border border-amber-700":"bg-amber-100 text-amber-700 hover:bg-amber-200 border border-amber-300"}`,children:"View Current"})]})}):null)]}),(()=>{const ve=[...(e.firstTerm||[]).map(Se=>({...Se,term:"first"})),...(e.secondTerm||[]).map(Se=>({...Se,term:"second"}))],Le=wt(ve),Ke=nt(Le),Je=Math.ceil(Le.length/J);return l.jsx(l.Fragment,{children:Le.length>0?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"mb-3 text-sm text-slate-500",children:["Showing ",Ke.length," of ",Le.length," subject",Le.length!==1?"s":""]}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 md:gap-5",children:Ke.map((Se,Pe)=>{const Ie=at(Se);return l.jsxs("div",{onClick:()=>Te(Se,Se.term||"first"),className:`subject-card p-4 sm:p-5 rounded-xl border cursor-pointer transition-all slide-up relative ${ue?Ie?"bg-[#2c2c2c] border-slate-600 hover:border-slate-500 opacity-75":"bg-[#1a1a1a] border-slate-700 hover:border-slate-600":Ie?"bg-slate-50 border-slate-300 hover:border-slate-400 opacity-75":"bg-white border-slate-200 hover:border-slate-300"}`,style:{animationDelay:`${.1*Pe}s`},children:[Ie&&l.jsxs("div",{className:`absolute top-2 right-2 px-2 py-1 rounded text-xs font-medium ${ue?"bg-amber-900/50 text-amber-300 border border-amber-700":"bg-amber-100 text-amber-800 border border-amber-300"}`,children:[l.jsx("i",{className:"fa-solid fa-archive mr-1"})," Archived"]}),l.jsxs("div",{className:"flex justify-between items-start mb-3 sm:mb-4 gap-2",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("h3",{className:`font-bold text-base sm:text-lg ${ue?"text-white":"text-slate-800"} break-words`,children:[Se.id||Se.code," - ",Se.name]}),l.jsxs("p",{className:`text-xs mt-1 ${ue?"text-slate-400":"text-slate-500"}`,children:["Code: ",Se.code," | ",Se.term==="second"?"2nd":"1st"," Term"]}),Se.instructor&&Se.instructor.name&&Se.instructor.name!=="TBA"&&l.jsxs("div",{className:"flex items-center mt-2 gap-2",children:[Se.instructor.photo_url?l.jsx("img",{src:Se.instructor.photo_url,alt:Se.instructor.name,className:"w-6 h-6 rounded-full object-cover border border-slate-200",onError:de=>{const Fe=de.target;Fe.style.display="none";const xt=Fe.parentElement;if(xt&&!xt.querySelector(".prof-initials")){const He=document.createElement("span");He.className="prof-initials w-6 h-6 rounded-full bg-gradient-to-br from-red-600 to-[#7A1315] flex items-center justify-center text-white text-xs font-semibold",He.textContent=pt(Se.instructor.name),xt.appendChild(He)}}}):l.jsx("span",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-red-600 to-[#7A1315] flex items-center justify-center text-white text-xs font-semibold",children:pt(Se.instructor.name)}),l.jsxs("span",{className:"text-xs text-slate-600 font-medium truncate",children:["Prof. ",Se.instructor.name]})]})]}),l.jsxs("div",{className:"text-right flex-shrink-0 ml-2",children:[l.jsxs("div",{className:`text-lg sm:text-xl font-bold ${xe(Se.grade)}`,children:[Se.grade||"N/A","%"]}),l.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500",children:"Current"})]})]}),l.jsx("div",{className:"w-full h-1.5 bg-slate-200 rounded-full overflow-hidden mb-3 sm:mb-4",children:l.jsx("div",{className:`h-full ${be(Se.grade)} progress`,style:{width:`${Se.grade||0}%`}})}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{className:"flex items-center min-w-0",children:[l.jsx("span",{className:"text-[10px] sm:text-xs text-slate-500 mr-1 sm:mr-2",children:"Attendance:"}),l.jsxs("span",{className:`text-[10px] sm:text-xs font-medium ${Se.attRate>=90?"text-emerald-600":Se.attRate>=80?"text-amber-600":"text-red-600"}`,children:[Se.attRate||"N/A","%"]})]}),l.jsx("button",{className:"text-xs text-slate-500 hover:text-slate-700 flex-shrink-0",children:l.jsx("i",{className:"fa-solid fa-chevron-right"})})]})]},Se.id||Se.code||Pe)})}),Je>1&&l.jsxs("div",{className:`flex flex-col sm:flex-row justify-between items-center gap-3 mt-6 pt-4 border-t ${ue?"border-slate-700":"border-slate-200"}`,children:[l.jsxs("div",{className:`text-sm ${ue?"text-slate-400":"text-slate-600"}`,children:["Page ",w," of ",Je]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>B(Se=>Math.max(1,Se-1)),disabled:w===1,className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${w===1?ue?"bg-[#2c2c2c] text-slate-600 cursor-not-allowed":"bg-slate-100 text-slate-400 cursor-not-allowed":ue?"bg-[#2c2c2c] text-white border border-slate-600 hover:bg-[#3c3c3c]":"bg-white text-slate-700 border border-slate-300 hover:bg-slate-50"}`,children:[l.jsx("i",{className:"fa-solid fa-chevron-left mr-1"})," Previous"]}),l.jsxs("button",{onClick:()=>B(Se=>Math.min(Je,Se+1)),disabled:w===Je,className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${w===Je?ue?"bg-[#2c2c2c] text-slate-600 cursor-not-allowed":"bg-slate-100 text-slate-400 cursor-not-allowed":ue?"bg-[#2c2c2c] text-white border border-slate-600 hover:bg-[#3c3c3c]":"bg-white text-slate-700 border border-slate-300 hover:bg-slate-50"}`,children:["Next ",l.jsx("i",{className:"fa-solid fa-chevron-right ml-1"})]})]})]})]}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:`w-20 h-20 mx-auto mb-4 rounded-full flex items-center justify-center ${ue?"bg-slate-800":"bg-slate-100"}`,children:l.jsx("svg",{className:"w-10 h-10 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),l.jsx("h3",{className:`text-lg font-semibold mb-2 ${ue?"text-slate-300":"text-slate-700"}`,children:h?"No subjects found":"Not Enrolled in Any Subjects"}),l.jsx("p",{className:`text-sm max-w-md mx-auto ${ue?"text-slate-400":"text-slate-500"}`,children:h?`No subjects match "${h}". Try adjusting your search or filters.`:"You are not currently enrolled in any subjects. Please contact your professor to be enrolled in subjects."}),h&&l.jsx("button",{onClick:()=>{m(""),y("all")},className:"mt-4 px-4 py-2 rounded-lg text-sm font-medium transition-colors bg-[#7A1315] text-white hover:bg-[#8a2325]",children:"Clear Filters"})]})})})()]})]}),o&&u&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-3 sm:p-4 z-50",onClick:We,children:l.jsxs("div",{className:`rounded-xl p-4 sm:p-6 w-full max-w-4xl max-h-[95vh] sm:max-h-[90vh] overflow-y-auto custom-scroll shadow-2xl modal-appear ${ue?"bg-[#1a1a1a]":"bg-white"}`,onClick:ve=>ve.stopPropagation(),children:[l.jsx("div",{className:`modal-sticky-header mb-4 sm:mb-6 pb-3 sm:pb-4 pt-3 sm:pt-4 border-b shadow-sm ${ue?"bg-[#1a1a1a] border-slate-700":"border-slate-200"}`,children:l.jsxs("div",{className:"flex justify-between items-start sm:items-center gap-2",children:[l.jsxs("div",{className:"min-w-0 flex-1 pr-2",children:[l.jsxs("h3",{className:`text-base sm:text-lg md:text-xl font-bold ${ue?"text-white":"text-slate-800"} break-words`,children:[u.id," - ",u.name]}),l.jsxs("p",{className:`text-xs sm:text-sm mt-1 ${ue?"text-slate-200":"text-slate-600"} break-words`,children:["Subject Code: ",u.code," | ",u.term==="first"?"1st":"2nd"," Term Subject"]})]}),l.jsx("button",{onClick:We,className:`w-8 h-8 sm:w-10 sm:h-10 flex items-center justify-center transition-colors rounded-full border shadow-md flex-shrink-0 ${ue?"text-white hover:text-slate-200 bg-[#1a1a1a] border-slate-600 hover:bg-[#2c2c2c] hover:border-slate-500":"text-slate-600 hover:text-slate-800 bg-white border-slate-200 hover:bg-slate-100"}`,children:l.jsx("i",{className:"fa-solid fa-xmark text-base sm:text-lg"})})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-5",children:[l.jsxs("div",{className:"md:col-span-2 space-y-4 sm:space-y-5",children:[l.jsxs("div",{className:`p-5 rounded-xl border ${ue?"bg-[#1a1a1a] border-slate-700":"bg-slate-50 border-slate-200"}`,children:[l.jsx("h4",{className:`text-lg font-bold mb-2 ${ue?"text-white":"text-slate-800"}`,children:"Grade Performance"}),l.jsx("p",{className:`text-sm mb-4 ${ue?"text-slate-300":"text-slate-500"}`,children:"Your current grade for this subject"}),l.jsx("div",{className:"flex items-center justify-between mb-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${ue?"bg-red-900/30":"bg-red-100"}`,children:l.jsx("i",{className:`fa-solid fa-graduation-cap ${ue?"text-red-400":"text-red-600"}`})}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:`text-xs ${ue?"text-slate-400":"text-slate-500"}`,children:"Current Grade"}),l.jsxs("span",{className:`text-2xl font-bold ${xe(u.grade)}`,children:[u.grade||"N/A","%"]})]})]})}),l.jsx("div",{className:`w-full rounded-full h-2 overflow-hidden ${ue?"bg-slate-700":"bg-slate-200"}`,children:l.jsx("div",{className:`h-full ${be(u.grade)} progress grade-progress`,style:{width:`${u.grade||0}%`}})})]}),u.exams&&u.exams.length>0&&(()=>{let ve=u.exams.filter(de=>C==="all"?!0:(de.type||"").toLowerCase()===C.toLowerCase());if(F){const de=F.toLowerCase();ve=ve.filter(Fe=>{const xt=(Fe.name||"").toLowerCase(),He=(Fe.type||"").toLowerCase();return xt.includes(de)||He.includes(de)})}ve.sort((de,Fe)=>{let xt,He;switch(O){case"date":xt=de.date?new Date(de.date).getTime():0,He=Fe.date?new Date(Fe.date).getTime():0;break;case"name":xt=(de.name||"").toLowerCase(),He=(Fe.name||"").toLowerCase();break;case"score":xt=de.score!==void 0?de.score/(de.maxPoints||100):0,He=Fe.score!==void 0?Fe.score/(Fe.maxPoints||100):0;break;case"type":xt=(de.type||"").toLowerCase(),He=(Fe.type||"").toLowerCase();break;default:xt=de.date?new Date(de.date).getTime():0,He=Fe.date?new Date(Fe.date).getTime():0}return me==="asc"?xt>He?1:xt<He?-1:0:xt<He?1:xt>He?-1:0});const Le={};ve.forEach(de=>{const Fe=de.type||"Other";Le[Fe]||(Le[Fe]=[]),Le[Fe].push(de)});const Ke=(rt-1)*ie,Je=Ke+ie,Se=ve.slice(Ke,Je),Pe=Math.ceil(ve.length/ie),Ie={};return u.exams.forEach(de=>{const Fe=de.type||"Other";Ie[Fe]=(Ie[Fe]||0)+1}),l.jsxs("div",{className:`p-4 sm:p-5 rounded-xl border ${ue?"bg-[#1a1a1a] border-slate-700":"bg-slate-50 border-slate-200"}`,children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[l.jsxs("h4",{className:`text-base sm:text-lg font-bold ${ue?"text-white":"text-slate-800"}`,children:["Exams & Grades (",ve.length,")"]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs("div",{className:"relative flex-1 sm:min-w-[150px]",children:[l.jsx("input",{type:"text",placeholder:"Search exams...",value:F,onChange:de=>{V(de.target.value),ze(1)},className:`w-full px-2 py-1.5 pl-7 rounded-lg border text-xs ${ue?"bg-[#2c2c2c] border-slate-600 text-white placeholder-slate-400":"bg-white border-slate-300 text-slate-800 placeholder-slate-400"} focus:outline-none focus:ring-2 focus:ring-[#7A1315] focus:border-transparent`}),l.jsx("i",{className:`fa-solid fa-search absolute left-2 top-1/2 transform -translate-y-1/2 text-xs ${ue?"text-slate-400":"text-slate-500"}`})]}),l.jsxs("select",{value:`${O}-${me}`,onChange:de=>{const[Fe,xt]=de.target.value.split("-");ct(Fe),ft(xt),ze(1)},className:`px-2 py-1.5 rounded-lg border text-xs ${ue?"bg-[#2c2c2c] border-slate-600 text-white":"bg-white border-slate-300 text-slate-800"} focus:outline-none focus:ring-2 focus:ring-[#7A1315] focus:border-transparent`,children:[l.jsx("option",{value:"date-desc",children:"Date (Newest)"}),l.jsx("option",{value:"date-asc",children:"Date (Oldest)"}),l.jsx("option",{value:"name-asc",children:"Name (A-Z)"}),l.jsx("option",{value:"name-desc",children:"Name (Z-A)"}),l.jsx("option",{value:"score-desc",children:"Score (High-Low)"}),l.jsx("option",{value:"score-asc",children:"Score (Low-High)"}),l.jsx("option",{value:"type-asc",children:"Type (A-Z)"})]})]})]}),l.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[l.jsxs("button",{onClick:()=>{L("all"),ze(1)},className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${C==="all"?"bg-[#7A1315] text-white":ue?"bg-[#2c2c2c] text-slate-300 border border-slate-600 hover:bg-[#3c3c3c]":"bg-slate-100 text-slate-700 border border-slate-300 hover:bg-slate-200"}`,children:["All (",u.exams.length,")"]}),Object.keys(Ie).map(de=>l.jsxs("button",{onClick:()=>{L(de.toLowerCase()),ze(1)},className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${C===de.toLowerCase()?"bg-[#7A1315] text-white":ue?"bg-[#2c2c2c] text-slate-300 border border-slate-600 hover:bg-[#3c3c3c]":"bg-slate-100 text-slate-700 border border-slate-300 hover:bg-slate-200"}`,children:[de," (",Ie[de],")"]},de))]}),l.jsx("div",{className:"space-y-3",children:Object.keys(Le).map(de=>{const Fe=Le[de],xt=Ye[de]!==!1,He=xt?Fe:Fe.slice(0,3),Oe=Fe.length>3;return l.jsxs("div",{className:`rounded-lg border overflow-hidden ${ue?"bg-[#1a1a1a] border-slate-700":"bg-white border-slate-200"}`,children:[l.jsxs("button",{onClick:()=>_e(Be=>({...Be,[de]:!xt})),className:`w-full flex items-center justify-between p-3 ${ue?"bg-slate-800/50 hover:bg-slate-800/70":"bg-slate-100 hover:bg-slate-200"} transition-colors`,children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("i",{className:`fa-solid fa-chevron-${xt?"down":"right"} text-xs ${ue?"text-slate-400":"text-slate-600"}`}),l.jsxs("span",{className:`font-semibold text-sm ${ue?"text-white":"text-slate-800"}`,children:[de," (",Fe.length,")"]})]}),Oe&&!xt&&l.jsxs("span",{className:`text-xs ${ue?"text-slate-400":"text-slate-500"}`,children:["+",Fe.length-3," more"]})]}),xt&&l.jsx("div",{className:"p-3 space-y-2",children:He.map((Be,it)=>{const $t=Be.date?(()=>{try{return new Date(Be.date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return Be.date}})():"N/A";return l.jsxs("div",{className:`p-3 rounded-lg border ${ue?"bg-[#1a1a1a] border-slate-700":"bg-slate-50 border-slate-200"}`,children:[l.jsx("div",{className:"mb-2",children:l.jsx("h5",{className:`font-bold text-sm mb-0.5 ${ue?"text-white":"text-slate-800"}`,children:Be.name})}),l.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[l.jsxs("div",{className:`flex flex-col items-center p-2 rounded-lg border ${ue?"bg-slate-800/30 border-slate-700":"bg-white border-slate-200"}`,children:[l.jsx("i",{className:`fa-solid fa-file-lines text-xs mb-1 ${ue?"text-slate-300":"text-slate-600"}`}),l.jsx("span",{className:`text-xs font-medium ${ue?"text-slate-400":"text-slate-500"}`,children:"Score"}),l.jsx("span",{className:`font-bold text-sm ${ue?"text-white":"text-slate-800"}`,children:Be.score!==void 0?`${Be.score}/${Be.maxPoints||100}`:"N/A"})]}),l.jsxs("div",{className:`flex flex-col items-center p-2 rounded-lg border ${Be.status==="Taken"?ue?"bg-emerald-900/30 border-emerald-700":"bg-emerald-50 border-emerald-100":ue?"bg-red-900/30 border-red-700":"bg-red-50 border-red-100"}`,children:[l.jsx("i",{className:`fa-solid ${Be.status==="Taken"?"fa-check-circle":"fa-times-circle"} text-xs mb-1 ${Be.status==="Taken"?ue?"text-emerald-400":"text-emerald-600":ue?"text-red-400":"text-red-600"}`}),l.jsx("span",{className:`text-xs font-medium mb-0.5 ${ue?"text-slate-400":"text-slate-500"}`,children:"Status"}),l.jsx("span",{className:`text-xs font-semibold ${Be.status==="Taken"?ue?"text-emerald-300":"text-emerald-700":ue?"text-red-300":"text-red-700"}`,children:Be.status})]}),l.jsxs("div",{className:`flex flex-col items-center p-2 rounded-lg border ${ue?"bg-slate-800/30 border-slate-700":"bg-white border-slate-200"}`,children:[l.jsx("i",{className:`fa-solid fa-calendar text-xs mb-1 ${ue?"text-slate-300":"text-slate-600"}`}),l.jsx("span",{className:`text-xs font-medium ${ue?"text-slate-400":"text-slate-500"}`,children:"Date"}),l.jsx("span",{className:`text-xs font-semibold ${ue?"text-slate-300":"text-slate-500"}`,children:$t})]})]})]},it)})})]},de)})}),Pe>1&&l.jsxs("div",{className:`flex flex-col sm:flex-row justify-between items-center gap-2 mt-4 pt-4 border-t ${ue?"border-slate-700":"border-slate-200"}`,children:[l.jsxs("div",{className:`text-xs ${ue?"text-slate-400":"text-slate-600"}`,children:["Showing ",Se.length," of ",ve.length," exam",ve.length!==1?"s":""]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>ze(de=>Math.max(1,de-1)),disabled:rt===1,className:`px-2 py-1 rounded-lg text-xs font-medium transition-colors ${rt===1?ue?"bg-[#2c2c2c] text-slate-600 cursor-not-allowed opacity-50":"bg-slate-100 text-slate-400 cursor-not-allowed opacity-50":ue?"bg-[#2c2c2c] text-white border border-slate-600 hover:bg-[#3c3c3c]":"bg-white text-slate-700 border border-slate-300 hover:bg-slate-50"}`,children:[l.jsx("i",{className:"fa-solid fa-chevron-left mr-1"})," Prev"]}),l.jsxs("span",{className:`px-2 py-1 text-xs ${ue?"text-slate-400":"text-slate-600"}`,children:["Page ",rt," of ",Pe]}),l.jsxs("button",{onClick:()=>ze(de=>Math.min(Pe,de+1)),disabled:rt===Pe,className:`px-2 py-1 rounded-lg text-xs font-medium transition-colors ${rt===Pe?ue?"bg-[#2c2c2c] text-slate-600 cursor-not-allowed opacity-50":"bg-slate-100 text-slate-400 cursor-not-allowed opacity-50":ue?"bg-[#2c2c2c] text-white border border-slate-600 hover:bg-[#3c3c3c]":"bg-white text-slate-700 border border-slate-300 hover:bg-slate-50"}`,children:["Next ",l.jsx("i",{className:"fa-solid fa-chevron-right ml-1"})]})]})]})]})})()]}),l.jsx("div",{className:"md:col-span-1 space-y-4 sm:space-y-5",children:l.jsxs("div",{className:`p-4 sm:p-5 rounded-xl border ${ue?"bg-[#1a1a1a] border-slate-700":"bg-slate-50 border-slate-200"}`,children:[l.jsx("h4",{className:`text-base sm:text-lg font-bold mb-3 sm:mb-4 ${ue?"text-white":"text-slate-800"}`,children:"Attendance Summary"}),l.jsxs("div",{className:"space-y-2 sm:space-y-3 mb-3 sm:mb-4",children:[l.jsxs("div",{className:`flex items-center justify-between p-2.5 sm:p-3 rounded-lg border ${ue?"bg-emerald-900/30 border-emerald-700":"bg-emerald-50 border-emerald-100"}`,children:[l.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[l.jsx("i",{className:`fa-solid fa-check-circle text-sm sm:text-base ${ue?"text-emerald-400":"text-emerald-600"}`}),l.jsx("span",{className:`font-medium text-xs sm:text-sm ${ue?"text-slate-200":"text-slate-700"}`,children:"Attendance Rate"})]}),l.jsxs("span",{className:`font-bold text-sm sm:text-base ${ue?"text-emerald-400":"text-emerald-600"}`,children:[u.attRate||"N/A","%"]})]}),l.jsxs("div",{className:`flex items-center justify-between p-2.5 sm:p-3 rounded-lg border ${ue?"bg-red-900/30 border-red-700":"bg-red-50 border-red-100"}`,children:[l.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[l.jsx("i",{className:`fa-solid fa-user-slash text-sm sm:text-base ${ue?"text-red-400":"text-red-600"}`}),l.jsx("span",{className:`font-medium text-xs sm:text-sm ${ue?"text-slate-200":"text-slate-700"}`,children:"Absences"})]}),l.jsx("span",{className:`font-bold text-sm sm:text-base ${ue?"text-red-400":"text-red-600"}`,children:u.abs||"N/A"})]})]}),u.attendanceRecords&&u.attendanceRecords.length>0&&l.jsxs("div",{className:"mt-4",children:[l.jsx("h5",{className:`text-sm font-semibold mb-2 ${ue?"text-slate-200":"text-slate-700"}`,children:"Attendance Records"}),l.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:u.attendanceRecords.map((ve,Le)=>l.jsxs("div",{className:`flex items-center justify-between p-2 rounded-lg text-xs border ${ve.status==="present"?ue?"bg-emerald-900/30 border-emerald-700":"bg-emerald-50 border-emerald-100":ue?"bg-red-900/30 border-red-700":"bg-red-50 border-red-100"}`,children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("i",{className:`fa-solid ${ve.status==="present"?ue?"fa-check-circle text-emerald-400":"fa-check-circle text-emerald-600":ue?"fa-user-slash text-red-400":"fa-user-slash text-red-600"}`}),l.jsx("span",{className:`font-medium capitalize ${ue?"text-slate-200":"text-slate-700"}`,children:ve.status})]}),l.jsx("span",{className:ue?"text-slate-400":"text-slate-500",children:(()=>{try{return new Date(ve.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch{return ve.date}})()})]},Le))})]})]})})]})]})}),le&&l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-3 sm:p-4",onClick:()=>{Qt.current!==null&&(er(Qt.current),ge(Qt.current),Mt(ve=>({...ve,pic:null,removePhoto:!1}))),ne(!1),Rr(!1),Lr("account")},children:l.jsxs("div",{className:`w-full max-w-6xl max-h-[95vh] sm:max-h-[90vh] overflow-hidden rounded-xl sm:rounded-2xl shadow-2xl flex flex-col lg:flex-row ${ue?"bg-[#1a1a1a]":"bg-white"}`,onClick:ve=>ve.stopPropagation(),children:[l.jsxs("div",{className:`lg:w-80 w-full lg:max-w-none flex-shrink-0 ${ue?"bg-[#7A1315]":"bg-gradient-to-b from-[#7A1315] to-red-800"} flex flex-col`,children:[l.jsxs("div",{className:"p-4 sm:p-6 md:p-8 flex flex-col items-center border-b border-red-900/30",children:[l.jsxs("div",{className:"relative mb-3 sm:mb-4 group",children:[l.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 md:w-28 md:h-28 rounded-full border-2 sm:border-4 border-white shadow-xl bg-gradient-to-br from-red-600 to-[#7A1315] flex items-center justify-center overflow-hidden",children:Ot||Ve?l.jsx("img",{src:Ot||Ve,alt:"Profile",className:"w-full h-full object-cover",onError:ve=>{const Le=ve.target,Ke=Le.parentElement;if(Ke){Le.style.display="none";const Je=document.createElement("span");Je.className="text-white text-3xl font-semibold tracking-wide",Je.textContent=pt(Ft.name||ot),Ke.appendChild(Je)}}}):l.jsx("span",{className:"text-white text-xl sm:text-2xl md:text-3xl font-semibold tracking-wide",children:pt(Ft.name||ot)})}),l.jsxs("label",{className:"absolute inset-0 rounded-full bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer flex items-center justify-center",children:[l.jsx("span",{className:"text-white text-[10px] sm:text-xs font-medium",children:"Change Photo"}),l.jsx("input",{type:"file",accept:"image/*",onChange:ve=>Ut(ve.target.files[0]),className:"absolute inset-0 opacity-0 cursor-pointer",disabled:Nr})]})]}),l.jsx("h3",{className:"text-white font-bold text-lg sm:text-xl md:text-2xl text-center mb-1 sm:mb-2 truncate w-full px-2",children:Ft.name||ot}),l.jsx("p",{className:"text-red-100 text-xs sm:text-sm font-medium mb-0.5 sm:mb-1 text-center",children:"Student"}),l.jsx("p",{className:"text-red-200 text-[10px] sm:text-xs mb-0.5 sm:mb-1 text-center w-full px-2 break-words",children:(Qe==null?void 0:Qe.studentId)||(Qe==null?void 0:Qe.student_id)||"Student ID"}),l.jsx("p",{className:"text-red-200 text-[10px] sm:text-xs text-center w-full px-2 break-words",children:et||(Qe==null?void 0:Qe.email)||"Email"})]}),l.jsxs("nav",{className:"flex lg:flex-col flex-row lg:flex-1 py-2 sm:py-4 overflow-x-auto lg:overflow-y-auto",children:[l.jsxs("button",{onClick:()=>Lr("account"),className:`w-full lg:w-full px-4 sm:px-6 py-2 sm:py-3 lg:py-4 text-left text-white font-medium transition-all flex items-center space-x-2 sm:space-x-3 whitespace-nowrap ${Dr==="account"?"bg-red-900/50 lg:border-l-4 border-b-2 lg:border-b-0 border-yellow-400":"hover:bg-red-900/30"}`,children:[l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),l.jsx("span",{className:"text-xs sm:text-sm",children:"Account Settings"})]}),l.jsxs("button",{onClick:()=>Lr("appearance"),className:`w-full lg:w-full px-4 sm:px-6 py-2 sm:py-3 lg:py-4 text-left text-white font-medium transition-all flex items-center space-x-2 sm:space-x-3 whitespace-nowrap ${Dr==="appearance"?"bg-red-900/50 lg:border-l-4 border-b-2 lg:border-b-0 border-yellow-400":"hover:bg-red-900/30"}`,children:[l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})}),l.jsx("span",{className:"text-xs sm:text-sm",children:"Appearance"})]})]}),l.jsx("div",{className:"p-2 sm:p-4 border-t border-red-900/30",children:l.jsx("button",{onClick:()=>{Qt.current!==null&&(er(Qt.current),ge(Qt.current),Mt(ve=>({...ve,pic:null,removePhoto:!1}))),ne(!1),Rr(!1),Lr("account")},className:"w-full px-3 sm:px-4 py-1.5 sm:py-2 bg-red-900/50 hover:bg-red-900/70 text-white text-xs sm:text-sm font-medium rounded-lg transition-all",children:"Close Profile"})})]}),l.jsx("div",{className:`flex-1 overflow-y-auto ${ue?"bg-[#1a1a1a]":"bg-white"}`,children:l.jsxs("div",{className:"max-w-4xl mx-auto p-4 sm:p-6 lg:p-8",children:[Dr==="account"&&l.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:`text-xl sm:text-2xl md:text-3xl font-bold mb-1 sm:mb-2 ${ue?"text-white":"text-slate-800"}`,children:"Account Settings"}),l.jsx("p",{className:`text-sm sm:text-base ${ue?"text-slate-300":"text-slate-600"}`,children:"Manage your personal information"})]}),l.jsxs("div",{className:`rounded-xl sm:rounded-2xl shadow-lg border p-4 sm:p-6 ${ue?"bg-[#1a1a1a] border-slate-700":"bg-white border-slate-200"}`,children:[l.jsx("h3",{className:`text-lg sm:text-xl font-bold mb-3 sm:mb-4 ${ue?"text-white":"text-slate-800"}`,children:"Personal Information"}),l.jsxs("form",{onSubmit:kr,className:"space-y-4 sm:space-y-5",children:[l.jsxs("div",{children:[l.jsx("label",{className:`block text-xs sm:text-sm font-semibold mb-1.5 sm:mb-2 ${ue?"text-white":"text-slate-700"}`,children:"Name"}),l.jsx("input",{type:"text",value:Ft.name,onChange:ve=>Mt(Le=>({...Le,name:ve.target.value})),className:`w-full px-3 sm:px-4 py-2 sm:py-3 border rounded-lg text-sm sm:text-base focus:ring-2 focus:ring-[#7A1315] ${ue?"bg-[#2c2c2c] border-[#7A1315] text-white":"bg-white border-slate-300 text-slate-800"}`,required:!0,disabled:Nr})]}),l.jsxs("div",{children:[l.jsx("label",{className:`block text-xs sm:text-sm font-semibold mb-1.5 sm:mb-2 ${ue?"text-white":"text-slate-700"}`,children:"Student ID"}),l.jsx("input",{type:"text",value:(Qe==null?void 0:Qe.studentId)||(Qe==null?void 0:Qe.student_id)||"",disabled:!0,className:`w-full px-3 sm:px-4 py-2 sm:py-3 border rounded-lg text-sm sm:text-base ${ue?"bg-[#1a1a1a] border-slate-600 text-slate-400":"bg-slate-50 border-slate-300 text-slate-600"}`}),l.jsx("small",{className:`text-[10px] sm:text-xs mt-1 block ${ue?"text-slate-400":"text-slate-500"}`,children:"Your student identification number"})]}),l.jsxs("div",{children:[l.jsx("label",{className:`block text-xs sm:text-sm font-semibold mb-1.5 sm:mb-2 ${ue?"text-slate-200":"text-slate-700"}`,children:"Profile Picture"}),l.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3",children:[l.jsx("input",{id:"student-profile-picture",name:"student-profile-picture",type:"file",accept:"image/*",onChange:ve=>Ut(ve.target.files[0]),className:"file:mr-2 sm:file:mr-4 file:py-1.5 sm:file:py-2 file:px-3 sm:file:px-4 file:rounded-lg file:border-0 file:text-xs sm:file:text-sm file:font-semibold file:bg-[#7A1315] file:text-white hover:file:bg-red-800 text-xs sm:text-sm",disabled:Nr}),(Qt.current||Ot||Ve)&&l.jsx("button",{type:"button",onClick:sr,disabled:Nr,className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg text-xs sm:text-sm font-semibold transition-colors whitespace-nowrap ${ue?"bg-red-900/50 text-red-200 hover:bg-red-900/70 border border-red-700":"bg-red-50 text-red-700 hover:bg-red-100 border border-red-200"} disabled:opacity-50 disabled:cursor-not-allowed`,children:Ot||Ve?"Remove Photo":"Photo Removed"})]}),l.jsx("small",{className:`block text-[10px] sm:text-xs mt-1 ${ue?"text-slate-400":"text-slate-500"}`,children:"Choose a square image for best results"})]}),ls&&l.jsxs("div",{className:`rounded-xl p-4 flex items-center space-x-3 border ${ue?"bg-red-900/30 border-red-700":"bg-red-50 border-red-200"}`,children:[l.jsx("svg",{className:`w-5 h-5 flex-shrink-0 ${ue?"text-red-400":"text-red-600"}`,fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),l.jsx("p",{className:`font-medium ${ue?"text-red-300":"text-red-800"}`,children:ls})]}),Nr&&l.jsxs("div",{className:`rounded-xl p-4 flex items-center space-x-3 border ${ue?"bg-emerald-900/30 border-emerald-700":"bg-emerald-50 border-emerald-200"}`,children:[l.jsx("svg",{className:`w-5 h-5 flex-shrink-0 ${ue?"text-emerald-400":"text-emerald-600"}`,fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),l.jsx("p",{className:`font-medium ${ue?"text-emerald-300":"text-emerald-800"}`,children:"Profile updated successfully! Your changes have been saved."})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:gap-3 sm:space-x-3 pt-3 sm:pt-4",children:[l.jsx("button",{type:"button",onClick:()=>{ne(!1),Rr(!1),Lr("account"),Qe!=null&&Qe.photo_url||Qe!=null&&Qe.photoURL?er(Qe.photo_url||Qe.photoURL):er(null),Mt({name:(Qe==null?void 0:Qe.name)||ot,pic:null})},className:`px-4 sm:px-5 py-2 rounded-lg sm:rounded-xl text-sm sm:text-base font-semibold w-full sm:w-auto ${ue?"bg-slate-700 text-slate-200 hover:bg-slate-600":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:Nr?"Close":"Cancel"}),l.jsx("button",{type:"submit",className:"px-5 sm:px-6 py-2 rounded-lg sm:rounded-xl bg-[#7A1315] text-white text-sm sm:text-base font-semibold hover:bg-red-800 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed w-full sm:w-auto",disabled:Nr,children:Nr?"Saved!":"Save Changes"})]})]})]})]}),Dr==="appearance"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:`text-3xl font-bold mb-2 ${ue?"text-white":"text-slate-800"}`,children:"Appearance"}),l.jsx("p",{className:ue?"text-slate-300":"text-slate-600",children:"Customize your interface theme and display preferences"})]}),l.jsxs("div",{className:`rounded-2xl shadow-lg border p-6 ${ue?"bg-[#1a1a1a] border-slate-700":"bg-white border-slate-200"}`,children:[l.jsx("h3",{className:`text-xl font-bold mb-4 ${ue?"text-white":"text-slate-800"}`,children:"Interface Theme"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:`flex items-center justify-between p-4 rounded-xl border ${ue?"bg-[#2c2c2c] border-slate-700":"bg-slate-50 border-slate-200"}`,children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[ue?l.jsx("svg",{className:"w-8 h-8 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}):l.jsx("svg",{className:"w-8 h-8 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),l.jsxs("div",{children:[l.jsx("p",{className:`font-semibold ${ue?"text-white":"text-slate-800"}`,children:ue?"Dark Mode":"Light Mode"}),l.jsx("p",{className:`text-sm ${ue?"text-slate-400":"text-slate-600"}`,children:ue?"Dark theme for reduced eye strain":"Light theme for better visibility"})]})]}),l.jsx("button",{type:"button",onClick:ni,className:`relative inline-flex h-8 w-16 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-[#7A1315] focus:ring-offset-2 ${ue?"bg-[#7A1315]":"bg-slate-300"}`,"aria-label":"Toggle dark mode",children:l.jsx("span",{className:`inline-block h-6 w-6 transform rounded-full bg-white transition-transform ${ue?"translate-x-9":"translate-x-1"}`})})]}),l.jsx("p",{className:`text-sm ${ue?"text-slate-400":"text-slate-600"}`,children:"The theme applies system-wide to all screens, maintaining consistent readability and navigation across the application."})]})]})]})]})})]})})]})}const $A="firestore_backup_";async function ag(t,e){var s,a;const r=`${$A}${t}_${e}`,n=localStorage.getItem("lastQuotaError");if(n)if(Date.now()-parseInt(n,10)<864e5){const o=E0(r);if(o)return console.log(` Using localStorage backup (quota protection): ${t}/${e}`),o}else localStorage.removeItem("lastQuotaError"),Tl=!1;if(Tl){const i=E0(r);if(i)return i}try{const i=rc(ll,t,e),o=await Of(i);if(o.exists()){const c=o.data();try{localStorage.setItem(r,JSON.stringify({data:c,timestamp:new Date().toISOString(),source:"firestore"}))}catch(u){console.warn("Could not update localStorage backup:",u)}return c}return E0(r)}catch(i){return console.warn(`Firestore read failed for ${t}/${e}, using localStorage backup:`,i.message),(i.code==="resource-exhausted"||(s=i.message)!=null&&s.includes("quota")||(a=i.message)!=null&&a.includes("Quota"))&&(Tl=!0,localStorage.setItem("lastQuotaError",Date.now().toString())),E0(r)}}function E0(t){try{const e=localStorage.getItem(t);if(e){const r=JSON.parse(e);return console.log(`Using localStorage backup for ${t}`),r.data||null}}catch(e){console.warn("Could not read from localStorage backup:",e)}return null}let Tl=!1;const Gb=6e4;async function Ns(t,e,r,n={}){var o,c,u;const s=`${$A}${t}_${e}`,{forceWrite:a,...i}=n;if(Tl&&!a){const d=localStorage.getItem("lastQuotaError");if(d){const h=Date.now()-parseInt(d,10),m=Math.ceil((Gb-h)/1e3);if(h<Gb){console.warn(` Skipping Firestore write (quota cooldown - ${m}s remaining): ${t}/${e}`),console.warn(" Data saved to localStorage only. Use syncBackupToFirestore() after quota resets.");try{localStorage.setItem(s,JSON.stringify({data:r,timestamp:new Date().toISOString(),source:"localStorage"}))}catch(p){console.warn("Could not save to localStorage backup:",p)}return!1}else console.log(" Quota cooldown expired - resuming Firestore writes"),Tl=!1,localStorage.removeItem("lastQuotaError")}}if(!a)try{const d=localStorage.getItem(s);if(d){const h=JSON.parse(d),m=JSON.stringify(h.data),p=JSON.stringify(r);if(m===p&&h.source==="firestore")return console.log(` Skipping Firestore write (no changes detected): ${t}/${e}`),!0;m===p&&h.source==="localStorage"&&console.log(` Retrying Firestore write (data unchanged but not synced): ${t}/${e}`)}}catch(d){console.warn("Data comparison failed, proceeding with write:",d)}try{localStorage.setItem(s,JSON.stringify({data:r,timestamp:new Date().toISOString(),source:"localStorage"}))}catch(d){console.warn("Could not save to localStorage backup:",d)}try{const d=i.merge===!0,h=d?{merge:!0}:{};console.log(` Attempting Firestore write: ${t}/${e}`,{hasMerge:d,forceWrite:a||!1,dataKeys:Object.keys(r||{}),studentsCount:((o=r==null?void 0:r.students)==null?void 0:o.length)||0,enrollsCount:Object.keys((r==null?void 0:r.enrolls)||{}).length,enrollsDetails:r!=null&&r.enrolls?Object.keys(r.enrolls).map(p=>({subject:p,studentCount:(r.enrolls[p]||[]).length})):[]});const m=rc(ll,t,e);await zv(m,r,h);try{localStorage.setItem(s,JSON.stringify({data:r,timestamp:new Date().toISOString(),source:"firestore"}))}catch{}return Tl=!1,localStorage.removeItem("lastQuotaError"),console.log(` Successfully saved to Firestore: ${t}/${e}`),!0}catch(d){return console.error(` Firestore write failed for ${t}/${e}:`,d.message),console.error(" Data saved to localStorage backup only"),d.code==="resource-exhausted"||(c=d.message)!=null&&c.includes("quota")||(u=d.message)!=null&&u.includes("Quota")?(console.warn(" Firestore quota exceeded - data saved to localStorage only"),console.warn(" Tip: Use syncBackupToFirestore() after quota resets to sync pending data"),Tl=!0,localStorage.setItem("lastQuotaError",Date.now().toString())):console.warn("Error details:",d.code,d.message),!1}}const UA="studentDashboards";async function Li(t){if(!t)return null;const e=rc(ll,UA,t),r=await Of(e);return r.exists()?{id:r.id,...r.data()}:null}async function VA(t,e={}){if(!t)return null;const r=rc(ll,UA,t),n=new Date().toISOString(),s={...e,updatedAt:n};try{await NM(r,s)}catch(i){if(i.code==="not-found"){const o={subjects:[],grades:{},attendance:{},notifications:[],createdAt:n,...s};await zv(r,o,{merge:!0})}else throw i}const a=await Of(r);return a.exists()?{id:a.id,...a.data()}:null}async function qb(t,e,r,n,s={}){if(t)try{const a=await Li(t),i=(a==null?void 0:a.attendance)||{},o=(a==null?void 0:a.notifications)||[],c=i[r]||{},u=new Date().toISOString(),d=s.subjectName||null,h=s.dateLabel||r;c[e]=n,i[r]=c;const m=n==="present"?"Present":"Absent",y=[{id:`attendance-${e}-${r}-${Date.now()}`,type:"attendance",title:`${d||e} Attendance`,message:`You were marked ${m} on ${h} for ${d||e}.`,subjectCode:e,subjectName:d,date:r,status:n,read:!1,timestamp:u},...o].slice(0,50);await VA(t,{attendance:i,notifications:y})}catch(a){console.error("Failed to sync student attendance",a)}}async function va(t,e){if(t)try{const r=await Li(t),n=(r==null?void 0:r.subjects)||[],s=(r==null?void 0:r.notifications)||[],a=new Set(n.map(d=>d==null?void 0:d.code).filter(Boolean)),i=(e||[]).filter(d=>!d||!d.code?!1:!a.has(d.code)),o=new Date().toISOString(),c=i.map(d=>({id:`subject-${d.code}-${Date.now()}-${Math.random().toString(36).slice(2,7)}`,type:"subject",title:`${d.code}: Enrollment Confirmed`,message:d.name?`You have been enrolled in ${d.name}.`:`You have been enrolled in subject ${d.code}.`,subjectCode:d.code,subjectName:d.name||d.code,read:!1,timestamp:o})),u={subjects:e};c.length>0&&(u.notifications=[...c,...s].slice(0,50)),await VA(t,u)}catch(r){console.error("Failed to sync student subjects",r)}}var d9={};const f9="professorDashboards",h9=6e4;function m9(){try{return localStorage.getItem("disableRealtimeUpdates")==="true"||d9.REACT_APP_DISABLE_REALTIME==="true"}catch{return!1}}function p9(t,e){if(!t)return console.warn("Cannot subscribe to professor dashboard: No UID provided"),()=>{};if(m9())return console.warn(" Real-time updates disabled to reduce Firestore quota usage"),()=>{};const r=rc(ll,f9,t);let n=0,s=null;return RM(r,i=>{var c;const o=Date.now();if(!(o-n<h9))if(i.exists()){const u=i.data(),d=JSON.stringify({updatedAt:u.updatedAt,alertsCount:(u.alerts||[]).length,alertsLatestId:((c=(u.alerts||[])[0])==null?void 0:c.id)||null,enrollsKeys:Object.keys(u.enrolls||{}).sort().join(","),enrollsTotal:Object.values(u.enrolls||{}).reduce((m,p)=>m+((p==null?void 0:p.length)||0),0),subjectsCount:(u.subjects||[]).length,studentsCount:(u.students||[]).length});if(d===s)return;const h={subjects:u.subjects||[],removedSubjects:u.removedSubjects||[],students:u.students||[],enrolls:u.enrolls||{},alerts:u.alerts||[],updatedAt:u.updatedAt,ownerUid:u.ownerUid};s=d,n=o,console.log("Professor dashboard updated in real-time (minimal data):",{subjects:h.subjects.length,students:h.students.length,alerts:h.alerts.length,enrolls:Object.keys(h.enrolls).length,updatedAt:h.updatedAt}),e(h)}else console.warn("Professor dashboard document does not exist"),e(null)},i=>{var o,c;console.error("Error listening to professor dashboard:",i),(i.code==="resource-exhausted"||(o=i.message)!=null&&o.includes("quota")||(c=i.message)!=null&&c.includes("Quota"))&&console.warn(' Tip: Disable real-time updates to reduce quota usage: localStorage.setItem("disableRealtimeUpdates", "true")')})}function ig(t,e){if(!t||!e)return"";const n=t.trim().toLowerCase().replace(/\s+/g," ").split(" ");if(n.length===0)return"";const s=n[0],a=n.length>1?n[n.length-1]:s;return`${s}.${a}.${e}.tc@umindanao.edu.ph`}function og(t){return t&&/^\d+$/.test(t)}async function xc(t,e){if(!t||!e)return{uid:null,verified:!1,student:null,error:"Missing student ID or email"};try{const r=await ms(t);return r?r.email&&r.email.toLowerCase()!==e.toLowerCase()?(console.warn(`Email mismatch for student ID ${t}: expected ${e}, found ${r.email}`),{uid:null,verified:!1,student:r,error:"Email mismatch - student ID and email do not match"}):{uid:r.firebase_uid||r.firebaseUid||null,verified:!0,student:r,error:null}:{uid:null,verified:!1,student:null,error:"Student not found by ID"}}catch(r){return console.error("Error verifying student ID-email pair:",r),{uid:null,verified:!1,student:null,error:r.message}}}async function qu(t,e=null){if(!t)return null;try{const r=await ms(t);if(r){e&&r.email&&r.email.toLowerCase()!==e.toLowerCase()&&console.warn(`Email mismatch for student ${t}, but proceeding with ID lookup`);const n=r.firebase_uid||r.firebaseUid;return n&&typeof n=="string"&&!n.startsWith("temp_")?n:(console.warn(`Student ${t} has no valid Firebase UID (found: ${n})`),null)}if(e){const n=await Oc(e);if(n){n.studentId&&n.studentId!==t&&console.warn(`Student ID mismatch: expected ${t}, found ${n.studentId}`);const s=n.firebase_uid||n.firebaseUid;return s&&typeof s=="string"&&!s.startsWith("temp_")?s:(console.warn(`Student ${e} has no valid Firebase UID (found: ${s})`),null)}}return null}catch(r){return console.error("Error getting student UID for sync:",r),null}}const g9={S101:"141715",S102:"142177",S103:"141800",S104:"141900"};function x9(t){return t&&typeof t=="string"&&/^S\d+$/.test(t)}function rp(t){return x9(t)?g9[t]||null:t}function v9(t){if(!t||!t.id)return t;const e=rp(t.id),r={...t,archivedSubjects:t.archivedSubjects||[]};return e&&e!==t.id&&(r.id=e),r}function Kb(t){return Array.isArray(t)?t.map(v9):t}function y9(t){if(!t||typeof t!="object")return t;const e={};for(const[r,n]of Object.entries(t))Array.isArray(n)?e[r]=n.map(s=>rp(s)||s):e[r]=n;return e}function w9(t){if(!t||typeof t!="object")return t;const e={};for(const[r,n]of Object.entries(t))if(n&&typeof n=="object"){e[r]={};for(const[s,a]of Object.entries(n))if(a&&typeof a=="object"){e[r][s]={};for(const[i,o]of Object.entries(a)){const c=rp(i)||i;e[r][s][c]=o}}else e[r][s]=a}else e[r]=n;return e}function b9(t){if(!t||typeof t!="object")return t;const e={};for(const[r,n]of Object.entries(t))if(n&&typeof n=="object"){e[r]={};for(const[s,a]of Object.entries(n))Array.isArray(a)?e[r][s]=a.map(i=>{if(i.scores&&typeof i.scores=="object"){const o={};for(const[c,u]of Object.entries(i.scores)){const d=rp(c)||c;o[d]=u}return{...i,scores:o}}return i}):e[r][s]=a}else e[r]=n;return e}function _9(t){return!t||typeof t!="object"?t:{...t,students:Kb(t.students||[]),removedStudents:Kb(t.removedStudents||[]),enrolls:y9(t.enrolls||{}),records:w9(t.records||{}),grades:b9(t.grades||{})}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var BA=1252,S9=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Wv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Hv=function(t){S9.indexOf(t)!=-1&&(BA=Wv[0]=t)};function E9(){Hv(1252)}var Qa=function(t){Hv(t)};function zA(){Qa(1200),E9()}function Qb(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function T9(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function WA(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var id=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?T9(t.slice(2)):e==254&&r==255?WA(t.slice(2)):e==65279?t.slice(1):t},T0=function(e){return String.fromCharCode(e)},Xb=function(e){return String.fromCharCode(e)},df,Co="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Yb(t){for(var e="",r=0,n=0,s=0,a=0,i=0,o=0,c=0,u=0;u<t.length;)r=t.charCodeAt(u++),a=r>>2,n=t.charCodeAt(u++),i=(r&3)<<4|n>>4,s=t.charCodeAt(u++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),e+=Co.charAt(a)+Co.charAt(i)+Co.charAt(o)+Co.charAt(c);return e}function ma(t){var e="",r=0,n=0,s=0,a=0,i=0,o=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)a=Co.indexOf(t.charAt(u++)),i=Co.indexOf(t.charAt(u++)),r=a<<2|i>>4,e+=String.fromCharCode(r),o=Co.indexOf(t.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),c=Co.indexOf(t.charAt(u++)),s=(o&3)<<6|c,c!==64&&(e+=String.fromCharCode(s));return e}var xr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),nc=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Zo(t){return xr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Jb(t){return xr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ga=function(e){return xr?nc(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function sc(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Gv(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Gv(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Eo=xr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:nc(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function k9(t){for(var e=[],r=0,n=t.length+250,s=Zo(t.length+255),a=0;a<t.length;++a){var i=t.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=t.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(e.push(s.slice(0,r)),r=0,s=Zo(65535),n=65530)}return e.push(s.slice(0,r)),Eo(e)}var Os=/\u0000/g,od=/[\u0001-\u0006]/g;function Jc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Xa(t,e){var r=""+t;return r.length>=e?r:on("0",e-r.length)+r}function qv(t,e){var r=""+t;return r.length>=e?r:on(" ",e-r.length)+r}function Jh(t,e){var r=""+t;return r.length>=e?r:r+on(" ",e-r.length)}function A9(t,e){var r=""+Math.round(t);return r.length>=e?r:on("0",e-r.length)+r}function I9(t,e){var r=""+t;return r.length>=e?r:on("0",e-r.length)+r}var Zb=Math.pow(2,32);function vc(t,e){if(t>Zb||t<-Zb)return A9(t,e);var r=Math.round(t);return I9(r,e)}function Zh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var e_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],lg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function C9(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var nr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},t_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},N9={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function em(t,e,r){for(var n=t<0?-1:1,s=t*n,a=0,i=1,o=0,c=1,u=0,d=0,h=Math.floor(s);u<e&&(h=Math.floor(s),o=h*i+a,d=h*u+c,!(s-h<5e-8));)s=1/(s-h),a=i,i=o,c=u,u=d;if(d>e&&(u>e?(d=c,o=a):(d=u,o=i)),!r)return[0,n*o,d];var m=Math.floor(n*o/d);return[m,n*o-m*d,d]}function kl(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),a=0,i=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=L9(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var HA=new Date(1899,11,31,0,0,0),R9=HA.getTime(),P9=new Date(1900,2,1,0,0,0);function GA(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=P9&&(r+=24*60*60*1e3),(r-(R9+(t.getTimezoneOffset()-HA.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Kv(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function j9(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function D9(t){var e=t<0?12:11,r=Kv(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function F9(t){var e=Kv(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function ff(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=D9(t):e===10?r=t.toFixed(10).substr(0,12):r=F9(t),Kv(j9(r.toUpperCase()))}function Hl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):ff(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Na(14,GA(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function L9(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function O9(t,e,r,n){var s="",a=0,i=0,o=r.y,c,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,u=e.length;break;case 3:return lg[r.m-1][1];case 5:return lg[r.m-1][0];default:return lg[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,u=e.length;break;case 3:return e_[r.q][0];default:return e_[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Xa(r.S,e.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),e==="s"?a===0?"0":""+a/i:(s=Xa(a,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?Xa(c,u):"";return d}function No(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var qA=/%/g;function M9(t,e,r){var n=e.replace(qA,""),s=e.length-n.length;return Hi(t,n,r*Math.pow(10,2*s))+on("%",s)}function $9(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Hi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function KA(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+KA(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var QA=/# (\?+)( ?)\/( ?)(\d+)/;function U9(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?on(" ",t[1].length+1+t[4].length):qv(i,t[1].length)+t[2]+"/"+t[3]+Xa(o,t[4].length))}function V9(t,e,r){return r+(e===0?"":""+e)+on(" ",t[1].length+2+t[4].length)}var XA=/^#*0*\.([0#]+)/,YA=/\).*[0#]/,JA=/\(###\) ###\\?-####/;function Ps(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function r_(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function n_(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function B9(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function z9(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function wa(t,e,r){if(t.charCodeAt(0)===40&&!e.match(YA)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?wa("n",n,r):"("+wa("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return $9(t,e,r);if(e.indexOf("%")!==-1)return M9(t,e,r);if(e.indexOf("E")!==-1)return KA(e,r);if(e.charCodeAt(0)===36)return"$"+wa(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+vc(c,e.length);if(e.match(/^[#?]+$/))return s=vc(r,0),s==="0"&&(s=""),s.length>e.length?s:Ps(e.substr(0,e.length-s.length))+s;if(a=e.match(QA))return U9(a,c,u);if(e.match(/^#+0+$/))return u+vc(c,e.length-e.indexOf("0"));if(a=e.match(XA))return s=r_(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Ps(a[1])).replace(/\.$/,"."+Ps(a[1])).replace(/\.(\d*)$/,function(y,v){return"."+v+on("0",Ps(a[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return u+r_(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return u+No(vc(c,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+wa(t,e,-r):No(""+(Math.floor(r)+B9(r,a[1].length)))+"."+Xa(n_(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return wa(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Jc(wa(t,e.replace(/[\\-]/g,""),r)),i=0,Jc(Jc(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return i<s.length?s.charAt(i++):y==="0"?"0":""}));if(e.match(JA))return s=wa(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=em(c,Math.pow(10,i)-1,!1),s=""+u,d=Hi("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=Jh(o[2],i),d.length<a[4].length&&(d=Ps(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=em(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?qv(o[1],i)+a[2]+"/"+a[3]+Jh(o[2],i):on(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=vc(r,0),e.length<=s.length?s:Ps(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=e.indexOf(".")-i,m=e.length-s.length-h;return Ps(e.substr(0,h)+s+e.substr(e.length-m))}if(a=e.match(/^00,000\.([#0]*0)$/))return i=n_(r,a[1].length),r<0?"-"+wa(t,e,-r):No(z9(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Xa(0,3-y.length):"")+y})+"."+Xa(i,a[1].length);switch(e){case"###,##0.00":return wa(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=No(vc(c,0));return p!=="0"?u+p:"";case"###,###.00":return wa(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return wa(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function W9(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Hi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function H9(t,e,r){var n=e.replace(qA,""),s=e.length-n.length;return Hi(t,n,r*Math.pow(10,2*s))+on("%",s)}function ZA(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+ZA(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function hi(t,e,r){if(t.charCodeAt(0)===40&&!e.match(YA)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?hi("n",n,r):"("+hi("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return W9(t,e,r);if(e.indexOf("%")!==-1)return H9(t,e,r);if(e.indexOf("E")!==-1)return ZA(e,r);if(e.charCodeAt(0)===36)return"$"+hi(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Xa(c,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Ps(e.substr(0,e.length-s.length))+s;if(a=e.match(QA))return V9(a,c,u);if(e.match(/^#+0+$/))return u+Xa(c,e.length-e.indexOf("0"));if(a=e.match(XA))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Ps(a[1])).replace(/\.$/,"."+Ps(a[1])),s=s.replace(/\.(\d*)$/,function(y,v){return"."+v+on("0",Ps(a[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return u+No(""+c);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+hi(t,e,-r):No(""+r)+"."+on("0",a[1].length);if(a=e.match(/^#,#*,#0/))return hi(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Jc(hi(t,e.replace(/[\\-]/g,""),r)),i=0,Jc(Jc(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return i<s.length?s.charAt(i++):y==="0"?"0":""}));if(e.match(JA))return s=hi(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=em(c,Math.pow(10,i)-1,!1),s=""+u,d=Hi("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=Jh(o[2],i),d.length<a[4].length&&(d=Ps(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=em(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?qv(o[1],i)+a[2]+"/"+a[3]+Jh(o[2],i):on(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Ps(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=e.indexOf(".")-i,m=e.length-s.length-h;return Ps(e.substr(0,h)+s+e.substr(e.length-m))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+hi(t,e,-r):No(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Xa(0,3-y.length):"")+y})+"."+Xa(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=No(""+c);return p!=="0"?u+p:"";default:if(e.match(/\.[0#?]*$/))return hi(t,e.slice(0,e.lastIndexOf(".")),r)+Ps(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Hi(t,e,r){return(r|0)===r?hi(t,e,r):wa(t,e,r)}function G9(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var eI=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Au(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Zh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(eI))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function q9(t,e,r,n){for(var s=[],a="",i=0,o="",c="t",u,d,h,m="H";i<t.length;)switch(o=t.charAt(i)){case"G":if(!Zh(t,i))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(h=t.charCodeAt(++i))!==34&&i<t.length;)a+=String.fromCharCode(h);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=t.charAt(++i),y=p==="("||p===")"?p:"t";s[s.length]={t:y,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:e},++i;break;case"B":case"b":if(t.charAt(i+1)==="1"||t.charAt(i+1)==="2"){if(u==null&&(u=kl(e,r,t.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:t.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=kl(e,r),u==null))return"";for(a=o;++i<t.length&&t.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),s[s.length]={t:o,v:a},c=o;break;case"A":case"a":case"":var v={t:o,v:o};if(u==null&&(u=kl(e,r)),t.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(v.v=u.H>=12?"P":"A"),v.t="T",m="h",i+=3):t.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(v.v=u.H>=12?"PM":"AM"),v.t="T",i+=5,m="h"):t.substr(i,5).toUpperCase()==="/"?(u!=null&&(v.v=u.H>=12?"":""),v.t="T",i+=5,m="h"):(v.t="t",++i),u==null&&v.t==="T")return"";s[s.length]=v,c=o;break;case"[":for(a=o;t.charAt(i++)!=="]"&&i<t.length;)a+=t.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(eI)){if(u==null&&(u=kl(e,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Au(t)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<t.length&&(o=t.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;t.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},c=o;break;case"*":++i,(t.charAt(i)==" "||t.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<t.length&&"0123456789".indexOf(t.charAt(++i))>-1;)a+=t.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++i;break}var b=0,E=0,T;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=m,c="h",b<1&&(b=1);break;case"s":(T=s[i].v.match(/\.0+$/))&&(E=Math.max(E,T[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&s[i].v.match(/[Hh]/)&&(b=1),b<2&&s[i].v.match(/[Mm]/)&&(b=2),b<3&&s[i].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var w="",B;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=O9(s[i].t.charCodeAt(0),s[i].v,u,E),s[i].t="t";break;case"n":case"?":for(B=i+1;s[B]!=null&&((o=s[B].t)==="?"||o==="D"||(o===" "||o==="t")&&s[B+1]!=null&&(s[B+1].t==="?"||s[B+1].t==="t"&&s[B+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[B].v==="/"||s[B].v===" "&&s[B+1]!=null&&s[B+1].t=="?"));)s[i].v+=s[B].v,s[B]={v:"",t:";"},++B;w+=s[i].v,i=B-1;break;case"G":s[i].t="t",s[i].v=Hl(e,r);break}var J="",Z,_;if(w.length>0){w.charCodeAt(0)==40?(Z=e<0&&w.charCodeAt(0)===45?-e:e,_=Hi("n",w,Z)):(Z=e<0&&n>1?-e:e,_=Hi("n",w,Z),Z<0&&s[0]&&s[0].t=="t"&&(_=_.substr(1),s[0].v="-"+s[0].v)),B=_.length-1;var I=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){I=i;break}var C=s.length;if(I===s.length&&_.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(B>=s[i].v.length-1?(B-=s[i].v.length,s[i].v=_.substr(B+1,s[i].v.length)):B<0?s[i].v="":(s[i].v=_.substr(0,B+1),B=-1),s[i].t="t",C=i);B>=0&&C<s.length&&(s[C].v=_.substr(0,B+1)+s[C].v)}else if(I!==s.length&&_.indexOf("E")===-1){for(B=_.indexOf(".")-1,i=I;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(d=s[i].v.indexOf(".")>-1&&i===I?s[i].v.indexOf(".")-1:s[i].v.length-1,J=s[i].v.substr(d+1);d>=0;--d)B>=0&&(s[i].v.charAt(d)==="0"||s[i].v.charAt(d)==="#")&&(J=_.charAt(B--)+J);s[i].v=J,s[i].t="t",C=i}for(B>=0&&C<s.length&&(s[C].v=_.substr(0,B+1)+s[C].v),B=_.indexOf(".")+1,i=I;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==I)){for(d=s[i].v.indexOf(".")>-1&&i===I?s[i].v.indexOf(".")+1:0,J=s[i].v.substr(0,d);d<s[i].v.length;++d)B<_.length&&(J+=_.charAt(B++));s[i].v=J,s[i].t="t",C=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(Z=n>1&&e<0&&i>0&&s[i-1].v==="-"?-e:e,s[i].v=Hi(s[i].t,s[i].v,Z),s[i].t="t");var L="";for(i=0;i!==s.length;++i)s[i]!=null&&(L+=s[i].v);return L}var s_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function a_(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function K9(t,e){var r=G9(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(s_),o=r[1].match(s_);return a_(e,i)?[n,r[0]]:a_(e,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function Na(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:nr)[t],n==null&&(n=r.table&&r.table[t_[t]]||nr[t_[t]]),n==null&&(n=N9[t]||"General");break}if(Zh(n,0))return Hl(e,r);e instanceof Date&&(e=GA(e,r.date1904));var s=K9(n,e);if(Zh(s[1]))return Hl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return q9(s[1],e,r,s[0])}function Pl(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(nr[r]==null){e<0&&(e=r);continue}if(nr[r]==t){e=r;break}}e<0&&(e=391)}return nr[e]=t,e}function tI(){nr=C9()}var Q9={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},rI=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function X9(t){var e=typeof t=="number"?nr[t]:t;return e=e.replace(rI,"(\\d+)"),new RegExp("^"+e+"$")}function Y9(t,e,r){var n=-1,s=-1,a=-1,i=-1,o=-1,c=-1;(e.match(rI)||[]).forEach(function(h,m){var p=parseInt(r[m+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":c=p;break;case"m":i>=0?o=p:s=p;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var J9=function(){var t={};t.version="1.2.0";function e(){for(var _=0,I=new Array(256),C=0;C!=256;++C)_=C,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,I[C]=_;return typeof Int32Array<"u"?new Int32Array(I):I}var r=e();function n(_){var I=0,C=0,L=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(L=0;L!=256;++L)F[L]=_[L];for(L=0;L!=256;++L)for(C=_[L],I=256+L;I<4096;I+=256)C=F[I]=C>>>8^_[C&255];var V=[];for(L=1;L!=16;++L)V[L-1]=typeof Int32Array<"u"?F.subarray(L*256,L*256+256):F.slice(L*256,L*256+256);return V}var s=n(r),a=s[0],i=s[1],o=s[2],c=s[3],u=s[4],d=s[5],h=s[6],m=s[7],p=s[8],y=s[9],v=s[10],b=s[11],E=s[12],T=s[13],w=s[14];function B(_,I){for(var C=I^-1,L=0,F=_.length;L<F;)C=C>>>8^r[(C^_.charCodeAt(L++))&255];return~C}function J(_,I){for(var C=I^-1,L=_.length-15,F=0;F<L;)C=w[_[F++]^C&255]^T[_[F++]^C>>8&255]^E[_[F++]^C>>16&255]^b[_[F++]^C>>>24]^v[_[F++]]^y[_[F++]]^p[_[F++]]^m[_[F++]]^h[_[F++]]^d[_[F++]]^u[_[F++]]^c[_[F++]]^o[_[F++]]^i[_[F++]]^a[_[F++]]^r[_[F++]];for(L+=15;F<L;)C=C>>>8^r[(C^_[F++])&255];return~C}function Z(_,I){for(var C=I^-1,L=0,F=_.length,V=0,O=0;L<F;)V=_.charCodeAt(L++),V<128?C=C>>>8^r[(C^V)&255]:V<2048?(C=C>>>8^r[(C^(192|V>>6&31))&255],C=C>>>8^r[(C^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,O=_.charCodeAt(L++)&1023,C=C>>>8^r[(C^(240|V>>8&7))&255],C=C>>>8^r[(C^(128|V>>2&63))&255],C=C>>>8^r[(C^(128|O>>6&15|(V&3)<<4))&255],C=C>>>8^r[(C^(128|O&63))&255]):(C=C>>>8^r[(C^(224|V>>12&15))&255],C=C>>>8^r[(C^(128|V>>6&63))&255],C=C>>>8^r[(C^(128|V&63))&255]);return~C}return t.table=r,t.bstr=B,t.buf=J,t.str=Z,t}(),br=function(){var e={};e.version="1.2.1";function r(R,X){for(var z=R.split("/"),K=X.split("/"),Y=0,ee=0,Ee=Math.min(z.length,K.length);Y<Ee;++Y){if(ee=z[Y].length-K[Y].length)return ee;if(z[Y]!=K[Y])return z[Y]<K[Y]?-1:1}return z.length-K.length}function n(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:n(R.slice(0,-1));var X=R.lastIndexOf("/");return X===-1?R:R.slice(0,X+1)}function s(R){if(R.charAt(R.length-1)=="/")return s(R.slice(0,-1));var X=R.lastIndexOf("/");return X===-1?R:R.slice(X+1)}function a(R,X){typeof X=="string"&&(X=new Date(X));var z=X.getHours();z=z<<6|X.getMinutes(),z=z<<5|X.getSeconds()>>>1,R.write_shift(2,z);var K=X.getFullYear()-1980;K=K<<4|X.getMonth()+1,K=K<<5|X.getDate(),R.write_shift(2,K)}function i(R){var X=R.read_shift(2)&65535,z=R.read_shift(2)&65535,K=new Date,Y=z&31;z>>>=5;var ee=z&15;z>>>=4,K.setMilliseconds(0),K.setFullYear(z+1980),K.setMonth(ee-1),K.setDate(Y);var Ee=X&31;X>>>=5;var De=X&63;return X>>>=6,K.setHours(X),K.setMinutes(De),K.setSeconds(Ee<<1),K}function o(R){ts(R,0);for(var X={},z=0;R.l<=R.length-4;){var K=R.read_shift(2),Y=R.read_shift(2),ee=R.l+Y,Ee={};switch(K){case 21589:z=R.read_shift(1),z&1&&(Ee.mtime=R.read_shift(4)),Y>5&&(z&2&&(Ee.atime=R.read_shift(4)),z&4&&(Ee.ctime=R.read_shift(4))),Ee.mtime&&(Ee.mt=new Date(Ee.mtime*1e3));break}R.l=ee,X[K]=Ee}return X}var c;function u(){return c||(c={})}function d(R,X){if(R[0]==80&&R[1]==75)return In(R,X);if((R[0]|32)==109&&(R[1]|32)==105)return ni(R,X);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var z=3,K=512,Y=0,ee=0,Ee=0,De=0,xe=0,be=[],Te=R.slice(0,512);ts(Te,0);var We=h(Te);switch(z=We[0],z){case 3:K=512;break;case 4:K=4096;break;case 0:if(We[1]==0)return In(R,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+z)}K!==512&&(Te=R.slice(0,K),ts(Te,28));var at=R.slice(0,K);m(Te,z);var wt=Te.read_shift(4,"i");if(z===3&&wt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+wt);Te.l+=4,Ee=Te.read_shift(4,"i"),Te.l+=4,Te.chk("00100000","Mini Stream Cutoff Size: "),De=Te.read_shift(4,"i"),Y=Te.read_shift(4,"i"),xe=Te.read_shift(4,"i"),ee=Te.read_shift(4,"i");for(var nt=-1,pt=0;pt<109&&(nt=Te.read_shift(4,"i"),!(nt<0));++pt)be[pt]=nt;var Ut=p(R,K);b(xe,ee,Ut,K,be);var sr=T(Ut,Ee,be,K);sr[Ee].name="!Directory",Y>0&&De!==O&&(sr[De].name="!MiniFAT"),sr[be[0]].name="!FAT",sr.fat_addrs=be,sr.ssz=K;var ur={},kr=[],Ur=[],ve=[];w(Ee,sr,Ut,kr,Y,ur,Ur,De),y(Ur,ve,kr),kr.shift();var Le={FileIndex:Ur,FullPaths:ve};return X&&X.raw&&(Le.raw={header:at,sectors:Ut}),Le}function h(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(ct,"Header Signature: "),R.l+=16;var X=R.read_shift(2,"u");return[R.read_shift(2,"u"),X]}function m(R,X){var z=9;switch(R.l+=2,z=R.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+z);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+z)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function p(R,X){for(var z=Math.ceil(R.length/X)-1,K=[],Y=1;Y<z;++Y)K[Y-1]=R.slice(Y*X,(Y+1)*X);return K[z-1]=R.slice(z*X),K}function y(R,X,z){for(var K=0,Y=0,ee=0,Ee=0,De=0,xe=z.length,be=[],Te=[];K<xe;++K)be[K]=Te[K]=K,X[K]=z[K];for(;De<Te.length;++De)K=Te[De],Y=R[K].L,ee=R[K].R,Ee=R[K].C,be[K]===K&&(Y!==-1&&be[Y]!==Y&&(be[K]=be[Y]),ee!==-1&&be[ee]!==ee&&(be[K]=be[ee])),Ee!==-1&&(be[Ee]=K),Y!==-1&&K!=be[K]&&(be[Y]=be[K],Te.lastIndexOf(Y)<De&&Te.push(Y)),ee!==-1&&K!=be[K]&&(be[ee]=be[K],Te.lastIndexOf(ee)<De&&Te.push(ee));for(K=1;K<xe;++K)be[K]===K&&(ee!==-1&&be[ee]!==ee?be[K]=be[ee]:Y!==-1&&be[Y]!==Y&&(be[K]=be[Y]));for(K=1;K<xe;++K)if(R[K].type!==0){if(De=K,De!=be[De])do De=be[De],X[K]=X[De]+"/"+X[K];while(De!==0&&be[De]!==-1&&De!=be[De]);be[K]=-1}for(X[0]+="/",K=1;K<xe;++K)R[K].type!==2&&(X[K]+="/")}function v(R,X,z){for(var K=R.start,Y=R.size,ee=[],Ee=K;z&&Y>0&&Ee>=0;)ee.push(X.slice(Ee*V,Ee*V+V)),Y-=V,Ee=vl(z,Ee*4);return ee.length===0?Pn(0):Eo(ee).slice(0,R.size)}function b(R,X,z,K,Y){var ee=O;if(R===O){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var Ee=z[R],De=(K>>>2)-1;if(!Ee)return;for(var xe=0;xe<De&&(ee=vl(Ee,xe*4))!==O;++xe)Y.push(ee);b(vl(Ee,K-4),X-1,z,K,Y)}}function E(R,X,z,K,Y){var ee=[],Ee=[];Y||(Y=[]);var De=K-1,xe=0,be=0;for(xe=X;xe>=0;){Y[xe]=!0,ee[ee.length]=xe,Ee.push(R[xe]);var Te=z[Math.floor(xe*4/K)];if(be=xe*4&De,K<4+be)throw new Error("FAT boundary crossed: "+xe+" 4 "+K);if(!R[Te])break;xe=vl(R[Te],be)}return{nodes:ee,data:p_([Ee])}}function T(R,X,z,K){var Y=R.length,ee=[],Ee=[],De=[],xe=[],be=K-1,Te=0,We=0,at=0,wt=0;for(Te=0;Te<Y;++Te)if(De=[],at=Te+X,at>=Y&&(at-=Y),!Ee[at]){xe=[];var nt=[];for(We=at;We>=0;){nt[We]=!0,Ee[We]=!0,De[De.length]=We,xe.push(R[We]);var pt=z[Math.floor(We*4/K)];if(wt=We*4&be,K<4+wt)throw new Error("FAT boundary crossed: "+We+" 4 "+K);if(!R[pt]||(We=vl(R[pt],wt),nt[We]))break}ee[at]={nodes:De,data:p_([xe])}}return ee}function w(R,X,z,K,Y,ee,Ee,De){for(var xe=0,be=K.length?2:0,Te=X[R].data,We=0,at=0,wt;We<Te.length;We+=128){var nt=Te.slice(We,We+128);ts(nt,64),at=nt.read_shift(2),wt=Zv(nt,0,at-be),K.push(wt);var pt={name:wt,type:nt.read_shift(1),color:nt.read_shift(1),L:nt.read_shift(4,"i"),R:nt.read_shift(4,"i"),C:nt.read_shift(4,"i"),clsid:nt.read_shift(16),state:nt.read_shift(4,"i"),start:0,size:0},Ut=nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2);Ut!==0&&(pt.ct=B(nt,nt.l-8));var sr=nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2);sr!==0&&(pt.mt=B(nt,nt.l-8)),pt.start=nt.read_shift(4,"i"),pt.size=nt.read_shift(4,"i"),pt.size<0&&pt.start<0&&(pt.size=pt.type=0,pt.start=O,pt.name=""),pt.type===5?(xe=pt.start,Y>0&&xe!==O&&(X[xe].name="!StreamData")):pt.size>=4096?(pt.storage="fat",X[pt.start]===void 0&&(X[pt.start]=E(z,pt.start,X.fat_addrs,X.ssz)),X[pt.start].name=pt.name,pt.content=X[pt.start].data.slice(0,pt.size)):(pt.storage="minifat",pt.size<0?pt.size=0:xe!==O&&pt.start!==O&&X[xe]&&(pt.content=v(pt,X[xe].data,(X[De]||{}).data))),pt.content&&ts(pt.content,0),ee[wt]=pt,Ee.push(pt)}}function B(R,X){return new Date((ia(R,X+4)/1e7*Math.pow(2,32)+ia(R,X)/1e7-11644473600)*1e3)}function J(R,X){return u(),d(c.readFileSync(R),X)}function Z(R,X){var z=X&&X.type;switch(z||xr&&Buffer.isBuffer(R)&&(z="buffer"),z||"base64"){case"file":return J(R,X);case"base64":return d(Ga(ma(R)),X);case"binary":return d(Ga(R),X)}return d(R,X)}function _(R,X){var z=X||{},K=z.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=K+"/",R.FileIndex[0]={name:K,type:5}),z.CLSID&&(R.FileIndex[0].clsid=z.CLSID),I(R)}function I(R){var X="Sh33tJ5";if(!br.find(R,"/"+X)){var z=Pn(4);z[0]=55,z[1]=z[3]=50,z[2]=54,R.FileIndex.push({name:X,type:2,content:z,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+X),C(R)}}function C(R,X){_(R);for(var z=!1,K=!1,Y=R.FullPaths.length-1;Y>=0;--Y){var ee=R.FileIndex[Y];switch(ee.type){case 0:K?z=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:K=!0,isNaN(ee.R*ee.L*ee.C)&&(z=!0),ee.R>-1&&ee.L>-1&&ee.R==ee.L&&(z=!0);break;default:z=!0;break}}if(!(!z&&!X)){var Ee=new Date(1987,1,19),De=0,xe=Object.create?Object.create(null):{},be=[];for(Y=0;Y<R.FullPaths.length;++Y)xe[R.FullPaths[Y]]=!0,R.FileIndex[Y].type!==0&&be.push([R.FullPaths[Y],R.FileIndex[Y]]);for(Y=0;Y<be.length;++Y){var Te=n(be[Y][0]);K=xe[Te],K||(be.push([Te,{name:s(Te).replace("/",""),type:1,clsid:ft,ct:Ee,mt:Ee,content:null}]),xe[Te]=!0)}for(be.sort(function(wt,nt){return r(wt[0],nt[0])}),R.FullPaths=[],R.FileIndex=[],Y=0;Y<be.length;++Y)R.FullPaths[Y]=be[Y][0],R.FileIndex[Y]=be[Y][1];for(Y=0;Y<be.length;++Y){var We=R.FileIndex[Y],at=R.FullPaths[Y];if(We.name=s(at).replace("/",""),We.L=We.R=We.C=-(We.color=1),We.size=We.content?We.content.length:0,We.start=0,We.clsid=We.clsid||ft,Y===0)We.C=be.length>1?1:-1,We.size=0,We.type=5;else if(at.slice(-1)=="/"){for(De=Y+1;De<be.length&&n(R.FullPaths[De])!=at;++De);for(We.C=De>=be.length?-1:De,De=Y+1;De<be.length&&n(R.FullPaths[De])!=n(at);++De);We.R=De>=be.length?-1:De,We.type=1}else n(R.FullPaths[Y+1]||"")==n(at)&&(We.R=Y+1),We.type=2}}}function L(R,X){var z=X||{};if(z.fileType=="mad")return ut(R,z);switch(C(R),z.fileType){case"zip":return Fr(R,z)}var K=function(wt){for(var nt=0,pt=0,Ut=0;Ut<wt.FileIndex.length;++Ut){var sr=wt.FileIndex[Ut];if(sr.content){var ur=sr.content.length;ur>0&&(ur<4096?nt+=ur+63>>6:pt+=ur+511>>9)}}for(var kr=wt.FullPaths.length+3>>2,Ur=nt+7>>3,ve=nt+127>>7,Le=Ur+pt+kr+ve,Ke=Le+127>>7,Je=Ke<=109?0:Math.ceil((Ke-109)/127);Le+Ke+Je+127>>7>Ke;)Je=++Ke<=109?0:Math.ceil((Ke-109)/127);var Se=[1,Je,Ke,ve,kr,pt,nt,0];return wt.FileIndex[0].size=nt<<6,Se[7]=(wt.FileIndex[0].start=Se[0]+Se[1]+Se[2]+Se[3]+Se[4]+Se[5])+(Se[6]+7>>3),Se}(R),Y=Pn(K[7]<<9),ee=0,Ee=0;{for(ee=0;ee<8;++ee)Y.write_shift(1,me[ee]);for(ee=0;ee<8;++ee)Y.write_shift(2,0);for(Y.write_shift(2,62),Y.write_shift(2,3),Y.write_shift(2,65534),Y.write_shift(2,9),Y.write_shift(2,6),ee=0;ee<3;++ee)Y.write_shift(2,0);for(Y.write_shift(4,0),Y.write_shift(4,K[2]),Y.write_shift(4,K[0]+K[1]+K[2]+K[3]-1),Y.write_shift(4,0),Y.write_shift(4,4096),Y.write_shift(4,K[3]?K[0]+K[1]+K[2]-1:O),Y.write_shift(4,K[3]),Y.write_shift(-4,K[1]?K[0]-1:O),Y.write_shift(4,K[1]),ee=0;ee<109;++ee)Y.write_shift(-4,ee<K[2]?K[1]+ee:-1)}if(K[1])for(Ee=0;Ee<K[1];++Ee){for(;ee<236+Ee*127;++ee)Y.write_shift(-4,ee<K[2]?K[1]+ee:-1);Y.write_shift(-4,Ee===K[1]-1?O:Ee+1)}var De=function(wt){for(Ee+=wt;ee<Ee-1;++ee)Y.write_shift(-4,ee+1);wt&&(++ee,Y.write_shift(-4,O))};for(Ee=ee=0,Ee+=K[1];ee<Ee;++ee)Y.write_shift(-4,rt.DIFSECT);for(Ee+=K[2];ee<Ee;++ee)Y.write_shift(-4,rt.FATSECT);De(K[3]),De(K[4]);for(var xe=0,be=0,Te=R.FileIndex[0];xe<R.FileIndex.length;++xe)Te=R.FileIndex[xe],Te.content&&(be=Te.content.length,!(be<4096)&&(Te.start=Ee,De(be+511>>9)));for(De(K[6]+7>>3);Y.l&511;)Y.write_shift(-4,rt.ENDOFCHAIN);for(Ee=ee=0,xe=0;xe<R.FileIndex.length;++xe)Te=R.FileIndex[xe],Te.content&&(be=Te.content.length,!(!be||be>=4096)&&(Te.start=Ee,De(be+63>>6)));for(;Y.l&511;)Y.write_shift(-4,rt.ENDOFCHAIN);for(ee=0;ee<K[4]<<2;++ee){var We=R.FullPaths[ee];if(!We||We.length===0){for(xe=0;xe<17;++xe)Y.write_shift(4,0);for(xe=0;xe<3;++xe)Y.write_shift(4,-1);for(xe=0;xe<12;++xe)Y.write_shift(4,0);continue}Te=R.FileIndex[ee],ee===0&&(Te.start=Te.size?Te.start-1:O);var at=ee===0&&z.root||Te.name;if(be=2*(at.length+1),Y.write_shift(64,at,"utf16le"),Y.write_shift(2,be),Y.write_shift(1,Te.type),Y.write_shift(1,Te.color),Y.write_shift(-4,Te.L),Y.write_shift(-4,Te.R),Y.write_shift(-4,Te.C),Te.clsid)Y.write_shift(16,Te.clsid,"hex");else for(xe=0;xe<4;++xe)Y.write_shift(4,0);Y.write_shift(4,Te.state||0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,Te.start),Y.write_shift(4,Te.size),Y.write_shift(4,0)}for(ee=1;ee<R.FileIndex.length;++ee)if(Te=R.FileIndex[ee],Te.size>=4096)if(Y.l=Te.start+1<<9,xr&&Buffer.isBuffer(Te.content))Te.content.copy(Y,Y.l,0,Te.size),Y.l+=Te.size+511&-512;else{for(xe=0;xe<Te.size;++xe)Y.write_shift(1,Te.content[xe]);for(;xe&511;++xe)Y.write_shift(1,0)}for(ee=1;ee<R.FileIndex.length;++ee)if(Te=R.FileIndex[ee],Te.size>0&&Te.size<4096)if(xr&&Buffer.isBuffer(Te.content))Te.content.copy(Y,Y.l,0,Te.size),Y.l+=Te.size+63&-64;else{for(xe=0;xe<Te.size;++xe)Y.write_shift(1,Te.content[xe]);for(;xe&63;++xe)Y.write_shift(1,0)}if(xr)Y.l=Y.length;else for(;Y.l<Y.length;)Y.write_shift(1,0);return Y}function F(R,X){var z=R.FullPaths.map(function(xe){return xe.toUpperCase()}),K=z.map(function(xe){var be=xe.split("/");return be[be.length-(xe.slice(-1)=="/"?2:1)]}),Y=!1;X.charCodeAt(0)===47?(Y=!0,X=z[0].slice(0,-1)+X):Y=X.indexOf("/")!==-1;var ee=X.toUpperCase(),Ee=Y===!0?z.indexOf(ee):K.indexOf(ee);if(Ee!==-1)return R.FileIndex[Ee];var De=!ee.match(od);for(ee=ee.replace(Os,""),De&&(ee=ee.replace(od,"!")),Ee=0;Ee<z.length;++Ee)if((De?z[Ee].replace(od,"!"):z[Ee]).replace(Os,"")==ee||(De?K[Ee].replace(od,"!"):K[Ee]).replace(Os,"")==ee)return R.FileIndex[Ee];return null}var V=64,O=-2,ct="d0cf11e0a1b11ae1",me=[208,207,17,224,161,177,26,225],ft="00000000000000000000000000000000",rt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:O,FREESECT:-1,HEADER_SIGNATURE:ct,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ft,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ze(R,X,z){u();var K=L(R,z);c.writeFileSync(X,K)}function ie(R){for(var X=new Array(R.length),z=0;z<R.length;++z)X[z]=String.fromCharCode(R[z]);return X.join("")}function Ye(R,X){var z=L(R,X);switch(X&&X.type||"buffer"){case"file":return u(),c.writeFileSync(X.filename,z),z;case"binary":return typeof z=="string"?z:ie(z);case"base64":return Yb(typeof z=="string"?z:ie(z));case"buffer":if(xr)return Buffer.isBuffer(z)?z:nc(z);case"array":return typeof z=="string"?Ga(z):z}return z}var _e;function Q(R){try{var X=R.InflateRaw,z=new X;if(z._processChunk(new Uint8Array([3,0]),z._finishFlushFlag),z.bytesRead)_e=R;else throw new Error("zlib does not expose bytesRead")}catch(K){console.error("cannot use native zlib: "+(K.message||K))}}function ae(R,X){if(!_e)return Gn(R,X);var z=_e.InflateRaw,K=new z,Y=K._processChunk(R.slice(R.l),K._finishFlushFlag);return R.l+=K.bytesRead,Y}function le(R){return _e?_e.deflateRawSync(R):Bt(R)}var ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],st=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ot(R){var X=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(X>>16|X>>8|X)&255}for(var Ne=typeof Uint8Array<"u",Ve=Ne?new Uint8Array(256):[],ge=0;ge<256;++ge)Ve[ge]=ot(ge);function W(R,X){var z=Ve[R&255];return X<=8?z>>>8-X:(z=z<<8|Ve[R>>8&255],X<=16?z>>>16-X:(z=z<<8|Ve[R>>16&255],z>>>24-X))}function we(R,X){var z=X&7,K=X>>>3;return(R[K]|(z<=6?0:R[K+1]<<8))>>>z&3}function et(R,X){var z=X&7,K=X>>>3;return(R[K]|(z<=5?0:R[K+1]<<8))>>>z&7}function ht(R,X){var z=X&7,K=X>>>3;return(R[K]|(z<=4?0:R[K+1]<<8))>>>z&15}function Qe(R,X){var z=X&7,K=X>>>3;return(R[K]|(z<=3?0:R[K+1]<<8))>>>z&31}function qe(R,X){var z=X&7,K=X>>>3;return(R[K]|(z<=1?0:R[K+1]<<8))>>>z&127}function Ft(R,X,z){var K=X&7,Y=X>>>3,ee=(1<<z)-1,Ee=R[Y]>>>K;return z<8-K||(Ee|=R[Y+1]<<8-K,z<16-K)||(Ee|=R[Y+2]<<16-K,z<24-K)||(Ee|=R[Y+3]<<24-K),Ee&ee}function Mt(R,X,z){var K=X&7,Y=X>>>3;return K<=5?R[Y]|=(z&7)<<K:(R[Y]|=z<<K&255,R[Y+1]=(z&7)>>8-K),X+3}function Ot(R,X,z){var K=X&7,Y=X>>>3;return z=(z&1)<<K,R[Y]|=z,X+1}function er(R,X,z){var K=X&7,Y=X>>>3;return z<<=K,R[Y]|=z&255,z>>>=8,R[Y+1]=z,X+8}function jt(R,X,z){var K=X&7,Y=X>>>3;return z<<=K,R[Y]|=z&255,z>>>=8,R[Y+1]=z&255,R[Y+2]=z>>>8,X+16}function lr(R,X){var z=R.length,K=2*z>X?2*z:X+5,Y=0;if(z>=X)return R;if(xr){var ee=Jb(K);if(R.copy)R.copy(ee);else for(;Y<R.length;++Y)ee[Y]=R[Y];return ee}else if(Ne){var Ee=new Uint8Array(K);if(Ee.set)Ee.set(R);else for(;Y<z;++Y)Ee[Y]=R[Y];return Ee}return R.length=K,R}function Nr(R){for(var X=new Array(R),z=0;z<R;++z)X[z]=0;return X}function Rr(R,X,z){var K=1,Y=0,ee=0,Ee=0,De=0,xe=R.length,be=Ne?new Uint16Array(32):Nr(32);for(ee=0;ee<32;++ee)be[ee]=0;for(ee=xe;ee<z;++ee)R[ee]=0;xe=R.length;var Te=Ne?new Uint16Array(xe):Nr(xe);for(ee=0;ee<xe;++ee)be[Y=R[ee]]++,K<Y&&(K=Y),Te[ee]=0;for(be[0]=0,ee=1;ee<=K;++ee)be[ee+16]=De=De+be[ee-1]<<1;for(ee=0;ee<xe;++ee)De=R[ee],De!=0&&(Te[ee]=be[De+16]++);var We=0;for(ee=0;ee<xe;++ee)if(We=R[ee],We!=0)for(De=W(Te[ee],K)>>K-We,Ee=(1<<K+4-We)-1;Ee>=0;--Ee)X[De|Ee<<We]=We&15|ee<<4;return K}var ls=Ne?new Uint16Array(512):Nr(512),mn=Ne?new Uint16Array(32):Nr(32);if(!Ne){for(var Dr=0;Dr<512;++Dr)ls[Dr]=0;for(Dr=0;Dr<32;++Dr)mn[Dr]=0}(function(){for(var R=[],X=0;X<32;X++)R.push(5);Rr(R,mn,32);var z=[];for(X=0;X<=143;X++)z.push(8);for(;X<=255;X++)z.push(9);for(;X<=279;X++)z.push(7);for(;X<=287;X++)z.push(8);Rr(z,ls,288)})();var Lr=function(){for(var X=Ne?new Uint8Array(32768):[],z=0,K=0;z<st.length-1;++z)for(;K<st[z+1];++K)X[K]=z;for(;K<32768;++K)X[K]=29;var Y=Ne?new Uint8Array(259):[];for(z=0,K=0;z<Ae.length-1;++z)for(;K<Ae[z+1];++K)Y[K]=z;function ee(De,xe){for(var be=0;be<De.length;){var Te=Math.min(65535,De.length-be),We=be+Te==De.length;for(xe.write_shift(1,+We),xe.write_shift(2,Te),xe.write_shift(2,~Te&65535);Te-- >0;)xe[xe.l++]=De[be++]}return xe.l}function Ee(De,xe){for(var be=0,Te=0,We=Ne?new Uint16Array(32768):[];Te<De.length;){var at=Math.min(65535,De.length-Te);if(at<10){for(be=Mt(xe,be,+(Te+at==De.length)),be&7&&(be+=8-(be&7)),xe.l=be/8|0,xe.write_shift(2,at),xe.write_shift(2,~at&65535);at-- >0;)xe[xe.l++]=De[Te++];be=xe.l*8;continue}be=Mt(xe,be,+(Te+at==De.length)+2);for(var wt=0;at-- >0;){var nt=De[Te];wt=(wt<<5^nt)&32767;var pt=-1,Ut=0;if((pt=We[wt])&&(pt|=Te&-32768,pt>Te&&(pt-=32768),pt<Te))for(;De[pt+Ut]==De[Te+Ut]&&Ut<250;)++Ut;if(Ut>2){nt=Y[Ut],nt<=22?be=er(xe,be,Ve[nt+1]>>1)-1:(er(xe,be,3),be+=5,er(xe,be,Ve[nt-23]>>5),be+=3);var sr=nt<8?0:nt-4>>2;sr>0&&(jt(xe,be,Ut-Ae[nt]),be+=sr),nt=X[Te-pt],be=er(xe,be,Ve[nt]>>3),be-=3;var ur=nt<4?0:nt-2>>1;ur>0&&(jt(xe,be,Te-pt-st[nt]),be+=ur);for(var kr=0;kr<Ut;++kr)We[wt]=Te&32767,wt=(wt<<5^De[Te])&32767,++Te;at-=Ut-1}else nt<=143?nt=nt+48:be=Ot(xe,be,1),be=er(xe,be,Ve[nt]),We[wt]=Te&32767,++Te}be=er(xe,be,0)-1}return xe.l=(be+7)/8|0,xe.l}return function(xe,be){return xe.length<8?ee(xe,be):Ee(xe,be)}}();function Bt(R){var X=Pn(50+Math.floor(R.length*1.1)),z=Lr(R,X);return X.slice(0,z)}var Qt=Ne?new Uint16Array(32768):Nr(32768),ir=Ne?new Uint16Array(32768):Nr(32768),cr=Ne?new Uint16Array(128):Nr(128),An=1,ta=1;function cs(R,X){var z=Qe(R,X)+257;X+=5;var K=Qe(R,X)+1;X+=5;var Y=ht(R,X)+4;X+=4;for(var ee=0,Ee=Ne?new Uint8Array(19):Nr(19),De=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],xe=1,be=Ne?new Uint8Array(8):Nr(8),Te=Ne?new Uint8Array(8):Nr(8),We=Ee.length,at=0;at<Y;++at)Ee[ne[at]]=ee=et(R,X),xe<ee&&(xe=ee),be[ee]++,X+=3;var wt=0;for(be[0]=0,at=1;at<=xe;++at)Te[at]=wt=wt+be[at-1]<<1;for(at=0;at<We;++at)(wt=Ee[at])!=0&&(De[at]=Te[wt]++);var nt=0;for(at=0;at<We;++at)if(nt=Ee[at],nt!=0){wt=Ve[De[at]]>>8-nt;for(var pt=(1<<7-nt)-1;pt>=0;--pt)cr[wt|pt<<nt]=nt&7|at<<3}var Ut=[];for(xe=1;Ut.length<z+K;)switch(wt=cr[qe(R,X)],X+=wt&7,wt>>>=3){case 16:for(ee=3+we(R,X),X+=2,wt=Ut[Ut.length-1];ee-- >0;)Ut.push(wt);break;case 17:for(ee=3+et(R,X),X+=3;ee-- >0;)Ut.push(0);break;case 18:for(ee=11+qe(R,X),X+=7;ee-- >0;)Ut.push(0);break;default:Ut.push(wt),xe<wt&&(xe=wt);break}var sr=Ut.slice(0,z),ur=Ut.slice(z);for(at=z;at<286;++at)sr[at]=0;for(at=K;at<30;++at)ur[at]=0;return An=Rr(sr,Qt,286),ta=Rr(ur,ir,30),X}function ja(R,X){if(R[0]==3&&!(R[1]&3))return[Zo(X),2];for(var z=0,K=0,Y=Jb(X||1<<18),ee=0,Ee=Y.length>>>0,De=0,xe=0;!(K&1);){if(K=et(R,z),z+=3,K>>>1)K>>1==1?(De=9,xe=5):(z=cs(R,z),De=An,xe=ta);else{z&7&&(z+=8-(z&7));var be=R[z>>>3]|R[(z>>>3)+1]<<8;if(z+=32,be>0)for(!X&&Ee<ee+be&&(Y=lr(Y,ee+be),Ee=Y.length);be-- >0;)Y[ee++]=R[z>>>3],z+=8;continue}for(;;){!X&&Ee<ee+32767&&(Y=lr(Y,ee+32767),Ee=Y.length);var Te=Ft(R,z,De),We=K>>>1==1?ls[Te]:Qt[Te];if(z+=We&15,We>>>=4,!(We>>>8&255))Y[ee++]=We;else{if(We==256)break;We-=257;var at=We<8?0:We-4>>2;at>5&&(at=0);var wt=ee+Ae[We];at>0&&(wt+=Ft(R,z,at),z+=at),Te=Ft(R,z,xe),We=K>>>1==1?mn[Te]:ir[Te],z+=We&15,We>>>=4;var nt=We<4?0:We-2>>1,pt=st[We];for(nt>0&&(pt+=Ft(R,z,nt),z+=nt),!X&&Ee<wt&&(Y=lr(Y,wt+100),Ee=Y.length);ee<wt;)Y[ee]=Y[ee-pt],++ee}}}return X?[Y,z+7>>>3]:[Y.slice(0,ee),z+7>>>3]}function Gn(R,X){var z=R.slice(R.l||0),K=ja(z,X);return R.l+=K[1],K[0]}function $n(R,X){if(R)typeof console<"u"&&console.error(X);else throw new Error(X)}function In(R,X){var z=R;ts(z,0);var K=[],Y=[],ee={FileIndex:K,FullPaths:Y};_(ee,{root:X.root});for(var Ee=z.length-4;(z[Ee]!=80||z[Ee+1]!=75||z[Ee+2]!=5||z[Ee+3]!=6)&&Ee>=0;)--Ee;z.l=Ee+4,z.l+=4;var De=z.read_shift(2);z.l+=6;var xe=z.read_shift(4);for(z.l=xe,Ee=0;Ee<De;++Ee){z.l+=20;var be=z.read_shift(4),Te=z.read_shift(4),We=z.read_shift(2),at=z.read_shift(2),wt=z.read_shift(2);z.l+=8;var nt=z.read_shift(4),pt=o(z.slice(z.l+We,z.l+We+at));z.l+=We+at+wt;var Ut=z.l;z.l=nt+4,ra(z,be,Te,ee,pt),z.l=Ut}return ee}function ra(R,X,z,K,Y){R.l+=2;var ee=R.read_shift(2),Ee=R.read_shift(2),De=i(R);if(ee&8257)throw new Error("Unsupported ZIP encryption");for(var xe=R.read_shift(4),be=R.read_shift(4),Te=R.read_shift(4),We=R.read_shift(2),at=R.read_shift(2),wt="",nt=0;nt<We;++nt)wt+=String.fromCharCode(R[R.l++]);if(at){var pt=o(R.slice(R.l,R.l+at));(pt[21589]||{}).mt&&(De=pt[21589].mt),((Y||{})[21589]||{}).mt&&(De=Y[21589].mt)}R.l+=at;var Ut=R.slice(R.l,R.l+be);switch(Ee){case 8:Ut=ae(R,Te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ee)}var sr=!1;ee&8&&(xe=R.read_shift(4),xe==134695760&&(xe=R.read_shift(4),sr=!0),be=R.read_shift(4),Te=R.read_shift(4)),be!=X&&$n(sr,"Bad compressed size: "+X+" != "+be),Te!=z&&$n(sr,"Bad uncompressed size: "+z+" != "+Te),si(K,wt,Ut,{unsafe:!0,mt:De})}function Fr(R,X){var z=X||{},K=[],Y=[],ee=Pn(1),Ee=z.compression?8:0,De=0,xe=0,be=0,Te=0,We=0,at=R.FullPaths[0],wt=at,nt=R.FileIndex[0],pt=[],Ut=0;for(xe=1;xe<R.FullPaths.length;++xe)if(wt=R.FullPaths[xe].slice(at.length),nt=R.FileIndex[xe],!(!nt.size||!nt.content||wt=="Sh33tJ5")){var sr=Te,ur=Pn(wt.length);for(be=0;be<wt.length;++be)ur.write_shift(1,wt.charCodeAt(be)&127);ur=ur.slice(0,ur.l),pt[We]=J9.buf(nt.content,0);var kr=nt.content;Ee==8&&(kr=le(kr)),ee=Pn(30),ee.write_shift(4,67324752),ee.write_shift(2,20),ee.write_shift(2,De),ee.write_shift(2,Ee),nt.mt?a(ee,nt.mt):ee.write_shift(4,0),ee.write_shift(-4,pt[We]),ee.write_shift(4,kr.length),ee.write_shift(4,nt.content.length),ee.write_shift(2,ur.length),ee.write_shift(2,0),Te+=ee.length,K.push(ee),Te+=ur.length,K.push(ur),Te+=kr.length,K.push(kr),ee=Pn(46),ee.write_shift(4,33639248),ee.write_shift(2,0),ee.write_shift(2,20),ee.write_shift(2,De),ee.write_shift(2,Ee),ee.write_shift(4,0),ee.write_shift(-4,pt[We]),ee.write_shift(4,kr.length),ee.write_shift(4,nt.content.length),ee.write_shift(2,ur.length),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(4,0),ee.write_shift(4,sr),Ut+=ee.l,Y.push(ee),Ut+=ur.length,Y.push(ur),++We}return ee=Pn(22),ee.write_shift(4,101010256),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,We),ee.write_shift(2,We),ee.write_shift(4,Ut),ee.write_shift(4,Te),ee.write_shift(2,0),Eo([Eo(K),Eo(Y),ee])}var Cn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ks(R,X){if(R.ctype)return R.ctype;var z=R.name||"",K=z.match(/\.([^\.]+)$/);return K&&Cn[K[1]]||X&&(K=(z=X).match(/[\.\\]([^\.\\])+$/),K&&Cn[K[1]])?Cn[K[1]]:"application/octet-stream"}function qn(R){for(var X=Yb(R),z=[],K=0;K<X.length;K+=76)z.push(X.slice(K,K+76));return z.join(`\r
`)+`\r
`}function Da(R){var X=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(be){var Te=be.charCodeAt(0).toString(16).toUpperCase();return"="+(Te.length==1?"0"+Te:Te)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var z=[],K=X.split(`\r
`),Y=0;Y<K.length;++Y){var ee=K[Y];if(ee.length==0){z.push("");continue}for(var Ee=0;Ee<ee.length;){var De=76,xe=ee.slice(Ee,Ee+De);xe.charAt(De-1)=="="?De--:xe.charAt(De-2)=="="?De-=2:xe.charAt(De-3)=="="&&(De-=3),xe=ee.slice(Ee,Ee+De),Ee+=De,Ee<ee.length&&(xe+="="),z.push(xe)}}return z.join(`\r
`)}function pn(R){for(var X=[],z=0;z<R.length;++z){for(var K=R[z];z<=R.length&&K.charAt(K.length-1)=="=";)K=K.slice(0,K.length-1)+R[++z];X.push(K)}for(var Y=0;Y<X.length;++Y)X[Y]=X[Y].replace(/[=][0-9A-Fa-f]{2}/g,function(ee){return String.fromCharCode(parseInt(ee.slice(1),16))});return Ga(X.join(`\r
`))}function ue(R,X,z){for(var K="",Y="",ee="",Ee,De=0;De<10;++De){var xe=X[De];if(!xe||xe.match(/^\s*$/))break;var be=xe.match(/^(.*?):\s*([^\s].*)$/);if(be)switch(be[1].toLowerCase()){case"content-location":K=be[2].trim();break;case"content-type":ee=be[2].trim();break;case"content-transfer-encoding":Y=be[2].trim();break}}switch(++De,Y.toLowerCase()){case"base64":Ee=Ga(ma(X.slice(De).join("")));break;case"quoted-printable":Ee=pn(X.slice(De));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Y)}var Te=si(R,K.slice(z.length),Ee,{unsafe:!0});ee&&(Te.ctype=ee)}function ni(R,X){if(ie(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var z=X&&X.root||"",K=(xr&&Buffer.isBuffer(R)?R.toString("binary"):ie(R)).split(`\r
`),Y=0,ee="";for(Y=0;Y<K.length;++Y)if(ee=K[Y],!!/^Content-Location:/i.test(ee)&&(ee=ee.slice(ee.indexOf("file")),z||(z=ee.slice(0,ee.lastIndexOf("/")+1)),ee.slice(0,z.length)!=z))for(;z.length>0&&(z=z.slice(0,z.length-1),z=z.slice(0,z.lastIndexOf("/")+1),ee.slice(0,z.length)!=z););var Ee=(K[1]||"").match(/boundary="(.*?)"/);if(!Ee)throw new Error("MAD cannot find boundary");var De="--"+(Ee[1]||""),xe=[],be=[],Te={FileIndex:xe,FullPaths:be};_(Te);var We,at=0;for(Y=0;Y<K.length;++Y){var wt=K[Y];wt!==De&&wt!==De+"--"||(at++&&ue(Te,K.slice(We,Y),z),We=Y)}return Te}function ut(R,X){var z=X||{},K=z.boundary||"SheetJS";K="------="+K;for(var Y=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+K.slice(2)+'"',"","",""],ee=R.FullPaths[0],Ee=ee,De=R.FileIndex[0],xe=1;xe<R.FullPaths.length;++xe)if(Ee=R.FullPaths[xe].slice(ee.length),De=R.FileIndex[xe],!(!De.size||!De.content||Ee=="Sh33tJ5")){Ee=Ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ut){return"_x"+Ut.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ut){return"_u"+Ut.charCodeAt(0).toString(16)+"_"});for(var be=De.content,Te=xr&&Buffer.isBuffer(be)?be.toString("binary"):ie(be),We=0,at=Math.min(1024,Te.length),wt=0,nt=0;nt<=at;++nt)(wt=Te.charCodeAt(nt))>=32&&wt<128&&++We;var pt=We>=at*4/5;Y.push(K),Y.push("Content-Location: "+(z.root||"file:///C:/SheetJS/")+Ee),Y.push("Content-Transfer-Encoding: "+(pt?"quoted-printable":"base64")),Y.push("Content-Type: "+ks(De,Ee)),Y.push(""),Y.push(pt?Da(Te):qn(Te))}return Y.push(K+`--\r
`),Y.join(`\r
`)}function Vs(R){var X={};return _(X,R),X}function si(R,X,z,K){var Y=K&&K.unsafe;Y||_(R);var ee=!Y&&br.find(R,X);if(!ee){var Ee=R.FullPaths[0];X.slice(0,Ee.length)==Ee?Ee=X:(Ee.slice(-1)!="/"&&(Ee+="/"),Ee=(Ee+X).replace("//","/")),ee={name:s(X),type:2},R.FileIndex.push(ee),R.FullPaths.push(Ee),Y||br.utils.cfb_gc(R)}return ee.content=z,ee.size=z?z.length:0,K&&(K.CLSID&&(ee.clsid=K.CLSID),K.mt&&(ee.mt=K.mt),K.ct&&(ee.ct=K.ct)),ee}function io(R,X){_(R);var z=br.find(R,X);if(z){for(var K=0;K<R.FileIndex.length;++K)if(R.FileIndex[K]==z)return R.FileIndex.splice(K,1),R.FullPaths.splice(K,1),!0}return!1}function hr(R,X,z){_(R);var K=br.find(R,X);if(K){for(var Y=0;Y<R.FileIndex.length;++Y)if(R.FileIndex[Y]==K)return R.FileIndex[Y].name=s(z),R.FullPaths[Y]=z,!0}return!1}function gn(R){C(R,!0)}return e.find=F,e.read=Z,e.parse=d,e.write=Ye,e.writeFile=ze,e.utils={cfb_new:Vs,cfb_add:si,cfb_del:io,cfb_mov:hr,cfb_gc:gn,ReadShift:kd,CheckField:EI,prep_blob:ts,bconcat:Eo,use_zlib:Q,_deflateRaw:Bt,_inflateRaw:Gn,consts:rt},e}();function Z9(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ni(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Qv(t){for(var e=[],r=Ni(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var tm=new Date(1899,11,30,0,0,0);function Ms(t,e){var r=t.getTime(),n=tm.getTime()+(t.getTimezoneOffset()-tm.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var nI=new Date,e$=tm.getTime()+(nI.getTimezoneOffset()-tm.getTimezoneOffset())*6e4,i_=nI.getTimezoneOffset();function np(t){var e=new Date;return e.setTime(t*24*60*60*1e3+e$),e.getTimezoneOffset()!==i_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-i_)*6e4),e}function t$(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[a],10)}return e}var o_=new Date("2017-02-19T19:06:09.000Z"),sI=isNaN(o_.getFullYear())?new Date("2/19/17"):o_,r$=sI.getFullYear()==2017;function Hn(t,e){var r=new Date(t);if(r$)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(sI.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Gl(t,e){if(xr&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return cd(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return cd(WA(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return cd(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return cd(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function ss(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=ss(t[r]));return e}function on(t,e){for(var r="";r.length<e;)r+=t;return r}function Za(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var n$=["january","february","march","april","may","june","july","august","september","october","november","december"];function pu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var i=t.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&n$.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var s$=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function aI(t){return t?t.content&&t.type?Gl(t.content,!0):t.data?id(t.data):t.asNodeBuffer&&xr?id(t.asNodeBuffer().toString("binary")):t.asBinary?id(t.asBinary()):t._data&&t._data.getContent?id(Gl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function iI(t){if(!t)return null;if(t.data)return Qb(t.data);if(t.asNodeBuffer&&xr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Qb(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function a$(t){return t&&t.name.slice(-4)===".bin"?iI(t):aI(t)}function ba(t,e){for(var r=t.FullPaths||Ni(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function Xv(t,e){var r=ba(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function bn(t,e,r){if(!r)return a$(Xv(t,e));if(!e)return null;try{return bn(t,e)}catch{return null}}function la(t,e,r){if(!r)return aI(Xv(t,e));if(!e)return null;try{return la(t,e)}catch{return null}}function i$(t,e,r){return iI(Xv(t,e))}function l_(t){for(var e=t.FullPaths||Ni(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function o$(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return xr?n=nc(r):n=k9(r),br.utils.cfb_add(t,e,n)}br.utils.cfb_add(t,e,r)}else t.file(e,r)}function oI(t,e){switch(e.type){case"base64":return br.read(t,{type:"base64"});case"binary":return br.read(t,{type:"binary"});case"buffer":case"array":return br.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function ld(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var lI=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,l$=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,c_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,c$=/<[^>]*>/g,Ts=lI.match(c_)?c_:c$,u$=/<\w*:/,d$=/<(\/?)\w+:/;function Kt(t,e,r){for(var n={},s=0,a=0;s!==t.length&&!((a=t.charCodeAt(s))===32||a===10||a===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var i=t.match(l$),o=0,c="",u=0,d="",h="",m=1;if(i)for(u=0;u!=i.length;++u){for(h=i[u],a=0;a!=h.length&&h.charCodeAt(a)!==61;++a);for(d=h.slice(0,a).trim();h.charCodeAt(a+1)==32;)++a;for(m=(s=h.charCodeAt(a+1))==34||s==39?1:0,c=h.slice(a+1+m,h.length-m),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var p=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[p]&&d.slice(o-3,o)=="ext")continue;n[p]=c,n[p.toLowerCase()]=c}}return n}function Pi(t){return t.replace(d$,"<$1")}var cI={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},f$=Qv(cI),Er=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(t,function(o,c){return cI[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),h$=/[&<>'"]/g,m$=/[\u0000-\u001f]/g;function Yv(t){var e=t+"";return e.replace(h$,function(r){return f$[r]}).replace(/\n/g,"<br/>").replace(m$,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var u_=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function qr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function cg(t){for(var e="",r=0,n=0,s=0,a=0,i=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,e+=String.fromCharCode(i);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function d_(t){var e=Zo(2*t.length),r,n,s=1,a=0,i=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(e[a++]=i&255,e[a++]=i>>>8,i=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function f_(t){return nc(t,"binary").toString("utf8")}var k0="foo bar baz",$r=xr&&(f_(k0)==cg(k0)&&f_||d_(k0)==cg(k0)&&d_)||cg,cd=xr?function(t){return nc(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},hf=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),uI=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),p$=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),g$=/<\/?(?:vt:)?variant>/g,x$=/<(?:vt:)([^>]*)>([\s\S]*)</;function h_(t,e){var r=Kt(t),n=t.match(p$(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(g$,"").match(x$);i&&s.push({v:$r(i[2]),t:i[1]})}),s}var v$=/(^\s|\s$|\n)/;function y$(t){return Ni(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function w$(t,e,r){return"<"+t+(r!=null?y$(r):"")+(e!=null?(e.match(v$)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Jv(t){if(xr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return $r(sc(Gv(t)));throw new Error("Bad input format: expected Buffer or string")}var mf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,b$={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},_$=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function S$(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,a=5;a>=0;--a)s=s*256+t[e+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function E$(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,a=0,i=n?-e:e;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(e)?26985:0);for(var o=0;o<=5;++o,a/=256)t[r+o]=a&255;t[r+6]=(s&15)<<4|a&15,t[r+7]=s>>4|n}var m_=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,a=t[0][n].length;s<a;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},p_=xr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:nc(e)})):m_(t)}:m_,g_=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(Bi(t,s)));return n.join("").replace(Os,"")},Zv=xr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Os,""):g_(t,e,r)}:g_,x_=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},dI=xr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):x_(t,e,r)}:x_,v_=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(Sc(t,s)));return n.join("")},Mf=xr?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):v_(e,r,n)}:v_,fI=function(t,e){var r=ia(t,e);return r>0?Mf(t,e+4,e+4+r-1):""},hI=fI,mI=function(t,e){var r=ia(t,e);return r>0?Mf(t,e+4,e+4+r-1):""},pI=mI,gI=function(t,e){var r=2*ia(t,e);return r>0?Mf(t,e+4,e+4+r-1):""},xI=gI,vI=function(e,r){var n=ia(e,r);return n>0?Zv(e,r+4,r+4+n):""},yI=vI,wI=function(t,e){var r=ia(t,e);return r>0?Mf(t,e+4,e+4+r):""},bI=wI,_I=function(t,e){return S$(t,e)},rm=_I,SI=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};xr&&(hI=function(e,r){if(!Buffer.isBuffer(e))return fI(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},pI=function(e,r){if(!Buffer.isBuffer(e))return mI(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},xI=function(e,r){if(!Buffer.isBuffer(e))return gI(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},yI=function(e,r){if(!Buffer.isBuffer(e))return vI(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},bI=function(e,r){if(!Buffer.isBuffer(e))return wI(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},rm=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):_I(e,r)},SI=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Sc=function(t,e){return t[e]},Bi=function(t,e){return t[e+1]*256+t[e]},T$=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},ia=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},vl=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},k$=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function kd(t,e){var r="",n,s,a=[],i,o,c,u;switch(e){case"dbcs":if(u=this.l,xr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(Bi(this,u)),u+=2;t*=2;break;case"utf8":r=Mf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Zv(this,this.l,this.l+t);break;case"wstr":return kd.call(this,t,"dbcs");case"lpstr-ansi":r=hI(this,this.l),t=4+ia(this,this.l);break;case"lpstr-cp":r=pI(this,this.l),t=4+ia(this,this.l);break;case"lpwstr":r=xI(this,this.l),t=4+2*ia(this,this.l);break;case"lpp4":t=4+ia(this,this.l),r=yI(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ia(this,this.l),r=bI(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(i=Sc(this,this.l+t++))!==0;)a.push(T0(i));r=a.join("");break;case"_wstr":for(t=0,r="";(i=Bi(this,this.l+t))!==0;)a.push(T0(i)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Sc(this,u),this.l=u+1,o=kd.call(this,t-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(T0(Bi(this,u))),u+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Sc(this,u),this.l=u+1,o=kd.call(this,t-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(T0(Sc(this,u))),u+=1}r=a.join("");break;default:switch(t){case 1:return n=Sc(this,this.l),this.l++,n;case 2:return n=(e==="i"?T$:Bi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?vl:k$)(this,this.l),this.l+=4,n):(s=ia(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=rm(this,this.l):s=rm([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=dI(this,this.l,t);break}}return this.l+=t,r}var A$=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},I$=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},C$=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function N$(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)C$(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var i=e.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,A$(this,e,this.l);break;case 8:if(n=8,r==="f"){E$(this,e,this.l);break}case 16:break;case-4:n=4,I$(this,e,this.l);break}return this.l+=n,this}function EI(t,e){var r=dI(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function ts(t,e){t.l=e,t.read_shift=kd,t.chk=EI,t.write_shift=N$}function Es(t,e){t.l+=e}function Pn(t){var e=Zo(t);return ts(e,0),e}function ao(t,e,r){if(t){var n,s,a;ts(t,t.l||0);for(var i=t.length,o=0,c=0;t.l<i;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var u=lm[o]||lm[65535];for(n=t.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=t.read_shift(1))&127)<<7*s;c=t.l+a;var d=u.f&&u.f(t,a,r);if(t.l=c,e(d,u,o))return}}}function Bx(){var t=[],e=xr?256:2048,r=function(u){var d=Pn(u);return ts(d,0),d},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,e)))},i=function(){return s(),Eo(t)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:o,end:i,_bufs:t}}function Ad(t,e,r){var n=ss(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function y_(t,e,r){var n=ss(t);return n.s=Ad(n.s,e.s,r),n.e=Ad(n.e,e.s,r),n}function Id(t,e){if(t.cRel&&t.c<0)for(t=ss(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=ss(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Yt(t);return!t.cRel&&t.cRel!=null&&(r=j$(r)),!t.rRel&&t.rRel!=null&&(r=R$(r)),r}function ug(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Ln(t.s.c)+":"+(t.e.cRel?"":"$")+Ln(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+as(t.s.r)+":"+(t.e.rRel?"":"$")+as(t.e.r):Id(t.s,e.biff)+":"+Id(t.e,e.biff)}function ey(t){return parseInt(P$(t),10)-1}function as(t){return""+(t+1)}function R$(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function P$(t){return t.replace(/\$(\d+)$/,"$1")}function ty(t){for(var e=D$(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Ln(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function j$(t){return t.replace(/^([A-Z])/,"$$$1")}function D$(t){return t.replace(/^\$([A-Z])/,"$1")}function F$(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ds(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Yt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Iu(t){var e=t.indexOf(":");return e==-1?{s:Ds(t),e:Ds(t)}:{s:Ds(t.slice(0,e)),e:Ds(t.slice(e+1))}}function _r(t,e){return typeof e>"u"||typeof e=="number"?_r(t.s,t.e):(typeof t!="string"&&(t=Yt(t)),typeof e!="string"&&(e=Yt(e)),t==e?t:t+":"+e)}function ln(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=t.length;for(r=0;n<a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===a||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function w_(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Na(t.z,r?Ms(e):e)}catch{}try{return t.w=Na((t.XF||{}).numFmtId||(r?14:0),r?Ms(e):e)}catch{return""+e}}function to(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?oc[t.v]||t.v:e==null?w_(t,t.v):w_(t,e))}function cl(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function TI(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,a=t||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Ds(n.origin):n.origin;i=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=ln(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[h].length;++m)if(!(typeof e[h][m]>"u")){var p={v:e[h][m]},y=i+h,v=o+m;if(u.s.r>y&&(u.s.r=y),u.s.c>v&&(u.s.c=v),u.e.r<y&&(u.e.r=y),u.e.c<v&&(u.e.c=v),e[h][m]&&typeof e[h][m]=="object"&&!Array.isArray(e[h][m])&&!(e[h][m]instanceof Date))p=e[h][m];else if(Array.isArray(p.v)&&(p.f=e[h][m][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||nr[14],n.cellDates?(p.t="d",p.w=Na(p.z,Ms(p.v))):(p.t="n",p.v=Ms(p.v),p.w=Na(p.z,p.v))):p.t="s";if(s)a[y]||(a[y]=[]),a[y][v]&&a[y][v].z&&(p.z=a[y][v].z),a[y][v]=p;else{var b=Yt({c:v,r:y});a[b]&&a[b].z&&(p.z=a[b].z),a[b]=p}}}return u.s.c<1e7&&(a["!ref"]=_r(u)),a}function Cu(t,e){return TI(null,t,e)}function L$(t){return t.read_shift(4,"i")}function bs(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function O$(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function ry(t,e){var r=t.l,n=t.read_shift(1),s=bs(t),a=[],i={t:s,h:s};if(n&1){for(var o=t.read_shift(4),c=0;c!=o;++c)a.push(O$(t));i.r=a}else i.r=[{ich:0,ifnt:0}];return t.l=r+e,i}var M$=ry;function Pa(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function ac(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var $$=bs;function ny(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var U$=bs,zx=ny;function sy(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?rm([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):vl(e,0)>>2;return r?s/100:s}function kI(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var ic=kI;function ys(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function V$(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),a=t.read_shift(2,"i"),i=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var u=jl[s];u&&(e.rgb=gf(u));break;case 2:e.rgb=gf([i,o,c]);break;case 3:e.theme=s;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function B$(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function AI(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function z$(t){return AI(t,1)}function W$(t){return AI(t,2)}var ay=2,Gs=3,A0=11,b_=12,nm=19,I0=64,H$=65,G$=71,q$=4108,K$=4126,Bn=80,II=81,Q$=[Bn,II],X$={1:{n:"CodePage",t:ay},2:{n:"Category",t:Bn},3:{n:"PresentationFormat",t:Bn},4:{n:"ByteCount",t:Gs},5:{n:"LineCount",t:Gs},6:{n:"ParagraphCount",t:Gs},7:{n:"SlideCount",t:Gs},8:{n:"NoteCount",t:Gs},9:{n:"HiddenCount",t:Gs},10:{n:"MultimediaClipCount",t:Gs},11:{n:"ScaleCrop",t:A0},12:{n:"HeadingPairs",t:q$},13:{n:"TitlesOfParts",t:K$},14:{n:"Manager",t:Bn},15:{n:"Company",t:Bn},16:{n:"LinksUpToDate",t:A0},17:{n:"CharacterCount",t:Gs},19:{n:"SharedDoc",t:A0},22:{n:"HyperlinksChanged",t:A0},23:{n:"AppVersion",t:Gs,p:"version"},24:{n:"DigSig",t:H$},26:{n:"ContentType",t:Bn},27:{n:"ContentStatus",t:Bn},28:{n:"Language",t:Bn},29:{n:"Version",t:Bn},255:{},2147483648:{n:"Locale",t:nm},2147483651:{n:"Behavior",t:nm},1919054434:{}},Y$={1:{n:"CodePage",t:ay},2:{n:"Title",t:Bn},3:{n:"Subject",t:Bn},4:{n:"Author",t:Bn},5:{n:"Keywords",t:Bn},6:{n:"Comments",t:Bn},7:{n:"Template",t:Bn},8:{n:"LastAuthor",t:Bn},9:{n:"RevNumber",t:Bn},10:{n:"EditTime",t:I0},11:{n:"LastPrinted",t:I0},12:{n:"CreatedDate",t:I0},13:{n:"ModifiedDate",t:I0},14:{n:"PageCount",t:Gs},15:{n:"WordCount",t:Gs},16:{n:"CharCount",t:Gs},17:{n:"Thumbnail",t:G$},18:{n:"Application",t:Bn},19:{n:"DocSecurity",t:Gs},255:{},2147483648:{n:"Locale",t:nm},2147483651:{n:"Behavior",t:nm},1919054434:{}},__={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},J$=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Z$(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var eU=Z$([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),jl=ss(eU),oc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},CI={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},S_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function tU(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function rU(t){var e=tU();if(!t||!t.match)return e;var r={};if((t.match(Ts)||[]).forEach(function(n){var s=Kt(n);switch(s[0].replace(u$,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[S_[s.ContentType]]!==void 0&&e[S_[s.ContentType]].push(s.PartName);break}}),e.xmlns!==b$.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var Mc={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Wx(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Cd(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Ts)||[]).forEach(function(s){var a=Kt(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:ld(a.Target,e);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}var nU="application/vnd.oasis.opendocument.spreadsheet";function sU(t,e){for(var r=Jv(t),n,s;n=mf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Kt(n[0],!1),s.path=="/"&&s.type!==nU)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var Nd=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],aU=function(){for(var t=new Array(Nd.length),e=0;e<Nd.length;++e){var r=Nd[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function NI(t){var e={};t=$r(t);for(var r=0;r<Nd.length;++r){var n=Nd[r],s=t.match(aU[r]);s!=null&&s.length>0&&(e[n[1]]=Er(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Hn(e[n[1]]))}return e}var iU=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function RI(t,e,r,n){var s=[];if(typeof t=="string")s=h_(t,n);else for(var a=0;a<t.length;++a)s=s.concat(t[a].map(function(d){return{v:d}}));var i=typeof e=="string"?h_(e,n).map(function(d){return d.v}):e,o=0,c=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(c=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function oU(t,e,r){var n={};return e||(e={}),t=$r(t),iU.forEach(function(s){var a=(t.match(hf(s[0]))||[])[1];switch(s[2]){case"string":a&&(e[s[1]]=Er(a));break;case"bool":e[s[1]]=a==="true";break;case"raw":var i=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&RI(n.HeadingPairs,n.TitlesOfParts,e,r),e}var lU=/<[^>]+>[^<]*/g;function cU(t,e){var r={},n="",s=t.match(lU);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Kt(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Er(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Er(d);break;case"bool":r[n]=qr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Hn(d);break;case"cy":case"error":r[n]=Er(d);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,c)}}else if(i.slice(0,2)!=="</"){if(e.WTF)throw new Error(i)}}}return r}var uU={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},dg;function dU(t,e,r){dg||(dg=Qv(uU)),e=dg[e]||e,t[e]=r}function iy(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function PI(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function jI(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function DI(t,e,r){return e===31?jI(t):PI(t,e,r)}function Hx(t,e,r){return DI(t,e,r===!1?0:4)}function fU(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return DI(t,e,0)}function hU(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Os,""),t.l-s&2&&(t.l+=2)}return r}function mU(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Os,"");return r}function pU(t){var e=t.l,r=sm(t,II);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=sm(t,Gs);return[r,n]}function gU(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(pU(t));return r}function E_(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var a=t.read_shift(4),i=t.read_shift(4);n[a]=t.read_shift(i,e===1200?"utf16le":"utf8").replace(Os,"").replace(od,"!"),e===1200&&i%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function FI(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function xU(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function sm(t,e,r){var n=t.read_shift(2),s,a=r||{};if(t.l+=2,e!==b_&&n!==e&&Q$.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===b_?n:e){case 2:return s=t.read_shift(2,"i"),a.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return PI(t,n,4).replace(Os,"");case 31:return jI(t);case 64:return iy(t);case 65:return FI(t);case 71:return xU(t);case 80:return Hx(t,n,!a.raw).replace(Os,"");case 81:return fU(t,n).replace(Os,"");case 4108:return gU(t);case 4126:case 4127:return n==4127?hU(t):mU(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function T_(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0,o=0,c=-1,u={};for(i=0;i!=s;++i){var d=t.read_shift(4),h=t.read_shift(4);a[i]=[d,h+r]}a.sort(function(T,w){return T[1]-w[1]});var m={};for(i=0;i!=s;++i){if(t.l!==a[i][1]){var p=!0;if(i>0&&e)switch(e[a[i-1][0]].t){case 2:t.l+2===a[i][1]&&(t.l+=2,p=!1);break;case 80:t.l<=a[i][1]&&(t.l=a[i][1],p=!1);break;case 4108:t.l<=a[i][1]&&(t.l=a[i][1],p=!1);break}if((!e||i==0)&&t.l<=a[i][1]&&(p=!1,t.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+t.l+" :"+i)}if(e){var y=e[a[i][0]];if(m[y.n]=sm(t,y.t,{raw:!0}),y.p==="version"&&(m[y.n]=String(m[y.n]>>16)+"."+("0000"+String(m[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(m[y.n]){case 0:m[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Qa(o=m[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[y.n])}}else if(a[i][0]===1){if(o=m.CodePage=sm(t,ay),Qa(o),c!==-1){var v=t.l;t.l=a[c][1],u=E_(t,o),t.l=v}}else if(a[i][0]===0){if(o===0){c=i,t.l=a[i+1][1];continue}u=E_(t,o)}else{var b=u[a[i][0]],E;switch(t[t.l]){case 65:t.l+=4,E=FI(t);break;case 30:t.l+=4,E=Hx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,E=Hx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,E=t.read_shift(4,"i");break;case 19:t.l+=4,E=t.read_shift(4);break;case 5:t.l+=4,E=t.read_shift(8,"f");break;case 11:t.l+=4,E=un(t,4);break;case 64:t.l+=4,E=Hn(iy(t));break;default:throw new Error("unparsed value: "+t[t.l])}m[b]=E}}return t.l=r+n,m}function k_(t,e,r){var n=t.content;if(!n)return{};ts(n,0);var s,a,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==br.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),c=n.read_shift(4));var h=T_(n,e),m={SystemIdentifier:u};for(var p in h)m[p]=h[p];if(m.FMTID=a,s===1)return m;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var y;try{y=T_(n,null)}catch{}for(p in y)m[p]=y[p];return m.FMTID=[a,i],m}function mo(t,e){return t.read_shift(e),null}function vU(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function un(t,e){return t.read_shift(e)===1}function _n(t){return t.read_shift(2,"u")}function LI(t,e){return vU(t,e,_n)}function yU(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function $f(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?t.read_shift(n,s):"";return i}function wU(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,c={};s&&(i=t.read_shift(2)),n&&(o=t.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,u);return s&&(t.l+=4*i),n&&(t.l+=o),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function ql(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Uf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):ql(t,n,r)}function lc(t,e,r){if(r.biff>5)return Uf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function bU(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function _U(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Os,"");return n&&(t.l+=24),s}function SU(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=t.read_shift(a>>1,"utf16le").replace(Os,"");return r+i}function EU(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return _U(t);case"0303000000000000c000000000000046":return SU(t);default:throw new Error("Unsupported Moniker "+r)}}function C0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Os,""):"";return r}function TU(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var a,i,o,c,u="",d,h;s&16&&(a=C0(t,r-t.l)),s&128&&(i=C0(t,r-t.l)),(s&257)===257&&(o=C0(t,r-t.l)),(s&257)===1&&(c=EU(t,r-t.l)),s&8&&(u=C0(t,r-t.l)),s&32&&(d=t.read_shift(16)),s&64&&(h=iy(t)),t.l=r;var m=i||o||c||"";m&&u&&(m+="#"+u),m||(m="#"+u),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var p={Target:m};return d&&(p.guid=d),h&&(p.time=h),a&&(p.Tooltip=a),p}function OI(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function MI(t,e){var r=OI(t);return r[3]=0,r}function ji(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function kU(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function AU(t,e,r){return e===0?"":lc(t,e,r)}function IU(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),a=t.read_shift(n,"i"),i=t.read_shift(n,"i");return[s,a,i]}function $I(t){var e=t.read_shift(2),r=sy(t);return[e,r]}function CU(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=$f(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,s}function sp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function UI(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var NU=UI;function VI(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function RU(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function PU(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function hs(t){t.l+=2,t.l+=t.read_shift(2)}var jU={0:hs,4:hs,5:hs,6:hs,7:PU,8:hs,9:hs,10:hs,11:hs,12:hs,13:RU,14:hs,15:hs,16:hs,17:hs,18:hs,19:hs,20:hs,21:VI};function DU(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(jU[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function N0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function FU(t,e){return e===0||t.read_shift(2),1200}function LU(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=lc(t,0,r);return t.read_shift(e+n-t.l),s}function OU(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function MU(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=$f(t,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function $U(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0;i!=s&&t.l<r;++i)a.push(wU(t));return a.Count=n,a.Unique=s,a}function UU(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function VU(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function BU(t){var e=kU(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function zU(t){return t.read_shift(2),t.read_shift(4)}function A_(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function WU(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:c,TabRatio:u}}function HU(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function GU(){}function qU(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=$f(t,0,r),n}function KU(t){var e=ji(t);return e.isst=t.read_shift(4),e}function QU(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=ji(t);r.biff==2&&t.l++;var a=Uf(t,n-t.l,r);return s.val=a,s}function XU(t,e,r){var n=t.read_shift(2),s=lc(t,0,r);return[n,s]}var YU=lc;function I_(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,a=t.read_shift(s),i=t.read_shift(s),o=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:a,c:o},e:{r:i,c}}}function JU(t){var e=t.read_shift(2),r=t.read_shift(2),n=$I(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function ZU(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push($I(t));if(t.l!==r)throw new Error("MulRK read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function eV(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function tV(t,e,r,n){var s={},a=t.read_shift(4),i=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(2);return s.patternType=J$[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function rV(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=tV(t,e,n.fStyle,r),n}function nV(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function C_(t,e,r){var n=ji(t);(r.biff==2||e==9)&&++t.l;var s=yU(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function sV(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ji(t),s=ys(t);return n.val=s,n}var N_=AU;function aV(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=ql(t,a),o=[];n>t.l;)o.push(Uf(t));return[a,s,i,o]}function R_(t,e,r){var n=t.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=CU(t,e-2,r)),a.body=s||t.read_shift(e-2),typeof s=="string"&&(a.Name=s),a}var iV=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function P_(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(1),i=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=ql(t,i,r);s&32&&(u=iV[u.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var h=n==t.l||o===0||!(d>0)?[]:VW(t,d,r,o);return{chKey:a,Name:u,itab:c,rgce:h}}function BI(t,e,r){if(r.biff<8)return oV(t,e,r);for(var n=[],s=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(IU(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function oV(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=$f(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function lV(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),a=ql(t,n,r),i=ql(t,s,r);return[a,i]}function cV(t,e,r){var n=UI(t);t.l++;var s=t.read_shift(1);return e-=8,[BW(t,e,r),s,n]}function j_(t,e,r){var n=NU(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,$W(t,e,r)]}function uV(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function dV(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=lc(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,i,a]}}function fV(t,e,r){return dV(t,e,r)}function hV(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(sp(t));return r}function mV(t,e,r){if(r&&r.biff<8)return gV(t,e,r);var n=VI(t),s=DU(t,e-22,n[1]);return{cmo:n,ft:s}}var pV={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function gV(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var i=[];return i.push((pV[n]||Es)(t,e,r)),{cmo:[s,n,a],ft:i}}function xV(t,e,r){var n=t.l,s="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:i=bU(t,6,r);var o=t.read_shift(2);t.read_shift(2),_n(t,2);var c=t.read_shift(2);t.l+=c;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var d=t[t.l],h=ql(t,t.lens[u+1]-t.lens[u]-1);if(s+=h,s.length>=(d?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function vV(t,e){var r=sp(t);t.l+=16;var n=TU(t,e-24);return[r,n]}function yV(t,e){t.read_shift(2);var r=sp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Os,""),[r,n]}function wV(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=__[r]||r,r=t.read_shift(2),e[1]=__[r]||r,e}function bV(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(MI(t));return r}function _V(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(MI(t));return r}function SV(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function zI(t,e,r){if(!r.cellStyles)return Es(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),a=t.read_shift(n),i=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var u={s,e:a,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function EV(t,e){var r={};return e<32||(t.l+=16,r.header=ys(t),r.footer=ys(t),t.l+=2),r}function TV(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}var kV=ji,AV=LI,IV=Uf;function CV(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function NV(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ji(t);++t.l;var s=lc(t,e-7,r);return n.t="str",n.val=s,n}function RV(t){var e=ji(t);++t.l;var r=ys(t);return e.t="n",e.val=r,e}function PV(t){var e=ji(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function jV(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function DV(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function FV(t,e,r){var n=t.l+e,s=ji(t),a=t.read_shift(2),i=ql(t,a,r);return t.l=n,s.t="str",s.val=i,s}var LV=[2,3,48,49,131,139,140,245],D_=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Qv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=Zo(1);switch(c.type){case"base64":d=Ga(ma(o));break;case"binary":d=Ga(o);break;case"buffer":case"array":d=o;break}ts(d,0);var h=d.read_shift(1),m=!!(h&136),p=!1,y=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,m=!0;break;case 49:p=!0,m=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var v=0,b=521;h==2&&(v=d.read_shift(2)),d.l+=3,h!=2&&(v=d.read_shift(4)),v>1048576&&(v=1e6),h!=2&&(b=d.read_shift(2));var E=d.read_shift(2),T=c.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(T=t[d[d.l]]),d.l+=1,d.l+=2),y&&(d.l+=36);for(var w=[],B={},J=Math.min(d.length,h==2?521:b-10-(p?264:0)),Z=y?32:11;d.l<J&&d[d.l]!=13;)switch(B={},B.name=df.utils.decode(T,d.slice(d.l,d.l+Z)).replace(/[\u0000\r\n].*$/g,""),d.l+=Z,B.type=String.fromCharCode(d.read_shift(1)),h!=2&&!y&&(B.offset=d.read_shift(4)),B.len=d.read_shift(1),h==2&&(B.offset=d.read_shift(2)),B.dec=d.read_shift(1),B.name.length&&w.push(B),h!=2&&(d.l+=y?13:14),B.type){case"B":(!p||B.len!=8)&&c.WTF&&console.log("Skipping "+B.name+":"+B.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+B.name+":"+B.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+B.type)}if(d[d.l]!==13&&(d.l=b-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=b;var _=0,I=0;for(u[0]=[],I=0;I!=w.length;++I)u[0][I]=w[I].name;for(;v-- >0;){if(d[d.l]===42){d.l+=E;continue}for(++d.l,u[++_]=[],I=0,I=0;I!=w.length;++I){var C=d.slice(d.l,d.l+w[I].len);d.l+=w[I].len,ts(C,0);var L=df.utils.decode(T,C);switch(w[I].type){case"C":L.trim().length&&(u[_][I]=L.replace(/\s+$/,""));break;case"D":L.length===8?u[_][I]=new Date(+L.slice(0,4),+L.slice(4,6)-1,+L.slice(6,8)):u[_][I]=L;break;case"F":u[_][I]=parseFloat(L.trim());break;case"+":case"I":u[_][I]=y?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(L.trim().toUpperCase()){case"Y":case"T":u[_][I]=!0;break;case"N":case"F":u[_][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+L+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[_][I]="##MEMO##"+(y?parseInt(L.trim(),10):C.read_shift(4));break;case"N":L=L.replace(/\u0000/g,"").trim(),L&&L!="."&&(u[_][I]=+L||0);break;case"@":u[_][I]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":u[_][I]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":u[_][I]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[_][I]=-C.read_shift(-8,"f");break;case"B":if(p&&w[I].len==8){u[_][I]=C.read_shift(8,"f");break}case"G":case"P":C.l+=w[I].len;break;case"0":if(w[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[I].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=w,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Cu(r(o,u),u);return d["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,d}function s(o,c){try{return cl(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var u=c||{};if(+u.codepage>=0&&Qa(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Bx(),h=Jx(o,{header:1,raw:!0,cellDates:!0}),m=h[0],p=h.slice(1),y=o["!cols"]||[],v=0,b=0,E=0,T=1;for(v=0;v<m.length;++v){if(((y[v]||{}).DBF||{}).name){m[v]=y[v].DBF.name,++E;continue}if(m[v]!=null){if(++E,typeof m[v]=="number"&&(m[v]=m[v].toString(10)),typeof m[v]!="string")throw new Error("DBF Invalid column name "+m[v]+" |"+typeof m[v]+"|");if(m.indexOf(m[v])!==v){for(b=0;b<1024;++b)if(m.indexOf(m[v]+"_"+b)==-1){m[v]+="_"+b;break}}}}var w=ln(o["!ref"]),B=[],J=[],Z=[];for(v=0;v<=w.e.c-w.s.c;++v){var _="",I="",C=0,L=[];for(b=0;b<p.length;++b)p[b][v]!=null&&L.push(p[b][v]);if(L.length==0||m[v]==null){B[v]="?";continue}for(b=0;b<L.length;++b){switch(typeof L[b]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=L[b]instanceof Date?"D":"C";break;default:I="C"}C=Math.max(C,String(L[b]).length),_=_&&_!=I?"C":I}C>250&&(C=250),I=((y[v]||{}).DBF||{}).type,I=="C"&&y[v].DBF.len>C&&(C=y[v].DBF.len),_=="B"&&I=="N"&&(_="N",Z[v]=y[v].DBF.dec,C=y[v].DBF.len),J[v]=_=="C"||I=="N"?C:a[_]||0,T+=J[v],B[v]=_}var F=d.next(32);for(F.write_shift(4,318902576),F.write_shift(4,p.length),F.write_shift(2,296+32*E),F.write_shift(2,T),v=0;v<4;++v)F.write_shift(4,0);for(F.write_shift(4,0|(+e[BA]||3)<<8),v=0,b=0;v<m.length;++v)if(m[v]!=null){var V=d.next(32),O=(m[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);V.write_shift(1,O,"sbcs"),V.write_shift(1,B[v]=="?"?"C":B[v],"sbcs"),V.write_shift(4,b),V.write_shift(1,J[v]||a[B[v]]||0),V.write_shift(1,Z[v]||0),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(1,0),V.write_shift(4,0),V.write_shift(4,0),b+=J[v]||a[B[v]]||0}var ct=d.next(264);for(ct.write_shift(4,13),v=0;v<65;++v)ct.write_shift(4,0);for(v=0;v<p.length;++v){var me=d.next(T);for(me.write_shift(1,0),b=0;b<m.length;++b)if(m[b]!=null)switch(B[b]){case"L":me.write_shift(1,p[v][b]==null?63:p[v][b]?84:70);break;case"B":me.write_shift(8,p[v][b]||0,"f");break;case"N":var ft="0";for(typeof p[v][b]=="number"&&(ft=p[v][b].toFixed(Z[b]||0)),E=0;E<J[b]-ft.length;++E)me.write_shift(1,32);me.write_shift(1,ft,"sbcs");break;case"D":p[v][b]?(me.write_shift(4,("0000"+p[v][b].getFullYear()).slice(-4),"sbcs"),me.write_shift(2,("00"+(p[v][b].getMonth()+1)).slice(-2),"sbcs"),me.write_shift(2,("00"+p[v][b].getDate()).slice(-2),"sbcs")):me.write_shift(8,"00000000","sbcs");break;case"C":var rt=String(p[v][b]!=null?p[v][b]:"").slice(0,J[b]);for(me.write_shift(1,rt,"sbcs"),E=0;E<J[b]-rt.length;++E)me.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),OV=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ni(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,p){var y=t[p];return typeof y=="number"?Xb(y):y},n=function(m,p,y){var v=p.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return v==59?m:Xb(v)};t["|"]=254;function s(m,p){switch(p.type){case"base64":return a(ma(m),p);case"binary":return a(m,p);case"buffer":return a(xr&&Buffer.isBuffer(m)?m.toString("binary"):sc(m),p);case"array":return a(Gl(m),p)}throw new Error("Unrecognized type "+p.type)}function a(m,p){var y=m.split(/[\n\r]+/),v=-1,b=-1,E=0,T=0,w=[],B=[],J=null,Z={},_=[],I=[],C=[],L=0,F;for(+p.codepage>=0&&Qa(+p.codepage);E!==y.length;++E){L=0;var V=y[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),O=V.replace(/;;/g,"\0").split(";").map(function(ne){return ne.replace(/\u0000/g,";")}),ct=O[0],me;if(V.length>0)switch(ct){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":O[1].charAt(0)=="P"&&B.push(V.slice(3).replace(/;;/g,";"));break;case"C":var ft=!1,rt=!1,ze=!1,ie=!1,Ye=-1,_e=-1;for(T=1;T<O.length;++T)switch(O[T].charAt(0)){case"A":break;case"X":b=parseInt(O[T].slice(1))-1,rt=!0;break;case"Y":for(v=parseInt(O[T].slice(1))-1,rt||(b=0),F=w.length;F<=v;++F)w[F]=[];break;case"K":me=O[T].slice(1),me.charAt(0)==='"'?me=me.slice(1,me.length-1):me==="TRUE"?me=!0:me==="FALSE"?me=!1:isNaN(Za(me))?isNaN(pu(me).getDate())||(me=Hn(me)):(me=Za(me),J!==null&&Au(J)&&(me=np(me))),ft=!0;break;case"E":ie=!0;var Q=Zc(O[T].slice(1),{r:v,c:b});w[v][b]=[w[v][b],Q];break;case"S":ze=!0,w[v][b]=[w[v][b],"S5S"];break;case"G":break;case"R":Ye=parseInt(O[T].slice(1))-1;break;case"C":_e=parseInt(O[T].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+V)}if(ft&&(w[v][b]&&w[v][b].length==2?w[v][b][0]=me:w[v][b]=me,J=null),ze){if(ie)throw new Error("SYLK shared formula cannot have own formula");var ae=Ye>-1&&w[Ye][_e];if(!ae||!ae[1])throw new Error("SYLK shared formula cannot find base");w[v][b][1]=ZI(ae[1],{r:v-Ye,c:b-_e})}break;case"F":var le=0;for(T=1;T<O.length;++T)switch(O[T].charAt(0)){case"X":b=parseInt(O[T].slice(1))-1,++le;break;case"Y":for(v=parseInt(O[T].slice(1))-1,F=w.length;F<=v;++F)w[F]=[];break;case"M":L=parseInt(O[T].slice(1))/20;break;case"F":break;case"G":break;case"P":J=B[parseInt(O[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=O[T].slice(1).split(" "),F=parseInt(C[0],10);F<=parseInt(C[1],10);++F)L=parseInt(C[2],10),I[F-1]=L===0?{hidden:!0}:{wch:L},gu(I[F-1]);break;case"C":b=parseInt(O[T].slice(1))-1,I[b]||(I[b]={});break;case"R":v=parseInt(O[T].slice(1))-1,_[v]||(_[v]={}),L>0?(_[v].hpt=L,_[v].hpx=xf(L)):L===0&&(_[v].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+V)}le<1&&(J=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+V)}}return _.length>0&&(Z["!rows"]=_),I.length>0&&(Z["!cols"]=I),p&&p.sheetRows&&(w=w.slice(0,p.sheetRows)),[w,Z]}function i(m,p){var y=s(m,p),v=y[0],b=y[1],E=Cu(v,p);return Ni(b).forEach(function(T){E[T]=b[T]}),E}function o(m,p){return cl(i(m,p),p)}function c(m,p,y,v){var b="C;Y"+(y+1)+";X"+(v+1)+";K";switch(m.t){case"n":b+=m.v||0,m.f&&!m.F&&(b+=";E"+Sz(m.f,{r:y,c:v}));break;case"b":b+=m.v?"TRUE":"FALSE";break;case"e":b+=m.w||m.v;break;case"d":b+='"'+(m.w||m.v)+'"';break;case"s":b+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function u(m,p){p.forEach(function(y,v){var b="F;W"+(v+1)+" "+(v+1)+" ";y.hidden?b+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=im(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=om(y.wpx)),typeof y.wch=="number"&&(b+=Math.round(y.wch))),b.charAt(b.length-1)!=" "&&m.push(b)})}function d(m,p){p.forEach(function(y,v){var b="F;";y.hidden?b+="M0;":y.hpt?b+="M"+20*y.hpt+";":y.hpx&&(b+="M"+20*XI(y.hpx)+";"),b.length>2&&m.push(b+"R"+(v+1))})}function h(m,p){var y=["ID;PWXL;N;E"],v=[],b=ln(m["!ref"]),E,T=Array.isArray(m),w=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),m["!cols"]&&u(y,m["!cols"]),m["!rows"]&&d(y,m["!rows"]),y.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var B=b.s.r;B<=b.e.r;++B)for(var J=b.s.c;J<=b.e.c;++J){var Z=Yt({r:B,c:J});E=T?(m[B]||[])[J]:m[Z],!(!E||E.v==null&&(!E.f||E.F))&&v.push(c(E,m,B,J))}return y.join(w)+w+v.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:i,from_sheet:h}}(),MV=function(){function t(a,i){switch(i.type){case"base64":return e(ma(a),i);case"binary":return e(a,i);case"buffer":return e(xr&&Buffer.isBuffer(a)?a.toString("binary"):sc(a),i);case"array":return e(Gl(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){for(var o=a.split(`
`),c=-1,u=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++c]=[],u=0;continue}if(!(c<0)){var m=o[d].trim().split(","),p=m[0],y=m[1];++d;for(var v=o[d]||"";(v.match(/["]/g)||[]).length&1&&d<o.length-1;)v+=`
`+o[++d];switch(v=v.trim(),+p){case-1:if(v==="BOT"){h[++c]=[],u=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?h[c][u]=!0:v==="FALSE"?h[c][u]=!1:isNaN(Za(y))?isNaN(pu(y).getDate())?h[c][u]=y:h[c][u]=Hn(y):h[c][u]=Za(y),++u;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),h[c][u++]=v!==""?v:null;break}if(v==="EOD")break}}return i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),h}function r(a,i){return Cu(t(a,i),i)}function n(a,i){return cl(r(a,i),i)}var s=function(){var a=function(c,u,d,h,m){c.push(u),c.push(d+","+h),c.push('"'+m.replace(/"/g,'""')+'"')},i=function(c,u,d,h){c.push(u+","+d),c.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var u=[],d=ln(c["!ref"]),h,m=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){i(u,-1,0,"BOT");for(var y=d.s.c;y<=d.e.c;++y){var v=Yt({r:p,c:y});if(h=m?(c[p]||[])[y]:c[v],!h){i(u,1,0,"");continue}switch(h.t){case"n":var b=h.w;!b&&h.v!=null&&(b=h.v),b==null?h.f&&!h.F?i(u,1,0,"="+h.f):i(u,1,0,""):i(u,0,b,"V");break;case"b":i(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Na(h.z||nr[14],Ms(Hn(h.v)))),i(u,0,h.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var E=`\r
`,T=u.join(E);return T}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),$V=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,m){for(var p=h.split(`
`),y=-1,v=-1,b=0,E=[];b!==p.length;++b){var T=p[b].trim().split(":");if(T[0]==="cell"){var w=Ds(T[1]);if(E.length<=w.r)for(y=E.length;y<=w.r;++y)E[y]||(E[y]=[]);switch(y=w.r,v=w.c,T[2]){case"t":E[y][v]=t(T[3]);break;case"v":E[y][v]=+T[3];break;case"vtf":var B=T[T.length-1];case"vtc":switch(T[3]){case"nl":E[y][v]=!!+T[4];break;default:E[y][v]=+T[4];break}T[2]=="vtf"&&(E[y][v]=[E[y][v],B])}}}return m&&m.sheetRows&&(E=E.slice(0,m.sheetRows)),E}function n(h,m){return Cu(r(h,m),m)}function s(h,m){return cl(n(h,m),m)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var m=[],p=[],y,v="",b=Iu(h["!ref"]),E=Array.isArray(h),T=b.s.r;T<=b.e.r;++T)for(var w=b.s.c;w<=b.e.c;++w)if(v=Yt({r:T,c:w}),y=E?(h[T]||[])[w]:h[v],!(!y||y.v==null||y.t==="z")){switch(p=["cell",v,"t"],y.t){case"s":case"str":p.push(e(y.v));break;case"n":y.f?(p[2]="vtf",p[3]="n",p[4]=y.v,p[5]=e(y.f)):(p[2]="v",p[3]=y.v);break;case"b":p[2]="vt"+(y.f?"f":"c"),p[3]="nl",p[4]=y.v?"1":"0",p[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var B=Ms(Hn(y.v));p[2]="vtc",p[3]="nd",p[4]=""+B,p[5]=y.w||Na(y.z||nr[14],B);break;case"e":continue}m.push(p.join(":"))}return m.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function d(h){return[a,i,o,i,u(h),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),pf=function(){function t(d,h,m,p,y){y.raw?h[m][p]=d:d===""||(d==="TRUE"?h[m][p]=!0:d==="FALSE"?h[m][p]=!1:isNaN(Za(d))?isNaN(pu(d).getDate())?h[m][p]=d:h[m][p]=Hn(d):h[m][p]=Za(d))}function e(d,h){var m=h||{},p=[];if(!d||d.length===0)return p;for(var y=d.split(/[\r\n]/),v=y.length-1;v>=0&&y[v].length===0;)--v;for(var b=10,E=0,T=0;T<=v;++T)E=y[T].indexOf(" "),E==-1?E=y[T].length:E++,b=Math.max(b,E);for(T=0;T<=v;++T){p[T]=[];var w=0;for(t(y[T].slice(0,b).trim(),p,T,w,m),w=1;w<=(y[T].length-b)/10+1;++w)t(y[T].slice(b+(w-1)*10,b+w*10).trim(),p,T,w,m)}return m.sheetRows&&(p=p.slice(0,m.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var h={},m=!1,p=0,y=0;p<d.length;++p)(y=d.charCodeAt(p))==34?m=!m:!m&&y in r&&(h[y]=(h[y]||0)+1);y=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&y.push([h[p],p]);if(!y.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&y.push([h[p],p])}return y.sort(function(v,b){return v[0]-b[0]||n[v[1]]-n[b[1]]}),r[y.pop()[1]]||44}function a(d,h){var m=h||{},p="",y=m.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=s(d.slice(0,1024)):m&&m.FS?p=m.FS:p=s(d.slice(0,1024));var b=0,E=0,T=0,w=0,B=0,J=p.charCodeAt(0),Z=!1,_=0,I=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var C=m.dateNF!=null?X9(m.dateNF):null;function L(){var F=d.slice(w,B),V={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)V.t="z";else if(m.raw)V.t="s",V.v=F;else if(F.trim().length===0)V.t="s",V.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(V.t="s",V.v=F.slice(2,-1).replace(/""/g,'"')):Tz(F)?(V.t="n",V.f=F.slice(1)):(V.t="s",V.v=F);else if(F=="TRUE")V.t="b",V.v=!0;else if(F=="FALSE")V.t="b",V.v=!1;else if(!isNaN(T=Za(F)))V.t="n",m.cellText!==!1&&(V.w=F),V.v=T;else if(!isNaN(pu(F).getDate())||C&&F.match(C)){V.z=m.dateNF||nr[14];var O=0;C&&F.match(C)&&(F=Y9(F,m.dateNF,F.match(C)||[]),O=1),m.cellDates?(V.t="d",V.v=Hn(F,O)):(V.t="n",V.v=Ms(Hn(F,O))),m.cellText!==!1&&(V.w=Na(V.z,V.v instanceof Date?Ms(V.v):V.v)),m.cellNF||delete V.z}else V.t="s",V.v=F;if(V.t=="z"||(m.dense?(y[b]||(y[b]=[]),y[b][E]=V):y[Yt({c:E,r:b})]=V),w=B+1,I=d.charCodeAt(w),v.e.c<E&&(v.e.c=E),v.e.r<b&&(v.e.r=b),_==J)++E;else if(E=0,++b,m.sheetRows&&m.sheetRows<=b)return!0}e:for(;B<d.length;++B)switch(_=d.charCodeAt(B)){case 34:I===34&&(Z=!Z);break;case J:case 10:case 13:if(!Z&&L())break e;break}return B-w>0&&L(),y["!ref"]=_r(v),y}function i(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,h):Cu(e(d,h),h)}function o(d,h){var m="",p=h.type=="string"?[0,0,0,0]:my(d,h);switch(h.type){case"base64":m=ma(d);break;case"binary":m=d;break;case"buffer":h.codepage==65001?m=d.toString("utf8"):h.codepage&&typeof df<"u"||(m=xr&&Buffer.isBuffer(d)?d.toString("binary"):sc(d));break;case"array":m=Gl(d);break;case"string":m=d;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?m=$r(m.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?m=$r(m):h.type=="binary"&&typeof df<"u",m.slice(0,19)=="socialcalc:version:"?$V.to_sheet(h.type=="string"?m:$r(m),h):i(m,h)}function c(d,h){return cl(o(d,h),h)}function u(d){for(var h=[],m=ln(d["!ref"]),p,y=Array.isArray(d),v=m.s.r;v<=m.e.r;++v){for(var b=[],E=m.s.c;E<=m.e.c;++E){var T=Yt({r:v,c:E});if(p=y?(d[v]||[])[E]:d[T],!p||p.v==null){b.push("          ");continue}for(var w=(p.w||(to(p),p.w)||"").slice(0,10);w.length<10;)w+=" ";b.push(w+(E===0?" ":""))}h.push(b.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}();function UV(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=OV.to_workbook(t,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return pf.to_workbook(t,e)}}var Rd=function(){function t(Q,ae,le){if(Q){ts(Q,Q.l||0);for(var ne=le.Enum||Ye;Q.l<Q.length;){var Ae=Q.read_shift(2),st=ne[Ae]||ne[65535],ot=Q.read_shift(2),Ne=Q.l+ot,Ve=st.f&&st.f(Q,ot,le);if(Q.l=Ne,ae(Ve,st,Ae))return}}}function e(Q,ae){switch(ae.type){case"base64":return r(Ga(ma(Q)),ae);case"binary":return r(Ga(Q),ae);case"buffer":case"array":return r(Q,ae)}throw"Unsupported type "+ae.type}function r(Q,ae){if(!Q)return Q;var le=ae||{},ne=le.dense?[]:{},Ae="Sheet1",st="",ot=0,Ne={},Ve=[],ge=[],W={s:{r:0,c:0},e:{r:0,c:0}},we=le.sheetRows||0;if(Q[2]==0&&(Q[3]==8||Q[3]==9)&&Q.length>=16&&Q[14]==5&&Q[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(Q[2]==2)le.Enum=Ye,t(Q,function(qe,Ft,Mt){switch(Mt){case 0:le.vers=qe,qe>=4096&&(le.qpro=!0);break;case 6:W=qe;break;case 204:qe&&(st=qe);break;case 222:st=qe;break;case 15:case 51:le.qpro||(qe[1].v=qe[1].v.slice(1));case 13:case 14:case 16:Mt==14&&(qe[2]&112)==112&&(qe[2]&15)>1&&(qe[2]&15)<15&&(qe[1].z=le.dateNF||nr[14],le.cellDates&&(qe[1].t="d",qe[1].v=np(qe[1].v))),le.qpro&&qe[3]>ot&&(ne["!ref"]=_r(W),Ne[Ae]=ne,Ve.push(Ae),ne=le.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},ot=qe[3],Ae=st||"Sheet"+(ot+1),st="");var Ot=le.dense?(ne[qe[0].r]||[])[qe[0].c]:ne[Yt(qe[0])];if(Ot){Ot.t=qe[1].t,Ot.v=qe[1].v,qe[1].z!=null&&(Ot.z=qe[1].z),qe[1].f!=null&&(Ot.f=qe[1].f);break}le.dense?(ne[qe[0].r]||(ne[qe[0].r]=[]),ne[qe[0].r][qe[0].c]=qe[1]):ne[Yt(qe[0])]=qe[1];break}},le);else if(Q[2]==26||Q[2]==14)le.Enum=_e,Q[2]==14&&(le.qpro=!0,Q.l=0),t(Q,function(qe,Ft,Mt){switch(Mt){case 204:Ae=qe;break;case 22:qe[1].v=qe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(qe[3]>ot&&(ne["!ref"]=_r(W),Ne[Ae]=ne,Ve.push(Ae),ne=le.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},ot=qe[3],Ae="Sheet"+(ot+1)),we>0&&qe[0].r>=we)break;le.dense?(ne[qe[0].r]||(ne[qe[0].r]=[]),ne[qe[0].r][qe[0].c]=qe[1]):ne[Yt(qe[0])]=qe[1],W.e.c<qe[0].c&&(W.e.c=qe[0].c),W.e.r<qe[0].r&&(W.e.r=qe[0].r);break;case 27:qe[14e3]&&(ge[qe[14e3][0]]=qe[14e3][1]);break;case 1537:ge[qe[0]]=qe[1],qe[0]==ot&&(Ae=qe[1]);break}},le);else throw new Error("Unrecognized LOTUS BOF "+Q[2]);if(ne["!ref"]=_r(W),Ne[st||Ae]=ne,Ve.push(st||Ae),!ge.length)return{SheetNames:Ve,Sheets:Ne};for(var et={},ht=[],Qe=0;Qe<ge.length;++Qe)Ne[Ve[Qe]]?(ht.push(ge[Qe]||Ve[Qe]),et[ge[Qe]]=Ne[ge[Qe]]||Ne[Ve[Qe]]):(ht.push(ge[Qe]),et[ge[Qe]]={"!ref":"A1"});return{SheetNames:ht,Sheets:et}}function n(Q,ae){var le=ae||{};if(+le.codepage>=0&&Qa(+le.codepage),le.type=="string")throw new Error("Cannot write WK1 to JS string");var ne=Bx(),Ae=ln(Q["!ref"]),st=Array.isArray(Q),ot=[];Ba(ne,0,a(1030)),Ba(ne,6,c(Ae));for(var Ne=Math.min(Ae.e.r,8191),Ve=Ae.s.r;Ve<=Ne;++Ve)for(var ge=as(Ve),W=Ae.s.c;W<=Ae.e.c;++W){Ve===Ae.s.r&&(ot[W]=Ln(W));var we=ot[W]+ge,et=st?(Q[Ve]||[])[W]:Q[we];if(!(!et||et.t=="z"))if(et.t=="n")(et.v|0)==et.v&&et.v>=-32768&&et.v<=32767?Ba(ne,13,p(Ve,W,et.v)):Ba(ne,14,v(Ve,W,et.v));else{var ht=to(et);Ba(ne,15,h(Ve,W,ht.slice(0,239)))}}return Ba(ne,1),ne.end()}function s(Q,ae){var le=ae||{};if(+le.codepage>=0&&Qa(+le.codepage),le.type=="string")throw new Error("Cannot write WK3 to JS string");var ne=Bx();Ba(ne,0,i(Q));for(var Ae=0,st=0;Ae<Q.SheetNames.length;++Ae)(Q.Sheets[Q.SheetNames[Ae]]||{})["!ref"]&&Ba(ne,27,ie(Q.SheetNames[Ae],st++));var ot=0;for(Ae=0;Ae<Q.SheetNames.length;++Ae){var Ne=Q.Sheets[Q.SheetNames[Ae]];if(!(!Ne||!Ne["!ref"])){for(var Ve=ln(Ne["!ref"]),ge=Array.isArray(Ne),W=[],we=Math.min(Ve.e.r,8191),et=Ve.s.r;et<=we;++et)for(var ht=as(et),Qe=Ve.s.c;Qe<=Ve.e.c;++Qe){et===Ve.s.r&&(W[Qe]=Ln(Qe));var qe=W[Qe]+ht,Ft=ge?(Ne[et]||[])[Qe]:Ne[qe];if(!(!Ft||Ft.t=="z"))if(Ft.t=="n")Ba(ne,23,L(et,Qe,ot,Ft.v));else{var Mt=to(Ft);Ba(ne,22,_(et,Qe,ot,Mt.slice(0,239)))}}++ot}}return Ba(ne,1),ne.end()}function a(Q){var ae=Pn(2);return ae.write_shift(2,Q),ae}function i(Q){var ae=Pn(26);ae.write_shift(2,4096),ae.write_shift(2,4),ae.write_shift(4,0);for(var le=0,ne=0,Ae=0,st=0;st<Q.SheetNames.length;++st){var ot=Q.SheetNames[st],Ne=Q.Sheets[ot];if(!(!Ne||!Ne["!ref"])){++Ae;var Ve=Iu(Ne["!ref"]);le<Ve.e.r&&(le=Ve.e.r),ne<Ve.e.c&&(ne=Ve.e.c)}}return le>8191&&(le=8191),ae.write_shift(2,le),ae.write_shift(1,Ae),ae.write_shift(1,ne),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(1,1),ae.write_shift(1,2),ae.write_shift(4,0),ae.write_shift(4,0),ae}function o(Q,ae,le){var ne={s:{c:0,r:0},e:{c:0,r:0}};return ae==8&&le.qpro?(ne.s.c=Q.read_shift(1),Q.l++,ne.s.r=Q.read_shift(2),ne.e.c=Q.read_shift(1),Q.l++,ne.e.r=Q.read_shift(2),ne):(ne.s.c=Q.read_shift(2),ne.s.r=Q.read_shift(2),ae==12&&le.qpro&&(Q.l+=2),ne.e.c=Q.read_shift(2),ne.e.r=Q.read_shift(2),ae==12&&le.qpro&&(Q.l+=2),ne.s.c==65535&&(ne.s.c=ne.e.c=ne.s.r=ne.e.r=0),ne)}function c(Q){var ae=Pn(8);return ae.write_shift(2,Q.s.c),ae.write_shift(2,Q.s.r),ae.write_shift(2,Q.e.c),ae.write_shift(2,Q.e.r),ae}function u(Q,ae,le){var ne=[{c:0,r:0},{t:"n",v:0},0,0];return le.qpro&&le.vers!=20768?(ne[0].c=Q.read_shift(1),ne[3]=Q.read_shift(1),ne[0].r=Q.read_shift(2),Q.l+=2):(ne[2]=Q.read_shift(1),ne[0].c=Q.read_shift(2),ne[0].r=Q.read_shift(2)),ne}function d(Q,ae,le){var ne=Q.l+ae,Ae=u(Q,ae,le);if(Ae[1].t="s",le.vers==20768){Q.l++;var st=Q.read_shift(1);return Ae[1].v=Q.read_shift(st,"utf8"),Ae}return le.qpro&&Q.l++,Ae[1].v=Q.read_shift(ne-Q.l,"cstr"),Ae}function h(Q,ae,le){var ne=Pn(7+le.length);ne.write_shift(1,255),ne.write_shift(2,ae),ne.write_shift(2,Q),ne.write_shift(1,39);for(var Ae=0;Ae<ne.length;++Ae){var st=le.charCodeAt(Ae);ne.write_shift(1,st>=128?95:st)}return ne.write_shift(1,0),ne}function m(Q,ae,le){var ne=u(Q,ae,le);return ne[1].v=Q.read_shift(2,"i"),ne}function p(Q,ae,le){var ne=Pn(7);return ne.write_shift(1,255),ne.write_shift(2,ae),ne.write_shift(2,Q),ne.write_shift(2,le,"i"),ne}function y(Q,ae,le){var ne=u(Q,ae,le);return ne[1].v=Q.read_shift(8,"f"),ne}function v(Q,ae,le){var ne=Pn(13);return ne.write_shift(1,255),ne.write_shift(2,ae),ne.write_shift(2,Q),ne.write_shift(8,le,"f"),ne}function b(Q,ae,le){var ne=Q.l+ae,Ae=u(Q,ae,le);if(Ae[1].v=Q.read_shift(8,"f"),le.qpro)Q.l=ne;else{var st=Q.read_shift(2);B(Q.slice(Q.l,Q.l+st),Ae),Q.l+=st}return Ae}function E(Q,ae,le){var ne=ae&32768;return ae&=-32769,ae=(ne?Q:0)+(ae>=8192?ae-16384:ae),(ne?"":"$")+(le?Ln(ae):as(ae))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function B(Q,ae){ts(Q,0);for(var le=[],ne=0,Ae="",st="",ot="",Ne="";Q.l<Q.length;){var Ve=Q[Q.l++];switch(Ve){case 0:le.push(Q.read_shift(8,"f"));break;case 1:st=E(ae[0].c,Q.read_shift(2),!0),Ae=E(ae[0].r,Q.read_shift(2),!1),le.push(st+Ae);break;case 2:{var ge=E(ae[0].c,Q.read_shift(2),!0),W=E(ae[0].r,Q.read_shift(2),!1);st=E(ae[0].c,Q.read_shift(2),!0),Ae=E(ae[0].r,Q.read_shift(2),!1),le.push(ge+W+":"+st+Ae)}break;case 3:if(Q.l<Q.length){console.error("WK1 premature formula end");return}break;case 4:le.push("("+le.pop()+")");break;case 5:le.push(Q.read_shift(2));break;case 6:{for(var we="";Ve=Q[Q.l++];)we+=String.fromCharCode(Ve);le.push('"'+we.replace(/"/g,'""')+'"')}break;case 8:le.push("-"+le.pop());break;case 23:le.push("+"+le.pop());break;case 22:le.push("NOT("+le.pop()+")");break;case 20:case 21:Ne=le.pop(),ot=le.pop(),le.push(["AND","OR"][Ve-20]+"("+ot+","+Ne+")");break;default:if(Ve<32&&w[Ve])Ne=le.pop(),ot=le.pop(),le.push(ot+w[Ve]+Ne);else if(T[Ve]){if(ne=T[Ve][1],ne==69&&(ne=Q[Q.l++]),ne>le.length){console.error("WK1 bad formula parse 0x"+Ve.toString(16)+":|"+le.join("|")+"|");return}var et=le.slice(-ne);le.length-=ne,le.push(T[Ve][0]+"("+et.join(",")+")")}else return Ve<=7?console.error("WK1 invalid opcode "+Ve.toString(16)):Ve<=24?console.error("WK1 unsupported op "+Ve.toString(16)):Ve<=30?console.error("WK1 invalid opcode "+Ve.toString(16)):Ve<=115?console.error("WK1 unsupported function opcode "+Ve.toString(16)):console.error("WK1 unrecognized opcode "+Ve.toString(16))}}le.length==1?ae[1].f=""+le[0]:console.error("WK1 bad formula parse |"+le.join("|")+"|")}function J(Q){var ae=[{c:0,r:0},{t:"n",v:0},0];return ae[0].r=Q.read_shift(2),ae[3]=Q[Q.l++],ae[0].c=Q[Q.l++],ae}function Z(Q,ae){var le=J(Q);return le[1].t="s",le[1].v=Q.read_shift(ae-4,"cstr"),le}function _(Q,ae,le,ne){var Ae=Pn(6+ne.length);Ae.write_shift(2,Q),Ae.write_shift(1,le),Ae.write_shift(1,ae),Ae.write_shift(1,39);for(var st=0;st<ne.length;++st){var ot=ne.charCodeAt(st);Ae.write_shift(1,ot>=128?95:ot)}return Ae.write_shift(1,0),Ae}function I(Q,ae){var le=J(Q);le[1].v=Q.read_shift(2);var ne=le[1].v>>1;if(le[1].v&1)switch(ne&7){case 0:ne=(ne>>3)*5e3;break;case 1:ne=(ne>>3)*500;break;case 2:ne=(ne>>3)/20;break;case 3:ne=(ne>>3)/200;break;case 4:ne=(ne>>3)/2e3;break;case 5:ne=(ne>>3)/2e4;break;case 6:ne=(ne>>3)/16;break;case 7:ne=(ne>>3)/64;break}return le[1].v=ne,le}function C(Q,ae){var le=J(Q),ne=Q.read_shift(4),Ae=Q.read_shift(4),st=Q.read_shift(2);if(st==65535)return ne===0&&Ae===3221225472?(le[1].t="e",le[1].v=15):ne===0&&Ae===3489660928?(le[1].t="e",le[1].v=42):le[1].v=0,le;var ot=st&32768;return st=(st&32767)-16446,le[1].v=(1-ot*2)*(Ae*Math.pow(2,st+32)+ne*Math.pow(2,st)),le}function L(Q,ae,le,ne){var Ae=Pn(14);if(Ae.write_shift(2,Q),Ae.write_shift(1,le),Ae.write_shift(1,ae),ne==0)return Ae.write_shift(4,0),Ae.write_shift(4,0),Ae.write_shift(2,65535),Ae;var st=0,ot=0,Ne=0,Ve=0;return ne<0&&(st=1,ne=-ne),ot=Math.log2(ne)|0,ne/=Math.pow(2,ot-31),Ve=ne>>>0,Ve&2147483648||(ne/=2,++ot,Ve=ne>>>0),ne-=Ve,Ve|=2147483648,Ve>>>=0,ne*=Math.pow(2,32),Ne=ne>>>0,Ae.write_shift(4,Ne),Ae.write_shift(4,Ve),ot+=16383+(st?32768:0),Ae.write_shift(2,ot),Ae}function F(Q,ae){var le=C(Q);return Q.l+=ae-14,le}function V(Q,ae){var le=J(Q),ne=Q.read_shift(4);return le[1].v=ne>>6,le}function O(Q,ae){var le=J(Q),ne=Q.read_shift(8,"f");return le[1].v=ne,le}function ct(Q,ae){var le=O(Q);return Q.l+=ae-10,le}function me(Q,ae){return Q[Q.l+ae-1]==0?Q.read_shift(ae,"cstr"):""}function ft(Q,ae){var le=Q[Q.l++];le>ae-1&&(le=ae-1);for(var ne="";ne.length<le;)ne+=String.fromCharCode(Q[Q.l++]);return ne}function rt(Q,ae,le){if(!(!le.qpro||ae<21)){var ne=Q.read_shift(1);Q.l+=17,Q.l+=1,Q.l+=2;var Ae=Q.read_shift(ae-21,"cstr");return[ne,Ae]}}function ze(Q,ae){for(var le={},ne=Q.l+ae;Q.l<ne;){var Ae=Q.read_shift(2);if(Ae==14e3){for(le[Ae]=[0,""],le[Ae][0]=Q.read_shift(2);Q[Q.l];)le[Ae][1]+=String.fromCharCode(Q[Q.l]),Q.l++;Q.l++}}return le}function ie(Q,ae){var le=Pn(5+Q.length);le.write_shift(2,14e3),le.write_shift(2,ae);for(var ne=0;ne<Q.length;++ne){var Ae=Q.charCodeAt(ne);le[le.l++]=Ae>127?95:Ae}return le[le.l++]=0,le}var Ye={0:{n:"BOF",f:_n},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:me},222:{n:"SHEETNAMELP",f:ft},65535:{n:""}},_e={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Z},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ze},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:O},40:{n:"FORMULA28",f:ct},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:me},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:rt},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function VV(t){var e={},r=t.match(Ts),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Kt(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=Wv[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return e}var BV=function(){var t=hf("t"),e=hf("rPr");function r(a){var i=a.match(t);if(!i)return{t:"s",v:""};var o={t:"s",v:Er(i[1])},c=a.match(e);return c&&(o.s=VV(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),zV=function(){var e=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),WV=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,HV=/<(?:\w+:)?r>/,GV=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function oy(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Er($r(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=$r(t),r&&(n.h=Yv(n.t))):t.match(HV)&&(n.r=$r(t),n.t=Er($r((t.replace(GV,"").match(WV)||[]).join("").replace(Ts,""))),r&&(n.h=zV(BV(n.r)))),n):{t:""}}var qV=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,KV=/<(?:\w+:)?(?:si|sstItem)>/g,QV=/<\/(?:\w+:)?(?:si|sstItem)>/;function XV(t,e){var r=[],n="";if(!t)return r;var s=t.match(qV);if(s){n=s[2].replace(KV,"").split(QV);for(var a=0;a!=n.length;++a){var i=oy(n[a].trim(),e);i!=null&&(r[r.length]=i)}s=Kt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function YV(t){return[t.read_shift(4),t.read_shift(4)]}function JV(t,e){var r=[],n=!1;return ao(t,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function WI(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Gi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function ZV(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Gi(t,4),e.U=Gi(t,4),e.W=Gi(t,4),e}function eB(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),a=[];s-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function tB(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(eB(t));return e}function rB(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function nB(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Gi(t,4),e.U=Gi(t,4),e.W=Gi(t,4),e}function sB(t){var e=nB(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function HI(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function GI(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function aB(t){var e=Gi(t);switch(e.Minor){case 2:return[e.Minor,iB(t)];case 3:return[e.Minor,oB()];case 4:return[e.Minor,lB(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function iB(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=HI(t,r),s=GI(t,t.length-t.l);return{t:"Std",h:n,v:s}}function oB(){throw new Error("File is password-protected: ECMA-376 Extensible")}function lB(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Ts,function(a){var i=Kt(a);switch(Pi(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function cB(t,e){var r={},n=r.EncryptionVersionInfo=Gi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=HI(t,s),e-=s,r.EncryptionVerifier=GI(t,e),r}function uB(t){var e={},r=e.EncryptionVersionInfo=Gi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function dB(t){var e=0,r,n=WI(t),s=n.length+1,a,i,o,c,u;for(r=Zo(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=e&16384?1:0,c=e<<1&32767,u=o|c,e=u^i;return e^52811}var qI=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=e[i.length-1],c=104,u=i.length-1;u>=0;--u)for(var d=i[u],h=0;h!=7;++h)d&64&&(o^=r[c]),d*=2,--c;return o};return function(i){for(var o=WI(i),c=a(o),u=o.length,d=Zo(16),h=0;h!=16;++h)d[h]=0;var m,p,y;for((u&1)===1&&(m=c>>8,d[u]=s(t[0],m),--u,m=c&255,p=o[o.length-1],d[u]=s(p,m));u>0;)--u,m=c>>8,d[u]=s(o[u],m),--u,m=c&255,d[u]=s(o[u],m);for(u=15,y=15-o.length;y>0;)m=c>>8,d[u]=s(t[y],m),--u,--y,m=c&255,d[u]=s(o[u],m),--u,--y;return d}}(),fB=function(t,e,r,n,s){s||(s=e),n||(n=qI(t));var a,i;for(a=0;a!=e.length;++a)i=e[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},hB=function(t){var e=0,r=qI(t);return function(n){var s=fB("",n,e,r);return e=s[1],s[0]}};function mB(t,e,r,n){var s={key:_n(t),verificationBytes:_n(t)};return r.password&&(s.verifier=dB(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=hB(r.password)),s}function pB(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=uB(t):n.Data=cB(t,e),n}function gB(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?pB(t,e-2,n):mB(t,r.biff>=8?e:e-2,r,n),n}var xB=function(){function t(s,a){switch(a.type){case"base64":return e(ma(s),a);case"binary":return e(s,a);case"buffer":return e(xr&&Buffer.isBuffer(s)?s.toString("binary"):sc(s),a);case"array":return e(Gl(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){var i=a||{},o=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var m=/\\\w+\b/g,p=0,y,v=-1;y=m.exec(d);){switch(y[0]){case"\\cell":var b=d.slice(p,m.lastIndex-y[0].length);if(b[0]==" "&&(b=b.slice(1)),++v,b.length){var E={v:b,t:"s"};Array.isArray(o)?o[h][v]=E:o[Yt({r:h,c:v})]=E}break}p=m.lastIndex}v>u.e.c&&(u.e.c=v)}),o["!ref"]=_r(u),o}function r(s,a){return cl(t(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=ln(s["!ref"]),o,c=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var h=Yt({r:u,c:d});o=c?(s[u]||[])[d]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(to(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function vB(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function gf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function yB(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),a=Math.min(e,r,n),i=s-a;if(i===0)return[0,0,e];var o=0,c=0,u=s+a;switch(c=i/(u>1?2-u:u),s){case e:o=((r-n)/i+6)%6;break;case r:o=(n-e)/i+2;break;case n:o=(e-r)/i+4;break}return[o/6,c,u/2]}function wB(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*e,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,i[0]+=s,i[1]+=c;break;case 1:c=s*(2-o),i[0]+=c,i[1]+=s;break;case 2:c=s*(o-2),i[1]+=s,i[2]+=c;break;case 3:c=s*(4-o),i[1]+=c,i[2]+=s;break;case 4:c=s*(o-4),i[2]+=s,i[0]+=c;break;case 5:c=s*(6-o),i[2]+=c,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function am(t,e){if(e===0)return t;var r=yB(vB(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),gf(wB(r))}var KI=6,bB=15,_B=1,js=KI;function im(t){return Math.floor((t+Math.round(128/js)/256)*js)}function om(t){return Math.floor((t-5)/js*100+.5)/100}function Gx(t){return Math.round((t*js+5)/js*256)/256}function fg(t){return Gx(om(im(t)))}function ly(t){var e=Math.abs(t-fg(t)),r=js;if(e>.005)for(js=_B;js<bB;++js)Math.abs(t-fg(t))<=e&&(e=Math.abs(t-fg(t)),r=js);js=r}function gu(t){t.width?(t.wpx=im(t.width),t.wch=om(t.wpx),t.MDW=js):t.wpx?(t.wch=om(t.wpx),t.width=Gx(t.wch),t.MDW=js):typeof t.wch=="number"&&(t.width=Gx(t.wch),t.wpx=im(t.width),t.MDW=js),t.customWidth&&delete t.customWidth}var SB=96,QI=SB;function XI(t){return t*96/QI}function xf(t){return t*QI/96}var EB={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function TB(t,e,r,n){e.Borders=[];var s={},a=!1;(t[0].match(Ts)||[]).forEach(function(i){var o=Kt(i);switch(Pi(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=qr(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=qr(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function kB(t,e,r,n){e.Fills=[];var s={},a=!1;(t[0].match(Ts)||[]).forEach(function(i){var o=Kt(i);switch(Pi(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function AB(t,e,r,n){e.Fonts=[];var s={},a=!1;(t[0].match(Ts)||[]).forEach(function(i){var o=Kt(i);switch(Pi(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=$r(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?qr(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?qr(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?qr(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?qr(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?qr(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?qr(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?qr(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Wv[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=qr(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=jl[s.color.index];s.color.index==81&&(c=jl[1]),c||(c=jl[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=am(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function IB(t,e,r){e.NumberFmt=[];for(var n=Ni(nr),s=0;s<n.length;++s)e.NumberFmt[n[s]]=nr[n[s]];var a=t[0].match(Ts);if(a)for(s=0;s<a.length;++s){var i=Kt(a[s]);switch(Pi(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Er($r(i.formatCode)),c=parseInt(i.numFmtId,10);if(e.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=o}Pl(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var R0=["numFmtId","fillId","fontId","borderId","xfId"],P0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function CB(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(Ts)||[]).forEach(function(a){var i=Kt(a),o=0;switch(Pi(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<R0.length;++o)n[R0[o]]&&(n[R0[o]]=parseInt(n[R0[o]],10));for(o=0;o<P0.length;++o)n[P0[o]]&&(n[P0[o]]=qr(n[P0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=qr(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var NB=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&IB(h,d,u),(h=o.match(s))&&AB(h,d,c,u),(h=o.match(n))&&kB(h,d,c,u),(h=o.match(a))&&TB(h,d,c,u),(h=o.match(r))&&CB(h,d,u),d}}();function RB(t,e){var r=t.read_shift(2),n=bs(t);return[r,n]}function PB(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=B$(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=t.read_shift(1);i!=0&&(n.underline=i);var o=t.read_shift(1);o>0&&(n.family=o);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=V$(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=bs(t),n}var jB=Es;function DB(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}var FB=Es;function LB(t,e,r){var n={};n.NumberFmt=[];for(var s in nr)n.NumberFmt[s]=nr[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return ao(t,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],Pl(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=am(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}var OB=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function MB(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Ts)||[]).forEach(function(s){var a=Kt(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[OB.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function $B(){}function UB(){}var VB=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,BB=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,zB=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function WB(t,e,r){e.themeElements={};var n;[["clrScheme",VB,MB],["fontScheme",BB,$B],["fmtScheme",zB,UB]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var HB=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function YI(t,e){(!t||t.length===0)&&(t=GB());var r,n={};if(!(r=t.match(HB)))throw new Error("themeElements not found in theme");return WB(r[0],n,e),n.raw=t,n}function GB(t,e){var r=[lI];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function qB(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var i;try{i=oI(a,{type:"array"})}catch{return}var o=la(i,"theme/theme/theme1.xml",!0);if(o)return YI(o,r)}}function KB(t){return t.read_shift(4)}function QB(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=XB(t,4);break;case 2:e.xclrValue=OI(t);break;case 3:e.xclrValue=KB(t);break;case 4:t.l+=4;break}return t.l+=8,e}function XB(t,e){return Es(t,e)}function YB(t,e){return Es(t,e)}function JB(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=QB(t);break;case 6:n[1]=YB(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function ZB(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),a=[];s-- >0;)a.push(JB(t,r-t.l));return{ixfe:n,ext:a}}function ez(t,e){e.forEach(function(r){switch(r[0]){}})}function tz(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:bs(t)}}function rz(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function nz(t){return t.l+=4,t.read_shift(4)!=0}function sz(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return ao(t,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function az(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,a=2,i;return t.replace(Ts,function(o){var c=Kt(o);switch(Pi(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function iz(t){var e=[];if(!t)return e;var r=1;return(t.match(Ts)||[]).forEach(function(n){var s=Kt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function oz(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Yt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function lz(t,e,r){var n=[];return ao(t,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function cz(t,e,r,n){if(!t)return t;var s=n||{},a=!1;ao(t,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function uz(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function F_(t,e,r,n){var s=Array.isArray(t),a;e.forEach(function(i){var o=Ds(i.ref);if(s?(t[o.r]||(t[o.r]=[]),a=t[o.r][o.c]):a=t[i.ref],!a){a={t:"z"},s?t[o.r][o.c]=a:t[i.ref]=a;var c=ln(t["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=_r(c);u!==t["!ref"]&&(t["!ref"]=u)}a.c||(a.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var h=a.c.length-1;h>=0;--h){if(!r&&a.c[h].T)return;r&&!a.c[h].T&&a.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(d.a==n[h].id){d.a=n[h].name||d.a;break}}a.c.push(d)})}function dz(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Kt(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Ds(c.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var h=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!h&&!!h[1]&&oy(h[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=m.h),n.push(u)}}}}),n}function fz(t,e){var r=[],n=!1,s={},a=0;return t.replace(Ts,function(o,c){var u=Kt(o);switch(Pi(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+o.length;break;case"</text>":s.t=t.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function hz(t,e){var r=[],n=!1;return t.replace(Ts,function(a){var i=Kt(a);switch(Pi(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function mz(t){var e={};e.iauthor=t.read_shift(4);var r=ic(t);return e.rfx=r.s,e.ref=Yt(r.s),t.l+=16,e}var pz=bs;function gz(t,e){var r=[],n=[],s={},a=!1;return ao(t,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}var xz="application/vnd.ms-office.vbaProject";function vz(t){var e=br.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");br.utils.cfb_add(e,s,t.FileIndex[n].content)}}),br.write(e)}function yz(){return{"!type":"dialog"}}function wz(){return{"!type":"dialog"}}function bz(){return{"!type":"macro"}}function _z(){return{"!type":"macro"}}var Zc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,a,i){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=e.c:--d,c?u+=e.r:--u,s+(o?"":"$")+Ln(d)+(c?"":"$")+as(u)}return function(s,a){return e=a,s.replace(t,r)}}(),JI=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Sz=function(){return function(e,r){return e.replace(JI,function(n,s,a,i,o,c){var u=ty(i)-(a?0:r.c),d=ey(c)-(o?0:r.r),h=d==0?"":o?d+1:"["+d+"]",m=u==0?"":a?u+1:"["+u+"]";return s+"R"+h+"C"+m})}}();function ZI(t,e){return t.replace(JI,function(r,n,s,a,i,o){return n+(s=="$"?s+a:Ln(ty(a)+e.c))+(i=="$"?i+o:as(ey(o)+e.r))})}function Ez(t,e,r){var n=Iu(e),s=n.s,a=Ds(r),i={r:a.r-s.r,c:a.c-s.c};return ZI(t,i)}function Tz(t){return t.length!=1}function L_(t){return t.replace(/_xlfn\./g,"")}function yn(t){t.l+=1}function el(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function eC(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return tC(t);r.biff==12&&(n=4)}var s=t.read_shift(n),a=t.read_shift(n),i=el(t),o=el(t);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function tC(t){var e=el(t),r=el(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function kz(t,e,r){if(r.biff<8)return tC(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),a=el(t),i=el(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function rC(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return Az(t);var n=t.read_shift(r&&r.biff==12?4:2),s=el(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function Az(t){var e=el(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function Iz(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Cz(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Nz(t);var s=t.read_shift(n>=12?4:2),a=t.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function Nz(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function Rz(t,e,r){var n=(t[t.l++]&96)>>5,s=eC(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function Pz(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var i=eC(t,a,r);return[n,s,i]}function jz(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Dz(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,s]}function Fz(t,e,r){var n=(t[t.l++]&96)>>5,s=kz(t,e-1,r);return[n,s]}function Lz(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function O_(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function Oz(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function Mz(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function $z(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Uz(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Vz(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function nC(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function Bz(t){return t.read_shift(2),nC(t)}function zz(t){return t.read_shift(2),nC(t)}function Wz(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=rC(t,0,r);return[n,s]}function Hz(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=Cz(t,0,r);return[n,s]}function Gz(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=rC(t,0,r);return[n,s,a]}function qz(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[KW[s],iC[s],n]}function Kz(t,e,r){var n=t[t.l++],s=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:Qz(t);return[s,(a[0]===0?iC:qW)[a[1]]]}function Qz(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Xz(t,e,r){t.l+=r&&r.biff==2?3:4}function Yz(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function Jz(t){return t.l++,oc[t.read_shift(1)]}function Zz(t){return t.l++,t.read_shift(2)}function eW(t){return t.l++,t.read_shift(1)!==0}function tW(t){return t.l++,ys(t)}function rW(t,e,r){return t.l++,$f(t,e-1,r)}function nW(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=un(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=oc[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=ys(t);break;case 2:r[1]=lc(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function sW(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?ic:sp)(t));return s}function aW(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=nW(t,r.biff);return i}function iW(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function oW(t,e,r){if(r.biff==5)return lW(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),a=t.read_shift(4);return[n,s,a]}function lW(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function cW(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function uW(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function dW(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function fW(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,s]}var hW=Es,mW=Es,pW=Es;function Vf(t,e,r){return t.l+=2,[Iz(t)]}function cy(t){return t.l+=6,[]}var gW=Vf,xW=cy,vW=cy,yW=Vf;function sC(t){return t.l+=2,[_n(t),t.read_shift(2)&1]}var wW=Vf,bW=sC,_W=cy,SW=Vf,EW=Vf,TW=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function kW(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),a=t.read_shift(2),i=TW[r>>2&31];return{ixti:e,coltype:r&3,rt:i,idx:n,c:s,C:a}}function AW(t){return t.l+=2,[t.read_shift(4)]}function IW(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function CW(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function NW(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function RW(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function PW(t){return t.l+=4,[0,0]}var M_={1:{n:"PtgExp",f:Yz},2:{n:"PtgTbl",f:pW},3:{n:"PtgAdd",f:yn},4:{n:"PtgSub",f:yn},5:{n:"PtgMul",f:yn},6:{n:"PtgDiv",f:yn},7:{n:"PtgPower",f:yn},8:{n:"PtgConcat",f:yn},9:{n:"PtgLt",f:yn},10:{n:"PtgLe",f:yn},11:{n:"PtgEq",f:yn},12:{n:"PtgGe",f:yn},13:{n:"PtgGt",f:yn},14:{n:"PtgNe",f:yn},15:{n:"PtgIsect",f:yn},16:{n:"PtgUnion",f:yn},17:{n:"PtgRange",f:yn},18:{n:"PtgUplus",f:yn},19:{n:"PtgUminus",f:yn},20:{n:"PtgPercent",f:yn},21:{n:"PtgParen",f:yn},22:{n:"PtgMissArg",f:yn},23:{n:"PtgStr",f:rW},26:{n:"PtgSheet",f:IW},27:{n:"PtgEndSheet",f:CW},28:{n:"PtgErr",f:Jz},29:{n:"PtgBool",f:eW},30:{n:"PtgInt",f:Zz},31:{n:"PtgNum",f:tW},32:{n:"PtgArray",f:Lz},33:{n:"PtgFunc",f:qz},34:{n:"PtgFuncVar",f:Kz},35:{n:"PtgName",f:iW},36:{n:"PtgRef",f:Wz},37:{n:"PtgArea",f:Rz},38:{n:"PtgMemArea",f:cW},39:{n:"PtgMemErr",f:hW},40:{n:"PtgMemNoMem",f:mW},41:{n:"PtgMemFunc",f:uW},42:{n:"PtgRefErr",f:dW},43:{n:"PtgAreaErr",f:jz},44:{n:"PtgRefN",f:Hz},45:{n:"PtgAreaN",f:Fz},46:{n:"PtgMemAreaN",f:NW},47:{n:"PtgMemNoMemN",f:RW},57:{n:"PtgNameX",f:oW},58:{n:"PtgRef3d",f:Gz},59:{n:"PtgArea3d",f:Pz},60:{n:"PtgRefErr3d",f:fW},61:{n:"PtgAreaErr3d",f:Dz},255:{}},jW={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},DW={1:{n:"PtgElfLel",f:sC},2:{n:"PtgElfRw",f:SW},3:{n:"PtgElfCol",f:gW},6:{n:"PtgElfRwV",f:EW},7:{n:"PtgElfColV",f:yW},10:{n:"PtgElfRadical",f:wW},11:{n:"PtgElfRadicalS",f:_W},13:{n:"PtgElfColS",f:xW},15:{n:"PtgElfColSV",f:vW},16:{n:"PtgElfRadicalLel",f:bW},25:{n:"PtgList",f:kW},29:{n:"PtgSxName",f:AW},255:{}},FW={0:{n:"PtgAttrNoop",f:PW},1:{n:"PtgAttrSemi",f:Vz},2:{n:"PtgAttrIf",f:$z},4:{n:"PtgAttrChoose",f:Oz},8:{n:"PtgAttrGoto",f:Mz},16:{n:"PtgAttrSum",f:Xz},32:{n:"PtgAttrBaxcel",f:O_},33:{n:"PtgAttrBaxcel",f:O_},64:{n:"PtgAttrSpace",f:Bz},65:{n:"PtgAttrSpaceSemi",f:zz},128:{n:"PtgAttrIfError",f:Uz},255:{}};function Bf(t,e,r,n){if(n.biff<8)return Es(t,e);for(var s=t.l+e,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=aW(t,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=sW(t,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=t.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return e=s-t.l,e!==0&&a.push(Es(t,e)),a}function zf(t,e,r){for(var n=t.l+e,s,a,i=[];n!=t.l;)e=n-t.l,a=t[t.l],s=M_[a]||M_[jW[a]],(a===24||a===25)&&(s=(a===24?DW:FW)[t[t.l+1]]),!s||!s.f?Es(t,e):i.push([s.n,s.f(t,e,r)]);return i}function LW(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var OW={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function MW(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function aC(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function $_(t,e,r){var n=aC(t,e,r);return n=="#REF"?n:MW(n,r)}function gs(t,e,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],c,u,d,h=0,m=0,p,y="";if(!t[0]||!t[0][0])return"";for(var v=-1,b="",E=0,T=t[0].length;E<T;++E){var w=t[0][E];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),v>=0){switch(t[0][v][1][0]){case 0:b=on(" ",t[0][v][1][1]);break;case 1:b=on("\r",t[0][v][1][1]);break;default:if(b="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}u=u+b,v=-1}o.push(u+OW[w[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Ad(w[1][1],i,s),o.push(Id(d,a));break;case"PtgRefN":d=r?Ad(w[1][1],r,s):w[1][1],o.push(Id(d,a));break;case"PtgRef3d":h=w[1][1],d=Ad(w[1][2],i,s),y=$_(n,h,s),o.push(y+"!"+Id(d,a));break;case"PtgFunc":case"PtgFuncVar":var B=w[1][0],J=w[1][1];B||(B=0),B&=127;var Z=B==0?[]:o.slice(-B);o.length-=B,J==="User"&&(J=Z.shift()),o.push(J+"("+Z.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":p=y_(w[1][1],r?{s:r}:i,s),o.push(ug(p,s));break;case"PtgArea":p=y_(w[1][1],i,s),o.push(ug(p,s));break;case"PtgArea3d":h=w[1][1],p=w[1][2],y=$_(n,h,s),o.push(y+"!"+ug(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=w[1][2];var _=(n.names||[])[m-1]||(n[0]||[])[m],I=_?_.Name:"SH33TJSNAME"+String(m);I&&I.slice(0,6)=="_xlfn."&&!s.xlfn&&(I=I.slice(6)),o.push(I);break;case"PtgNameX":var C=w[1][1];m=w[1][2];var L;if(s.biff<=5)C<0&&(C=-C),n[C]&&(L=n[C][m]);else{var F="";if(((n[C]||[])[0]||[])[0]==14849||(((n[C]||[])[0]||[])[0]==1025?n[C][m]&&n[C][m].itab>0&&(F=n.SheetNames[n[C][m].itab-1]+"!"):F=n.SheetNames[m-1]+"!"),n[C]&&n[C][m])F+=n[C][m].Name;else if(n[0]&&n[0][m])F+=n[0][m].Name;else{var V=(aC(n,C,s)||"").split(";;");V[m-1]?F=V[m-1]:F+="SH33TJSERRX"}o.push(F);break}L||(L={Name:"SH33TJSERRY"}),o.push(L.Name);break;case"PtgParen":var O="(",ct=")";if(v>=0){switch(b="",t[0][v][1][0]){case 2:O=on(" ",t[0][v][1][1])+O;break;case 3:O=on("\r",t[0][v][1][1])+O;break;case 4:ct=on(" ",t[0][v][1][1])+ct;break;case 5:ct=on("\r",t[0][v][1][1])+ct;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}v=-1}o.push(O+o.pop()+ct);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var me={c:r.c,r:r.r};if(n.sharedf[Yt(d)]){var ft=n.sharedf[Yt(d)];o.push(gs(ft,i,me,n,s))}else{var rt=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(gs(u[1],i,me,n,s)),rt=!0;break}rt||o.push(w[1])}break;case"PtgArray":o.push("{"+LW(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var ze=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&ze.indexOf(t[0][E][0])==-1){w=t[0][v];var ie=!0;switch(w[1][0]){case 4:ie=!1;case 0:b=on(" ",w[1][1]);break;case 5:ie=!1;case 1:b=on("\r",w[1][1]);break;default:if(b="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((ie?b:"")+o.pop()+(ie?"":b)),v=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function $W(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],Es(t,e-2)];var o=zf(t,i,r);return e!==i+s&&(a=Bf(t,e-i-s,o,r)),t.l=n,[o,a]}function UW(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],Es(t,e-2)];var o=zf(t,i,r);return e!==i+s&&(a=Bf(t,e-i-s,o,r)),t.l=n,[o,a]}function VW(t,e,r,n){var s=t.l+e,a=zf(t,n,r),i;return s!==t.l&&(i=Bf(t,s-t.l,a,r)),[a,i]}function BW(t,e,r){var n=t.l+e,s,a=t.read_shift(2),i=zf(t,a,r);return a==65535?[[],Es(t,e-2)]:(e!==a+2&&(s=Bf(t,n-a-2,i,r)),[i,s])}function zW(t){var e;if(Bi(t,t.l+6)!==65535)return[ys(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function hg(t,e,r){var n=t.l+e,s=ji(t);r.biff==2&&++t.l;var a=zW(t),i=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=UW(t,n-t.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function ap(t,e,r){var n=t.read_shift(4),s=zf(t,n,r),a=t.read_shift(4),i=a>0?Bf(t,a,s,r):null;return[s,i]}var WW=ap,ip=ap,HW=ap,GW=ap,qW={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},iC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},KW={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function U_(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function mg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Pd={},eu={};function jd(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function oC(t,e,r,n,s,a){try{n.cellNF&&(t.z=nr[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Hn(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(nr[e]==null&&Pl(Q9[e]||"General",e),t.t==="e")t.w=t.w||oc[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ff(t.v);else if(t.t==="d"){var i=Ms(t.v);(i|0)===i?t.w=i.toString(10):t.w=ff(i)}else{if(t.v===void 0)return"";t.w=Hl(t.v,eu)}else t.t==="d"?t.w=Na(e,Ms(t.v),eu):t.w=Na(e,t.v,eu)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=am(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=am(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function QW(t,e){var r=ln(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=_r(r))}var XW=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,YW=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,JW=/<(?:\w:)?hyperlink [^>]*>/mg,ZW=/"(\w*:\w*)"/,eH=/<(?:\w:)?col\b[^>]*[\/]?>/g,tH=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,rH=/<(?:\w:)?pageMargins[^>]*\/>/g,lC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,nH=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,sH=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function aH(t,e,r,n,s,a,i){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",h=t.match(YW);h?(u=t.slice(0,h.index),d=t.slice(h.index+h[0].length)):u=d=t;var m=u.match(lC);m?uy(m[0],o,s,r):(m=u.match(nH))&&iH(m[0],m[1]||"",o,s,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var y=u.slice(p,p+50).match(ZW);y&&QW(o,y[1])}var v=u.match(sH);v&&v[1]&&fH(v[1],s);var b=[];if(e.cellStyles){var E=u.match(eH);E&&cH(b,E)}h&&hH(h[1],o,e,c,a,i);var T=d.match(tH);T&&(o["!autofilter"]=uH(T[0]));var w=[],B=d.match(XW);if(B)for(p=0;p!=B.length;++p)w[p]=ln(B[p].slice(B[p].indexOf('"')+1));var J=d.match(JW);J&&oH(o,J,n);var Z=d.match(rH);if(Z&&(o["!margins"]=lH(Kt(Z[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=_r(c)),e.sheetRows>0&&o["!ref"]){var _=ln(o["!ref"]);e.sheetRows<=+_.e.r&&(_.e.r=e.sheetRows-1,_.e.r>c.e.r&&(_.e.r=c.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>c.e.c&&(_.e.c=c.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),o["!fullref"]=o["!ref"],o["!ref"]=_r(_))}return b.length>0&&(o["!cols"]=b),w.length>0&&(o["!merges"]=w),o}function uy(t,e,r,n){var s=Kt(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Er($r(s.codeName)))}function iH(t,e,r,n,s){uy(t.slice(0,t.indexOf(">")),r,n,s)}function oH(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var a=Kt($r(e[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+Er(a.location))):(a.Target="#"+Er(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=ln(a.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=Yt({c:u,r:c});n?(t[c]||(t[c]=[]),t[c][u]||(t[c][u]={t:"z",v:void 0}),t[c][u].l=a):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=a)}}}function lH(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function cH(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=Kt(e[n],!0);s.hidden&&(s.hidden=qr(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,ly(s.width)),gu(s);a<=i;)t[a++]=ss(s)}}function uH(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var dH=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function fH(t,e){e.Views||(e.Views=[{}]),(t.match(dH)||[]).forEach(function(r,n){var s=Kt(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),qr(s.rightToLeft)&&(e.Views[n].RTL=!0)})}var hH=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=hf("v"),i=hf("f");return function(c,u,d,h,m,p){for(var y=0,v="",b=[],E=[],T=0,w=0,B=0,J="",Z,_,I=0,C=0,L,F,V=0,O=0,ct=Array.isArray(p.CellXf),me,ft=[],rt=[],ze=Array.isArray(u),ie=[],Ye={},_e=!1,Q=!!d.sheetStubs,ae=c.split(e),le=0,ne=ae.length;le!=ne;++le){v=ae[le].trim();var Ae=v.length;if(Ae!==0){var st=0;e:for(y=0;y<Ae;++y)switch(v[y]){case">":if(v[y-1]!="/"){++y;break e}if(d&&d.cellStyles){if(_=Kt(v.slice(st,y),!0),I=_.r!=null?parseInt(_.r,10):I+1,C=-1,d.sheetRows&&d.sheetRows<I)continue;Ye={},_e=!1,_.ht&&(_e=!0,Ye.hpt=parseFloat(_.ht),Ye.hpx=xf(Ye.hpt)),_.hidden=="1"&&(_e=!0,Ye.hidden=!0),_.outlineLevel!=null&&(_e=!0,Ye.level=+_.outlineLevel),_e&&(ie[I-1]=Ye)}break;case"<":st=y;break}if(st>=y)break;if(_=Kt(v.slice(st,y),!0),I=_.r!=null?parseInt(_.r,10):I+1,C=-1,!(d.sheetRows&&d.sheetRows<I)){h.s.r>I-1&&(h.s.r=I-1),h.e.r<I-1&&(h.e.r=I-1),d&&d.cellStyles&&(Ye={},_e=!1,_.ht&&(_e=!0,Ye.hpt=parseFloat(_.ht),Ye.hpx=xf(Ye.hpt)),_.hidden=="1"&&(_e=!0,Ye.hidden=!0),_.outlineLevel!=null&&(_e=!0,Ye.level=+_.outlineLevel),_e&&(ie[I-1]=Ye)),b=v.slice(y).split(t);for(var ot=0;ot!=b.length&&b[ot].trim().charAt(0)=="<";++ot);for(b=b.slice(ot),y=0;y!=b.length;++y)if(v=b[y].trim(),v.length!==0){if(E=v.match(r),T=y,w=0,B=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,E!=null&&E.length===2){for(T=0,J=E[1],w=0;w!=J.length&&!((B=J.charCodeAt(w)-64)<1||B>26);++w)T=26*T+B;--T,C=T}else++C;for(w=0;w!=v.length&&v.charCodeAt(w)!==62;++w);if(++w,_=Kt(v.slice(0,w),!0),_.r||(_.r=Yt({r:I-1,c:C})),J=v.slice(w),Z={t:""},(E=J.match(a))!=null&&E[1]!==""&&(Z.v=Er(E[1])),d.cellFormula){if((E=J.match(i))!=null&&E[1]!==""){if(Z.f=Er($r(E[1])).replace(/\r\n/g,`
`),d.xlfn||(Z.f=L_(Z.f)),E[0].indexOf('t="array"')>-1)Z.F=(J.match(s)||[])[1],Z.F.indexOf(":")>-1&&ft.push([ln(Z.F),Z.F]);else if(E[0].indexOf('t="shared"')>-1){F=Kt(E[0]);var Ne=Er($r(E[1]));d.xlfn||(Ne=L_(Ne)),rt[parseInt(F.si,10)]=[F,Ne,_.r]}}else(E=J.match(/<f[^>]*\/>/))&&(F=Kt(E[0]),rt[F.si]&&(Z.f=Ez(rt[F.si][1],rt[F.si][2],_.r)));var Ve=Ds(_.r);for(w=0;w<ft.length;++w)Ve.r>=ft[w][0].s.r&&Ve.r<=ft[w][0].e.r&&Ve.c>=ft[w][0].s.c&&Ve.c<=ft[w][0].e.c&&(Z.F=ft[w][1])}if(_.t==null&&Z.v===void 0)if(Z.f||Z.F)Z.v=0,Z.t="n";else if(Q)Z.t="z";else continue;else Z.t=_.t||"n";switch(h.s.c>C&&(h.s.c=C),h.e.c<C&&(h.e.c=C),Z.t){case"n":if(Z.v==""||Z.v==null){if(!Q)continue;Z.t="z"}else Z.v=parseFloat(Z.v);break;case"s":if(typeof Z.v>"u"){if(!Q)continue;Z.t="z"}else L=Pd[parseInt(Z.v,10)],Z.v=L.t,Z.r=L.r,d.cellHTML&&(Z.h=L.h);break;case"str":Z.t="s",Z.v=Z.v!=null?$r(Z.v):"",d.cellHTML&&(Z.h=Yv(Z.v));break;case"inlineStr":E=J.match(n),Z.t="s",E!=null&&(L=oy(E[1]))?(Z.v=L.t,d.cellHTML&&(Z.h=L.h)):Z.v="";break;case"b":Z.v=qr(Z.v);break;case"d":d.cellDates?Z.v=Hn(Z.v,1):(Z.v=Ms(Hn(Z.v,1)),Z.t="n");break;case"e":(!d||d.cellText!==!1)&&(Z.w=Z.v),Z.v=CI[Z.v];break}if(V=O=0,me=null,ct&&_.s!==void 0&&(me=p.CellXf[_.s],me!=null&&(me.numFmtId!=null&&(V=me.numFmtId),d.cellStyles&&me.fillId!=null&&(O=me.fillId))),oC(Z,V,O,d,m,p),d.cellDates&&ct&&Z.t=="n"&&Au(nr[V])&&(Z.t="d",Z.v=np(Z.v)),_.cm&&d.xlmeta){var ge=(d.xlmeta.Cell||[])[+_.cm-1];ge&&ge.type=="XLDAPR"&&(Z.D=!0)}if(ze){var W=Ds(_.r);u[W.r]||(u[W.r]=[]),u[W.r][W.c]=Z}else u[_.r]=Z}}}}ie.length>0&&(u["!rows"]=ie)}}();function mH(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}var pH=ic;function gH(){}function xH(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=$$(t),r}function vH(t){var e=Pa(t);return[e]}function yH(t){var e=ac(t);return[e]}function wH(t){var e=Pa(t),r=t.read_shift(1);return[e,r,"b"]}function bH(t){var e=ac(t),r=t.read_shift(1);return[e,r,"b"]}function _H(t){var e=Pa(t),r=t.read_shift(1);return[e,r,"e"]}function SH(t){var e=ac(t),r=t.read_shift(1);return[e,r,"e"]}function EH(t){var e=Pa(t),r=t.read_shift(4);return[e,r,"s"]}function TH(t){var e=ac(t),r=t.read_shift(4);return[e,r,"s"]}function kH(t){var e=Pa(t),r=ys(t);return[e,r,"n"]}function cC(t){var e=ac(t),r=ys(t);return[e,r,"n"]}function AH(t){var e=Pa(t),r=sy(t);return[e,r,"n"]}function IH(t){var e=ac(t),r=sy(t);return[e,r,"n"]}function CH(t){var e=Pa(t),r=ry(t);return[e,r,"is"]}function NH(t){var e=Pa(t),r=bs(t);return[e,r,"str"]}function RH(t){var e=ac(t),r=bs(t);return[e,r,"str"]}function PH(t,e,r){var n=t.l+e,s=Pa(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"b"];if(r.cellFormula){t.l+=2;var o=ip(t,n-t.l,r);i[3]=gs(o,null,s,r.supbooks,r)}else t.l=n;return i}function jH(t,e,r){var n=t.l+e,s=Pa(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"e"];if(r.cellFormula){t.l+=2;var o=ip(t,n-t.l,r);i[3]=gs(o,null,s,r.supbooks,r)}else t.l=n;return i}function DH(t,e,r){var n=t.l+e,s=Pa(t);s.r=r["!row"];var a=ys(t),i=[s,a,"n"];if(r.cellFormula){t.l+=2;var o=ip(t,n-t.l,r);i[3]=gs(o,null,s,r.supbooks,r)}else t.l=n;return i}function FH(t,e,r){var n=t.l+e,s=Pa(t);s.r=r["!row"];var a=bs(t),i=[s,a,"str"];if(r.cellFormula){t.l+=2;var o=ip(t,n-t.l,r);i[3]=gs(o,null,s,r.supbooks,r)}else t.l=n;return i}var LH=ic;function OH(t,e){var r=t.l+e,n=ic(t),s=ny(t),a=bs(t),i=bs(t),o=bs(t);t.l=r;var c={rfx:n,relId:s,loc:a,display:o};return i&&(c.Tooltip=i),c}function MH(){}function $H(t,e,r){var n=t.l+e,s=kI(t),a=t.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=WW(t,n-t.l,r);i[1]=o}else t.l=n;return i}function UH(t,e,r){var n=t.l+e,s=ic(t),a=[s];if(r.cellFormula){var i=GW(t,n-t.l,r);a[1]=i,t.l=n}else t.l=n;return a}var VH=["left","right","top","bottom","header","footer"];function BH(t){var e={};return VH.forEach(function(r){e[r]=ys(t)}),e}function zH(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function WH(){}function HH(){}function GH(t,e,r,n,s,a,i){if(!t)return t;var o=e||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,m=!1,p,y,v,b,E,T,w,B,J,Z=[];o.biff=12,o["!row"]=0;var _=0,I=!1,C=[],L={},F=o.supbooks||s.supbooks||[[]];if(F.sharedf=L,F.arrayf=C,F.SheetNames=s.SheetNames||s.Sheets.map(function(ze){return ze.name}),!o.supbooks&&(o.supbooks=F,s.Names))for(var V=0;V<s.Names.length;++V)F[0][V+1]=s.Names[V];var O=[],ct=[],me=!1;lm[16]={n:"BrtShortReal",f:cC};var ft;if(ao(t,function(ie,Ye,_e){if(!m)switch(_e){case 148:u=ie;break;case 0:p=ie,o.sheetRows&&o.sheetRows<=p.r&&(m=!0),B=as(b=p.r),o["!row"]=p.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=xf(ie.hpt)),ct[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:ie[2]},ie[2]){case"n":y.v=ie[1];break;case"s":w=Pd[ie[1]],y.v=w.t,y.r=w.r;break;case"b":y.v=!!ie[1];break;case"e":y.v=ie[1],o.cellText!==!1&&(y.w=oc[y.v]);break;case"str":y.t="s",y.v=ie[1];break;case"is":y.t="s",y.v=ie[1].t;break}if((v=i.CellXf[ie[0].iStyleRef])&&oC(y,v.numFmtId,null,o,a,i),E=ie[0].c==-1?E+1:ie[0].c,o.dense?(c[b]||(c[b]=[]),c[b][E]=y):c[Ln(E)+B]=y,o.cellFormula){for(I=!1,_=0;_<C.length;++_){var Q=C[_];p.r>=Q[0].s.r&&p.r<=Q[0].e.r&&E>=Q[0].s.c&&E<=Q[0].e.c&&(y.F=_r(Q[0]),I=!0)}!I&&ie.length>3&&(y.f=ie[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>E&&(d.s.c=E),d.e.r<p.r&&(d.e.r=p.r),d.e.c<E&&(d.e.c=E),o.cellDates&&v&&y.t=="n"&&Au(nr[v.numFmtId])){var ae=kl(y.v);ae&&(y.t="d",y.v=new Date(ae.y,ae.m-1,ae.d,ae.H,ae.M,ae.S,ae.u))}ft&&(ft.type=="XLDAPR"&&(y.D=!0),ft=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;y={t:"z",v:void 0},E=ie[0].c==-1?E+1:ie[0].c,o.dense?(c[b]||(c[b]=[]),c[b][E]=y):c[Ln(E)+B]=y,d.s.r>p.r&&(d.s.r=p.r),d.s.c>E&&(d.s.c=E),d.e.r<p.r&&(d.e.r=p.r),d.e.c<E&&(d.e.c=E),ft&&(ft.type=="XLDAPR"&&(y.D=!0),ft=void 0);break;case 176:Z.push(ie);break;case 49:ft=((o.xlmeta||{}).Cell||[])[ie-1];break;case 494:var le=n["!id"][ie.relId];for(le?(ie.Target=le.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=le):ie.relId==""&&(ie.Target="#"+ie.loc),b=ie.rfx.s.r;b<=ie.rfx.e.r;++b)for(E=ie.rfx.s.c;E<=ie.rfx.e.c;++E)o.dense?(c[b]||(c[b]=[]),c[b][E]||(c[b][E]={t:"z",v:void 0}),c[b][E].l=ie):(T=Yt({c:E,r:b}),c[T]||(c[T]={t:"z",v:void 0}),c[T].l=ie);break;case 426:if(!o.cellFormula)break;C.push(ie),J=o.dense?c[b][E]:c[Ln(E)+B],J.f=gs(ie[1],d,{r:p.r,c:E},F,o),J.F=_r(ie[0]);break;case 427:if(!o.cellFormula)break;L[Yt(ie[0].s)]=ie[1],J=o.dense?c[b][E]:c[Ln(E)+B],J.f=gs(ie[1],d,{r:p.r,c:E},F,o);break;case 60:if(!o.cellStyles)break;for(;ie.e>=ie.s;)O[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},me||(me=!0,ly(ie.w/256)),gu(O[ie.e+1]);break;case 161:c["!autofilter"]={ref:_r(ie)};break;case 476:c["!margins"]=ie;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),ie.name&&(s.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(c["!outline"]={above:ie.above,left:ie.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),ie.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!Ye.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+_e.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=_r(u||d)),o.sheetRows&&c["!ref"]){var rt=ln(c["!ref"]);o.sheetRows<=+rt.e.r&&(rt.e.r=o.sheetRows-1,rt.e.r>d.e.r&&(rt.e.r=d.e.r),rt.e.r<rt.s.r&&(rt.s.r=rt.e.r),rt.e.c>d.e.c&&(rt.e.c=d.e.c),rt.e.c<rt.s.c&&(rt.s.c=rt.e.c),c["!fullref"]=c["!ref"],c["!ref"]=_r(rt))}return Z.length>0&&(c["!merges"]=Z),O.length>0&&(c["!cols"]=O),ct.length>0&&(c["!rows"]=ct),c}function qH(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(e[+i[1]]=r?+i[2]:i[2])});var s=Er((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,s,n]}function KH(t,e,r,n,s,a){var i=a||{"!type":"chart"};if(!t)return a;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var m=qH(h);d.s.r=d.s.c=0,d.e.c=o,u=Ln(o),m[0].forEach(function(p,y){i[u+as(y)]={t:"n",v:p,z:m[1]},c=y}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(i["!ref"]=_r(d)),i}function QH(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=t.match(lC);return o&&uy(o[0],a,s,r),(i=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function XH(t,e){t.l+=10;var r=bs(t);return{name:r}}function YH(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return ao(t,function(c,u,d){switch(d){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var uC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],JH=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],ZH=[],eG=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function V_(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var a=e[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=qr(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function B_(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=qr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function dC(t){B_(t.WBProps,uC),B_(t.CalcPr,eG),V_(t.WBView,JH),V_(t.Sheets,ZH),eu.date1904=qr(t.WBProps.date1904)}var tG="][*?/\\".split("");function rG(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return tG.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var nG=/<\w+:workbook/;function sG(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(t.replace(Ts,function(c,u){var d=Kt(c);switch(Pi(d[0])){case"<?xml":break;case"<workbook":c.match(nG)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":uC.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=qr(d[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:r.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(r.WBProps.CodeName=$r(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Er($r(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=$r(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),qr(d.hidden||"0")&&(a.Hidden=!0),i=u+c.length;break;case"</definedName>":a.Ref=Er($r(t.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),_$.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return dC(r),r}function aG(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=zx(t),r.name=bs(t),r}function iG(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?bs(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function oG(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function lG(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),a=U$(t),i=HW(t,0,r),o=ny(t);t.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function cG(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],lm[16]={n:"BrtFRTArchID$",f:oG},ao(t,function(c,u,d){switch(d){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=gs(c.Ptg,null,null,i,e),delete e.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,c]):i[0]=[d,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),dC(r),r.Names=a,r.supbooks=i,r}function uG(t,e,r){return e.slice(-4)===".bin"?cG(t,r):sG(t,r)}function dG(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?GH(t,n,r,s,a,i,o):aH(t,n,r,s,a,i,o)}function fG(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?YH(t,n,r,s,a):QH(t,n,r,s,a)}function hG(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?bz():_z()}function mG(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?yz():wz()}function pG(t,e,r,n){return e.slice(-4)===".bin"?LB(t,r,n):NB(t,r,n)}function gG(t,e,r){return YI(t,r)}function xG(t,e,r){return e.slice(-4)===".bin"?JV(t,r):XV(t,r)}function vG(t,e,r){return e.slice(-4)===".bin"?gz(t,r):dz(t,r)}function yG(t,e,r){return e.slice(-4)===".bin"?lz(t):iz(t)}function wG(t,e,r,n){return r.slice(-4)===".bin"?cz(t,e,r,n):void 0}function bG(t,e,r){return e.slice(-4)===".bin"?sz(t,e,r):az(t,e,r)}var fC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,hC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Va(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(fC),a,i,o,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(hC),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function _G(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(fC),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(hC),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var Dd;function SG(t,e){var r=Dd[t]||Er(t);return r==="General"?Hl(e):Na(r,e)}function EG(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=qr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Hn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Er(e)]=s}function TG(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||oc[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ff(t.v):t.w=Hl(t.v):t.w=SG(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=Dd[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Au(n)){var s=kl(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function kG(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=EB[n.Pattern]||n.Pattern)}t[e.ID]=e}function AG(t,e,r,n,s,a,i,o,c,u){var d="General",h=n.StyleID,m={};u=u||{};var p=[],y=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&i&&(h=i.StyleID);a[h]!==void 0&&(a[h].nf&&(d=a[h].nf),a[h].Interior&&p.push(a[h].Interior),!!a[h].Parent);)h=a[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=qr(t);break;case"String":n.t="s",n.r=u_(Er(t)),n.v=t.indexOf("<")>-1?Er(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Hn(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Er(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=CI[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=u_(e||t));break}if(TG(n,d,u),u.cellFormula!==!1)if(n.Formula){var v=Er(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=Zc(v,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Zc("RC:RC",s):n.ArrayRange&&(n.F=Zc(n.ArrayRange,s),c.push([ln(n.F),n.F]))}else for(y=0;y<c.length;++y)s.r>=c[y][0].s.r&&s.r<=c[y][0].e.r&&s.c>=c[y][0].s.c&&s.c<=c[y][0].e.c&&(n.F=c[y][1]);u.cellStyles&&(p.forEach(function(b){!m.patternType&&b.patternType&&(m.patternType=b.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function IG(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function pg(t,e){var r=e||{};tI();var n=id(Jv(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=$r(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=ss(r);return i.type="string",pf.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ft){s.indexOf("<"+Ft)>=0&&(a=!0)}),a)return OG(n,r);Dd={"General Number":"General","General Date":nr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":nr[15],"Short Date":nr[14],"Long Time":nr[19],"Medium Time":nr[18],"Short Time":nr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:nr[2],Standard:nr[4],Percent:nr[10],Scientific:nr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},h=[],m=r.dense?[]:{},p="",y={},v={},b=Va('<Data ss:Type="String">'),E=0,T=0,w=0,B={s:{r:2e6,c:2e6},e:{r:0,c:0}},J={},Z={},_="",I=0,C=[],L={},F={},V=0,O=[],ct=[],me={},ft=[],rt,ze=!1,ie=[],Ye=[],_e={},Q=0,ae=0,le={Sheets:[],WBProps:{date1904:!1}},ne={};mf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Ae="";o=mf.exec(n);)switch(o[3]=(Ae=o[3]).toLowerCase()){case"data":if(Ae=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?AG(n.slice(E,o.index),_,b,c[c.length-1][0]=="comment"?me:y,{c:T,r:w},J,ft[T],v,ie,r):(_="",b=Va(o[0]),E=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ct.length>0&&(y.c=ct),(!r.sheetRows||r.sheetRows>w)&&y.v!==void 0&&(r.dense?(m[w]||(m[w]=[]),m[w][T]=y):m[Ln(T)+as(w)]=y),y.HRef&&(y.l={Target:Er(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(Q=T+(parseInt(y.MergeAcross,10)|0),ae=w+(parseInt(y.MergeDown,10)|0),C.push({s:{c:T,r:w},e:{c:Q,r:ae}})),!r.sheetStubs)y.MergeAcross?T=Q+1:++T;else if(y.MergeAcross||y.MergeDown){for(var st=T;st<=Q;++st)for(var ot=w;ot<=ae;++ot)(st>T||ot>w)&&(r.dense?(m[ot]||(m[ot]=[]),m[ot][st]={t:"z"}):m[Ln(st)+as(ot)]={t:"z"});T=Q+1}else++T;else y=_G(o[0]),y.Index&&(T=+y.Index-1),T<B.s.c&&(B.s.c=T),T>B.e.c&&(B.e.c=T),o[0].slice(-2)==="/>"&&++T,ct=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<B.s.r&&(B.s.r=w),w>B.e.r&&(B.e.r=w),o[0].slice(-2)==="/>"&&(v=Va(o[0]),v.Index&&(w=+v.Index-1)),T=0,++w):(v=Va(o[0]),v.Index&&(w=+v.Index-1),_e={},(v.AutoFitHeight=="0"||v.Height)&&(_e.hpx=parseInt(v.Height,10),_e.hpt=XI(_e.hpx),Ye[w]=_e),v.Hidden=="1"&&(_e.hidden=!0,Ye[w]=_e));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));h.push(p),B.s.r<=B.e.r&&B.s.c<=B.e.c&&(m["!ref"]=_r(B),r.sheetRows&&r.sheetRows<=B.e.r&&(m["!fullref"]=m["!ref"],B.e.r=r.sheetRows-1,m["!ref"]=_r(B))),C.length&&(m["!merges"]=C),ft.length>0&&(m["!cols"]=ft),Ye.length>0&&(m["!rows"]=Ye),d[p]=m}else B={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=T=0,c.push([o[3],!1]),u=Va(o[0]),p=Er(u.Name),m=r.dense?[]:{},C=[],ie=[],Ye=[],ne={name:p,Hidden:0},le.Sheets.push(ne);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),ft=[],ze=!1}break;case"style":o[1]==="/"?kG(J,Z,r):Z=Va(o[0]);break;case"numberformat":Z.nf=Er(Va(o[0]).Format||"General"),Dd[Z.nf]&&(Z.nf=Dd[Z.nf]);for(var Ne=0;Ne!=392&&nr[Ne]!=Z.nf;++Ne);if(Ne==392){for(Ne=57;Ne!=392;++Ne)if(nr[Ne]==null){Pl(Z.nf,Ne);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(rt=Va(o[0]),rt.Hidden&&(rt.hidden=!0,delete rt.Hidden),rt.Width&&(rt.wpx=parseInt(rt.Width,10)),!ze&&rt.wpx>10){ze=!0,js=KI;for(var Ve=0;Ve<ft.length;++Ve)ft[Ve]&&gu(ft[Ve])}ze&&gu(rt),ft[rt.Index-1||ft.length]=rt;for(var ge=0;ge<+rt.Span;++ge)ft[ft.length]=ss(rt);break;case"namedrange":if(o[1]==="/")break;le.Names||(le.Names=[]);var W=Kt(o[0]),we={Name:W.Name,Ref:Zc(W.RefersTo.slice(1),{r:0,c:0})};le.Sheets.length>0&&(we.Sheet=le.Sheets.length-1),le.Names.push(we);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?_+=n.slice(I,o.index):I=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;Z.Interior=Va(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?dU(L,Ae,n.slice(V,o.index)):V=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));IG(me),ct.push(me)}else c.push([o[3],!1]),u=Va(o[0]),me={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var et=Va(o[0]);m["!autofilter"]={ref:Zc(et.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return K_(n,r);var ht=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ht=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ht=!1}break;case"excelworkbook":switch(o[3]){case"date1904":le.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ht=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ht=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(V,o.index)){case"SheetHidden":ne.Hidden=1;break;case"SheetVeryHidden":ne.Hidden=2;break}else V=o.index+o[0].length;break;case"header":m["!margins"]||jd(m["!margins"]={},"xlml"),isNaN(+Kt(o[0]).Margin)||(m["!margins"].header=+Kt(o[0]).Margin);break;case"footer":m["!margins"]||jd(m["!margins"]={},"xlml"),isNaN(+Kt(o[0]).Margin)||(m["!margins"].footer=+Kt(o[0]).Margin);break;case"pagemargins":var Qe=Kt(o[0]);m["!margins"]||jd(m["!margins"]={},"xlml"),isNaN(+Qe.Top)||(m["!margins"].top=+Qe.Top),isNaN(+Qe.Left)||(m["!margins"].left=+Qe.Left),isNaN(+Qe.Right)||(m["!margins"].right=+Qe.Right),isNaN(+Qe.Bottom)||(m["!margins"].bottom=+Qe.Bottom);break;case"displayrighttoleft":le.Views||(le.Views=[]),le.Views[0]||(le.Views[0]={}),le.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ht=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ht=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ht=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ht=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ht=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ht=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ht=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ht=!1}break;case"smarttags":break;default:ht=!1;break}if(ht||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?EG(F,Ae,O,n.slice(V,o.index)):(O=o,V=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var qe={};return!r.bookSheets&&!r.bookProps&&(qe.Sheets=d),qe.SheetNames=h,qe.Workbook=le,qe.SSF=ss(nr),qe.Props=L,qe.Custprops=F,qe}function qx(t,e){switch(hy(e=e||{}),e.type||"base64"){case"base64":return pg(ma(t),e);case"binary":case"buffer":case"file":return pg(t,e);case"array":return pg(sc(t),e)}}function CG(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=z$(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=W$(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var NG=[60,1084,2066,2165,2175];function RG(t,e,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var c=Bi(r,r.l),u=Kx[c],d=0;u!=null&&NG.indexOf(c)>-1;)a=Bi(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=r.slice(d,r.l+4+a),i.push(o),r.l+=4+a,u=Kx[c=Bi(r,r.l)];var h=Eo(i);ts(h,0);var m=0;h.lens=[];for(var p=0;p<i.length;++p)h.lens.push(m),m+=i[p].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,s)}function fi(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=nr[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||oc[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ff(t.v):t.w=Hl(t.v):t.w=Na(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&Au(nr[n]||String(n))){var s=kl(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function j0(t,e,r){return{v:t,ixfe:e,t:r}}function PG(t,e){var r={opts:{}},n={},s=e.dense?[]:{},a={},i={},o=null,c=[],u="",d={},h,m="",p,y,v,b,E={},T=[],w,B,J=[],Z=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},I={},C=function(Bt){return Bt<8?jl[Bt]:Bt<64&&Z[Bt-8]||jl[Bt]},L=function(Bt,Qt,ir){var cr=Qt.XF.data;if(!(!cr||!cr.patternType||!ir||!ir.cellStyles)){Qt.s={},Qt.s.patternType=cr.patternType;var An;(An=gf(C(cr.icvFore)))&&(Qt.s.fgColor={rgb:An}),(An=gf(C(cr.icvBack)))&&(Qt.s.bgColor={rgb:An})}},F=function(Bt,Qt,ir){if(!(_e>1)&&!(ir.sheetRows&&Bt.r>=ir.sheetRows)){if(ir.cellStyles&&Qt.XF&&Qt.XF.data&&L(Bt,Qt,ir),delete Qt.ixfe,delete Qt.XF,h=Bt,m=Yt(Bt),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Bt.r<i.s.r&&(i.s.r=Bt.r),Bt.c<i.s.c&&(i.s.c=Bt.c),Bt.r+1>i.e.r&&(i.e.r=Bt.r+1),Bt.c+1>i.e.c&&(i.e.c=Bt.c+1),ir.cellFormula&&Qt.f){for(var cr=0;cr<T.length;++cr)if(!(T[cr][0].s.c>Bt.c||T[cr][0].s.r>Bt.r)&&!(T[cr][0].e.c<Bt.c||T[cr][0].e.r<Bt.r)){Qt.F=_r(T[cr][0]),(T[cr][0].s.c!=Bt.c||T[cr][0].s.r!=Bt.r)&&delete Qt.f,Qt.f&&(Qt.f=""+gs(T[cr][1],i,Bt,ie,V));break}}ir.dense?(s[Bt.r]||(s[Bt.r]=[]),s[Bt.r][Bt.c]=Qt):s[m]=Qt}},V={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(V.password=e.password);var O,ct=[],me=[],ft=[],rt=[],ze=!1,ie=[];ie.SheetNames=V.snames,ie.sharedf=V.sharedf,ie.arrayf=V.arrayf,ie.names=[],ie.XTI=[];var Ye=0,_e=0,Q=0,ae=[],le=[],ne;V.codepage=1200,Qa(1200);for(var Ae=!1;t.l<t.length-1;){var st=t.l,ot=t.read_shift(2);if(ot===0&&Ye===10)break;var Ne=t.l===t.length?0:t.read_shift(2),Ve=Kx[ot];if(Ve&&Ve.f){if(e.bookSheets&&Ye===133&&ot!==133)break;if(Ye=ot,Ve.r===2||Ve.r==12){var ge=t.read_shift(2);if(Ne-=2,!V.enc&&ge!==ot&&((ge&255)<<8|ge>>8)!==ot)throw new Error("rt mismatch: "+ge+"!="+ot);Ve.r==12&&(t.l+=10,Ne-=10)}var W={};if(ot===10?W=Ve.f(t,Ne,V):W=RG(ot,Ve,t,Ne,V),_e==0&&[9,521,1033,2057].indexOf(Ye)===-1)continue;switch(ot){case 34:r.opts.Date1904=_.WBProps.date1904=W;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(V.enc||(t.l=0),V.enc=W,!e.password)throw new Error("File is password-protected");if(W.valid==null)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:V.lastuser=W;break;case 66:var we=Number(W);switch(we){case 21010:we=1200;break;case 32768:we=1e4;break;case 32769:we=1252;break}Qa(V.codepage=we),Ae=!0;break;case 317:V.rrtabid=W;break;case 25:V.winlocked=W;break;case 439:r.opts.RefreshAll=W;break;case 12:r.opts.CalcCount=W;break;case 16:r.opts.CalcDelta=W;break;case 17:r.opts.CalcIter=W;break;case 13:r.opts.CalcMode=W;break;case 14:r.opts.CalcPrecision=W;break;case 95:r.opts.CalcSaveRecalc=W;break;case 15:V.CalcRefMode=W;break;case 2211:r.opts.FullCalc=W;break;case 129:W.fDialog&&(s["!type"]="dialog"),W.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),W.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:J.push(W);break;case 430:ie.push([W]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(W);break;case 24:case 536:ne={Name:W.Name,Ref:gs(W.rgce,i,null,ie,V)},W.itab>0&&(ne.Sheet=W.itab-1),ie.names.push(ne),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(W),W.Name=="_xlnm._FilterDatabase"&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&W.rgce[0][0][0]=="PtgArea3d"&&(le[W.itab-1]={ref:_r(W.rgce[0][0][1][2])});break;case 22:V.ExternCount=W;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(W),ie.XTI=ie.XTI.concat(W);break;case 2196:if(V.biff<8)break;ne!=null&&(ne.Comment=W[1]);break;case 18:s["!protect"]=W;break;case 19:W!==0&&V.WTF&&console.error("Password verifier: "+W);break;case 133:a[W.pos]=W,V.snames.push(W.name);break;case 10:{if(--_e)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=_r(i),e.sheetRows&&e.sheetRows<=i.e.r){var et=i.e.r;i.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=_r(i),i.e.r=et}i.e.r++,i.e.c++}ct.length>0&&(s["!merges"]=ct),me.length>0&&(s["!objects"]=me),ft.length>0&&(s["!cols"]=ft),rt.length>0&&(s["!rows"]=rt),_.Sheets.push(I)}u===""?d=s:n[u]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(V.biff===8&&(V.biff={9:2,521:3,1033:4}[ot]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),V.biffguess=W.BIFFVer==0,W.BIFFVer==0&&W.dt==4096&&(V.biff=5,Ae=!0,Qa(V.codepage=28591)),V.biff==8&&W.BIFFVer==0&&W.dt==16&&(V.biff=2),_e++)break;if(s=e.dense?[]:{},V.biff<8&&!Ae&&(Ae=!0,Qa(V.codepage=e.codepage||1252)),V.biff<5||W.BIFFVer==0&&W.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var ht={pos:t.l-Ne,name:u};a[ht.pos]=ht,V.snames.push(u)}else u=(a[st]||{name:""}).name;W.dt==32&&(s["!type"]="chart"),W.dt==64&&(s["!type"]="macro"),ct=[],me=[],V.arrayf=T=[],ft=[],rt=[],ze=!1,I={Hidden:(a[st]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[W.r]||[])[W.c]:s[Yt({c:W.c,r:W.r})])&&++W.c,w={ixfe:W.ixfe,XF:J[W.ixfe]||{},v:W.val,t:"n"},Q>0&&(w.z=ae[w.ixfe>>8&63]),fi(w,e,r.opts.Date1904),F({c:W.c,r:W.r},w,e);break;case 5:case 517:w={ixfe:W.ixfe,XF:J[W.ixfe],v:W.val,t:W.t},Q>0&&(w.z=ae[w.ixfe>>8&63]),fi(w,e,r.opts.Date1904),F({c:W.c,r:W.r},w,e);break;case 638:w={ixfe:W.ixfe,XF:J[W.ixfe],v:W.rknum,t:"n"},Q>0&&(w.z=ae[w.ixfe>>8&63]),fi(w,e,r.opts.Date1904),F({c:W.c,r:W.r},w,e);break;case 189:for(var Qe=W.c;Qe<=W.C;++Qe){var qe=W.rkrec[Qe-W.c][0];w={ixfe:qe,XF:J[qe],v:W.rkrec[Qe-W.c][1],t:"n"},Q>0&&(w.z=ae[w.ixfe>>8&63]),fi(w,e,r.opts.Date1904),F({c:Qe,r:W.r},w,e)}break;case 6:case 518:case 1030:{if(W.val=="String"){o=W;break}if(w=j0(W.val,W.cell.ixfe,W.tt),w.XF=J[w.ixfe],e.cellFormula){var Ft=W.formula;if(Ft&&Ft[0]&&Ft[0][0]&&Ft[0][0][0]=="PtgExp"){var Mt=Ft[0][0][1][0],Ot=Ft[0][0][1][1],er=Yt({r:Mt,c:Ot});E[er]?w.f=""+gs(W.formula,i,W.cell,ie,V):w.F=((e.dense?(s[Mt]||[])[Ot]:s[er])||{}).F}else w.f=""+gs(W.formula,i,W.cell,ie,V)}Q>0&&(w.z=ae[w.ixfe>>8&63]),fi(w,e,r.opts.Date1904),F(W.cell,w,e),o=W}break;case 7:case 519:if(o)o.val=W,w=j0(W,o.cell.ixfe,"s"),w.XF=J[w.ixfe],e.cellFormula&&(w.f=""+gs(o.formula,i,o.cell,ie,V)),Q>0&&(w.z=ae[w.ixfe>>8&63]),fi(w,e,r.opts.Date1904),F(o.cell,w,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(W);var jt=Yt(W[0].s);if(p=e.dense?(s[W[0].s.r]||[])[W[0].s.c]:s[jt],e.cellFormula&&p){if(!o||!jt||!p)break;p.f=""+gs(W[1],i,W[0],ie,V),p.F=_r(W[0])}}break;case 1212:{if(!e.cellFormula)break;if(m){if(!o)break;E[Yt(o.cell)]=W[0],p=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Yt(o.cell)],(p||{}).f=""+gs(W[0],i,h,ie,V)}}break;case 253:w=j0(c[W.isst].t,W.ixfe,"s"),c[W.isst].h&&(w.h=c[W.isst].h),w.XF=J[w.ixfe],Q>0&&(w.z=ae[w.ixfe>>8&63]),fi(w,e,r.opts.Date1904),F({c:W.c,r:W.r},w,e);break;case 513:e.sheetStubs&&(w={ixfe:W.ixfe,XF:J[W.ixfe],t:"z"},Q>0&&(w.z=ae[w.ixfe>>8&63]),fi(w,e,r.opts.Date1904),F({c:W.c,r:W.r},w,e));break;case 190:if(e.sheetStubs)for(var lr=W.c;lr<=W.C;++lr){var Nr=W.ixfe[lr-W.c];w={ixfe:Nr,XF:J[Nr],t:"z"},Q>0&&(w.z=ae[w.ixfe>>8&63]),fi(w,e,r.opts.Date1904),F({c:lr,r:W.r},w,e)}break;case 214:case 516:case 4:w=j0(W.val,W.ixfe,"s"),w.XF=J[w.ixfe],Q>0&&(w.z=ae[w.ixfe>>8&63]),fi(w,e,r.opts.Date1904),F({c:W.c,r:W.r},w,e);break;case 0:case 512:_e===1&&(i=W);break;case 252:c=W;break;case 1054:if(V.biff==4){ae[Q++]=W[1];for(var Rr=0;Rr<Q+163&&nr[Rr]!=W[1];++Rr);Rr>=163&&Pl(W[1],Q+163)}else Pl(W[1],W[0]);break;case 30:{ae[Q++]=W;for(var ls=0;ls<Q+163&&nr[ls]!=W;++ls);ls>=163&&Pl(W,Q+163)}break;case 229:ct=ct.concat(W);break;case 93:me[W.cmo[0]]=V.lastobj=W;break;case 438:V.lastobj.TxO=W;break;case 127:V.lastobj.ImData=W;break;case 440:for(b=W[0].s.r;b<=W[0].e.r;++b)for(v=W[0].s.c;v<=W[0].e.c;++v)p=e.dense?(s[b]||[])[v]:s[Yt({c:v,r:b})],p&&(p.l=W[1]);break;case 2048:for(b=W[0].s.r;b<=W[0].e.r;++b)for(v=W[0].s.c;v<=W[0].e.c;++v)p=e.dense?(s[b]||[])[v]:s[Yt({c:v,r:b})],p&&p.l&&(p.l.Tooltip=W[1]);break;case 28:{if(V.biff<=5&&V.biff>=2)break;p=e.dense?(s[W[0].r]||[])[W[0].c]:s[Yt(W[0])];var mn=me[W[2]];p||(e.dense?(s[W[0].r]||(s[W[0].r]=[]),p=s[W[0].r][W[0].c]={t:"z"}):p=s[Yt(W[0])]={t:"z"},i.e.r=Math.max(i.e.r,W[0].r),i.s.r=Math.min(i.s.r,W[0].r),i.e.c=Math.max(i.e.c,W[0].c),i.s.c=Math.min(i.s.c,W[0].c)),p.c||(p.c=[]),y={a:W[1],t:mn.TxO.t},p.c.push(y)}break;case 2173:ez(J[W.ixfe],W.ext);break;case 125:{if(!V.cellStyles)break;for(;W.e>=W.s;)ft[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(W.flags&1)},ze||(ze=!0,ly(W.w/256)),gu(ft[W.e+1])}break;case 520:{var Dr={};W.level!=null&&(rt[W.r]=Dr,Dr.level=W.level),W.hidden&&(rt[W.r]=Dr,Dr.hidden=!0),W.hpt&&(rt[W.r]=Dr,Dr.hpt=W.hpt,Dr.hpx=xf(W.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||jd(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ot]]=W;break;case 161:s["!margins"]||jd(s["!margins"]={}),s["!margins"].header=W.header,s["!margins"].footer=W.footer;break;case 574:W.RTL&&(_.Views[0].RTL=!0);break;case 146:Z=W;break;case 2198:O=W;break;case 140:B=W;break;case 442:u?I.CodeName=W||I.name:_.WBProps.CodeName=W||"ThisWorkbook";break}}else Ve||console.error("Missing Info for XLS Record 0x"+ot.toString(16)),t.l+=Ne}return r.SheetNames=Ni(a).sort(function(Lr,Bt){return Number(Lr)-Number(Bt)}).map(function(Lr){return a[Lr].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&le.forEach(function(Lr,Bt){r.Sheets[r.SheetNames[Bt]]["!autofilter"]=Lr}),r.Strings=c,r.SSF=ss(nr),V.enc&&(r.Encryption=V.enc),O&&(r.Themes=O),r.Metadata={},B!==void 0&&(r.Metadata.Country=B),ie.names.length>0&&(_.Names=ie.names),r.Workbook=_,r}var z_={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function jG(t,e,r){var n=br.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=k_(n,X$,z_.DSI);for(var a in s)e[a]=s[a]}catch(u){if(r.WTF)throw u}var i=br.find(t,"/!SummaryInformation");if(i&&i.size>0)try{var o=k_(i,Y$,z_.SI);for(var c in o)e[c]==null&&(e[c]=o[c])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(RI(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function mC(t,e){e||(e={}),hy(e),zA(),e.codepage&&Hv(e.codepage);var r,n;if(t.FullPaths){if(br.find(t,"/encryption"))throw new Error("File is password-protected");r=br.find(t,"!CompObj"),n=br.find(t,"/Workbook")||br.find(t,"/Book")}else{switch(e.type){case"base64":t=Ga(ma(t));break;case"binary":t=Ga(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}ts(t,0),n={content:t}}var s,a;if(r&&CG(r),e.bookProps&&!e.bookSheets)s={};else{var i=xr?"buffer":"array";if(n&&n.content)s=PG(n.content,e);else if((a=br.find(t,"PerfectOffice_MAIN"))&&a.content)s=Rd.to_workbook(a.content,(e.type=i,e));else if((a=br.find(t,"NativeContent_MAIN"))&&a.content)s=Rd.to_workbook(a.content,(e.type=i,e));else throw(a=br.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&br.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=vz(t))}var o={};return t.FullPaths&&jG(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}var lm={0:{f:mH},1:{f:vH},2:{f:AH},3:{f:_H},4:{f:wH},5:{f:kH},6:{f:NH},7:{f:EH},8:{f:FH},9:{f:DH},10:{f:PH},11:{f:jH},12:{f:yH},13:{f:IH},14:{f:SH},15:{f:bH},16:{f:cC},17:{f:RH},18:{f:TH},19:{f:ry},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:lG},40:{},42:{},43:{f:PB},44:{f:RB},45:{f:jB},46:{f:FB},47:{f:DB},48:{},49:{f:L$},50:{},51:{f:rz},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zI},62:{f:CH},63:{f:oz},64:{f:WH},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Es,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:zH},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:xH},148:{f:pH,p:16},151:{f:MH},152:{},153:{f:iG},154:{},155:{},156:{f:aG},157:{},158:{},159:{T:1,f:YV},160:{T:-1},161:{T:1,f:ic},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:LH},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:tz},336:{T:-1},337:{f:nz,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:zx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:BI},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:$H},427:{f:UH},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:BH},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:gH},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:OH},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:zx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:pz},633:{T:1},634:{T:-1},635:{T:1,f:mz},636:{T:-1},637:{f:M$},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:XH},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:HH},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Kx={6:{f:hg},10:{f:mo},12:{f:_n},13:{f:_n},14:{f:un},15:{f:un},16:{f:ys},17:{f:un},18:{f:un},19:{f:_n},20:{f:N_},21:{f:N_},23:{f:BI},24:{f:P_},25:{f:un},26:{},27:{},28:{f:fV},29:{},34:{f:un},35:{f:R_},38:{f:ys},39:{f:ys},40:{f:ys},41:{f:ys},42:{f:un},43:{f:un},47:{f:gB},49:{f:qU},51:{f:_n},60:{},61:{f:WU},64:{f:un},65:{f:GU},66:{f:_n},77:{},80:{},81:{},82:{},85:{f:_n},89:{},90:{},91:{},92:{f:LU},93:{f:mV},94:{},95:{f:un},96:{},97:{},99:{f:un},125:{f:zI},128:{f:nV},129:{f:OU},130:{f:_n},131:{f:un},132:{f:un},133:{f:MU},134:{},140:{f:wV},141:{f:_n},144:{},146:{f:_V},151:{},152:{},153:{},154:{},155:{},156:{f:_n},157:{},158:{},160:{f:AV},161:{f:EV},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:ZU},190:{f:eV},193:{f:mo},197:{},198:{},199:{},200:{},201:{},202:{f:un},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:_n},220:{},221:{f:un},222:{},224:{f:rV},225:{f:FU},226:{f:mo},227:{},229:{f:hV},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:$U},253:{f:KU},255:{f:UU},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:LI},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:un},353:{f:mo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:aV},431:{f:un},432:{},433:{},434:{},437:{},438:{f:xV},439:{f:un},440:{f:vV},441:{},442:{f:Uf},443:{},444:{f:_n},445:{},446:{},448:{f:mo},449:{f:zU,r:2},450:{f:mo},512:{f:I_},513:{f:kV},515:{f:sV},516:{f:QU},517:{f:C_},519:{f:IV},520:{f:VU},523:{},545:{f:j_},549:{f:A_},566:{},574:{f:HU},638:{f:JU},659:{},1048:{},1054:{f:XU},1084:{},1212:{f:cV},2048:{f:yV},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:N0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:mo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:SV,r:12},2173:{f:ZB,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:un,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:lV,r:12},2197:{},2198:{f:qB,r:12},2199:{},2200:{},2201:{},2202:{f:uV,r:12},2203:{f:mo},2204:{},2205:{},2206:{},2207:{},2211:{f:BU},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:_n},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:TV},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:bV},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:I_},1:{},2:{f:PV},3:{f:RV},4:{f:NV},5:{f:C_},7:{f:jV},8:{},9:{f:N0},11:{},22:{f:_n},30:{f:YU},31:{},32:{},33:{f:j_},36:{},37:{f:A_},50:{f:DV},62:{},52:{},67:{},68:{f:_n},69:{},86:{},126:{},127:{f:CV},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:FV},223:{},234:{},354:{},421:{},518:{f:hg},521:{f:N0},536:{f:P_},547:{f:R_},561:{},579:{},1030:{f:hg},1033:{f:N0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ba(t,e,r,n){var s=e;if(!isNaN(s)){var a=(r||[]).length||0,i=t.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&SI(r)&&t.push(r)}}function W_(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),i=s.index,o=a&&a.index||t.length,c=s$(t.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,h=0,m=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(i=0;i<c.length;++i){var v=c[i].trim(),b=v.slice(0,3).toLowerCase();if(b=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(b!="<td"&&b!="<th")){var E=v.split(/<\/t[dh]>/i);for(o=0;o<E.length;++o){var T=E[o].trim();if(T.match(/<t[dh]/i)){for(var w=T,B=0;w.charAt(0)=="<"&&(B=w.indexOf(">"))>-1;)w=w.slice(B+1);for(var J=0;J<y.length;++J){var Z=y[J];Z.s.c==d&&Z.s.r<u&&u<=Z.e.r&&(d=Z.e.c+1,J=-1)}var _=Kt(T.slice(0,T.indexOf(">")));m=_.colspan?+_.colspan:1,((h=+_.rowspan)>1||m>1)&&y.push({s:{r:u,c:d},e:{r:u+(h||1)-1,c:d+m-1}});var I=_.t||_["data-t"]||"";if(!w.length){d+=m;continue}if(w=uI(w),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>d&&(p.s.c=d),p.e.c<d&&(p.e.c=d),!w.length){d+=m;continue}var C={t:"s",v:w};r.raw||!w.trim().length||I=="s"||(w==="TRUE"?C={t:"b",v:!0}:w==="FALSE"?C={t:"b",v:!1}:isNaN(Za(w))?isNaN(pu(w).getDate())||(C={t:"d",v:Hn(w)},r.cellDates||(C={t:"n",v:Ms(C.v)}),C.z=r.dateNF||nr[14]):C={t:"n",v:Za(w)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=C):n[Yt({r:u,c:d})]=C,d+=m}}}}return n["!ref"]=_r(p),y.length&&(n["!merges"]=y),n}function DG(t,e,r,n){for(var s=t["!merges"]||[],a=[],i=e.s.c;i<=e.e.c;++i){for(var o=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var d=Yt({r,c:i}),h=n.dense?(t[r]||[])[i]:t[d],m=h&&h.v!=null&&(h.h||Yv(h.w||(to(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+h.l.Target+'">'+m+"</a>")),p.id=(n.id||"sjs")+"-"+d,a.push(w$("td",m,p))}}var y="<tr>";return y+a.join("")+"</tr>"}var FG='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',LG="</body></html>";function OG(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return cl(W_(r[0],e),e);var n=py();return r.forEach(function(s,a){gy(n,W_(s,e),"Sheet"+(a+1))}),n}function MG(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function $G(t,e){var r=e||{},n=r.header!=null?r.header:FG,s=r.footer!=null?r.footer:LG,a=[n],i=Iu(t["!ref"]);r.dense=Array.isArray(t),a.push(MG(t,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(DG(t,i,o,r));return a.push("</table>"+s),a.join("")}function pC(t,e,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Ds(n.origin):n.origin;s=i.r,a=i.c}var o=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(t["!ref"]){var d=Iu(t["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var h=[],m=0,p=t["!rows"]||(t["!rows"]=[]),y=0,v=0,b=0,E=0,T=0,w=0;for(t["!cols"]||(t["!cols"]=[]);y<o.length&&v<c;++y){var B=o[y];if(H_(B)){if(n.display)continue;p[v]={hidden:!0}}var J=B.children;for(b=E=0;b<J.length;++b){var Z=J[b];if(!(n.display&&H_(Z))){var _=Z.hasAttribute("data-v")?Z.getAttribute("data-v"):Z.hasAttribute("v")?Z.getAttribute("v"):uI(Z.innerHTML),I=Z.getAttribute("data-z")||Z.getAttribute("z");for(m=0;m<h.length;++m){var C=h[m];C.s.c==E+a&&C.s.r<v+s&&v+s<=C.e.r&&(E=C.e.c+1-a,m=-1)}w=+Z.getAttribute("colspan")||1,((T=+Z.getAttribute("rowspan")||1)>1||w>1)&&h.push({s:{r:v+s,c:E+a},e:{r:v+s+(T||1)-1,c:E+a+(w||1)-1}});var L={t:"s",v:_},F=Z.getAttribute("data-t")||Z.getAttribute("t")||"";_!=null&&(_.length==0?L.t=F||"z":n.raw||_.trim().length==0||F=="s"||(_==="TRUE"?L={t:"b",v:!0}:_==="FALSE"?L={t:"b",v:!1}:isNaN(Za(_))?isNaN(pu(_).getDate())||(L={t:"d",v:Hn(_)},n.cellDates||(L={t:"n",v:Ms(L.v)}),L.z=n.dateNF||nr[14]):L={t:"n",v:Za(_)})),L.z===void 0&&I!=null&&(L.z=I);var V="",O=Z.getElementsByTagName("A");if(O&&O.length)for(var ct=0;ct<O.length&&!(O[ct].hasAttribute("href")&&(V=O[ct].getAttribute("href"),V.charAt(0)!="#"));++ct);V&&V.charAt(0)!="#"&&(L.l={Target:V}),n.dense?(t[v+s]||(t[v+s]=[]),t[v+s][E+a]=L):t[Yt({c:E+a,r:v+s})]=L,u.e.c<E+a&&(u.e.c=E+a),E+=w}}++v}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,v-1+s),t["!ref"]=_r(u),v>=c&&(t["!fullref"]=_r((u.e.r=o.length-y+v-1+s,u))),t}function gC(t,e){var r=e||{},n=r.dense?[]:{};return pC(n,t,e)}function UG(t,e){return cl(gC(t,e),e)}function H_(t){var e="",r=VG(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function VG(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function BG(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Er(e.replace(/<[^>]*>/g,""));return[r]}var G_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function xC(t,e){var r=e||{},n=Jv(t),s=[],a,i,o={name:""},c="",u=0,d,h,m={},p=[],y=r.dense?[]:{},v,b,E={value:""},T="",w=0,B=[],J=-1,Z=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},I=0,C={},L=[],F={},V=0,O=0,ct=[],me=1,ft=1,rt=[],ze={Names:[]},ie={},Ye=["",""],_e=[],Q={},ae="",le=0,ne=!1,Ae=!1,st=0;for(mf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=mf.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?y["!ref"]=_r(_):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(y["!fullref"]=y["!ref"],_.e.r=r.sheetRows-1,y["!ref"]=_r(_)),L.length&&(y["!merges"]=L),ct.length&&(y["!rows"]=ct),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),p.push(d.name),m[d.name]=y,Ae=!1):v[0].charAt(v[0].length-2)!=="/"&&(d=Kt(v[0],!1),J=Z=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,y=r.dense?[]:{},L=[],ct=[],Ae=!0);break;case"table-row-group":v[1]==="/"?--I:++I;break;case"table-row":case"":if(v[1]==="/"){J+=me,me=1;break}if(h=Kt(v[0],!1),h.?J=h.-1:J==-1&&(J=0),me=+h["number-rows-repeated"]||1,me<10)for(st=0;st<me;++st)I>0&&(ct[J+st]={level:I});Z=-1;break;case"covered-table-cell":v[1]!=="/"&&++Z,r.sheetStubs&&(r.dense?(y[J]||(y[J]=[]),y[J][Z]={t:"z"}):y[Yt({r:J,c:Z})]={t:"z"}),T="",B=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++Z,E=Kt(v[0],!1),ft=parseInt(E["number-columns-repeated"]||"1",10),b={t:"z",v:null},E.formula&&r.cellFormula!=!1&&(b.f=U_(Er(E.formula))),(E.||E["value-type"])=="string"&&(b.t="s",b.v=Er(E["string-value"]||""),r.dense?(y[J]||(y[J]=[]),y[J][Z]=b):y[Yt({r:J,c:Z})]=b),Z+=ft-1;else if(v[1]!=="/"){++Z,T="",w=0,B=[],ft=1;var ot=me?J+me-1:J;if(Z>_.e.c&&(_.e.c=Z),Z<_.s.c&&(_.s.c=Z),J<_.s.r&&(_.s.r=J),ot>_.e.r&&(_.e.r=ot),E=Kt(v[0],!1),_e=[],Q={},b={t:E.||E["value-type"],v:null},r.cellFormula)if(E.formula&&(E.formula=Er(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(V=parseInt(E["number-matrix-rows-spanned"],10)||0,O=parseInt(E["number-matrix-columns-spanned"],10)||0,F={s:{r:J,c:Z},e:{r:J+V-1,c:Z+O-1}},b.F=_r(F),rt.push([F,b.F])),E.formula)b.f=U_(E.formula);else for(st=0;st<rt.length;++st)J>=rt[st][0].s.r&&J<=rt[st][0].e.r&&Z>=rt[st][0].s.c&&Z<=rt[st][0].e.c&&(b.F=rt[st][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(V=parseInt(E["number-rows-spanned"],10)||0,O=parseInt(E["number-columns-spanned"],10)||0,F={s:{r:J,c:Z},e:{r:J+V-1,c:Z+O-1}},L.push(F)),E["number-columns-repeated"]&&(ft=parseInt(E["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=qr(E["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(E.value);break;case"percentage":b.t="n",b.v=parseFloat(E.value);break;case"currency":b.t="n",b.v=parseFloat(E.value);break;case"date":b.t="d",b.v=Hn(E["date-value"]),r.cellDates||(b.t="n",b.v=Ms(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=t$(E["time-value"])/86400,r.cellDates&&(b.t="d",b.v=np(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(E.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",E["string-value"]!=null&&(T=Er(E["string-value"]),B=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(ne=!1,b.t==="s"&&(b.v=T||"",B.length&&(b.R=B),ne=w==0),ie.Target&&(b.l=ie),_e.length>0&&(b.c=_e,_e=[]),T&&r.cellText!==!1&&(b.w=T),ne&&(b.t="z",delete b.v),(!ne||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=J))for(var Ne=0;Ne<me;++Ne){if(ft=parseInt(E["number-columns-repeated"]||"1",10),r.dense)for(y[J+Ne]||(y[J+Ne]=[]),y[J+Ne][Z]=Ne==0?b:ss(b);--ft>0;)y[J+Ne][Z+ft]=ss(b);else for(y[Yt({r:J+Ne,c:Z})]=b;--ft>0;)y[Yt({r:J+Ne,c:Z+ft})]=ss(b);_.e.c<=Z&&(_.e.c=Z)}ft=parseInt(E["number-columns-repeated"]||"1",10),Z+=ft-1,ft=0,b={},T="",B=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a;Q.t=T,B.length&&(Q.R=B),Q.a=ae,_e.push(Q)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);ae="",le=0,T="",w=0,B=[];break;case"creator":v[1]==="/"?ae=n.slice(le,v.index):le=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);T="",w=0,B=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(C[o.name]=c,(a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&(c="",o=Kt(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Kt(v[0],!1),c+=G_[v[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Kt(v[0],!1),c+=G_[v[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,v.index);break}else u=v.index+v[0].length;break;case"named-range":i=Kt(v[0],!1),Ye=mg(i["cell-range-address"]);var Ve={Name:i.name,Ref:Ye[0]+"!"+Ye[1]};Ae&&(Ve.Sheet=p.length),ze.Names.push(Ve);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!E||!E["string-value"])){var ge=BG(n.slice(w,v.index));T=(T.length>0?T+`
`:"")+ge[0]}else Kt(v[0],!1),w=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{Ye=mg(Kt(v[0])["target-range-address"]),m[Ye[0]]["!autofilter"]={ref:Ye[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(ie=Kt(v[0],!1),!ie.href)break;ie.Target=Er(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(Ye=mg(ie.Target.slice(1)),ie.Target="#"+Ye[0]+"!"+Ye[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var W={Sheets:m,SheetNames:p,Workbook:ze};return r.bookSheets&&delete W.Sheets,W}function q_(t,e){e=e||{},ba(t,"META-INF/manifest.xml")&&sU(bn(t,"META-INF/manifest.xml"),e);var r=la(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=xC($r(r),e);return ba(t,"meta.xml")&&(n.Props=NI(bn(t,"meta.xml"))),n}function K_(t,e){return xC(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function dy(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Qx(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):$r(sc(t))}function Xx(t){var e=t.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function Q_(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function zG(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function vf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Mn(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function ws(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=vf(t,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var c=r[0];t[r[0]++]>=128;);o=t.slice(c,r[0])}break;case 5:i=4,o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=vf(t,r),o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:a};e[s]==null?e[s]=[u]:e[s].push(u)}return e}function fy(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function WG(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=vf(t,n),a=ws(t.slice(n[0],n[0]+s));n[0]+=s;var i={id:Mn(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=ws(o.data),u=Mn(c[3][0].data);i.messages.push({meta:c,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=a[3])!=null&&e[0]&&(i.merge=Mn(a[3][0].data)>>>0>0),r.push(i)}return r}function HG(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=vf(e,r),s=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var i=e[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=e[r[0]],o>1&&(i|=e[r[0]+1]<<8),o>2&&(i|=e[r[0]+2]<<16),o>3&&(i|=e[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(e.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(a==1?(u=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,a==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Xx(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=Xx(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function GG(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(HG(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Xx(e)}function qG(t,e,r,n){var s=dy(t),a=s.getUint32(4,!0),i=(n>1?12:8)+Q_(a&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,d=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=Q_(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(i,!0),i+=4),a&32&&(u=s.getFloat64(i,!0),i+=8),a&64&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:u};break;case 3:h={t:"s",v:e[c]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(c>-1)h={t:"s",v:e[c]};else if(!isNaN(u))h={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function KG(t,e,r){var n=dy(t),s=n.getUint32(8,!0),a=12,i=-1,o=-1,c=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(c=zG(t,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(i>-1)h={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return h}function QG(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return qG(t,e,r,t[0]);case 5:return KG(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function zo(t){var e=ws(t);return vf(e[1][0].data)}function X_(t,e){var r=ws(e.data),n=Mn(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=ws(i.data),c=Mn(o[1][0].data)>>>0;switch(n){case 1:a[c]=Qx(o[3][0].data);break;case 8:{var u=t[zo(o[9][0].data)][0],d=ws(u.data),h=t[zo(d[1][0].data)][0],m=Mn(h.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var p=ws(h.data);a[c]=p[3].map(function(y){return Qx(y.data)}).join("")}break}}),a}function XG(t,e){var r,n,s,a,i,o,c,u,d,h,m,p,y,v,b=ws(t),E=Mn(b[1][0].data)>>>0,T=Mn(b[2][0].data)>>>0,w=((n=(r=b[8])==null?void 0:r[0])==null?void 0:n.data)&&Mn(b[8][0].data)>0||!1,B,J;if((a=(s=b[7])==null?void 0:s[0])!=null&&a.data&&e!=0)B=(o=(i=b[7])==null?void 0:i[0])==null?void 0:o.data,J=(u=(c=b[6])==null?void 0:c[0])==null?void 0:u.data;else if((h=(d=b[4])==null?void 0:d[0])!=null&&h.data&&e!=1)B=(p=(m=b[4])==null?void 0:m[0])==null?void 0:p.data,J=(v=(y=b[3])==null?void 0:y[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var Z=w?4:1,_=dy(B),I=[],C=0;C<B.length/2;++C){var L=_.getUint16(C*2,!0);L<65535&&I.push([C,L])}if(I.length!=T)throw"Expected ".concat(T," cells, found ").concat(I.length);var F=[];for(C=0;C<I.length-1;++C)F[I[C][0]]=J.subarray(I[C][1]*Z,I[C+1][1]*Z);return I.length>=1&&(F[I[I.length-1][0]]=J.subarray(I[I.length-1][1]*Z)),{R:E,cells:F}}function YG(t,e){var r,n=ws(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Mn(n[7][0].data)>>>0>0?1:0:-1,a=fy(n[5],function(i){return XG(i,s)});return{nrows:Mn(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=c}),i},[])}}function JG(t,e,r){var n,s=ws(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Mn(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Mn(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=_r(a);var i=ws(s[4][0].data),o=X_(t,t[zo(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?X_(t,t[zo(i[17][0].data)][0]):[],u=ws(i[3][0].data),d=0;u[1].forEach(function(h){var m=ws(h.data),p=t[zo(m[2][0].data)][0],y=Mn(p.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var v=YG(t,p);v.data.forEach(function(b,E){b.forEach(function(T,w){var B=Yt({r:d+E,c:w}),J=QG(T,o,c);J&&(r[B]=J)})}),d+=v.nrows})}function ZG(t,e){var r=ws(e.data),n={"!ref":"A1"},s=t[zo(r[2][0].data)],a=Mn(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return JG(t,s[0],n),n}function eq(t,e){var r,n=ws(e.data),s={name:(r=n[1])!=null&&r[0]?Qx(n[1][0].data):"",sheets:[]},a=fy(n[2],zo);return a.forEach(function(i){t[i].forEach(function(o){var c=Mn(o.meta[1][0].data);c==6e3&&s.sheets.push(ZG(t,o))})}),s}function tq(t,e){var r=py(),n=ws(e.data),s=fy(n[1],zo);if(s.forEach(function(a){t[a].forEach(function(i){var o=Mn(i.meta[1][0].data);if(o==2){var c=eq(t,i);c.sheets.forEach(function(u,d){gy(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function gg(t){var e,r,n,s,a={},i=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=GG(c.content)}catch(h){return console.log("?? "+c.content.length+" "+(h.message||h))}var d;try{d=WG(u)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){a[h.id]=h.messages,i.push(h.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=a==null?void 0:a[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Mn(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(c){a[c].forEach(function(u){var d=Mn(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return tq(a,o)}function rq(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function hy(t){rq([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function nq(t){return Mc.WS.indexOf(t)>-1?"sheet":t==Mc.CS?"chart":t==Mc.DS?"dialog":t==Mc.MS?"macro":t&&t.length?t:"sheet"}function sq(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,nq(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function aq(t,e,r,n,s,a,i,o,c,u,d,h){try{a[n]=Cd(la(t,r,!0),e);var m=bn(t,e),p;switch(o){case"sheet":p=dG(m,e,s,c,a[n],u,d,h);break;case"chart":if(p=fG(m,e,s,c,a[n],u,d,h),!p||!p["!drawel"])break;var y=ld(p["!drawel"].Target,e),v=Wx(y),b=uz(la(t,y,!0),Cd(la(t,v,!0),y)),E=ld(b,y),T=Wx(E);p=KH(la(t,E,!0),E,c,Cd(la(t,T,!0),E),u,p);break;case"macro":p=hG(m,e,s,c,a[n],u,d,h);break;case"dialog":p=mG(m,e,s,c,a[n],u,d,h);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var w=[];a&&a[n]&&Ni(a[n]).forEach(function(B){var J="";if(a[n][B].Type==Mc.CMNT){J=ld(a[n][B].Target,e);var Z=vG(bn(t,J,!0),J,c);if(!Z||!Z.length)return;F_(p,Z,!1)}a[n][B].Type==Mc.TCMNT&&(J=ld(a[n][B].Target,e),w=w.concat(fz(bn(t,J,!0),c)))}),w&&w.length&&F_(p,w,!0,c.people||[])}catch(B){if(c.WTF)throw B}}function ya(t){return t.charAt(0)=="/"?t.slice(1):t}function iq(t,e){if(tI(),e=e||{},hy(e),ba(t,"META-INF/manifest.xml")||ba(t,"objectdata.xml"))return q_(t,e);if(ba(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof gg<"u"){if(t.FileIndex)return gg(t);var r=br.utils.cfb_new();return l_(t).forEach(function(ct){o$(r,ct,i$(t,ct))}),gg(r)}throw new Error("Unsupported NUMBERS file")}if(!ba(t,"[Content_Types].xml"))throw ba(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ba(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=l_(t),s=rU(la(t,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",bn(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!bn(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},u={};if(!e.bookSheets&&!e.bookProps){if(Pd=[],s.sst)try{Pd=xG(bn(t,ya(s.sst)),s.sst,e)}catch(ct){if(e.WTF)throw ct}e.cellStyles&&s.themes.length&&(c=gG(la(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(u=pG(bn(t,ya(s.style)),s.style,c,e))}s.links.map(function(ct){try{var me=Cd(la(t,Wx(ya(ct))),ct);return wG(bn(t,ya(ct)),me,ct,e)}catch{}});var d=uG(bn(t,ya(s.workbooks[0])),s.workbooks[0],e),h={},m="";s.coreprops.length&&(m=bn(t,ya(s.coreprops[0]),!0),m&&(h=NI(m)),s.extprops.length!==0&&(m=bn(t,ya(s.extprops[0]),!0),m&&oU(m,h,e)));var p={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(m=la(t,ya(s.custprops[0]),!0),m&&(p=cU(m,e)));var y={};if((e.bookSheets||e.bookProps)&&(d.Sheets?i=d.Sheets.map(function(me){return me.name}):h.Worksheets&&h.SheetNames.length>0&&(i=h.SheetNames),e.bookProps&&(y.Props=h,y.Custprops=p),e.bookSheets&&typeof i<"u"&&(y.SheetNames=i),e.bookSheets?y.SheetNames:e.bookProps))return y;i={};var v={};e.bookDeps&&s.calcchain&&(v=yG(bn(t,ya(s.calcchain)),s.calcchain));var b=0,E={},T,w;{var B=d.Sheets;h.Worksheets=B.length,h.SheetNames=[];for(var J=0;J!=B.length;++J)h.SheetNames[J]=B[J].name}var Z=a?"bin":"xml",_=s.workbooks[0].lastIndexOf("/"),I=(s.workbooks[0].slice(0,_+1)+"_rels/"+s.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");ba(t,I)||(I="xl/_rels/workbook."+Z+".rels");var C=Cd(la(t,I,!0),I.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=bG(bn(t,ya(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=hz(bn(t,ya(s.people[0])),e)),C&&(C=sq(C,d.Sheets));var L=bn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=h.Worksheets;++b){var F="sheet";if(C&&C[b]?(T="xl/"+C[b][1].replace(/[\/]?xl\//,""),ba(t,T)||(T=C[b][1]),ba(t,T)||(T=I.replace(/_rels\/.*$/,"")+C[b][1]),F=C[b][2]):(T="xl/worksheets/sheet"+(b+1-L)+"."+Z,T=T.replace(/sheet0\./,"sheet.")),w=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(b!=e.sheets)continue e;break;case"string":if(h.SheetNames[b].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var V=!1,O=0;O!=e.sheets.length;++O)typeof e.sheets[O]=="number"&&e.sheets[O]==b&&(V=1),typeof e.sheets[O]=="string"&&e.sheets[O].toLowerCase()==h.SheetNames[b].toLowerCase()&&(V=1);if(!V)continue e}}aq(t,T,w,h.SheetNames[b],b,E,i,F,e,d,c,u)}return y={Directory:s,Workbook:d,Props:h,Custprops:p,Deps:v,Sheets:i,SheetNames:h.SheetNames,Strings:Pd,Styles:u,Themes:c,SSF:ss(nr)},e&&e.bookFiles&&(t.files?(y.keys=n,y.files=t.files):(y.keys=[],y.files={},t.FullPaths.forEach(function(ct,me){ct=ct.replace(/^Root Entry[\/]/,""),y.keys.push(ct),y.files[ct]=t.FileIndex[me]}))),e&&e.bookVBA&&(s.vba.length>0?y.vbaraw=bn(t,ya(s.vba[0]),!0):s.defaults&&s.defaults.bin===xz&&(y.vbaraw=bn(t,"xl/vbaProject.bin",!0))),y}function oq(t,e){var r=e||{},n="Workbook",s=br.find(t,n);try{if(n="/!DataSpaces/Version",s=br.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(ZV(s.content),n="/!DataSpaces/DataSpaceMap",s=br.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=tB(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=br.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=rB(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=br.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);sB(s.content)}catch{}if(n="/EncryptionInfo",s=br.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=aB(s.content);if(n="/EncryptedPackage",s=br.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function my(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=ma(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function lq(t,e){return br.find(t,"EncryptedPackage")?oq(t,e):mC(t,e)}function cq(t,e){var r,n=t,s=e||{};return s.type||(s.type=xr&&Buffer.isBuffer(t)?"buffer":"base64"),r=oI(n,s),iq(r,s)}function vC(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return qx(t.slice(r),e);default:break e}return pf.to_workbook(t,e)}function uq(t,e){var r="",n=my(t,e);switch(e.type){case"base64":r=ma(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Gl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=$r(r)),e.type="binary",vC(r,e)}function dq(t,e){var r=t;return e.type=="base64"&&(r=ma(r)),r=df.utils.decode(1200,r.slice(2),"str"),e.type="binary",vC(r,e)}function fq(t){return t.match(/[^\x00-\x7F]/)?cd(t):t}function xg(t,e,r,n){return n?(r.type="string",pf.to_workbook(t,r)):pf.to_workbook(e,r)}function Yx(t,e){zA();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Yx(new Uint8Array(t),(r=ss(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),eu={},r.dateNF&&(eu.dateNF=r.dateNF),r.type||(r.type=xr&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=xr?"buffer":"binary",n=Z9(t),typeof Uint8Array<"u"&&!xr&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=fq(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=ss(r),r.type="array",Yx(Gv(n),r)}switch((s=my(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return lq(br.read(n,r),r);break;case 9:if(s[1]<=8)return mC(n,r);break;case 60:return qx(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return UV(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return MV.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?cq(n,r):xg(t,n,r,a);case 239:return s[3]===60?qx(n,r):xg(t,n,r,a);case 255:if(s[1]===254)return dq(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Rd.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Rd.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return D_.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return xB.to_workbook(n,r);break;case 10:case 13:case 32:return uq(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return LV.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?D_.to_workbook(n,r):xg(t,n,r,a)}function hq(t,e,r,n,s,a,i,o){var c=as(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!i||t[r])for(var p=e.s.c;p<=e.e.c;++p){var y=i?t[r][p]:t[n[p]+c];if(y===void 0||y.t===void 0){if(u===void 0)continue;a[p]!=null&&(m[a[p]]=u);continue}var v=y.v;switch(y.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(a[p]!=null){if(v==null)if(y.t=="e"&&v===null)m[a[p]]=null;else if(u!==void 0)m[a[p]]=u;else if(d&&v===null)m[a[p]]=null;else continue;else m[a[p]]=d&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?v:to(y,v,o);v!=null&&(h=!1)}}return{row:m,isempty:h}}function Jx(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=ln(d);break;case"number":c=ln(t["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var h=as(c.s.r),m=[],p=[],y=0,v=0,b=Array.isArray(t),E=c.s.r,T=0,w={};b&&!t[E]&&(t[E]=[]);var B=u.skipHidden&&t["!cols"]||[],J=u.skipHidden&&t["!rows"]||[];for(T=c.s.c;T<=c.e.c;++T)if(!(B[T]||{}).hidden)switch(m[T]=Ln(T),r=b?t[E][T]:t[m[T]+h],n){case 1:a[T]=T-c.s.c;break;case 2:a[T]=m[T];break;case 3:a[T]=u.header[T-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=to(r,null,u),v=w[i]||0,!v)w[i]=1;else{do o=i+"_"+v++;while(w[o]);w[i]=v,w[o]=1}a[T]=o}for(E=c.s.r+s;E<=c.e.r;++E)if(!(J[E]||{}).hidden){var Z=hq(t,c,E,m,n,a,b,u);(Z.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[y++]=Z.row)}return p.length=y,p}var Y_=/"/g;function mq(t,e,r,n,s,a,i,o){for(var c=!0,u=[],d="",h=as(r),m=e.s.c;m<=e.e.c;++m)if(n[m]){var p=o.dense?(t[r]||[])[m]:t[n[m]+h];if(p==null)d="";else if(p.v!=null){c=!1,d=""+(o.rawNumbers&&p.t=="n"?p.v:to(p,null,o));for(var y=0,v=0;y!==d.length;++y)if((v=d.charCodeAt(y))===s||v===a||v===34||o.forceQuotes){d='"'+d.replace(Y_,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(c=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(Y_,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(i)}function yC(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=ln(t["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",h=[];n.dense=Array.isArray(t);for(var m=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],y=s.s.c;y<=s.e.c;++y)(m[y]||{}).hidden||(h[y]=Ln(y));for(var v=0,b=s.s.r;b<=s.e.r;++b)(p[b]||{}).hidden||(d=mq(t,s,b,h,i,c,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((v++?o:"")+d)));return delete n.dense,r.join("")}function pq(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=yC(t,e);return r}function gq(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=ln(t["!ref"]),a="",i=[],o,c=[],u=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)i[o]=Ln(o);for(var d=s.s.r;d<=s.e.r;++d)for(a=as(d),o=s.s.c;o<=s.e.c;++o)if(e=i[o]+a,r=u?(t[d]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function wC(t,e,r){var n=r||{},s=+!n.skipHeader,a=t||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Ds(n.origin):n.origin;i=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:i+e.length-1+s}};if(a["!ref"]){var h=ln(a["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),i==-1&&(i=h.e.r+1,d.e.r=i+e.length-1+s)}else i==-1&&(i=0,d.e.r=e.length-1+s);var m=n.header||[],p=0;e.forEach(function(v,b){Ni(v).forEach(function(E){(p=m.indexOf(E))==-1&&(m[p=m.length]=E);var T=v[E],w="z",B="",J=Yt({c:o+p,r:i+b+s});u=yf(a,J),T&&typeof T=="object"&&!(T instanceof Date)?a[J]=T:(typeof T=="number"?w="n":typeof T=="boolean"?w="b":typeof T=="string"?w="s":T instanceof Date?(w="d",n.cellDates||(w="n",T=Ms(T)),B=n.dateNF||nr[14]):T===null&&n.nullError&&(w="e",T=0),u?(u.t=w,u.v=T,delete u.w,delete u.R,B&&(u.z=B)):a[J]=u={t:w,v:T},B&&(u.z=B))})}),d.e.c=Math.max(d.e.c,o+m.length-1);var y=as(i);if(s)for(p=0;p<m.length;++p)a[Ln(p+o)+y]={t:"s",v:m[p]};return a["!ref"]=_r(d),a}function xq(t,e){return wC(null,t,e)}function yf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Ds(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?yf(t,Yt(e)):yf(t,Yt({r:e,c:r||0}))}function vq(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function py(){return{SheetNames:[],Sheets:{}}}function gy(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=i+s)!=-1;++s);}if(rG(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function yq(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=vq(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function wq(t,e){return t.z=e,t}function bC(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function bq(t,e,r){return bC(t,"#"+e,r)}function _q(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function Sq(t,e,r,n){for(var s=typeof e!="string"?e:ln(e),a=typeof e=="string"?e:_r(e),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var c=yf(t,i,o);c.t="n",c.F=a,delete c.v,i==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return t}var Eq={encode_col:Ln,encode_row:as,encode_cell:Yt,encode_range:_r,decode_col:ty,decode_row:ey,split_cell:F$,decode_cell:Ds,decode_range:Iu,format_cell:to,sheet_add_aoa:TI,sheet_add_json:wC,sheet_add_dom:pC,aoa_to_sheet:Cu,json_to_sheet:xq,table_to_sheet:gC,table_to_book:UG,sheet_to_csv:yC,sheet_to_txt:pq,sheet_to_json:Jx,sheet_to_html:$G,sheet_to_formulae:gq,sheet_to_row_object_array:Jx,sheet_get_cell:yf,book_new:py,book_append_sheet:gy,book_set_sheet_visibility:yq,cell_set_number_format:wq,cell_set_hyperlink:bC,cell_set_internal_link:bq,cell_add_comment:_q,sheet_set_array_formula:Sq,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const J_="/assets/subject-icon.png-n4it4i20.png",Re=t=>t==null?"":String(t).trim(),po=(t={})=>{const e={};return Object.keys(t).forEach(r=>{const s=(Array.isArray(t[r])?t[r]:[]).map(Re).filter(Boolean);e[r]=Array.from(new Set(s))}),e};function Tq(){var Sy,Ey,Ty,ky;const t=Am(),e=km(),[r,n]=G.useState("subjects"),[s,a]=G.useState("Professor User"),[i,o]=G.useState(null),c=G.useRef(null),[u,d]=G.useState(!1),[h,m]=G.useState(!1),[p,y]=G.useState(!1),[v,b]=G.useState(!1),[E,T]=G.useState(!1),[w,B]=G.useState(null),[J,Z]=G.useState({code:"",name:"",credits:"",term:"first"}),[_,I]=G.useState({name:"",pic:null}),[C,L]=G.useState(!1),[F,V]=G.useState(""),[O,ct]=G.useState(!1),[me,ft]=G.useState([]),[rt,ze]=G.useState([]),[ie,Ye]=G.useState([]),[_e,Q]=G.useState([]),[ae,le]=G.useState({}),[ne,Ae]=G.useState([]),[st,ot]=G.useState({}),[Ne,Ve]=G.useState({}),[ge,W]=G.useState({}),[we,et]=G.useState(null),[ht,Qe]=G.useState(new Date().toISOString().slice(0,10)),[qe,Ft]=G.useState(""),[Mt,Ot]=G.useState("quiz"),[er,jt]=G.useState(""),[lr,Nr]=G.useState(""),[Rr,ls]=G.useState(""),[mn,Dr]=G.useState(!1),[Lr,Bt]=G.useState({}),Qt=G.useRef(null),ir=G.useRef(null),cr=G.useRef(!1),An=G.useRef(0),ta=G.useRef(0),[cs,ja]=G.useState(!1),[Gn,$n]=G.useState(!1),[In,ra]=G.useState(!1),[Fr,Cn]=G.useState(!1),[ks,qn]=G.useState(""),[Da,pn]=G.useState(null),[ue,ni]=G.useState(null),[ut,Vs]=G.useState(""),[si,io]=G.useState(!1),[hr,gn]=G.useState({id:"",name:"",email:"",subjects:[]}),[R,X]=G.useState(""),[z,K]=G.useState("all"),[Y,ee]=G.useState("name"),[Ee,De]=G.useState("asc"),[xe,be]=G.useState(1),[Te]=G.useState(12),[We,at]=G.useState([]),[wt,nt]=G.useState(""),[pt,Ut]=G.useState(!1),[sr,ur]=G.useState({id:"",name:"",email:""}),[kr,Ur]=G.useState("import"),[ve,Le]=G.useState([]),[Ke,Je]=G.useState([]),[Se,Pe]=G.useState(!1),[Ie,de]=G.useState([]),[Fe,xt]=G.useState(!1),[He,Oe]=G.useState([]),[Be,it]=G.useState(!1),[$t,zt]=G.useState(null),[Dt,Tt]=G.useState(""),[dr,jr]=G.useState(!1),[Qr,Un]=G.useState(""),[Nn,Me]=G.useState("all"),[$e,Zt]=G.useState(null),[Wt,or]=G.useState([]),[kt,vt]=G.useState([]),[Hr,Gr]=G.useState(!1),[Di,Rn]=G.useState(0),[As,Bs]=G.useState("professor"),[Rt,xa]=G.useState(""),[Nu,oo]=G.useState(null),[Or,ul]=G.useState(null),[cc,Fa]=G.useState(null),[op,Ru]=G.useState([]),[bt,ai]=G.useState(null),[lo,Wf]=G.useState(""),[nn,uc]=G.useState(null),[Hf,Pu]=G.useState(null),[dl,ii]=G.useState("account"),[co,fl]=G.useState(()=>{try{return localStorage.getItem("disableRealtimeUpdates")==="true"}catch{return!1}}),[hl,Gf]=G.useState({});G.useRef({});const[qf,Is]=G.useState(!1),[cn,zs]=G.useState(null),[Kn,La]=G.useState("delete"),[Ws,na]=G.useState("active"),[oi,ju]=G.useState(""),[Du,dc]=G.useState(!1),[ml,Qn]=G.useState(!1),fc=G.useRef(null),hc=G.useRef(null),[Oa,f]=G.useState(!1),[x,S]=G.useState(!1),[H,he]=G.useState(null),[Ce,mt]=G.useState(null),[tr,Vr]=G.useState(!1),vr=G.useMemo(()=>{const g={};return _e.forEach(k=>{const N=Re(k.id);N&&(g[N]=k)}),g},[_e]),Xr=G.useMemo(()=>new Set(ve.map(Re).filter(Boolean)),[ve]),yr=G.useCallback(g=>{le(typeof g=="function"?k=>po(g(k)):po(g))},[le]),li=G.useCallback(g=>{const k=me.find(N=>N.code===g);return k?`${k.code}  ${k.name}`:g},[me]);G.useCallback((g,k)=>{if(!g)return;const j=(P=>{if(!P)return null;let D=me.find(U=>U.code===P);return D||(D=me.find(U=>{var M;return((M=U.code)==null?void 0:M.toLowerCase())===P.toLowerCase()}),D)?D:(D=me.find(U=>{var M;return((M=U.code)==null?void 0:M.includes(P))||P.includes(U.code)}),D||null)})(g);if(j){B(j),(k==="attendance"||k==="grades"||k==="students"||k==="subjects")&&n(k),y(!1);try{const P=new URLSearchParams(e.search);P.set("tab",k),P.set("subjectId",j.code),t({pathname:e.pathname,search:P.toString()})}catch{}}},[me,t,e.pathname,e.search]),G.useEffect(()=>{(async()=>{var k;if(!(!bt||!nn))try{const N=await ag("professors",bt);if(((k=N==null?void 0:N.preferences)==null?void 0:k.disableRealtimeUpdates)!==void 0){const j=N.preferences.disableRealtimeUpdates,P=localStorage.getItem("disableRealtimeUpdates")==="true";j!==P&&(j?localStorage.setItem("disableRealtimeUpdates","true"):localStorage.removeItem("disableRealtimeUpdates"),fl(j))}else if(localStorage.getItem("disableRealtimeUpdates")==="true"){fl(!0);try{const P=await Yn(bt);await Ns("professors",bt,{...P,preferences:{...(P==null?void 0:P.preferences)||{},disableRealtimeUpdates:!0}},{merge:!0})}catch(P){console.warn("Could not sync preference to Firestore:",P.message)}}}catch(N){console.warn("Could not load real-time preference from Firestore, using localStorage:",N.message);const j=localStorage.getItem("disableRealtimeUpdates")==="true";fl(j)}})()},[bt,nn]),G.useEffect(()=>{if(!bt||me.length===0)return;const g=localStorage.getItem("lastQuotaError");if(g&&Date.now()-parseInt(g)<36e5){console.log(" Skipping course creation checks - quota exceeded recently");return}let k=!1;const N=async()=>{var D;const P={};for(const U of me){const M=U==null?void 0:U.code;if(!(!M||hl[M]||P[M]))try{const q=`firestore_backup_courses_${M}`,ce=localStorage.getItem(q);let se=null;if(ce)try{const re=JSON.parse(ce).data;re&&re.code===M&&(se={id:M,...re})}catch{}if(se||(se=await Cs(M)),!se){let te=await Yn(bt);if(!te||!te.id){console.error(" Professor profile not found when creating course");continue}const re=parseInt(U.credits)||0;se={id:await gc({code:U.code,name:U.name,credits:re,professorId:te.id})}}P[M]=se.id}catch(q){if(q.code==="resource-exhausted"||(D=q.message)!=null&&D.includes("quota")){console.warn(" Quota exceeded - stopping course creation checks"),localStorage.setItem("lastQuotaError",Date.now().toString());break}console.warn("Failed to resolve course for subject",M,q)}}!k&&Object.keys(P).length>0&&Gf(U=>({...U,...P}))};return sessionStorage.getItem("coursesEnsured")||(N(),sessionStorage.setItem("coursesEnsured","true")),()=>{k=!0}},[bt]);const{isDarkMode:A,toggleTheme:ci}=Im(),xn="professorDashboards",Fu=G.useCallback(g=>{const k=sessionStorage.getItem("currentUser");if(k)try{const j={...JSON.parse(k),...g};sessionStorage.setItem("currentUser",JSON.stringify(j))}catch(N){console.warn("Unable to update currentUser session data",N)}},[]),ui=G.useCallback(async(g,k)=>{if(!g)return console.warn("Cannot build enrolls: professor MySQL ID not available"),{enrolls:{},enrolledStudentIds:[]};try{console.log(" Building enrolls from MySQL enrollments...");const N=await o9(g);console.log(` Found ${N.length} courses for professor`);const j={},P=new Set;for(const D of N){const U=await Bb(D.id),M=[];for(const q of U){const ce=q.student_number||q.student_id;if(ce){const se=Re(ce);M.push(se),P.add(se)}}M.length>0&&(j[D.code]=M)}return console.log(" Built enrolls from MySQL:",{coursesProcessed:N.length,enrollsKeys:Object.keys(j).length,totalEnrollments:Object.values(j).reduce((D,U)=>D+U.length,0),uniqueEnrolledStudents:P.size}),{enrolls:po(j),enrolledStudentIds:Array.from(P)}}catch(N){return console.error(" Error building enrolls from MySQL:",N),{enrolls:{},enrolledStudentIds:[]}}},[]),Lu=G.useCallback(async g=>{var k,N;if(!g)return console.warn("loadData called without UID"),!1;Vr(!0);try{const j=await ag(xn,g);if(j){console.log(" Dashboard data loaded from Firestore:",{subjects:(j.subjects||[]).length,students:(j.students||[]).length,enrolls:Object.keys(j.enrolls||{}).length,alerts:(j.alerts||[]).length,records:Object.keys(j.records||{}).length,grades:Object.keys(j.grades||{}).length,enrollsDetails:Object.keys(j.enrolls||{}).map(je=>({subject:je,studentCount:(j.enrolls[je]||[]).length,studentIds:j.enrolls[je]})),allStudentIds:(j.students||[]).map(je=>je.id)});const P=_9(j),D=JSON.stringify(j)!==JSON.stringify(P);D&&(console.log("Migrating legacy student IDs to numerical IDs..."),await Ns(xn,g,{...P,ownerUid:g,updatedAt:new Date().toISOString()},{forceWrite:!0}),console.log("Migration complete - data saved with numerical IDs"));const U=(P.students||[]).map(je=>({...je,archivedSubjects:Array.isArray(je.archivedSubjects)?je.archivedSubjects:[]})),M=U.filter(je=>Array.isArray(je.archivedSubjects)&&je.archivedSubjects.length>0);M.length>0&&console.log(" Found students with archived subjects:",{count:M.length,students:M.map(je=>({id:je.id,name:je.name,archivedSubjects:je.archivedSubjects}))});const q=po(P.enrolls||{}),ce={};Object.keys(q).forEach(je=>{const _t=(q[je]||[]).map(Re).filter(Boolean);ce[je]=_t.filter(St=>{const tt=U.find(Yr=>Re(Yr.id)===St);if(!tt)return console.warn(` Enrollment found for student ID ${St} in subject ${je}, but student not found in students array. Keeping enrollment.`,{enrolledId:St,subjectCode:je,totalStudents:U.length,studentIds:U.map(Yr=>Re(Yr.id))}),!0;const Pt=(tt.archivedSubjects||[]).includes(je);return Pt&&console.log(` Filtering out archived student ${tt.name} (${tt.id}) from ${je}`),!Pt})});const se=po(P.enrolls||{}),te=JSON.stringify(se)!==JSON.stringify(ce);if(te){console.warn(" Data inconsistency detected: Archived students found in enrolls. Cleaning and saving...");try{await Ns(xn,g,{...P,enrolls:ce,ownerUid:g,updatedAt:new Date().toISOString()},{forceWrite:!0}),console.log(" Cleaned enrolls data saved to Firestore (full document write)")}catch(je){console.error("Failed to save cleaned enrolls:",je)}}let re={},fe=[];try{const je=await Yn(g);if(je&&je.id){console.log(" Building enrolls from MySQL (replacing Firestore enrolls)...");const At=await ui(je.id,P.subjects||[]);re=At.enrolls||At,fe=At.enrolledStudentIds||[]}else console.warn(" Professor MySQL ID not found, using empty enrolls")}catch(je){console.error(" Failed to build enrolls from MySQL, using Firestore enrolls as fallback:",je),re=po(ce),fe=[]}if(fe.length>0){const je=new Set(U.map(_t=>Re(_t.id))),At=fe.filter(_t=>!je.has(_t));if(At.length>0){console.log(` Loading ${At.length} missing students from MySQL...`);try{const St=(await $b()).filter(tt=>{const Pt=Re(tt.student_id||tt.studentId||tt.id);return At.includes(Pt)});if(St.length>0){console.log(` Found ${St.length} missing students in MySQL, adding to students array`);const tt=St.map(Pt=>({id:Re(Pt.student_id||Pt.studentId||String(Pt.id)),name:Pt.name||"Unknown Student",email:Pt.email||"",department:Pt.department||"",archivedSubjects:[],photoURL:Pt.photo_url||Pt.photoURL||""}));U.push(...tt),console.log(` Added ${tt.length} missing students. Total students: ${U.length}`)}else console.warn(` Could not find ${At.length} enrolled students in MySQL database. They may need to be created.`)}catch(_t){console.error(" Error loading missing students from MySQL:",_t)}}}const oe=re,pe=new Set;Object.values(oe||{}).forEach(je=>{je.forEach(At=>pe.add(Re(At)))});const ye=new Set(U.map(je=>Re(je.id))),dt=Array.from(pe).filter(je=>!ye.has(je));return dt.length>0?console.warn(" Found enrollments for students not in local students array (may be in MySQL):",{missingStudentIds:dt,totalEnrollments:pe.size,totalStudents:ye.size}):console.log(" Data integrity check passed: All enrolled students exist in students array",{totalEnrollments:pe.size,totalStudents:ye.size,enrollmentsBySubject:Object.keys(oe).map(je=>({subject:je,studentCount:oe[je].length}))}),ft(P.subjects||[]),ze(P.removedSubjects||[]),Ye(P.recycleBinSubjects||[]),Q(U),yr(oe),Ae(P.alerts||[]),Ve(P.records||{}),W(P.grades||{}),ta.current=Date.now(),Rn(je=>je+1),console.log(" Dashboard data loaded from Firestore:",{subjects:(P.subjects||[]).length,students:(P.students||[]).length,enrolls:Object.keys(oe||{}).length,enrollsDetails:Object.keys(oe||{}).map(je=>({subject:je,studentCount:(oe[je]||[]).length,studentIds:oe[je],studentNames:(oe[je]||[]).map(At=>{const _t=U.find(St=>Re(St.id)===At);return _t?_t.name:"Unknown"})})),alerts:(P.alerts||[]).length,records:Object.keys(P.records||{}).length,grades:Object.keys(P.grades||{}).length,updatedAt:P.updatedAt||"N/A",migrated:D,cleaned:te}),Object.keys(oe||{}).forEach(je=>{const At=oe[je]||[],_t=At.filter(St=>{const tt=Re(St);return!U.find(Pt=>Re(Pt.id)===tt)});_t.length>0?(console.warn(` Subject ${je} has ${_t.length} enrolled students not found in students array:`,{missingIds:_t,enrolledIds:At,totalEnrolled:At.length,studentsInSystem:U.map(St=>Re(St.id)),subjectCode:je}),_t.forEach(St=>{const tt=Re(St),Pt=U.filter(Yr=>{const Nt=Re(Yr.id);return Nt.includes(tt)||tt.includes(Nt)});Pt.length>0&&console.warn(`  Found similar student IDs for ${St}:`,Pt.map(Yr=>Yr.id))})):console.log(` Subject ${je}: All ${At.length} enrolled students found in students array`)}),Vr(!1),!0}else{const P=[{code:"CCE106 2061",name:"Application Dev",credits:"3"},{code:"IT 14 2062",name:"Professional Track",credits:"4"},{code:"IT11 2063",name:"Networking II",credits:"5"}],D=[],U={};return ft(P),Q(D),yr(U),Ve({}),W({}),await Ns(xn,g,{subjects:P,students:D,alerts:[],records:{},grades:{},ownerUid:g,updatedAt:new Date().toISOString()}),console.log("Default dashboard data created for new user"),Vr(!1),!0}}catch(j){return console.error("Failed to load professor dashboard data",j),(j.code==="resource-exhausted"||(k=j.message)!=null&&k.includes("quota")||(N=j.message)!=null&&N.includes("Quota"))&&(console.error(" Firestore quota exceeded!"),console.error(" To reduce quota usage, disable real-time updates:"),console.error('   localStorage.setItem("disableRealtimeUpdates", "true")'),console.error(" Or upgrade to Blaze plan for higher limits")),Vr(!1),!1}},[]),_C=G.useCallback(async()=>{if(!bt){console.warn("Cannot refresh: No professor UID available");return}console.log(" Manually refreshing dashboard data...");try{if(await Lu(bt)&&nn&&nn.id){const k=await ui(nn.id,me),N=k.enrolls||k;yr(N),console.log(" Data refreshed successfully"),Rn(j=>j+1)}}catch(g){console.error(" Failed to refresh data:",g),Vr(!1)}},[bt,nn,Lu,ui,me,yr]),Ma=G.useRef(null),uo=G.useRef(null),vn=G.useCallback(async(g,k,N,j,P,D,U=null,M=!1)=>{var se;let q=U||bt;if(!q&&((se=Zn==null?void 0:Zn.currentUser)!=null&&se.uid)&&(q=Zn.currentUser.uid),!q)try{const te=sessionStorage.getItem("currentUser");if(te){const re=JSON.parse(te);q=re==null?void 0:re.uid}}catch(te){console.warn("Could not get UID from sessionStorage",te)}if(!q){const te=new Error("Cannot save data: No UID available");throw console.error(te.message),te}const ce={subjects:g??me,removedSubjects:rt,students:k??_e,alerts:j??ne,records:P??Ne,grades:D??ge,ownerUid:q,updatedAt:new Date().toISOString()};if(uo.current={payload:ce,uidToUse:q},M)return Ma.current&&(clearTimeout(Ma.current),Ma.current=null),await Kf(ce,q);Ma.current&&clearTimeout(Ma.current),Ma.current=setTimeout(async()=>{uo.current&&(await Kf(uo.current.payload,uo.current.uidToUse),uo.current=null),Ma.current=null},1e4)},[me,rt,_e,ae,ne,Ne,ge,bt]),Kf=G.useCallback(async(g,k)=>{var N,j;try{const P={...g},D=await Ns(xn,k,P,{forceWrite:!0});return D?console.log(" Data saved successfully to Firestore:",{subjects:(P.subjects||[]).length,students:(P.students||[]).length,enrolls:Object.keys(P.enrolls||{}).length,enrollsDetails:Object.keys(P.enrolls||{}).map(U=>({subject:U,studentCount:(P.enrolls[U]||[]).length,studentIds:P.enrolls[U]})),alerts:(P.alerts||[]).length,records:Object.keys(P.records||{}).length,grades:Object.keys(P.grades||{}).length,updatedAt:P.updatedAt,dataIntegrity:" All enrolled students exist in students array"}):console.log(" Data saved to localStorage backup (Firestore unavailable):",{subjects:(P.subjects||[]).length,students:(P.students||[]).length,enrolls:Object.keys(P.enrolls||{}).length,enrollsDetails:Object.keys(P.enrolls||{}).map(U=>({subject:U,studentCount:(P.enrolls[U]||[]).length})),alerts:(P.alerts||[]).length,records:Object.keys(P.records||{}).length,grades:Object.keys(P.grades||{}).length,updatedAt:P.updatedAt}),D}catch(P){throw console.error("Failed to save professor dashboard data",P),(P.code==="resource-exhausted"||(N=P.message)!=null&&N.includes("quota")||(j=P.message)!=null&&j.includes("Quota"))&&(console.error(" Firestore quota exceeded! Please check Firebase Console or wait for daily reset."),gt("error","Quota Exceeded","Firestore quota has been exceeded. Data will be saved when quota resets (daily at midnight Pacific Time).",!1)),P}},[]),gt=G.useCallback(async(g,k,N,j=!0)=>{const P={id:Date.now(),type:g||"general",title:k||"Notification",message:N||"",timestamp:new Date,read:!1,target_courseId:null},D=[P,...ne];if(Ae(D),j)try{await vn(me,_e,ae,D,Ne,ge,bt,!0)}catch(U){console.warn("Failed to save notification alert",U)}return P},[ne,me,_e,ae,Ne,ge,bt]),xy=G.useCallback(()=>new Promise(g=>{if(Zn!=null&&Zn.currentUser){g(Zn.currentUser);return}const k=ep(N=>{k(),g(N||null)})}),[]);G.useEffect(()=>{(async()=>{let j=Zn==null?void 0:Zn.currentUser;if(j||(j=await xy()),!j){t("/login",{replace:!0});return}let P=sessionStorage.getItem("currentUser"),D=null;if(P)try{D=JSON.parse(P)}catch(se){console.warn("Unable to parse currentUser session data",se)}(!D||D.uid!==j.uid)&&(D={uid:j.uid,email:j.email||"",name:j.displayName||"Professor User"},sessionStorage.setItem("currentUser",JSON.stringify(D))),ai(j.uid),D.email&&Wf(D.email),D.name&&(a(D.name),I(se=>({...se,name:D.name})));const U=Yn(j.uid).catch(se=>(console.warn("Unable to load professor profile from database",se),null)),M=Lu(j.uid).catch(se=>(console.error("Failed to load professor dashboard data",se),!1));let q=await U;const ce=await M;if(ce){if(console.log("Dashboard data loaded successfully from Firestore on page load/refresh"),q&&q.id)try{const se=me.length>0?me:[],te=await ui(q.id,se),re=te.enrolls||te;Object.keys(re).length>0&&(yr(re),console.log(" Rebuilt enrolls from MySQL after data load"))}catch(se){console.error("Failed to rebuild enrolls after load:",se)}}else ce===!1&&(console.error("Failed to load dashboard data - data may not persist correctly"),setTimeout(async()=>{if(console.log(" Retrying data load..."),await Lu(j.uid)&&(console.log(" Data loaded successfully on retry"),q&&q.id))try{const te=await ui(q.id,me),re=te.enrolls||te;yr(re),console.log(" Rebuilt enrolls from MySQL after retry")}catch(te){console.error("Failed to rebuild enrolls on retry:",te)}},2e3));if(!q)try{const se=D.name||j.displayName||"Professor User",te=Td(se,j.uid),re={name:se,email:D.email||j.email||"",role:"Professor",department:"",photoURL:te};q=await Yc(j.uid,re)||re,console.log(" Auto-created professor profile for current user")}catch(se){console.error(" Failed to auto-create professor profile:",se)}if(q){uc(q),q.email&&Wf(q.email),q.name&&(a(q.name),I(te=>({...te,name:q.name})));const se=q.photoURL||q.photoUrl||q.photo_url||null;if(se&&(o(se),Fa(se)),!q.id){console.warn(" Professor profile missing MySQL ID, reloading...");const te=await Yn(j.uid);te&&te.id&&(uc(te),console.log(" Reloaded professor profile with MySQL ID:",te.id))}}})();const k=()=>{const j=new Date,P=j.getHours(),D=P%12||12,U=P>=12?"PM":"AM",M=j.getMinutes().toString().padStart(2,"0"),q=j.getSeconds().toString().padStart(2,"0");Ft(`${D}:${M}:${q} ${U}`)};k();const N=setInterval(k,1e3);return()=>{clearInterval(N),Qt.current&&(Qt.current(),Qt.current=null)}},[t,Lu,xy]),G.useEffect(()=>{if(!bt)return;if(localStorage.getItem("disableRealtimeUpdates")==="true"){Qt.current&&(Qt.current(),Qt.current=null);return}const k={subjects:me,students:_e,enrolls:ae,alerts:ne,records:Ne,grades:ge};ir.current=k;const N=p9(bt,j=>{if(!j)return;if(cr.current){console.log(" Real-time update skipped during import to prevent overwrite");return}const P=Date.now()-(ta.current||0);if(P<3e3){console.log(" Real-time update skipped: Data just loaded (within 3s)",{timeSinceLoad:Math.round(P/1e3)+"s"});return}const D=Date.now()-(An.current||0);if(D<5e3){console.log(" Real-time update skipped: Recent import detected (within 5s)",{timeSinceImport:Math.round(D/1e3)+"s"});return}if(j.subjects&&ft(j.subjects),j.removedSubjects&&ze(j.removedSubjects),j.students&&Q(j.students),j.alerts){const U=j.alerts.map(M=>{let q=M.timestamp;if(q&&typeof q=="object"&&q.toDate)q=q.toDate();else if(typeof q=="string"){const ce=new Date(q);q=isNaN(ce.getTime())?new Date:ce}else typeof q=="number"?q=q>1e12?new Date(q):new Date(q*1e3):q instanceof Date||(q=new Date);return(!q||isNaN(q.getTime()))&&(q=new Date),{...M,timestamp:q}});Ae(U)}Rn(U=>U+1),ir.current=j});return Qt.current=N,()=>{Qt.current&&(Qt.current(),Qt.current=null)}},[bt,me,_e,ae,ne,Ne,ge,co]),G.useEffect(()=>()=>{uo.current&&Ma.current?(clearTimeout(Ma.current),Kf(uo.current.payload,uo.current.uidToUse).catch(g=>{console.warn("Failed to save pending data on unmount:",g)})):Ma.current&&clearTimeout(Ma.current)},[Kf]),G.useEffect(()=>{const g=k=>{p&&!k.target.closest(".relative")&&y(!1),v&&!k.target.closest(".relative")&&b(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[p,v]),G.useEffect(()=>{oo(null),ul(null)},[As]),G.useEffect(()=>{oo(null)},[Rt]),G.useEffect(()=>{As==="student"&&!Rt&&_e.length>0&&xa(_e[0].id)},[As,_e,Rt]),G.useEffect(()=>{if(As==="student"&&Rt){const g=_y(Rt),N=fp(Rt)[0],j=[{id:`attendance-${Rt}`,title:"Attendance Update",message:`You are currently at ${g.attendanceRate}% attendance. Keep it up!`,timestamp:new Date,read:!1},{id:`grade-${Rt}`,title:"Grade Highlight",message:g.averageGrade==="0"?"Grades will appear here once assessments are recorded.":`Your overall average grade is ${g.averageGrade}%.`,timestamp:new Date,read:!1},N?{id:`subject-${N.code}`,title:`${N.name}`,message:`Target grade ${N.targetGrade||90}%  Attendance ${rN(Rt,N.code).rate}%`,timestamp:new Date,read:!1}:null].filter(Boolean);Ru(j)}else As!=="student"&&Ru([])},[As,Rt,me,ae,Ne,ge]),G.useEffect(()=>{u?(I({name:s,pic:null,removePhoto:!1}),Fa(i),c.current=i):(c.current!==null&&i===null&&!C&&(o(c.current),Fa(c.current)),c.current=null)},[u,s,i,C]),G.useEffect(()=>{try{const g=new URLSearchParams(e.search),k=g.get("tab"),N=g.get("subjectId");if((k==="attendance"||k==="grades"||k==="students"||k==="subjects")&&n(k),N&&me.length>0){const P=(D=>{if(!D)return null;let U=me.find(M=>M.code===D);return U||(U=me.find(M=>{var q;return((q=M.code)==null?void 0:q.toLowerCase())===D.toLowerCase()}),U)?U:(U=me.find(M=>{var q;return((q=M.code)==null?void 0:q.includes(D))||D.includes(M.code)}),U||null)})(N);P&&B(P)}}catch{}},[e.search,me]),G.useEffect(()=>{if(e.pathname!=="/prof")return;const g=k=>{const N=sessionStorage.getItem("currentUser");window.location.pathname==="/login"&&N?(k.preventDefault(),window.history.pushState(null,"","/prof"),t("/prof",{replace:!0})):window.history.pushState(null,"",window.location.href)};return window.history.pushState(null,"",window.location.href),window.addEventListener("popstate",g),()=>{window.removeEventListener("popstate",g)}},[e.pathname,t]),G.useEffect(()=>{const g=k=>{fc.current&&!fc.current.contains(k.target)&&dc(!1),hc.current&&!hc.current.contains(k.target)&&Qn(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]),G.useEffect(()=>{h&&(V(""),ct(!1))},[h]),G.useEffect(()=>{F&&(J.code||J.name||J.credits)&&V("")},[J.code,J.name,J.credits,J.term]);const SC=async()=>{if(bt)try{await vn(me,_e,ae,ne,Ne,ge,bt),console.log("All data saved successfully before logout")}catch(g){console.error("Failed to save data before logout",g)}sessionStorage.removeItem("currentUser"),t("/login",{replace:!0})},EC=()=>{ja(!0)},TC=()=>{ja(!1)},[mc,vy]=G.useState({});G.useCallback(async(g,k)=>{const N=`${g}-${k}`;if(mc[N])return mc[N];try{let j=null;if(g&&/^\d+$/.test(String(g))&&(j=await ms(g)),!j&&k&&(j=await Oc(k)),j&&(j.photoURL||j.photo_url)){const P=j.photoURL||j.photo_url;return vy(D=>({...D,[N]:P})),P}}catch(j){console.warn(`Failed to fetch profile image for student ${g}:`,j)}return null},[mc]);const lp=({student:g,className:k="w-10 h-10"})=>{var se;const[N,j]=G.useState(null),[P,D]=G.useState(!1),U=G.useRef(!1),M=G.useRef(null),q=G.useRef(null);G.useEffect(()=>{const te=g?`${g.id}-${g.email}`:null;if(!g||te===M.current)return;M.current=te,U.current=!1,D(!1),j(null),q.current=null;const re=`${g.id}-${g.email}`;if(mc[re]){j(mc[re]),q.current=mc[re];return}if(U.current)return;U.current=!0,(async()=>{try{let oe=null;if(g.id&&/^\d+$/.test(String(g.id))&&(oe=await ms(g.id)),!oe&&g.email&&(oe=await Oc(g.email)),oe&&(oe.photoURL||oe.photo_url)){const pe=oe.photoURL||oe.photo_url;vy(ye=>({...ye,[re]:pe})),j(pe),q.current=pe}else D(!0)}catch(oe){console.warn(`Failed to fetch profile image for student ${g.id}:`,oe),D(!0)}finally{U.current=!1}})()},[g==null?void 0:g.id,g==null?void 0:g.email]);const ce=((se=g==null?void 0:g.name)==null?void 0:se.split(" ").map(te=>te[0]).join("").slice(0,2).toUpperCase())||"??";return!N||P?l.jsx("div",{className:`${k} bg-gradient-to-r from-red-800 to-red-600 rounded-full flex items-center justify-center flex-shrink-0`,children:l.jsx("span",{className:"text-white font-semibold text-sm",children:ce})}):l.jsx("div",{className:`${k} rounded-full flex items-center justify-center overflow-hidden flex-shrink-0 border-2 border-white shadow-md`,children:l.jsx("img",{src:N,alt:(g==null?void 0:g.name)||"Student",className:"w-full h-full object-cover",onError:()=>{D(!0)}})})},cp=g=>!g||g==="TBA"?"PU":g.split(/\s+/).filter(Boolean).map(k=>k[0]).slice(0,2).join("").toUpperCase(),yy=g=>{if(g){console.log("Profile picture selected:",{name:g.name,size:g.size,type:g.type}),I(N=>{const j={...N,pic:g};return console.log("Updated profileForm with pic:",{hasPic:!!j.pic,picType:typeof j.pic}),j});const k=new FileReader;k.onload=N=>{Fa(N.target.result),console.log("Profile preview updated")},k.onerror=N=>{console.error("Error reading file:",N)},k.readAsDataURL(g)}else console.log("Profile picture cleared"),I(k=>({...k,pic:null})),Fa(i)},kC=()=>{console.log("Removing profile picture");const g=document.getElementById("profile-picture");g&&(g.value=""),I(k=>({...k,pic:null,removePhoto:!0})),Fa(null),o(null),console.log("Profile picture removed - avatar updated immediately")},AC=async g=>{if(g.preventDefault(),V(""),!J.code||!J.name||!J.credits){V("Please fill in all fields");return}if(me.find(N=>N.code===J.code&&N.name===J.name)){V("A subject with this code and name already exists. Please use a different code or name.");return}ct(!0);try{const N=[...me,{...J,createdAt:new Date().toISOString()}],j={...ae,[J.code]:[]};ft(N),yr(j);const D=[{id:Date.now(),type:"general",title:"Subject Added",message:`${J.name} (${J.code}) has been added successfully`,timestamp:new Date,read:!1},...ne];Ae(D),await vn(N,_e,j,D,Ne,ge,bt),Z({code:"",name:"",credits:"",term:"first"}),V(""),ct(!1),n("subjects"),T(!1),B(null),m(!1)}catch(N){console.error("Failed to save subject to Firestore",N),V("Failed to save subject. Please try again."),ct(!1)}},Qf=async(g,k,N)=>{N&&N.stopPropagation();try{if(!me.find(M=>M.code===g)){gt("error","Subject Not Found","Subject not found. Please refresh and try again.",!1);return}const P=me.map(M=>M.code===g?{...M,term:k}:M);ft(P);try{const M=await Cs(g);M&&M.id?(await l9(M.id,{term:k}),console.log(` Updated course term in MySQL: ${g}  ${k}`)):console.warn(` Course not found in MySQL for ${g}, term not updated in database`)}catch(M){console.error(" Failed to update course term in MySQL:",M)}await vn(P,_e,ae,ne,Ne,ge,bt);const D=ae[g]||[];if(D.length>0){console.log(` Syncing term update to ${D.length} enrolled students for subject ${g}`);const M=D.map(async q=>{try{const ce=Re(q),se=_e.find(fe=>Re(fe.id)===ce);if(!se||!se.email){console.warn(` Student ${ce} not found or missing email, skipping sync`);return}const te=await xc(se.id,se.email);let re=null;if(te.verified&&te.uid)re=te.uid;else{const fe=await qu(se.id,se.email);fe&&typeof fe=="string"&&(re=fe)}if(re&&typeof re=="string"){const fe=await Li(re),pe=((fe==null?void 0:fe.subjects)||[]).map(ye=>ye.code===g?{...ye,term:k}:ye);await va(re,pe),console.log(` Synced term update to student ${se.name} (${se.id})`)}else console.warn(` Could not find Firebase UID for student ${se.id}, term will sync when student logs in`)}catch(ce){console.error(` Failed to sync term update to student ${q}:`,ce)}});Promise.all(M).then(()=>{console.log(` Completed syncing term updates to ${D.length} students`)}).catch(q=>{console.error("Some term syncs failed:",q)})}const U={id:Date.now(),type:"general",title:"Term Updated",message:`Subject term has been updated to ${k==="first"?"1st Term":"2nd Term"}. ${D.length>0?`Syncing to ${D.length} enrolled student(s)...`:""}`,timestamp:new Date,read:!1};Ae(M=>[U,...M])}catch(j){console.error("Failed to update subject term",j),gt("error","Update Failed","Failed to update subject term. Please try again.",!1)}},IC=g=>{Je(k=>k.includes(g)?k.filter(N=>N!==g):[...k,g])},CC=g=>{gn(k=>{const N=k.subjects||[];return N.includes(g)?{...k,subjects:N.filter(j=>j!==g)}:{...k,subjects:[...N,g]}})},NC=async(g,k)=>{k.stopPropagation();const N=me.find(j=>j.code===g);N&&(zs(N),La("archive"),Is(!0))},RC=async g=>{const k=rt.find(P=>P.code===g);if(!k)return;const N=rt.filter(P=>P.code!==g),j=[...me,k];ft(j),ze(N);try{if(nn&&nn.id){const P=await ui(nn.id,j),D=P.enrolls||P;console.log(" Rebuilt enrollments from MySQL after restoring subject:",D),yr(D);const U={subjects:j,removedSubjects:N,students:_e,enrolls:D,alerts:ne,records:Ne,grades:ge,ownerUid:bt,updatedAt:new Date().toISOString()};try{await Ns(xn,bt,U,{forceWrite:!0})}catch(M){console.error("Failed to save restored subject",M)}}else{console.warn(" Professor MySQL ID not available; cannot rebuild enrollments from MySQL");const P={subjects:j,removedSubjects:N,students:_e,enrolls:ae,alerts:ne,records:Ne,grades:ge,ownerUid:bt,updatedAt:new Date().toISOString()};try{await Ns(xn,bt,P,{forceWrite:!0})}catch(D){console.error("Failed to save restored subject",D)}}}catch(P){console.error(" Failed to rebuild enrollments from MySQL:",P);const D={subjects:j,removedSubjects:N,students:_e,enrolls:ae,alerts:ne,records:Ne,grades:ge,ownerUid:bt,updatedAt:new Date().toISOString()};try{await Ns(xn,bt,D,{forceWrite:!0})}catch(U){console.error("Failed to save restored subject",U)}}},PC=async g=>{const k=rt.find(N=>N.code===g);k&&(zs(k),La("delete"),Is(!0))},jC=()=>{zs({code:"ALL",name:"All Recycle Bin Subjects",isBulkDelete:!0}),La("permanent"),Is(!0)},DC=()=>{if(He.length===0){gt("warning","No Selection","Please select at least one subject to permanently delete.",!1);return}zs({code:"SELECTED",name:`${He.length} Selected Subject(s)`,isBulkDelete:!0,selectedCodes:He}),La("permanent"),Is(!0)},FC=async()=>{const g=cn;if(!g)return;const k=g.code;try{const U=await Cs(k);if(U&&U.id){const M=await Bb(U.id);console.log(` Deleting ${M.length} enrollments for archived course ${k}`);for(const q of M)try{await j7(q.id)}catch(ce){console.error(`Failed to delete enrollment ${q.id}:`,ce)}console.log(` Deleted all enrollments for course ${k} from MySQL`)}else console.warn(` Course ${k} not found in MySQL; skipping enrollment deletion`)}catch(U){console.error(" Failed to delete enrollments from MySQL:",U)}const N=me.filter(U=>U.code!==k),j=[...rt,g],P={...ae};delete P[k],ft(N),ze(j),yr(P);const D={subjects:N,removedSubjects:j,students:_e,enrolls:P,alerts:ne,records:Ne,grades:ge,ownerUid:bt,updatedAt:new Date().toISOString()};try{await Ns(xn,bt,D,{forceWrite:!0})}catch(U){console.error("Failed to save removed subject",U)}w&&w.code===k&&(T(!1),B(null)),Is(!1),zs(null),La("delete")},LC=async()=>{const g=cn;if(!g)return;if(g.isBulkDelete&&g.code==="ALL"){const U=[...rt];ze([]),Ye(se=>[...se,...U]);const q=[{id:Date.now(),type:"general",title:"Subjects Moved to Recycle Bin",message:`All ${U.length} archived subject(s) have been moved to Recycle Bin.`,timestamp:new Date,read:!1},...ne];Ae(q);const ce={subjects:me,removedSubjects:[],recycleBinSubjects:[...ie,...U],students:_e,enrolls:ae,alerts:q,records:Ne,grades:ge,ownerUid:bt,updatedAt:new Date().toISOString()};try{await Ns(xn,bt,ce,{forceWrite:!0})}catch(se){console.error("Failed to save after moving to recycle bin",se)}Is(!1),zs(null);return}const k=g.code,N=rt.filter(U=>U.code!==k);ze(N),Ye(U=>[...U,g]);const P=[{id:Date.now(),type:"general",title:"Subject Moved to Recycle Bin",message:`${g.name} has been moved to Recycle Bin.`,timestamp:new Date,read:!1},...ne];Ae(P);const D={subjects:me,removedSubjects:N,recycleBinSubjects:[...ie,g],students:_e,enrolls:ae,alerts:P,records:Ne,grades:ge,ownerUid:bt,updatedAt:new Date().toISOString()};try{await Ns(xn,bt,D,{forceWrite:!0})}catch(U){console.error("Failed to save after moving to recycle bin",U)}Is(!1),zs(null),La("delete")},OC=async g=>{const k=ie.find(N=>N.code===g);k&&(zs(k),La("permanent"),Is(!0))},MC=async()=>{const g=cn;if(!g)return;if(g.isBulkDelete){let U=[];g.code==="ALL"?U=[...ie]:g.code==="SELECTED"&&g.selectedCodes?U=ie.filter(te=>g.selectedCodes.includes(te.code)):U=[g];for(const te of U)try{const re=await Cs(te.code);re&&re.id&&(await Hb(re.id),console.log(` Permanently deleted course ${te.code} from MySQL (ID: ${re.id})`))}catch(re){console.error(` Failed to permanently delete course ${te.code} from MySQL:`,re)}const M=ie.filter(te=>!U.some(re=>re.code===te.code));Ye(M),Oe([]),it(!1);const ce=[{id:Date.now(),type:"general",title:"Subjects Permanently Deleted",message:`${U.length} subject(s) have been permanently deleted from Recycle Bin.`,timestamp:new Date,read:!1},...ne];Ae(ce);const se={subjects:me,removedSubjects:rt,recycleBinSubjects:M,students:_e,enrolls:ae,alerts:ce,records:Ne,grades:ge,ownerUid:bt,updatedAt:new Date().toISOString()};try{await Ns(xn,bt,se,{forceWrite:!0})}catch(te){console.error("Failed to save after permanent delete",te)}Is(!1),zs(null);return}const k=g.code;try{const U=await Cs(k);U&&U.id?(await Hb(U.id),console.log(` Permanently deleted course ${k} from MySQL (ID: ${U.id})`)):console.warn(` Course ${k} not found in MySQL; skipping delete`)}catch(U){console.error(" Failed to permanently delete course from MySQL:",U)}const N=ie.filter(U=>U.code!==k);Ye(N);const P=[{id:Date.now(),type:"general",title:"Subject Permanently Deleted",message:`${g.name} has been permanently deleted.`,timestamp:new Date,read:!1},...ne];Ae(P);const D={subjects:me,removedSubjects:rt,recycleBinSubjects:N,students:_e,enrolls:ae,alerts:P,records:Ne,grades:ge,ownerUid:bt,updatedAt:new Date().toISOString()};try{await Ns(xn,bt,D,{forceWrite:!0})}catch(U){console.error("Failed to save after permanent delete",U)}Is(!1),zs(null),La("delete")},$C=async g=>{const k=ie.find(M=>M.code===g);if(!k)return;const N=ie.filter(M=>M.code!==g),j=[...rt,k];Ye(N),ze(j);const D=[{id:Date.now(),type:"general",title:"Subject Restored",message:`${k.name} has been restored to Archived Subjects.`,timestamp:new Date,read:!1},...ne];Ae(D);const U={subjects:me,removedSubjects:j,recycleBinSubjects:N,students:_e,enrolls:ae,alerts:D,records:Ne,grades:ge,ownerUid:bt,updatedAt:new Date().toISOString()};try{await Ns(xn,bt,U,{forceWrite:!0})}catch(M){console.error("Failed to save after restore",M)}},UC=g=>{B(g),T(!0)},up=()=>{T(!1),B(null),et(null),r!=="subjects"&&n("subjects")},VC=()=>{w&&(et(w),n("attendance"),T(!1))},BC=()=>{w&&(et(w),n("grades"),T(!1))},wy=(g,k)=>{if(!we)return;const N=ht,j={...Ne};j[N]||(j[N]={}),j[N][we.code]||(j[N][we.code]={});const P=j[N][we.code][g];P===k?delete j[N][we.code][g]:j[N][we.code][g]=k,Ve(j),vn(me,_e,ae,ne,j,ge,bt,!0).catch(U=>console.warn("Background save failed",U));const D=_e.find(U=>Re(U.id)===Re(g));D&&P!==k&&Promise.resolve().then(async()=>{try{const U=await xc(D.id,D.email);if(U.verified&&U.uid)await qb(U.uid,we.code,N,k,{subjectName:we.name,dateLabel:formattedDate});else{const M=await qu(D.id,D.email);M&&await qb(M,we.code,N,k,{subjectName:we.name,dateLabel:formattedDate})}}catch(U){console.warn("Failed to sync attendance to student dashboard",U)}}).catch(U=>{console.warn("Background sync error:",U)})},zC=g=>{var N,j;return we&&((j=(N=Ne[ht])==null?void 0:N[we.code])==null?void 0:j[g])||null},WC=()=>{var M;if(!we)return{present:0,absent:0,total:0,rate:0};const g=ae[we.code]||[],N=((M=Ne[ht])==null?void 0:M[we.code])||{};let j=0,P=0;g.forEach(q=>{const ce=N[q];ce==="present"?j++:ce==="absent"&&P++});const D=g.length,U=D>0?Math.round(j/D*100):0;return{present:j,absent:P,total:D,rate:U}},HC=()=>{if(!we)return;const g=ht,k=ae[we.code]||[],N={...Ne};N[g]||(N[g]={}),N[g][we.code]||(N[g][we.code]={}),k.forEach(j=>{N[g][we.code][j]="present"}),Ve(N),vn(me,_e,ae,ne,N,ge,bt,!0).then(()=>{const j=new Date(ht).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});lastAutoSaveMessageRef.current=Date.now(),gt("success","Attendance Auto-Saved",`All students marked as present for ${j} and automatically saved.`,!1)}).catch(j=>console.warn("Background save failed",j))},GC=()=>{var j;if(!we)return!1;const g=ae[we.code]||[];if(g.length===0)return!1;const N=((j=Ne[ht])==null?void 0:j[we.code])||{};return g.every(P=>N[P]==="present")},qC=async()=>{var g;console.log(" handleSaveAttendance called");try{if(!we){console.error(" No subject selected"),gt("error","No Subject","Please select a subject first.",!1);return}const k=new Date(ht).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),N=ae[we.code]||[],j=ht,P=((g=Ne[j])==null?void 0:g[we.code])||{};if(Object.keys(P).length===0){console.warn(" No attendance records to save"),mt("No Record, please mark attendance before saving."),setTimeout(()=>mt(null),3e3),gt("warning","No Records","Please mark attendance for at least one student before saving.",!1);return}console.log(" Getting/creating course in MySQL...");let D=await Cs(we.code);if(!D){const ye=await Yn(bt);if(!ye||!ye.id){console.error(" Professor profile not found"),gt("error","Profile Error","Professor profile not found. Please refresh and try again.",!1);return}D={id:await gc({code:we.code,name:we.name,credits:parseInt(we.credits)||0,professorId:ye.id}),code:we.code},console.log(` Created new course in MySQL: ${we.name} (ID: ${D.id})`)}const U=D.id;console.log(` Using Course: ${we.name} (Code: ${we.code}, MySQL ID: ${U})`);let M=0,q=0;const ce=[],se=N.map(async ye=>{const dt=P[ye];if(dt){const je=_e.find(At=>Re(At.id)===Re(ye));if(je)try{const At=await ms(je.id);if(!At||!At.id){console.warn(`Student ${je.id} not found in MySQL`),q++,ce.push(je.name||je.id);return}const _t=At.id;console.log(` Student: ${je.name} (Numerical ID: ${je.id}, MySQL ID: ${_t})`),console.log(" Saving attendance to MySQL:",{studentId:_t,courseId:U,date:j,status:dt}),await H7(_t,U,j,dt),M++,console.log(` Attendance saved to MySQL for student ${je.id} (MySQL ID: ${_t})`)}catch(At){q++,ce.push(je.name||je.id),console.error(` Failed to save attendance for student ${ye}:`,At)}}});await Promise.all(se);const te=Object.values(P).filter(ye=>ye==="present").length,re=Object.values(P).filter(ye=>ye==="absent").length,fe=te+re;if(M>0&&q===0)mt("Attendance saved!"),setTimeout(()=>mt(null),3e3),gt("success","Attendance Saved",`Attendance records for ${k} saved successfully. ${M} student${M===1?"":"s"} marked (${te} present, ${re} absent).`,!1),console.log(` All attendance saved successfully (${M} student${M===1?"":"s"})`);else if(M>0&&q>0){const ye=`Attendance saved for ${M} student(s), but failed for ${q} student(s): ${ce.join(", ")}. Check console for details.`;console.warn(" Partial save:",ye),gt("warning","Partial Save",ye,!1)}else if(M===0){const ye="No attendance records were saved. Please check that students exist in the system and try again.";console.error(" No attendance saved"),gt("error","No Attendance Saved",ye,!1);return}if(M===0)return;const pe=[{id:Date.now(),type:"attendance",title:"Attendance Saved",message:`Attendance records for ${k} saved successfully. ${M} student${M===1?"":"s"} marked (${te} present, ${re} absent).`,timestamp:new Date,read:!1,target_courseId:we.code,subjectCode:we.code},...ne];Ae(pe),await vn(me,_e,ae,pe,Ne,ge,bt,!0)}catch(k){console.error(" Error in handleSaveAttendance:",k),gt("error","Save Failed",`Unable to save attendance: ${k.message||"An unexpected error occurred"}. Please try again.`,!1)}},KC=()=>{if(!er||!lr){gt("warning","Missing Information","Please enter a title and max points for the assessment.",!1);return}Dr(!0);const g=ae[we==null?void 0:we.code]||[],k={};g.forEach(N=>{k[N]=""}),Bt(k)},QC=()=>{qn(""),Cn(!0)},by=()=>{const g=ks.trim();if(g===""||isNaN(g)||parseFloat(g)<0){gt("warning","Invalid Score","Please enter a valid non-negative number.",!1);return}const k=ae[we==null?void 0:we.code]||[],N={...Lr};k.forEach(j=>{N[j]=g}),Bt(N),Cn(!1),qn("")},dp=()=>{Cn(!1),qn("")},XC=async()=>{console.log(" handleSaveAllGrades called"),S(!0),he("saving");let g=!1;try{if(!we){console.error(" No subject selected"),S(!1),he("error"),gt("error","No Subject","Please select a subject first.",!1),setTimeout(()=>he(null),3e3);return}if(!er||!er.trim()){console.error(" Missing assessment title"),S(!1),he("error"),gt("error","Missing Title","Please enter an assessment title.",!1),setTimeout(()=>he(null),3e3);return}const k=ae[we.code]||[];if(k.length===0){console.warn(" No students enrolled in this subject"),S(!1),he("error"),gt("warning","No Students","No students enrolled in this subject.",!1),setTimeout(()=>he(null),3e3);return}const N=parseFloat(lr);if(isNaN(N)||N<=0){console.error(" Invalid max points:",lr),S(!1),he("error"),gt("error","Invalid Input","Please enter a valid max points value.",!1),setTimeout(()=>he(null),3e3);return}if(!k.some(fe=>{const oe=Lr[fe];return oe!=null&&oe!==""&&!isNaN(parseFloat(oe))})){console.warn(" No scores entered"),S(!1),he("error"),gt("warning","No Scores","Please enter at least one score before saving.",!1),setTimeout(()=>he(null),3e3);return}console.log(" Validation passed");const P={type:Mt,title:er,maxPoints:N,scores:{},dueDate:Rr||null,dateRecorded:new Date().toISOString().split("T")[0],timestamp:new Date().toISOString()};let D=!0;if(k.forEach(fe=>{const oe=parseFloat(Lr[fe]);!isNaN(oe)&&oe<=N&&oe>=0?P.scores[fe]=oe:Lr[fe]!==""&&(D=!1)}),!D){console.error(" Invalid scores detected"),S(!1),he("error"),setTimeout(()=>he(null),3e3);return}const U={...ge};U[we.code]||(U[we.code]={}),U[we.code][Mt]||(U[we.code][Mt]=[]),U[we.code][Mt].push(P),W(U),console.log(" Getting/creating course in MySQL...");let M=await Cs(we.code);if(!M)try{const fe=await Yn(bt);if(!fe||!fe.id){console.error(" Professor profile not found"),S(!1),he("error"),gt("error","Profile Error","Professor profile not found. Please refresh and try again.",!1),setTimeout(()=>he(null),3e3);return}console.log(" Attempting to create course in MySQL..."),console.log(" Course data:",{code:we.code,name:we.name,credits:we.credits,creditsType:typeof we.credits,professorId:fe.id});const oe=parseInt(we.credits)||0,pe={code:we.code,name:we.name,credits:oe,professorId:fe.id};console.log(" Sending course data:",pe),M={id:await gc(pe),code:we.code},console.log(` Created new course in MySQL: ${we.name} (ID: ${M.id})`)}catch(fe){if(console.warn(" Course creation failed, trying to fetch again:",fe.message),M=await Cs(we.code),M)console.log(" Course found after creation attempt failed (likely created by another request)");else{console.error(" Failed to create or find course:",fe),S(!1),he("error");let oe="Failed to create course. ";fe.message&&fe.message.includes("CSRF")?oe+="CSRF token error. Please check your environment configuration or refresh the page.":oe+=fe.message||"Please try again.",gt("error","Course Error",oe,!1),setTimeout(()=>he(null),5e3);return}}const q=M.id;console.log(` Using Course: ${we.name} (Code: ${we.code}, MySQL ID: ${q})`);let ce=0,se=0;const te=[],re=[];console.log(` Starting to save grades for ${k.length} enrolled students`);for(const fe of k){const oe=_e.find(pe=>Re(pe.id)===Re(fe));if(console.log(`Processing student: ${fe}`,{student:oe,hasScore:P.scores[fe]!==void 0}),oe&&P.scores[fe]!==void 0)try{const pe=await ms(oe.id);if(!pe||!pe.id){console.warn(` Student ${oe.id} not found in MySQL`),se++,te.push(oe.name||oe.id),re.push(`${oe.name||oe.id}: Student not found in MySQL.`);continue}const ye=pe.id;console.log(` Student: ${oe.name} (Numerical ID: ${oe.id}, MySQL ID: ${ye})`);const dt={studentId:ye,courseId:q,assessmentType:Mt,assessmentTitle:er,score:P.scores[fe],maxPoints:N,date:new Date().toISOString().split("T")[0]};console.log(" Saving grade to MySQL:",dt),await M7(dt),ce++,console.log(` Grade saved to MySQL for student ${oe.id} (MySQL ID: ${ye})`)}catch(pe){se++,te.push(oe.name||oe.id);const ye=pe.message||pe.toString();re.push(`${oe.name||oe.id}: ${ye}`),console.error(` Failed to save grade for student ${fe}:`,pe),console.error("Error details:",{studentId:oe.id,courseId:q,assessmentType:Mt,assessmentTitle:er,score:P.scores[fe],maxPoints:N,error:pe,errorMessage:pe.message,errorStack:pe.stack})}else console.log(` Skipping student ${fe}: ${oe?"no score entered":"student not found"}`)}if(console.log(` Save summary: ${ce} saved, ${se} failed`),g=ce>0,console.log(` MySQL save result: ${ce} saved, ${se} failed, mysqlSaveSuccessful=${g}`),ce>0&&se===0)console.log(" Setting success status - all grades saved"),he("success"),gt("success","Grades Saved",`All grades saved successfully for ${er} (${ce} student${ce===1?"":"s"})`,!1),console.log(` All grades saved successfully for ${er} (${ce} student${ce===1?"":"s"})`),setTimeout(()=>{he(null)},3e3);else if(ce>0&&se>0){console.log(" Setting success status - partial save (some grades saved)"),he("success");const fe=`Grades saved successfully for ${ce} student${ce===1?"":"s"}.`;console.log(` Grades saved for ${ce} student(s)`),gt("success","Grades Saved",fe,!1),se>0&&console.warn(` Some students had issues: ${te.join(", ")}`),setTimeout(()=>{he(null)},3e3)}else if(ce===0){console.log(" Setting error status - no grades saved"),he("error");const fe=re.length>0?`No grades were saved. Errors: ${re.join("; ")}`:"No grades were saved. Please check that students exist in the system and try again.";console.error(" No grades saved:",re),gt("error","No Grades Saved",fe,!1),setTimeout(()=>{he(null)},5e3),S(!1);return}if(ce===0){S(!1);return}console.log(" MySQL save phase completed successfully, proceeding to non-critical operations");try{const oe=[{id:Date.now(),type:"grade",title:"Grade Posted",message:`Grade Posted: ${er} grades for ${we.name} are now available to ${ce} student${ce===1?"":"s"}.`,timestamp:new Date,read:!1,target_courseId:we.code,subjectCode:we.code},...ne];Ae(oe);try{await vn(me,_e,ae,oe,Ne,U,bt,!0),console.log(" Grades and alerts saved to Firestore")}catch(pe){console.warn(" Failed to save to Firestore (non-critical):",pe)}jt(""),Nr(""),ls(""),Bt({}),Dr(!1)}catch(fe){console.warn(" Non-critical operation failed after successful MySQL save:",fe)}S(!1)}catch(k){if(console.error(" Error in handleSaveAllGrades catch block:",k),console.error("Error details:",{message:k.message,stack:k.stack,mysqlSaveSuccessful:g,savedCount:typeof savedCount<"u"?savedCount:"undefined"}),g)console.warn(" Error occurred after successful MySQL save - keeping success status:",k),console.warn(" This error is non-critical since grades are already saved to MySQL"),S(!1);else{console.log(" MySQL save failed, setting error status"),S(!1),he("error");let N="Unable to save grades. ";k.message?k.message.includes("Network")||k.message.includes("Failed to fetch")?N+="Cannot connect to server. Please ensure the backend server is running.":k.message.includes("401")||k.message.includes("403")?N+="Authentication error. Please refresh the page and try again.":N+=k.message:N+="An unexpected error occurred. Please check the browser console for details.",gt("error","Save Failed",N,!1),setTimeout(()=>{he(null)},5e3)}}},YC=()=>{if(!we){gt("warning","No Subject Selected","Please select a subject to export attendance.",!1);return}const g=ae[we.code]||[];if(g.length===0){gt("info","No Students","No students enrolled in this subject yet.",!1);return}const k=Object.keys(Ne).filter(re=>{var fe;return((fe=Ne[re])==null?void 0:fe[we.code])&&Object.keys(Ne[re][we.code]).length>0}).sort((re,fe)=>new Date(re)-new Date(fe));if(k.length===0){gt("info","No Attendance Records","No attendance records found for this subject.",!1);return}const N=re=>{if(!re)return"";try{let fe=null;if(typeof re=="string"){const oe=re.trim();if(/^\d{4}-\d{2}-\d{2}$/.test(oe)){const[pe,ye,dt]=oe.split("-");fe=new Date(parseInt(pe),parseInt(ye)-1,parseInt(dt))}else if(oe.includes("T")){const pe=oe.split("T")[0].trim();if(/^\d{4}-\d{2}-\d{2}$/.test(pe)){const[ye,dt,je]=pe.split("-");fe=new Date(parseInt(ye),parseInt(dt)-1,parseInt(je))}else fe=new Date(re)}else fe=new Date(re)}else fe=new Date(re);if(fe&&!isNaN(fe.getTime())&&fe.getTime()>0){const oe=String(fe.getMonth()+1).padStart(2,"0"),pe=String(fe.getDate()).padStart(2,"0"),ye=fe.getFullYear();return`${oe}/${pe}/${ye}`}}catch(fe){console.warn("Date formatting error:",fe,re)}return""},P=[["Student ID","Student Name",...k.map(N)]];if(g.forEach(re=>{const fe=_e.find(pe=>Re(pe.id)===Re(re));if(!fe)return;const oe=[re,fe.name];k.forEach(pe=>{var dt,je;const ye=((je=(dt=Ne[pe])==null?void 0:dt[we.code])==null?void 0:je[re])||"";oe.push(ye||"")}),P.push(oe)}),P.length===1){gt("info","No Data","No attendance entries to export yet.",!1);return}const M="\uFEFF"+P.map((re,fe)=>re.map((oe,pe)=>{const ye=String(oe??"").trim();if(/^\d{2}\/\d{2}\/\d{4}$/.test(ye))return ye;if(/^\d{4}-\d{2}-\d{2}$/.test(ye)){const[dt,je,At]=ye.split("-");return`${je}/${At}/${dt}`}return ye.includes(",")||ye.includes('"')||ye.includes(`
`)?`"${ye.replace(/"/g,'""')}"`:ye}).join(",")).join(`
`),q=new Blob([M],{type:"text/csv;charset=utf-8;"}),ce=URL.createObjectURL(q),se=document.createElement("a");se.href=ce;const te=we.code.replace(/[^a-z0-9]/gi,"_");se.download=`attendance_${te}.csv`,document.body.appendChild(se),se.click(),document.body.removeChild(se),URL.revokeObjectURL(ce)},JC=()=>{if(!we){gt("warning","No Subject Selected","Please select a subject to export grades.",!1);return}const g=ge[we.code];if(!g||Object.keys(g).length===0){gt("info","No Grades","No grades recorded for this subject yet.",!1);return}const k=[["Assessment","Type","Date","Student ID","Student Name","Score","Max Points"]],N=se=>{if(!se)return"";try{let te=null;if(typeof se=="string"){const re=se.trim();if(/^\d{4}-\d{2}-\d{2}$/.test(re)){const[fe,oe,pe]=re.split("-");te=new Date(parseInt(fe),parseInt(oe)-1,parseInt(pe))}else if(re.includes("T")){const fe=re.split("T")[0].trim();if(/^\d{4}-\d{2}-\d{2}$/.test(fe)){const[oe,pe,ye]=fe.split("-");te=new Date(parseInt(oe),parseInt(pe)-1,parseInt(ye))}else te=new Date(se)}else te=new Date(se)}else se instanceof Date?te=se:te=new Date(se);if(te&&!isNaN(te.getTime())&&te.getTime()>0){const re=String(te.getMonth()+1).padStart(2,"0"),fe=String(te.getDate()).padStart(2,"0"),oe=te.getFullYear();return`${re}/${fe}/${oe}`}}catch(te){console.warn("Date formatting error:",te,"Input:",se)}return""};if(Object.entries(g).forEach(([se,te])=>{te.forEach(re=>{const fe=re.title||`${se} Assessment`,oe=se.charAt(0).toUpperCase()+se.slice(1);let pe="";if(re.dateRecorded&&(pe=N(re.dateRecorded),pe||console.warn("dateRecorded failed to format:",re.dateRecorded)),!pe&&re.timestamp){const ye=re.timestamp.split("T")[0];pe=N(ye),pe||console.warn("timestamp failed to format:",re.timestamp)}if(!pe&&re.dueDate&&(pe=N(re.dueDate)),!pe&&re.date&&(pe=N(re.date)),!pe){console.error("WARNING: No date found for assessment:",fe,"Using current date as fallback");const ye=new Date,dt=String(ye.getMonth()+1).padStart(2,"0"),je=String(ye.getDate()).padStart(2,"0"),At=ye.getFullYear();pe=`${dt}/${je}/${At}`}(!pe||!/^\d{2}\/\d{2}\/\d{4}$/.test(pe))&&(console.error("ERROR: Date format validation failed for assessment:",fe,"dateValue:",pe),re.dateRecorded&&(pe=N(re.dateRecorded)),(!pe||!/^\d{2}\/\d{2}\/\d{4}$/.test(pe))&&console.error("CRITICAL: Cannot determine date for assessment:",fe,"assessment object:",re)),console.log("Export grade date - Assessment object:",{assessment:fe,fullAssessment:re,dateRecorded:re.dateRecorded,timestamp:re.timestamp,dueDate:re.dueDate,date:re.date,formattedDate:pe,isValidFormat:/^\d{4}-\d{2}-\d{2}$/.test(pe)}),Object.entries(re.scores||{}).forEach(([ye,dt])=>{const je=_e.find(_t=>Re(_t.id)===Re(ye));let At=pe;if(!At||typeof At!="string"||!/^\d{2}\/\d{2}\/\d{4}$/.test(At.trim())){const _t=new Date,St=String(_t.getMonth()+1).padStart(2,"0"),tt=String(_t.getDate()).padStart(2,"0"),Pt=_t.getFullYear();At=`${St}/${tt}/${Pt}`,console.warn("Date value invalid or empty, using current date:",At,"for assessment:",fe,"original dateValue:",pe)}else At=At.trim();if(!/^\d{2}\/\d{2}\/\d{4}$/.test(At)){const _t=new Date,St=String(_t.getMonth()+1).padStart(2,"0"),tt=String(_t.getDate()).padStart(2,"0"),Pt=_t.getFullYear();At=`${St}/${tt}/${Pt}`,console.error("Date format validation failed, forced to current date:",At)}k.push([fe,oe,At,ye,je?je.name:"Unknown Student",dt,re.maxPoints])})})}),k.length===1){gt("info","No Data","No grade entries to export yet.",!1);return}const D="\uFEFF"+k.map((se,te)=>se.map((re,fe)=>{const oe=String(re??"").trim();if(fe===2&&te>0){let pe=oe.trim();if(/^\d{2}\/\d{2}\/\d{4}$/.test(pe))return pe;if(/^\d{4}-\d{2}-\d{2}$/.test(pe)){const[ye,dt,je]=pe.split("-");return`${dt}/${je}/${ye}`}else if(pe)try{const ye=new Date(pe);if(!isNaN(ye.getTime())){const dt=String(ye.getMonth()+1).padStart(2,"0"),je=String(ye.getDate()).padStart(2,"0"),At=ye.getFullYear();return pe=`${dt}/${je}/${At}`,pe}}catch{console.warn("Failed to parse date:",pe)}return console.error("Date column empty or invalid in CSV generation, Row:",te,"Value:",oe),pe||""}return te===0||oe.includes(",")||oe.includes('"')||oe.includes(`
`)?`"${oe.replace(/"/g,'""')}"`:oe}).join(",")).join(`
`),U=new Blob([D],{type:"text/csv;charset=utf-8;"}),M=URL.createObjectURL(U),q=document.createElement("a");q.href=M;const ce=we.code.replace(/[^a-z0-9]/gi,"_");q.download=`grades_${ce}.csv`,document.body.appendChild(q),q.click(),document.body.removeChild(q),URL.revokeObjectURL(M)},ZC=()=>new Date().toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),eN=()=>{const g=new Date().toISOString().slice(0,10),k=new Date;k.setDate(k.getDate()-1);const N=k.toISOString().slice(0,10);return ht===g?"Selected: Today":ht===N?"Selected: Yesterday":`Selected: ${new Date(ht).toLocaleDateString("en-US",{month:"short",day:"numeric"})}`},fp=g=>g?me.filter(k=>(ae[k.code]||[]).includes(g)):[],_y=g=>{const k={examsTaken:0,examsAvailable:0,attendanceRate:0,averageGrade:"0",totalAbsences:0};if(!g)return k;const N=fp(g),j=new Set(N.map(fe=>fe.code));let P=0,D=0,U=0,M=0,q=0,ce=0,se=0;N.forEach(fe=>{const oe=ge[fe.code]||{};Object.values(oe).forEach(pe=>{pe.forEach(ye=>{D++,ye.scores&&ye.scores[g]!==void 0&&(P++,U+=ye.scores[g],M+=ye.maxPoints)})})}),Object.keys(Ne).forEach(fe=>{const oe=Ne[fe]||{};Object.keys(oe).forEach(pe=>{var dt;if(!j.has(pe))return;const ye=(dt=oe[pe])==null?void 0:dt[g];ye&&(q++,ye==="present"&&ce++,ye==="absent"&&se++)})});const te=q>0?Math.round(ce/q*100):0,re=M>0?Math.round(U/M*100):0;return{examsTaken:P,examsAvailable:D,attendanceRate:te,averageGrade:re,totalAbsences:se}},tN=(g,k)=>{const N=ge[k]||{};let j=0,P=0,D=0,U=0;return Object.values(N).forEach(M=>{M.forEach(q=>{P++,q.scores&&q.scores[g]!==void 0&&(j++,D+=q.scores[g],U+=q.maxPoints)})}),{completed:j,total:P,average:U>0?Math.round(D/U*100):"N/A"}},rN=(g,k)=>{let N=0,j=0,P=0;return Object.keys(Ne).forEach(D=>{var M,q;const U=(q=(M=Ne[D])==null?void 0:M[k])==null?void 0:q[g];U&&(j++,U==="present"&&N++,U==="absent"&&P++)}),{present:N,total:j,absent:P,rate:j>0?Math.round(N/j*100):0}},nN=(g,k)=>{const N=ge[k]||{},j=[];return Object.entries(N).forEach(([P,D])=>{D.forEach((U,M)=>{var ce;const q=U.dateRecorded||U.date||U.dueDate||null;j.push({title:U.title||`${P} ${M+1}`,type:P,score:(ce=U.scores)==null?void 0:ce[g],maxPoints:U.maxPoints,date:q})})}),j},sN=(g,k)=>{const N=[];return Object.keys(Ne).sort().forEach(j=>{var D,U;const P=(U=(D=Ne[j])==null?void 0:D[k])==null?void 0:U[g];P&&N.push({date:j,status:P})}),N.sort((j,P)=>new Date(P.date)-new Date(j.date))},aN=g=>{const k=ae[g]||[],N=k.map(M=>{const q=tN(M,g);return q.average==="N/A"?null:parseFloat(q.average)}).filter(M=>M!==null),j=N.length>0?Math.round(N.reduce((M,q)=>M+q,0)/N.length):"0";let P=0,D=0;Object.keys(Ne).forEach(M=>{var ce;const q=((ce=Ne[M])==null?void 0:ce[g])||{};k.forEach(se=>{const te=q[se];te&&(D++,te==="present"&&P++)})});const U=D>0?Math.round(P/D*100):0;return{totalStudents:k.length,averageGrade:j,attendanceRate:U}},iN=()=>rt||[],oN=(g,k)=>{xa(g),oo(k),ul(null),Bs("student"),typeof window<"u"&&window.scrollTo({top:0,behavior:"smooth"})},lN=()=>{Rt&&fp(Rt);const g=_e.find(M=>M.id===Rt);_y(Rt);const k=Nu?me.find(M=>M.code===Nu):null,N=k&&Rt?nN(Rt,k.code):[],j=k&&Rt?sN(Rt,k.code):[],P=Or?me.find(M=>M.code===Or):null,D=P?(ae[P.code]||[]).map(M=>_e.find(q=>q.id===M)).filter(Boolean):[],U=P?aN(P.code):null;return l.jsxs("div",{className:"fadeIn space-y-8",children:[l.jsxs("div",{className:`glass rounded-2xl shadow-xl p-4 sm:p-6 lg:p-8 ${A?"bg-[#1a1a1a]":""}`,children:[l.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-4 sm:mb-6",children:[l.jsxs("div",{children:[l.jsx("h3",{className:`text-lg sm:text-xl font-bold ${A?"text-white":"text-slate-800"}`,children:"Subjects"}),l.jsx("p",{className:`mt-1 ${A?"text-slate-300":"text-slate-600"}`,children:"Browse all subjects and view enrollment details"})]}),P&&l.jsx("button",{onClick:()=>ul(null),className:`text-sm font-semibold transition-colors ${A?"text-red-400 hover:text-red-300":"text-red-500 hover:text-red-700"}`,children:"Close Preview"})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-4",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx("input",{type:"text",placeholder:"Search subjects...",value:R,onChange:M=>{X(M.target.value),be(1)},className:`w-full px-4 py-2 pl-10 rounded-lg border text-sm ${A?"bg-[#2c2c2c] border-slate-600 text-white placeholder-slate-400":"bg-white border-slate-300 text-slate-800 placeholder-slate-400"} focus:outline-none focus:ring-2 focus:ring-[#7A1315] focus:border-transparent`}),l.jsx("i",{className:`fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-sm ${A?"text-slate-400":"text-slate-500"}`})]}),l.jsxs("select",{value:`${Y}-${Ee}`,onChange:M=>{const[q,ce]=M.target.value.split("-");ee(q),De(ce),be(1)},className:`px-4 py-2 rounded-lg border text-sm ${A?"bg-[#2c2c2c] border-slate-600 text-white":"bg-white border-slate-300 text-slate-800"} focus:outline-none focus:ring-2 focus:ring-[#7A1315] focus:border-transparent`,children:[l.jsx("option",{value:"name-asc",children:"Name (A-Z)"}),l.jsx("option",{value:"name-desc",children:"Name (Z-A)"}),l.jsx("option",{value:"code-asc",children:"Code (A-Z)"}),l.jsx("option",{value:"code-desc",children:"Code (Z-A)"}),l.jsx("option",{value:"credits-desc",children:"Credits (High-Low)"}),l.jsx("option",{value:"credits-asc",children:"Credits (Low-High)"}),l.jsx("option",{value:"enrollment-desc",children:"Enrollment (High-Low)"}),l.jsx("option",{value:"enrollment-asc",children:"Enrollment (Low-High)"})]})]}),(()=>{let M=me.filter(re=>{if(!R)return!0;const fe=R.toLowerCase(),oe=(re.name||"").toLowerCase(),pe=(re.code||"").toLowerCase();return oe.includes(fe)||pe.includes(fe)});z!=="all"&&(M=M.filter(re=>z==="first"?!re.term||re.term==="first":z==="second"?re.term==="second":!0)),M.sort((re,fe)=>{var ye,dt;let oe,pe;switch(Y){case"name":oe=(re.name||"").toLowerCase(),pe=(fe.name||"").toLowerCase();break;case"code":oe=(re.code||"").toLowerCase(),pe=(fe.code||"").toLowerCase();break;case"credits":oe=parseInt(re.credits)||0,pe=parseInt(fe.credits)||0;break;case"enrollment":oe=((ye=ae[re.code])==null?void 0:ye.length)||0,pe=((dt=ae[fe.code])==null?void 0:dt.length)||0;break;default:oe=(re.name||"").toLowerCase(),pe=(fe.name||"").toLowerCase()}return Ee==="asc"?oe>pe?1:oe<pe?-1:0:oe<pe?1:oe>pe?-1:0});const q=(xe-1)*Te,ce=q+Te,se=M.slice(q,ce),te=Math.ceil(M.length/Te);return l.jsxs(l.Fragment,{children:[M.length>0&&l.jsxs("div",{className:`text-sm mb-4 ${A?"text-slate-400":"text-slate-600"}`,children:["Showing ",se.length," of ",M.length," subject",M.length!==1?"s":""]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[se.map(re=>{var pe;const fe=((pe=ae[re.code])==null?void 0:pe.length)||0,oe=Or===re.code;return l.jsxs("button",{onClick:()=>ul(re.code),className:`text-left glass card shadowLg p-4 sm:p-6 rounded-2xl transition-all w-full ${A?"bg-[#1a1a1a] border border-slate-700":""} ${oe?"ring-2 ring-maroon-500":"hover:translate-y-[-2px]"}`,children:[l.jsx("div",{className:"flex items-start justify-between gap-3 mb-3",children:l.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[l.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${A?"bg-[#7A1315]/30":"bg-red-100"}`,children:l.jsx("svg",{className:"w-5 h-5 text-[#7A1315]",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})})}),l.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("h4",{className:`text-lg font-bold truncate ${A?"text-[#7A1315]":"text-slate-800"}`,children:re.name}),l.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",onClick:ye=>ye.stopPropagation(),children:[l.jsx("button",{onClick:ye=>Qf(re.code,"first",ye),className:`px-2 py-0.5 rounded-md text-xs font-semibold transition-all ${!re.term||re.term==="first"?A?"bg-blue-600 text-white shadow-sm":"bg-blue-500 text-white shadow-sm":A?"bg-slate-700 text-slate-300 hover:bg-slate-600":"bg-slate-200 text-slate-600 hover:bg-slate-300"}`,title:"Click to set as 1st Term",children:"1st"}),l.jsx("button",{onClick:ye=>Qf(re.code,"second",ye),className:`px-2 py-0.5 rounded-md text-xs font-semibold transition-all ${re.term==="second"?A?"bg-purple-600 text-white shadow-sm":"bg-purple-500 text-white shadow-sm":A?"bg-slate-700 text-slate-300 hover:bg-slate-600":"bg-slate-200 text-slate-600 hover:bg-slate-300"}`,title:"Click to set as 2nd Term",children:"2nd"})]})]}),l.jsxs("p",{className:`text-sm ${A?"text-white":"text-slate-500"}`,children:[re.code,"  ",re.credits," Credits"]})]})]})}),l.jsxs("div",{className:`flex items-center gap-1.5 mb-2 ${A?"text-slate-400":"text-slate-500"}`,children:[l.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})}),l.jsxs("span",{className:"text-sm font-medium",children:[fe," ",fe===1?"student":"students"," enrolled"]})]}),l.jsx("p",{className:`text-xs transition-colors ${A?"text-slate-400 hover:text-red-300":"text-slate-400 hover:text-[#7A1315]"}`,children:"Click to view student records"})]},`preview-${re.code}`)}),M.length===0&&l.jsx("div",{className:"col-span-full text-center text-slate-500 py-12",children:R?"No subjects found matching your search.":"No subjects available yet."})]}),te>1&&l.jsxs("div",{className:`flex flex-col sm:flex-row justify-between items-center gap-3 mt-6 pt-6 border-t ${A?"border-slate-700":"border-slate-200"}`,children:[l.jsxs("div",{className:`text-sm ${A?"text-slate-400":"text-slate-600"}`,children:["Page ",xe," of ",te]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>be(re=>Math.max(1,re-1)),disabled:xe===1,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${xe===1?A?"bg-[#2c2c2c] text-slate-600 cursor-not-allowed opacity-50":"bg-slate-100 text-slate-400 cursor-not-allowed opacity-50":A?"bg-[#2c2c2c] text-white border border-slate-600 hover:bg-[#3c3c3c]":"bg-white text-slate-700 border border-slate-300 hover:bg-slate-50"}`,children:[l.jsx("i",{className:"fa-solid fa-chevron-left mr-1"})," Prev"]}),l.jsxs("button",{onClick:()=>be(re=>Math.min(te,re+1)),disabled:xe===te,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${xe===te?A?"bg-[#2c2c2c] text-slate-600 cursor-not-allowed opacity-50":"bg-slate-100 text-slate-400 cursor-not-allowed opacity-50":A?"bg-[#2c2c2c] text-white border border-slate-600 hover:bg-[#3c3c3c]":"bg-white text-slate-700 border border-slate-300 hover:bg-slate-50"}`,children:["Next ",l.jsx("i",{className:"fa-solid fa-chevron-right ml-1"})]})]})]})]})})()]}),P&&l.jsxs("div",{className:`glass rounded-2xl shadow-xl p-4 sm:p-6 lg:p-8 space-y-4 sm:space-y-6 ${A?"bg-[#1a1a1a]":""}`,children:[l.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:`text-xl sm:text-2xl font-bold ${A?"text-[#7A1315]":"textGrad"}`,children:P.name}),l.jsxs("p",{className:`mt-1 ${A?"text-white":"text-slate-600"}`,children:[P.code,"  ",P.credits," Credits"]})]}),l.jsxs("span",{className:`text-sm ${A?"text-white":"text-slate-500"}`,children:[D.length," ",D.length===1?"student":"students"," enrolled"]})]}),U&&l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[l.jsxs("div",{className:`p-4 rounded-2xl border ${A?"border-slate-700 bg-[#1a1a1a]":"border-slate-200 bg-white/80"}`,children:[l.jsx("p",{className:`text-xs uppercase tracking-wide ${A?"text-slate-400":"text-slate-500"}`,children:"Total Students"}),l.jsx("p",{className:`text-3xl font-bold mt-1 ${A?"text-white":"text-slate-800"}`,children:U.totalStudents})]}),l.jsxs("div",{className:`p-4 rounded-2xl border ${A?"border-slate-700 bg-[#1a1a1a]":"border-slate-200 bg-white/80"}`,children:[l.jsx("p",{className:`text-xs uppercase tracking-wide ${A?"text-slate-400":"text-slate-500"}`,children:"Avg Grade"}),l.jsxs("p",{className:`text-3xl font-bold mt-1 ${A?"text-white":"text-amber-600"}`,children:[U.averageGrade,"%"]})]}),l.jsxs("div",{className:`p-4 rounded-2xl border ${A?"border-slate-700 bg-[#1a1a1a]":"border-slate-200 bg-white/80"}`,children:[l.jsx("p",{className:`text-xs uppercase tracking-wide ${A?"text-slate-400":"text-slate-500"}`,children:"Attendance Rate"}),l.jsxs("p",{className:`text-3xl font-bold mt-1 ${A?"text-white":"text-emerald-600"}`,children:[U.attendanceRate,"%"]})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h4",{className:`text-lg font-semibold ${A?"text-white":"text-slate-800"}`,children:"Enrolled Students"}),l.jsxs("div",{className:"relative w-64",children:[l.jsx("input",{type:"text",placeholder:"Search students...",value:Qr,onChange:M=>Un(M.target.value),className:`w-full px-3 py-1.5 text-sm rounded-lg border focus:ring-2 focus:ring-maroon-500 focus:outline-none ${A?"bg-[#1a1a1a] text-white border-slate-600 placeholder-slate-400":"bg-white text-slate-800 border-slate-300 placeholder-slate-400"}`}),l.jsx("svg",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),D.filter(M=>{var te,re;if(Qr.trim()==="")return!0;const q=Qr.toLowerCase().trim(),ce=((te=M.name)==null?void 0:te.toLowerCase().includes(q))||!1,se=((re=M.id)==null?void 0:re.toString().includes(q))||!1;return ce||se}).length>0?l.jsx("div",{className:`divide-y rounded-2xl border overflow-hidden ${A?"divide-slate-700 border-slate-700":"divide-slate-200 border-slate-200"}`,children:D.filter(M=>{var te,re;if(Qr.trim()==="")return!0;const q=Qr.toLowerCase().trim(),ce=((te=M.name)==null?void 0:te.toLowerCase().includes(q))||!1,se=((re=M.id)==null?void 0:re.toString().includes(q))||!1;return ce||se}).map(M=>l.jsxs("div",{className:`flex items-center justify-between px-4 py-3 ${A?"bg-[#1a1a1a]":"bg-white/80"}`,children:[l.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[l.jsx(lp,{student:M,className:"w-10 h-10"}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:`font-semibold truncate ${A?"text-white":"text-slate-800"}`,children:M.name}),l.jsxs("p",{className:`text-xs truncate ${A?"text-slate-400":"text-slate-500"}`,children:["ID: ",M.id]})]})]}),l.jsx("button",{onClick:()=>oN(M.id,P.code),className:`text-sm font-semibold transition-colors flex-shrink-0 ${A?"text-red-400 hover:text-red-300":"text-[#7A1315] hover:text-red-800"}`,children:"View Record"})]},M.id))}):l.jsx("div",{className:`p-4 rounded-xl text-sm text-center ${A?"bg-[#1a1a1a] text-slate-400":"bg-slate-50 text-slate-500"}`,children:Qr.trim()!==""?`No students found matching "${Qr}"`:"No students enrolled yet."})]})]}),Rt&&l.jsx(l.Fragment,{children:k&&l.jsxs("div",{className:`glass rounded-2xl shadow-xl p-4 sm:p-6 lg:p-8 space-y-4 sm:space-y-6 ${A?"bg-[#1a1a1a]":""}`,children:[l.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[l.jsxs("div",{children:[g&&l.jsxs("div",{className:"mb-1",children:[l.jsx("p",{className:`text-sm font-semibold ${A?"text-slate-100":"text-slate-800"}`,children:g.name}),l.jsxs("p",{className:`text-xs ${A?"text-slate-400":"text-slate-500"}`,children:["ID: ",g.id]})]}),l.jsx("h3",{className:`text-xl sm:text-2xl font-bold ${A?"text-[#7A1315]":"textGrad"}`,children:k.name}),l.jsxs("p",{className:`mt-1 ${A?"text-white":"text-slate-600"}`,children:[k.code,"  ",k.credits," Credits"]})]}),l.jsx("button",{onClick:()=>{k&&ul(k.code),oo(null)},className:`text-sm font-semibold transition-colors ${A?"text-red-400 hover:text-red-300":"text-red-500 hover:text-red-700"}`,children:"Close Detail"})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[l.jsxs("div",{children:[l.jsx("h4",{className:`text-lg font-semibold mb-3 ${A?"text-white":"text-slate-800"}`,children:"Assessment Scores"}),N.length>0?l.jsx("div",{className:`overflow-hidden rounded-xl border ${A?"border-slate-700":"border-slate-200"}`,children:l.jsxs("table",{className:"min-w-full text-sm",children:[l.jsx("thead",{className:"uppercase tracking-wide bg-[#7A1315] text-white",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left",children:"Assessment"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Type"}),l.jsx("th",{className:"px-4 py-3 text-right",children:"Score"}),l.jsx("th",{className:"px-4 py-3 text-left",children:"Date Recorded"})]})}),l.jsx("tbody",{children:N.map((M,q)=>l.jsxs("tr",{className:`border-t ${A?q%2===0?"bg-[#1a1a1a]":"bg-[#000000]":""}`,children:[l.jsx("td",{className:`px-4 py-3 font-medium ${A?"text-white":"text-slate-700"}`,children:M.title}),l.jsx("td",{className:`px-4 py-3 capitalize ${A?"text-slate-300":"text-slate-500"}`,children:M.type}),l.jsx("td",{className:`px-4 py-3 text-right ${A?"text-white":"text-slate-700"}`,children:M.score!==void 0?`${M.score}/${M.maxPoints}`:""}),l.jsx("td",{className:`px-4 py-3 ${A?"text-slate-300":"text-slate-500"}`,children:M.date?new Date(M.date).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):""})]},`${M.title}-${q}`))})]})}):l.jsx("div",{className:`p-4 rounded-xl text-sm ${A?"bg-[#1a1a1a] text-slate-400":"bg-slate-50 text-slate-500"}`,children:"No assessments recorded yet for this student."})]}),l.jsxs("div",{children:[l.jsx("h4",{className:`text-lg font-semibold mb-3 ${A?"text-white":"text-slate-800"}`,children:"Attendance History"}),j.length>0?l.jsx("div",{className:"space-y-3 max-h-72 overflow-y-auto",children:j.map(M=>l.jsxs("div",{className:`flex items-center justify-between rounded-xl px-4 py-3 ${A?"bg-[#1a1a1a]":"bg-slate-50"}`,children:[l.jsxs("div",{children:[l.jsx("p",{className:`font-semibold ${A?"text-white":"text-slate-700"}`,children:new Date(M.date).toLocaleDateString("en-US",{month:"long",day:"numeric"})}),l.jsx("p",{className:`text-xs ${A?"text-slate-400":"text-slate-500"}`,children:M.date})]}),l.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${M.status==="present"?A?"bg-emerald-900/50 text-emerald-300":"bg-emerald-100 text-emerald-700":A?"bg-red-900/50 text-red-300":"bg-red-100 text-red-700"}`,children:M.status==="present"?"Present":"Absent"})]},`${M.date}-${M.status}`))}):l.jsx("div",{className:`p-4 rounded-xl text-sm ${A?"bg-[#1a1a1a] text-slate-400":"bg-slate-50 text-slate-500"}`,children:"No attendance records yet for this subject."})]})]})]})})]})},cN=async()=>{if(!hr.id||!hr.name){gt("warning","Missing Information","Please complete Student ID and Name fields.",!1);return}if(!og(hr.id)){gt("error","Invalid Student ID","Student ID must be numerical only (e.g., 141715, 142177). Legacy IDs like S101, S102 are no longer supported.",!1);return}if(/^S\d+$/i.test(hr.id)){gt("error","Invalid Student ID Format","Legacy student ID format (S101, S102, etc.) is no longer supported. Please use numerical IDs only (e.g., 141715, 142177).",!1);return}let g=hr.email;(!g||!/.+@.+\..+/.test(g))&&(g=ig(hr.name,k));const k=Re(hr.id),N=_e.find(te=>Re(te.id)===k);let j,P;if(N){if(N.name.trim().toLowerCase()!==hr.name.trim().toLowerCase()){gt("error","Data Integrity Error",`Student ID ${k} already exists with a different name:

Existing: ${N.name}
New: ${hr.name}

Student ID must be unique. Please verify the Student ID or use the existing student record.`,!1);return}j={...N,id:k,name:hr.name||N.name,email:g||N.email},P=_e.map(te=>Re(te.id)===k?j:te),Q(P)}else j={id:k,name:hr.name,email:g,archivedSubjects:[]},P=[..._e,j],Q(P);const D={...ae};hr.subjects.forEach(te=>{D[te]||(D[te]=[]),D[te].includes(j.id)||(D[te]=[...D[te],j.id])}),yr(D);try{const te=await xc(j.id,j.email);let re=te.verified?te.uid:null;if(!re){const fe=await ms(j.id);re=fe==null?void 0:fe.id}if(re){await Rl(re,{name:j.name,email:g,studentId:j.id,role:"Student"}),console.log(` Student profile created/updated in users collection: ${re}`);for(const oe of hr.subjects){const pe=me.find(je=>je.code===oe);if(!pe)continue;let ye=await Cs(oe);if(!ye){let je=await Yn(bt);if(!je||!je.id){console.error(" Professor profile not found when creating course"),gt("error","Profile Error","Professor profile not found. Please refresh and try again.",!1);continue}const At=parseInt(pe.credits)||0;ye={id:await gc({code:pe.code,name:pe.name,credits:At,professorId:je.id}),...pe},console.log(` Created course: ${pe.name} (${oe})`)}await ad(studentData.id,ye.id)||(await _0(studentData.id,ye.id),console.log(` Created enrollment in MySQL: Student ${j.id} (MySQL ID: ${studentData.id})  Course ${oe}`))}const fe=hr.subjects.map(oe=>me.find(ye=>ye.code===oe)||{code:oe,name:oe});await va(re,fe),console.log(` Legacy sync: Updated student dashboard for ${j.id}`)}else console.warn(` Could not find/create student UID for ${j.id}. Student may need to sign up first.`)}catch(te){console.error(" Error in multi-part write (users + enrollments):",te)}const U=hr.subjects.length,q=N?`${j.name} (${j.id}) has been updated and enrolled in ${U} subject(s)`:`${j.name} (${j.id}) has been registered successfully${U>0?" and enrolled in "+U+" subject(s)":""}`,se=[{id:Date.now(),type:"general",title:"Student Added",message:q,timestamp:new Date,read:!1,studentId:j.id,subjectCodes:[...hr.subjects],target_courseId:hr.subjects[0]||null},...ne];Ae(se),await vn(me,P,D,se,Ne,ge,bt,!0),$n(!1),gn({id:"",name:"",email:"",subjects:[]})},uN=async()=>{var N;if(!ue||Oa)return;const g=We&&We.length>0,k=sr.id.trim()&&sr.name.trim();if(!g&&!k){gt("warning","No Selection","Please select at least one student or create a new student.",!1);return}f(!0);try{let j=[],P=_e;if(g)for(const se of We){const te=_e.find(re=>Re(re.id)===Re(se));te&&j.push(te)}if(k){const se=sr.id.trim(),te=sr.name.trim(),re=sr.email.trim();if(!se||!te){gt("warning","Missing Information","Please select an existing student or enter Student ID and Name to create one.",!1);return}if(!og(se)){gt("error","Invalid Student ID","Student ID must be numerical only (e.g., 141715, 142177). Legacy IDs like S101, S102 are no longer supported.",!1);return}if(/^S\d+$/i.test(se)){gt("error","Invalid Student ID Format","Legacy student ID format (S101, S102, etc.) is no longer supported. Please use numerical IDs only (e.g., 141715, 142177).",!1);return}let fe=re;(!fe||!/.+@.+\..+/.test(fe))&&(fe=ig(te,se));const oe=Re(se),pe=_e.find(dt=>Re(dt.id)===oe);let ye=null;if(pe){if(pe.name.trim().toLowerCase()!==te.trim().toLowerCase()){gt("error","Data Integrity Error",`Student ID ${oe} already exists with a different name:

Existing: ${pe.name}
New: ${te}

Student ID must be unique. Please verify the Student ID or use the existing student record.`,!1),f(!1);return}ye={...pe,id:oe}}else ye={id:oe,name:te,email:fe,archivedSubjects:[]},P=[..._e,ye],Q(P);ye&&j.push(ye)}if(j.length===0){f(!1);return}const D=me.find(se=>se.code===ue);if(!D){f(!1);return}const U=[],M=[],q=[];for(const se of j)try{console.log(` Creating enrollment: Student ${se.id}  Subject ${ue}`);let te=await ms(se.id);if(te){if(!te.firebase_uid||te.firebase_uid.startsWith("temp_")){console.log(" Student exists but Firebase UID not linked, checking by email...");try{const ye=await Oc(se.email);ye&&ye.firebase_uid&&!ye.firebase_uid.startsWith("temp_")&&(console.log(` Linking Firebase UID ${ye.firebase_uid} to MySQL student ${te.id}`),await Rl(ye.firebase_uid,{name:te.name,email:te.email,studentId:te.student_id}),te.firebase_uid=ye.firebase_uid)}catch{console.log("Could not link Firebase UID, student will need to log in first")}}}else{console.log(` Creating new student in MySQL: ${se.name} (ID: ${se.id})`);let ye="temp_"+Date.now();try{const dt=await Oc(se.email);dt&&dt.firebase_uid&&!dt.firebase_uid.startsWith("temp_")&&(ye=dt.firebase_uid,console.log(` Found existing Firebase UID for student: ${ye}`))}catch{console.log("No existing student found by email, using temp UID")}try{const dt=await Mb({studentId:se.id,name:se.name,email:se.email||"",firebase_uid:ye});if(!dt||isNaN(dt))throw new Error(`Failed to create student: Invalid MySQL ID returned (${dt})`);if(te=await ms(se.id),!te)throw new Error(`Student was created but could not be retrieved: ${se.id}`);console.log(` Created student in MySQL: ${se.name} (MySQL ID: ${te.id}, Firebase UID: ${ye})`)}catch(dt){console.error(` Failed to create student ${se.name} (${se.id}) in MySQL:`,dt),M.push({student:se,error:dt.message||"Failed to create student in database"});continue}}if(!te||!te.id){console.error(` Student data is invalid for ${se.name} (${se.id})`),M.push({student:se,error:"Student data is invalid after creation/retrieval"});continue}const re=te.id;console.log(` Student: ${se.name} (Numerical ID: ${se.id}, MySQL ID: ${re}, Firebase UID: ${te.firebase_uid||"not linked"})`);let fe=await Cs(ue);if(!fe){let ye=await Yn(bt);if(!ye||!ye.id){console.warn(" Professor profile not found, attempting to create...");try{const At=s||"Professor User",_t=Td(At,bt);ye=await Yc(bt,{name:At,email:lo||"",role:"Professor",department:"",photoURL:_t}),console.log(" Auto-created professor profile")}catch(At){console.error(" Failed to auto-create professor profile:",At),gt("error","Profile Error","Professor profile not found. Please refresh the page and try again.",!1),M.push({student:se,error:"Professor profile not found"});continue}}if(!ye||!ye.id){console.error(" Professor profile still not found after creation attempt"),gt("error","Profile Error","Professor profile not found. Please refresh and try again.",!1),M.push({student:se,error:"Professor profile not found"});continue}const dt=parseInt(D.credits)||0,je=await gc({code:D.code,name:D.name,credits:dt,professorId:ye.id});fe={id:je,code:D.code,name:D.name},console.log(` Created course in MySQL: ${D.name} (ID: ${je})`)}const oe=fe.id;if(console.log(` Course: ${D.name} (Code: ${D.code}, MySQL ID: ${oe})`),await ad(re,oe)){console.log(` Enrollment already exists: Student ${se.id}  Course ${ue}`),q.push(se);continue}else await _0(re,oe),console.log(` Enrollment created in MySQL: Student ${se.id} (MySQL ID: ${re})  Course ${ue} (MySQL ID: ${oe})`),U.push(se)}catch(te){console.error(` Failed to create enrollment for ${se.name}:`,te),M.push({student:se,error:te.message||"An unexpected error occurred"})}let ce=P;if(U.length>0){const se=await Yn(bt);if(se&&se.id){const te=await ui(se.id,me),re=te.enrolls||te,fe=te.enrolledStudentIds||[];console.log(" Reloading all students from MySQL to update Student Management view...");try{const oe=await $b();console.log(` Fetched ${oe.length} students from MySQL:`,oe.map(Nt=>({id:Nt.student_id||Nt.studentId,name:Nt.name})));const pe=oe.map(Nt=>({id:Re(Nt.student_id||Nt.studentId||String(Nt.id)),name:Nt.name||"Unknown Student",email:Nt.email||"",department:Nt.department||"",archivedSubjects:[],photoURL:Nt.photo_url||Nt.photoURL||""}));console.log(` Formatted ${pe.length} students:`,pe.map(Nt=>({id:Nt.id,name:Nt.name})));const ye=new Map;P.forEach(Nt=>{const Ht=Re(Nt.id);ye.set(Ht,Nt)}),console.log(` Existing students in local state: ${ye.size}`,Array.from(ye.keys()));const dt=new Map;pe.forEach(Nt=>{const Ht=Re(Nt.id),Ar=ye.get(Ht);Ar?dt.set(Ht,{...Nt,archivedSubjects:Ar.archivedSubjects||[]}):dt.set(Ht,Nt)});const je=Array.from(dt.values());console.log(` Merged ${je.length} students (${pe.length} from MySQL, ${P.length} in local state)`),console.log(" Final student IDs:",je.map(Nt=>({id:Nt.id,name:Nt.name}))),ce=je,Q(()=>je),console.log(` Reloaded ${je.length} students from MySQL (was ${P.length})`);const At=new Set;Object.values(re).forEach(Nt=>{Nt.forEach(Ht=>At.add(Re(Ht)))});const _t=new Set(je.map(Nt=>Re(Nt.id))),St=Array.from(At).filter(Nt=>!_t.has(Re(Nt)));if(console.log(" Checking for missing enrolled students:",{totalEnrolledIds:At.size,totalMergedStudents:je.length,missingCount:St.length,missingIds:St}),St.length>0){console.warn(` ${St.length} enrolled students are missing from the merged list:`,St);const Nt=[];for(const Ht of St)try{const Ar=await ms(Ht)||await ms(String(Ht).replace(/^0+/,""));if(Ar){const sa=Re(Ar.student_id||Ar.studentId||Ht);je.some(Xf=>Re(Xf.id)===sa)?console.log(` Student ${sa} already exists with different ID format`):(Nt.push({id:sa,name:Ar.name||"Unknown Student",email:Ar.email||"",department:Ar.department||"",archivedSubjects:[],photoURL:Ar.photo_url||Ar.photoURL||""}),console.log(` Fetched missing student: ${Ar.name} (${sa})`))}else console.warn(` Could not fetch student data for ID: ${Ht}`)}catch(Ar){console.error(` Failed to fetch missing student ${Ht}:`,Ar)}if(Nt.length>0){const Ht=[...je,...Nt];Q(()=>Ht),ce=Ht,console.log(` Added ${Nt.length} missing students. Total: ${Ht.length}`)}else console.warn(" No missing students could be fetched. This may indicate an ID mismatch issue.")}else console.log(` All ${At.size} enrolled students are in the merged list`);yr(re),console.log(` Updated enrolls state with ${Object.keys(re).length} subjects`);const tt=new Set;Object.values(re).forEach(Nt=>{Nt.forEach(Ht=>tt.add(Re(Ht)))});const Pt=new Set(ce.map(Nt=>Re(Nt.id))),Yr=Array.from(tt).filter(Nt=>!Pt.has(Nt));Yr.length>0?(console.error(` FINAL CHECK: ${Yr.length} enrolled students still missing after all attempts:`,Yr),console.error("Enrolled IDs:",Array.from(tt)),console.error("Student IDs:",Array.from(Pt))):console.log(` FINAL CHECK: All ${tt.size} enrolled students are in the students array`),Rn(Nt=>Nt+1)}catch(oe){if(console.error(" Failed to reload students from MySQL:",oe),fe.length>0){console.log(` Loading ${fe.length} enrolled students into local state...`);const pe=[];for(const ye of fe)if(!P.find(je=>Re(je.id)===Re(ye)))try{const je=await ms(ye);je&&(pe.push({id:je.student_id||je.studentId||ye,name:je.name,email:je.email,archivedSubjects:[]}),console.log(` Loaded student: ${je.name} (${ye})`))}catch(je){console.warn(` Could not load student ${ye} from MySQL:`,je)}pe.length>0&&(ce=[...P,...pe],Q(()=>ce),console.log(` Added ${pe.length} new students to local state`))}}yr(re),Rn(oe=>oe+1),console.log(" Rebuilt enrolls from MySQL after enrollment creation and reloaded all students")}}if(U.length>0){const se=new Date().toISOString().slice(0,10),te=[...ne],re=te.findIndex(fe=>(fe.type==="subject"||fe.type==="enrollment")&&fe.summaryDate==se);if(re!==-1){const fe=te[re],pe=(fe.enrolledCount||0)+U.length;te[re]={...fe,enrolledCount:pe,message:`${pe} student${pe===1?"":"s"} have been enrolled today.`,timestamp:new Date,read:!1}}else{const fe={id:Date.now(),type:"subject",title:"Student Enrolled",message:`${U.length} student${U.length===1?"":"s"} ${U.length===1?"has":"have"} been enrolled today.`,timestamp:new Date,read:!1,studentId:((N=U[0])==null?void 0:N.id)||null,subjectCode:null,target_courseId:null,summaryDate:se,enrolledCount:U.length};te.unshift(fe)}Ae(te),await vn(me,ce,null,te,Ne,ge,bt,!0)}if(U.length>0){const se=U.map(te=>`${te.name} (${te.id})`).join(", ");gt("success","Student(s) Enrolled",`${U.length} student${U.length===1?"":"s"} enrolled: ${se}`,!1),console.log(" Verifying enrolled students are in students array..."),console.log(` Final students list has ${ce.length} students`),U.forEach(te=>{const re=Re(te.id);ce.find(oe=>Re(oe.id)===re)?console.log(` Enrolled student ${te.name} (${te.id}) is in final students list`):console.error(` CRITICAL: Enrolled student ${te.name} (${te.id}) is NOT in final students list!`,{enrolledStudentId:re,finalStudentsIds:ce.map(oe=>Re(oe.id)),finalStudentsNames:ce.map(oe=>oe.name)})})}if(q.length>0){const se=q.map(te=>`${te.name} (${te.id})`).join(", ");pn(`${q.length} student${q.length===1?"":"s"} already enrolled in ${ue}: ${se}`)}if(M.length>0){const se=M.map(te=>`${te.student.name} (${te.student.id})`).join(", ");gt("error","Enrollment Failed",`Failed to enroll ${M.length} student${M.length===1?"":"s"}: ${se}`,!1)}U.length>0&&M.length===0&&q.length===0?(ra(!1),at([]),ur({id:"",name:"",email:""}),ni(null),pn(null)):U.length>0&&(at([]),ur({id:"",name:"",email:""}))}catch(j){console.error(" Unexpected error in handleAddStudentToSubject:",j),gt("error","Enrollment Error","An unexpected error occurred while adding the student. Please try again.",!1)}finally{f(!1)}},dN=async(g,k)=>{const N=Re(g),j=_e.find(M=>Re(M.id)===N);if(!j)return;const P=_e.map(M=>{if(Re(M.id)===N){const q=M.archivedSubjects||[];if(!q.includes(k))return{...M,archivedSubjects:[...q,k]}}return M});Q(P);try{const M=await ms(j.id),q=await Cs(k);if(M&&q){await D7(M.id,q.id),console.log(` Deleted enrollment from MySQL: Student ${j.id}  Course ${k}`);const ce=await Yn(bt);if(ce&&ce.id){const se=await ui(ce.id,me),te=se.enrolls||se;yr(te),console.log(" Rebuilt enrolls from MySQL after enrollment deletion")}}else console.warn(" Could not delete enrollment from MySQL - student or course not found")}catch(M){console.error(" Failed to delete enrollment from MySQL:",M)}Promise.resolve().then(async()=>{try{const M=await xc(j.id,j.email);if(M.verified&&M.uid){const q=await Li(M.uid),ce=((q==null?void 0:q.subjects)||[]).filter(se=>se.code!==k);await va(M.uid,ce)}else{const q=await qu(j.id,j.email);if(q){const ce=await Li(q),se=((ce==null?void 0:ce.subjects)||[]).filter(te=>te.code!==k);await va(q,se)}}}catch(M){console.warn("Failed to sync student subject removal",M)}});const U=[{id:Date.now(),type:"general",title:"Student Archived",message:`${j.name} (${j.id}) has been archived from ${k}`,timestamp:new Date,read:!1,studentId:j.id,subjectCode:k,target_courseId:k},...ne];Ae(U),(async()=>{var M,q;try{const ce=P.find(te=>Re(te.id)===N),se=((ce==null?void 0:ce.archivedSubjects)||[]).includes(k);if(!se){console.error(` CRITICAL ERROR: Student ${N} not marked as archived before save!`),gt("error","Archive Failed","Error: Failed to archive student. Please try again.",!1);return}await vn(me,P,null,U,Ne,ge,bt,!0),console.log(` Student ${j.id} archived from ${k} and saved to Firestore`,{studentId:N,subjectCode:k,archivedSubjects:(ce==null?void 0:ce.archivedSubjects)||[],enrollsForSubject:updatedEnrolls[k]||[],enrollsCount:((M=updatedEnrolls[k])==null?void 0:M.length)||0,studentInEnrolls:((q=updatedEnrolls[k])==null?void 0:q.some(te=>Re(te)===N))||!1,verification:{isArchived:se}})}catch(ce){console.error("Failed to save archived student to Firestore:",ce),gt("error","Save Failed","Failed to save archive action. Please try again.",!1)}})()},fN=async(g,k)=>{const N=`${k}-${Re(g)}`;if(!st[N]){ot(j=>({...j,[N]:!0}));try{await dN(g,k)}finally{ot(j=>{const P={...j};return delete P[N],P})}}},hN=async(g,k)=>{const N=Re(g),j=_e.find(q=>Re(q.id)===N);if(!j)return;const P=_e.map(q=>{if(Re(q.id)===N){const ce=(q.archivedSubjects||[]).filter(se=>se!==k);return{...q,archivedSubjects:ce}}return q});Q(P);const D=me.find(q=>q.code===k);if(j&&D)try{const q=await ms(j.id),ce=await Cs(k);if(q&&ce){await ad(q.id,ce.id)||(await _0(q.id,ce.id),console.log(` Created enrollment in MySQL: Student ${j.id}  Course ${k}`));const te=await Yn(bt);if(te&&te.id){const re=await ui(te.id,me),fe=re.enrolls||re;yr(fe),console.log(" Rebuilt enrolls from MySQL after enrollment restoration")}}try{let se={...D,term:D.term||"first"};try{const re=await Cs(k);re&&re.term&&(se={...se,term:re.term},console.log(` Using term from MySQL for ${k}: ${re.term}`))}catch(re){console.warn(" Could not fetch course term from MySQL, using local term:",re)}const te=await xc(j.id,j.email);if(te.verified&&te.uid){const re=await Li(te.uid),fe=(re==null?void 0:re.subjects)||[],oe=fe.findIndex(pe=>pe.code===k);if(oe===-1){const pe=[...fe,se];await va(te.uid,pe)}else{const pe=fe.map((ye,dt)=>dt===oe?{...ye,term:se.term}:ye);await va(te.uid,pe)}}else{const re=await qu(j.id,j.email);if(re){const fe=await Li(re),oe=(fe==null?void 0:fe.subjects)||[],pe=oe.findIndex(ye=>ye.code===k);if(pe===-1){const ye=[...oe,se];await va(re,ye)}else{const ye=oe.map((dt,je)=>je===pe?{...dt,term:se.term}:dt);await va(re,ye)}}}}catch(se){console.warn("Failed to sync student subject restoration",se)}}catch(q){console.error(" Failed to restore enrollment in MySQL:",q)}const M=[{id:Date.now(),type:"general",title:"Student Restored",message:`${j.name} (${j.id}) has been restored to ${(D==null?void 0:D.name)||k}`,timestamp:new Date,read:!1},...ne];Ae(M),await vn(me,P,null,M,Ne,ge,bt)},mN=g=>{const k=g.name.toLowerCase();if(k.endsWith(".xlsx")||k.endsWith(".xls")){const j=new FileReader;j.onload=P=>{try{const D=new Uint8Array(P.target.result),U=Yx(D,{type:"array"}),M=U.SheetNames[0],q=U.Sheets[M],ce=Eq.sheet_to_json(q,{header:1,defval:""});let se=-1,te=0,re=1,fe=2;for(let ye=0;ye<Math.min(5,ce.length);ye++){const dt=ce[ye];if(Array.isArray(dt)){const je=dt.map(tt=>String(tt).toLowerCase().trim()),At=je.findIndex(tt=>tt==="id"||tt==="student id"||tt==="student_id"||tt==="studentid"||tt.includes("id")),_t=je.findIndex(tt=>tt==="name"||tt==="student name"||tt==="student_name"||tt==="studentname"||tt.includes("name")),St=je.findIndex(tt=>tt==="email"||tt==="e-mail"||tt==="student email"||tt==="student_email"||tt.includes("email")||tt.includes("@")||tt.includes("umindanao"));if(At>=0&&_t>=0){if(se=ye,te=At,re=_t,fe=St>=0?St:dt.length>2?2:-1,fe<0||fe>=dt.length)for(let tt=0;tt<dt.length;tt++){const Pt=String(dt[tt]||"").toLowerCase();if(Pt.includes("@")||Pt.includes("email")||Pt.includes("umindanao")){fe=tt,console.log(` Email column detected by content in column ${tt}: "${dt[tt]}"`);break}}console.log(" Found header row:",{row:ye,idColumn:te,nameColumn:re,emailColumn:fe,rowLength:dt.length,allColumns:dt.map((tt,Pt)=>({index:Pt,value:String(tt)}))});break}}}const oe=se>=0?se+1:0,pe=[];for(let ye=oe;ye<ce.length;ye++){const dt=ce[ye];if(!Array.isArray(dt))continue;const je=String(dt[te]||"").trim(),At=String(dt[re]||"").trim();let _t="";if(fe>=0&&dt.length>fe)_t=String(dt[fe]||"").trim(),(_t.startsWith('"')&&_t.endsWith('"')||_t.startsWith("'")&&_t.endsWith("'"))&&(_t=_t.slice(1,-1).trim());else for(let St=0;St<dt.length;St++){const tt=String(dt[St]||"").trim();if(tt.includes("@")&&(tt.includes(".tc@umindanao.edu.ph")||tt.includes("umindanao"))){_t=tt,(_t.startsWith('"')&&_t.endsWith('"')||_t.startsWith("'")&&_t.endsWith("'"))&&(_t=_t.slice(1,-1).trim()),console.log(` Found email in column ${St} (not detected as email column): ${_t}`);break}}_t&&!_t.includes("@")&&(console.warn(` Invalid email format for ${At} (${je}): "${_t}" - treating as empty`),_t=""),!(!je&&!At)&&(je&&At?pe.push({id:je,name:At,email:_t}):console.warn(`Skipping row ${ye+1}: Missing ID or Name`,{id:je,name:At,email:_t}))}if(console.log(" Excel parsing complete:",{totalRows:ce.length,headerRowIndex:se,startRow:oe,parsedCount:pe.length,firstFewParsed:pe.slice(0,3),idColumn:te,nameColumn:re,emailColumn:fe}),pe.length===0){const ye=se>=0?"No student data found after the header row. Please ensure your Excel file has data rows with ID and Name columns.":'Could not find ID and Name columns in your Excel file. Please ensure your file has columns labeled "ID" (or "Student ID") and "Name" (or "Student Name").';gt("warning","No Data Found",ye,!1),console.warn(" Excel parsing result: No data found",{jsonData:ce.slice(0,5),headerRowIndex:se,totalRows:ce.length,firstRow:ce[0],secondRow:ce[1]})}else console.log(` Excel parsed successfully: ${pe.length} students found`,{students:pe,headerRow:se>=0?se:"none (using first row as data)",columns:{id:te,name:re,email:fe}});console.log(" Excel parsing complete - setting preview:",{parsedCount:pe.length,firstFewParsed:pe.slice(0,3)}),or(pe),vt([]),console.log(" csvPreview state updated with Excel data:",pe.length,"students"),pe.length>0&&gt("success","File Parsed",`Successfully parsed ${pe.length} student(s) from Excel file.`,!1)}catch(D){console.error(" Excel parsing error:",D),console.error("Error details:",{errorName:D.name,errorMessage:D.message,errorStack:D.stack,fileName:g.name}),gt("error","File Error",`Failed to parse Excel file: ${D.message}. Please check the console (F12) for more details.`,!1),or([])}},j.onerror=P=>{console.error(" Excel file read error:",P),gt("error","File Error","Failed to read Excel file. Please try again.",!1),or([])},j.readAsArrayBuffer(g)}else{const j=new FileReader;j.onload=P=>{var D,U;try{const q=P.target.result.split(/\r?\n/).filter(St=>St.trim());if(q.length===0){gt("warning","Empty File","The CSV file appears to be empty.",!1),or([]);return}const ce=q[0];let se=",";ce.includes(";")&&ce.split(";").length>ce.split(",").length?se=";":ce.includes("	")&&(se="	");const te=St=>{const tt=[];let Pt="",Yr=!1,Nt=null;for(let Ht=0;Ht<St.length;Ht++){const Ar=St[Ht],sa=St[Ht+1];if((Ar==='"'||Ar==="'")&&!Yr){Yr=!0,Nt=Ar;continue}else if(Ar===Nt&&Yr)if(sa===Nt){Pt+=Ar,Ht++;continue}else{Yr=!1,Nt=null;continue}if(Ar===se&&!Yr){tt.push(Pt.trim()),Pt="";continue}Pt+=Ar}return(Pt.length>0||tt.length>0)&&tt.push(Pt.trim()),tt};let re=0,fe=0,oe=1,pe=2;const ye=te(ce),dt=ye.map(St=>St.toLowerCase().trim()),je=dt.some(St=>St==="id"||St==="student id"||St==="student_id"||St==="studentid"||St.includes("id")),At=dt.some(St=>St==="name"||St==="student name"||St==="student_name"||St==="studentname"||St.includes("name"));if(je&&At){re=1,fe=dt.findIndex(tt=>tt==="id"||tt==="student id"||tt==="student_id"||tt==="studentid"||tt.includes("id")),oe=dt.findIndex(tt=>tt==="name"||tt==="student name"||tt==="student_name"||tt==="studentname"||tt.includes("name"));const St=dt.findIndex(tt=>tt==="email"||tt==="e-mail"||tt==="student email"||tt==="student_email"||tt.includes("email")||tt.includes("@")||tt.includes("umindanao"));if(pe=St>=0?St:ye.length>2?2:-1,pe<0||pe>=ye.length)for(let tt=0;tt<ye.length;tt++){const Pt=ye[tt].toLowerCase();if(Pt.includes("@")||Pt.includes("email")||Pt.includes("umindanao")){pe=tt,console.log(` Email column detected by content in column ${tt}: "${ye[tt]}"`);break}}console.log(" CSV header detected:",{idColumn:fe,nameColumn:oe,emailColumn:pe,headerRow:ye,allColumns:ye.map((tt,Pt)=>({index:Pt,value:tt}))})}const _t=[];for(let St=re;St<q.length;St++){const tt=q[St].trim();if(!tt)continue;const Pt=te(tt);if(St<re+3&&console.log(` Parsing row ${St+1}:`,{rawLine:tt.substring(0,100),parsedValues:Pt,valuesCount:Pt.length,idColumn:fe,nameColumn:oe,emailColumn:pe}),Pt.length>=2){const Yr=((D=Pt[fe])==null?void 0:D.trim())||"",Nt=((U=Pt[oe])==null?void 0:U.trim())||"";let Ht="";if(pe>=0&&Pt.length>pe)Ht=(Pt[pe]||"").trim(),(Ht.startsWith('"')&&Ht.endsWith('"')||Ht.startsWith("'")&&Ht.endsWith("'"))&&(Ht=Ht.slice(1,-1).trim());else for(let Ar=0;Ar<Pt.length;Ar++){const sa=(Pt[Ar]||"").trim();if(sa.includes("@")&&sa.includes(".tc@umindanao.edu.ph")){Ht=sa,(Ht.startsWith('"')&&Ht.endsWith('"')||Ht.startsWith("'")&&Ht.endsWith("'"))&&(Ht=Ht.slice(1,-1).trim()),console.log(` Found email in column ${Ar} (not detected as email column): ${Ht}`);break}}Ht&&!Ht.includes("@")&&(console.warn(` Invalid email format for ${Nt} (${Yr}): "${Ht}" - treating as empty`),Ht=""),Yr&&Nt&&(_t.push({id:Yr,name:Nt,email:Ht}),console.log(` Parsed student: ${Nt} (${Yr}) - Email: ${Ht||"N/A"}`))}else console.warn(` Row ${St+1} has insufficient columns (${Pt.length}):`,Pt)}_t.length===0?(gt("warning","No Data Found","The CSV file appears to be empty or in an unexpected format. Please ensure it has columns: ID, Name, Email",!1),console.warn(" CSV parsing result: No data found",{lines:q.slice(0,5),delimiter:se,startIndex:re,firstLine:q[0],columnPositions:{id:fe,name:oe,email:pe}})):console.log(` CSV parsed successfully: ${_t.length} students found`,{students:_t,columnPositions:{id:fe,name:oe,email:pe},emailsFound:_t.filter(St=>St.email).length,emailsMissing:_t.filter(St=>!St.email).length}),console.log(" CSV parsing complete:",{parsedCount:_t.length,firstFewParsed:_t.slice(0,3),detectedDelimiter:se}),or(_t),console.log(" csvPreview state updated:",_t.length,"students"),_t.length>0&&gt("success","File Parsed",`Successfully parsed ${_t.length} student(s) from CSV file.`,!1)}catch(M){console.error(" CSV parsing error:",M),gt("error","File Error",`Failed to parse CSV file: ${M.message}`,!1),or([])}},j.onerror=P=>{console.error(" File read error:",P),gt("error","File Error","Failed to read CSV file. Please try again.",!1),or([])},j.readAsText(g,"UTF-8")}},pN=async()=>{var sa,hp,Xf,Ay,Iy,Cy,Ny;if(console.log(" Import started:",{csvFile:$e==null?void 0:$e.name,subject:ut,previewCount:Wt.length,previewData:Wt.slice(0,3),subjectsAvailable:me.length}),!$e){console.error(" Import failed: No file selected"),gt("error","Missing File","Please upload a CSV or Excel file.",!1);return}if(!ut){console.error(" Import failed: No subject selected"),gt("error","Missing Subject","Please select a subject to enroll students.",!1);return}if(Wt.length===0){console.error(" Import failed: No preview data",{csvFile:$e.name,csvPreview:Wt}),gt("error","No Data","The file appears to be empty or could not be parsed. Please check the file format and try uploading again.",!1);return}Gr(!0),cr.current=!0,An.current=Date.now();const g=me.find(ke=>ke.code===ut);if(!g){gt("error","Invalid Subject","Selected subject not found.",!1),Gr(!1),cr.current=!1;return}const k=[],N=[],j=new Map;Wt.forEach((ke,Ue)=>{const Xe=Re((ke.id||"").trim());Xe&&(j.has(Xe)?j.get(Xe).push(Ue):j.set(Xe,[Ue]))}),j.forEach((ke,Ue)=>{if(ke.length>1){const Xe=ke.map(Et=>Wt[Et]);N.push({id:Ue,students:Xe,count:ke.length})}});const P=[],D=[],U=new Set((ae[ut]||[]).map(ke=>Re(ke)));if(Wt.forEach(ke=>{const Ue=Re((ke.id||"").trim()),Xe=(ke.email||"").trim().toLowerCase();if(Ue&&U.has(Ue)){const Et=_e.find(yt=>Re(yt.id)===Ue);P.push({id:Ue,name:ke.name||(Et==null?void 0:Et.name)||"Unknown",csvName:ke.name})}if(Xe){const Et=_e.find(yt=>{var Ir;return((Ir=yt.email)==null?void 0:Ir.trim().toLowerCase())===Xe});if(Et){const yt=Re(Et.id);yt&&yt!==Ue&&D.push({csvName:ke.name||"Unknown",csvId:Ue||"Unknown",email:ke.email,existingName:Et.name,existingId:yt})}}}),N.length>0){const ke=N.reduce((yt,Ir)=>yt+Ir.count,0),Ue=N.length,Xe=N.slice(0,3).map(yt=>`ID ${yt.id}: ${yt.students.map(Ir=>Ir.name||"Unknown").join(", ")}`).join("; "),Et=N.length>3?` and ${N.length-3} more`:"";k.push({type:"warning",title:"Duplicate IDs Detected",message:`Found ${Ue} duplicate ID${Ue>1?"s":""} in the file (${ke} total occurrences). Only the first occurrence of each duplicate ID will be enrolled. Duplicates: ${Xe}${Et}`})}if(P.length>0){const ke=P.slice(0,5).map(Xe=>`${Xe.csvName||Xe.name} (${Xe.id})`).join(", "),Ue=P.length>5?` and ${P.length-5} more`:"";k.push({type:"warning",title:"Already Enrolled Students",message:`${P.length} student${P.length>1?"s are":" is"} already enrolled in this subject and will be skipped: ${ke}${Ue}`})}if(D.length>0){const ke=D.slice(0,5).map(Xe=>`${Xe.csvName} (${Xe.csvId})  ${Xe.email} already belongs to ${Xe.existingName} (${Xe.existingId})`).join("; "),Ue=D.length>5?` and ${D.length-5} more`:"";k.push({type:"error",title:"Email & ID Mismatch",message:`${D.length} student${D.length>1?"s":""} have emails that already belong to different IDs. These entries will be skipped. Details: ${ke}${Ue}`})}vt(k);let M=0,q=0;const ce=[],se=new Set;let te=[..._e];const re=JSON.parse(JSON.stringify(ae));Object.keys(re).forEach(ke=>{const Ue=Array.isArray(re[ke])?re[ke]:[];re[ke]=Ue.map(Re).filter(Boolean)}),re[ut]||(re[ut]=[]);const fe=new Map;te.forEach(ke=>{const Ue=(ke.email||"").trim().toLowerCase(),Xe=Re(ke.id);Ue&&Xe&&!fe.has(Ue)&&fe.set(Ue,Xe)}),console.log("Before import:",{currentStudentsCount:_e.length,currentEnrolledInSubject:((sa=ae[ut])==null?void 0:sa.length)||0,csvPreviewCount:Wt.length,duplicatesInFile:N.length,alreadyEnrolled:P.length}),console.log(" Processing CSV students:",{totalInCsv:Wt.length,csvStudents:Wt.map(ke=>({id:ke.id,name:ke.name,email:ke.email||"N/A"}))});for(const ke of Wt)try{const Ue=(ke.id||"").trim(),Xe=(ke.name||"").trim(),Et=(ke.email||"").trim();if(!Ue||!Xe){console.warn(` Skipping invalid row: ID=${Ue}, Name=${Xe}`),ce.push(`Row missing ID or Name: ${Xe||Ue||"Unknown"}`),q++;continue}if(!og(Ue)){ce.push(`${Xe} (${Ue}): Invalid Student ID format`),q++;continue}const yt=Re(Ue);if(se.has(yt)){console.warn(` Duplicate ID in file: ${yt} (${Xe}) - skipping`),ce.push(`${Xe} (${yt}): Duplicate ID in file - already processed`),q++;continue}se.add(yt);const Ir=re[ut]||[];if(Ir.includes(yt)){console.warn(` Student already enrolled: ${yt} (${Xe}) in ${ut} - skipping enrollment`);continue}let rr=Et;!rr||!/.+@.+\..+/.test(rr)?(rr=ig(Xe,yt),console.log(` Generated email for ${Xe} (${yt}): ${rr}`)):console.log(` Using provided email for ${Xe} (${yt}): ${rr}`);const sn=(rr||"").trim().toLowerCase();if(sn){const Hs=fe.get(sn);if(Hs&&Hs!==yt){console.warn(` Duplicate email detected: ${rr} already used by ID ${Hs}. Skipping ${Xe} (${yt}).`),ce.push(`${Xe} (${yt}): Email ${rr} is already used by student ID ${Hs}`),q++;continue}fe.set(sn,yt)}let ar=te.find(Hs=>Re(Hs.id)===yt);const $a=!ar;if(ar){if(console.log(` Found existing student: ${ar.name} (${yt})`),ar.name.trim().toLowerCase()!==Xe.trim().toLowerCase()){ce.push(`${Xe} (${yt}): ID exists with different name: ${ar.name}`),q++;continue}Et&&ar.email!==Et&&(ar={...ar,email:rr},te=te.map(Hs=>Re(Hs.id)===yt?ar:Hs),console.log(` Updated email for existing student ${ar.name}: ${rr}`))}else ar={id:yt,name:Xe,email:rr,archivedSubjects:[]},te.push(ar),console.log(` Created NEW student: ${ar.name} (${yt}) - Email: ${rr}`,{archivedSubjects:ar.archivedSubjects,willNotBeFiltered:!0});const Mu=Array.isArray(ar.archivedSubjects)?ar.archivedSubjects:[];Mu.includes(ut)&&(console.log(` Unarchiving student ${ar.name} (${yt}) from ${ut} - they are being re-enrolled`),ar.archivedSubjects=Mu.filter(Hs=>Hs!==ut),te=te.map(Hs=>Re(Hs.id)===yt?ar:Hs),console.log(` Student ${ar.name} unarchived from ${ut}`,{previousArchived:Mu,newArchived:ar.archivedSubjects})),re[ut]||(re[ut]=[]),re[ut]=[...Ir,yt],M++,console.log(`   ${$a?"Created and enrolled":"Enrolled"} ${ar.name} (${yt}) in ${ut}`)}catch(Ue){const Xe=`${ke.name||"Unknown"} (${ke.id||"Unknown"}): ${Ue.message}`;ce.push(Xe),q++,console.error(" Error processing student:",Xe,Ue)}console.log(" Import processing complete:",{totalProcessed:Wt.length,successCount:M,errorCount:q,newStudentsCreated:te.length-_e.length,totalStudents:te.length,enrolledInSubject:((hp=re[ut])==null?void 0:hp.length)||0,errors:ce.slice(0,5)}),Q(ke=>(console.log("Setting students:",{prevCount:ke.length,newCount:te.length,newStudents:te.filter(Ue=>!ke.find(Xe=>Re(Xe.id)===Re(Ue.id)))}),te)),yr(ke=>{var Xe,Et;const Ue={};return Object.keys(ke).forEach(yt=>{Ue[yt]=[...ke[yt]]}),Object.keys(re).forEach(yt=>{Ue[yt]=[...re[yt]]}),console.log(" Setting enrolls:",{subject:ut,prevEnrolled:((Xe=ke[ut])==null?void 0:Xe.length)||0,newEnrolled:((Et=Ue[ut])==null?void 0:Et.length)||0,newEnrollsForSubject:Ue[ut],allSubjects:Object.keys(Ue),updatedEnrollsKeys:Object.keys(re),studentIds:Ue[ut]}),Ue}),await new Promise(ke=>{requestAnimationFrame(()=>{setTimeout(ke,100)})}),console.log(" State updated - students should now be visible in UI",{studentsCount:te.length,enrolledCount:re[ut].length,enrolledIds:re[ut]}),yr(ke=>{const Ue=ke[ut]||[],Xe=re[ut]||[];if(Ue.length!==Xe.length){console.log(" Forcing enrolls update - state mismatch detected",{current:Ue.length,expected:Xe.length,currentIds:Ue,expectedIds:Xe});const yt={...ke};return yt[ut]=[...Xe],yt}const Et={...ke};return Object.keys(Et).forEach(yt=>{Et[yt]=[...Et[yt]]}),Et});const oe=po(re);console.log(" Saving to Firestore...",{students:te.length,enrolls:Object.keys(oe).length,enrollsForSubject:((Xf=oe[ut])==null?void 0:Xf.length)||0,enrolledIds:oe[ut],enrollsObject:oe,normalized:!0}),yr(ke=>{var Xe;const Ue={...ke};return Object.keys(oe).forEach(Et=>{Ue[Et]=[...oe[Et]]}),console.log(" Pre-save state update with normalized enrolls:",{subject:ut,enrolled:((Xe=Ue[ut])==null?void 0:Xe.length)||0,ids:Ue[ut]||[],allSubjects:Object.keys(Ue)}),Ue}),Q(ke=>{const Ue=[...te];return console.log(" Pre-save students update:",{prev:ke.length,new:Ue.length}),Ue}),Rn(ke=>ke+1);const pe=new Set;Object.values(oe||{}).forEach(ke=>{ke.forEach(Ue=>pe.add(Re(Ue)))});const ye=new Set(te.map(ke=>Re(ke.id))),dt=Array.from(pe).filter(ke=>!ye.has(ke));if(dt.length>0){console.error(" CRITICAL: Cannot save - enrollments reference students that don't exist:",{missingStudentIds:dt,totalEnrollments:pe.size,totalStudents:ye.size}),gt("error","Data Error",`Cannot save: ${dt.length} enrolled students not found in students list. Please try importing again.`,!1),Gr(!1),cr.current=!1;return}const je=[];Object.keys(oe||{}).forEach(ke=>{(oe[ke]||[]).forEach(Xe=>{const Et=te.find(yt=>Re(yt.id)===Re(Xe));Et&&(Array.isArray(Et.archivedSubjects)?Et.archivedSubjects:[]).includes(ke)&&je.push({studentId:Et.id,studentName:Et.name,subjectCode:ke})})}),je.length>0&&(console.error(" CRITICAL: Found enrolled students that are archived for their subjects:",je),console.log(" Fixing archived issues by unarchiving students..."),je.forEach(ke=>{const Ue=te.find(Xe=>Re(Xe.id)===Re(ke.studentId));Ue&&(Ue.archivedSubjects=(Ue.archivedSubjects||[]).filter(Xe=>Xe!==ke.subjectCode),console.log(` Unarchived ${Ue.name} from ${ke.subjectCode}`))}),te=te.map(ke=>je.find(Xe=>Re(Xe.studentId)===Re(ke.id))&&te.find(Et=>Re(Et.id)===Re(ke.id))||ke),console.log(" All archived issues fixed")),console.log(" Saving to Firestore with complete data:",{students:te.length,newStudents:te.length-_e.length,existingStudents:_e.length,enrolls:Object.keys(oe).length,enrollsForSubject:((Ay=oe[ut])==null?void 0:Ay.length)||0,enrolledIds:oe[ut],enrolledStudentNames:((Iy=oe[ut])==null?void 0:Iy.map(ke=>{const Ue=te.find(Xe=>Re(Xe.id)===ke);return Ue?Ue.name:"Unknown"}))||[],dataIntegrity:" All enrolled students exist in students array",willPersist:!0});const _t=[{id:Date.now(),type:"subject",title:"Students Imported",message:`Successfully imported ${M} student${M===1?"":"s"} to ${g.name}.`,timestamp:new Date,read:!1,target_courseId:ut,subjectCode:ut},...ne];Ae(_t),console.log(" Creating MySQL enrollments for imported students...");let St=0,tt=0;try{let ke=await Cs(ut);if(!ke){const Ue=await Yn(bt);if(!Ue||!Ue.id)console.error(" Professor profile not found for MySQL enrollment");else{const Xe=parseInt(g.credits)||0,Et=await gc({code:g.code,name:g.name,credits:Xe,professorId:Ue.id});ke={id:Et,code:g.code,name:g.name},console.log(` Created course in MySQL: ${g.name} (ID: ${Et})`)}}if(ke&&ke.id){const Ue=ke.id,Xe=oe[ut]||[];for(const Et of Xe)try{const yt=te.find(ar=>Re(ar.id)===Re(Et));if(!yt){console.warn(` Student ${Et} not found in updated list`);continue}let Ir=await ms(yt.id);if(!Ir){console.log(` Creating new student in MySQL: ${yt.name} (ID: ${yt.id})`);const ar=await Mb({studentId:yt.id,name:yt.name,email:yt.email,firebase_uid:"temp_"+Date.now()});Ir={id:ar,student_id:yt.id,name:yt.name,email:yt.email},console.log(` Created student in MySQL: ${yt.name} (MySQL ID: ${ar})`)}const rr=Ir.id;await ad(rr,Ue)?(St++,console.log(` MySQL enrollment already exists: Student ${yt.id}  Course ${ut}`)):(await _0(rr,Ue),St++,console.log(` MySQL enrollment created: Student ${yt.id} (MySQL ID: ${rr})  Course ${ut} (MySQL ID: ${Ue})`))}catch(yt){tt++,console.error(` Failed to create MySQL enrollment for student ${Et}:`,yt)}console.log(` MySQL enrollment creation complete: ${St} succeeded, ${tt} failed`)}else console.warn(" Could not get/create course in MySQL - enrollments not created")}catch(ke){console.error(" Error creating MySQL enrollments:",ke)}let Pt={};try{const ke=await Yn(bt);if(ke&&ke.id){const Ue=await ui(ke.id,me);Pt=Ue.enrolls||Ue,yr(Pt),console.log(" Rebuilt enrolls from MySQL after CSV import")}}catch(ke){console.error(" Failed to rebuild enrolls from MySQL after import:",ke),Pt=oe,yr(Pt)}await vn(me,te,null,_t,Ne,ge,bt,!0)?console.log(" Save operation completed successfully"):(console.error(" CRITICAL: Save operation returned false - data may not have been saved!"),gt("error","Save Failed","Failed to save students to Firestore. Data may not persist after refresh. Please try again.",!1)),console.log(` Imported ${M} students to ${g.name}`,{subject:ut,studentsAdded:M,newStudentsCreated:te.length-_e.length,totalStudents:te.length,enrolledInSubject:((Cy=Pt[ut])==null?void 0:Cy.length)||0,enrolledStudentIds:Pt[ut]||[],enrollsFromMySQL:Object.keys(Pt).length}),Q(ke=>{const Ue=[...te];return ke.length!==Ue.length&&console.log(" Post-save students update:",{prev:ke.length,new:Ue.length}),Ue}),Rn(ke=>ke+1),setTimeout(()=>Rn(ke=>ke+1),100),setTimeout(()=>Rn(ke=>ke+1),300),console.log(" Waiting 2 seconds for Firestore to propagate..."),await new Promise(ke=>setTimeout(ke,2e3)),console.log(" Import complete - real-time listener re-enabled after 2s delay"),await new Promise(ke=>setTimeout(ke,1e3));try{const ke=await ag(xn,bt);if(ke&&ke.enrolls){const Ue=po(ke.enrolls),Xe=Ue[ut]||[],Et=ke.students||[],yt=new Set(Et.map(rr=>Re(rr.id))),Ir=Xe.filter(rr=>!yt.has(Re(rr)));console.log(" Verification - Data read back from Firestore:",{subject:ut,savedEnrollsCount:Xe.length,expectedCount:oe[ut].length,savedEnrolls:Xe,expectedEnrolls:oe[ut],savedStudentsCount:Et.length,expectedStudentsCount:te.length,match:JSON.stringify(Xe.sort())===JSON.stringify(oe[ut].sort()),missingEnrolledStudents:Ir.length>0?Ir:"None"}),Ir.length>0&&console.error(" CRITICAL: Saved enrollments reference students that don't exist in saved students:",{missingStudentIds:Ir,savedEnrolls:Xe,savedStudentIds:Array.from(yt)}),console.log(" Updating state with verified Firestore data"),yr(rr=>{const sn={};return Object.keys(Ue||{}).forEach(ar=>{sn[ar]=[...Ue[ar]||[]]}),Object.keys(rr).forEach(ar=>{sn[ar]||(sn[ar]=[...rr[ar]])}),sn[ut]=[...Xe],console.log(" State updated with Firestore data:",{subject:ut,enrolled:sn[ut].length,ids:sn[ut],allSubjects:Object.keys(sn),allEnrollments:Object.keys(sn).map(ar=>({subject:ar,count:sn[ar].length}))}),sn}),Q(rr=>{const sn=rr.map($a=>Re($a.id)).sort().join(","),ar=Et.map($a=>Re($a.id)).sort().join(",");return(Et.length!==rr.length||sn!==ar)&&console.log(" Updating students with Firestore data:",{prev:rr.length,saved:Et.length,prevIds:rr.map($a=>Re($a.id)),savedIds:Et.map($a=>Re($a.id)),newStudents:Et.filter($a=>!rr.find(Mu=>Re(Mu.id)===Re($a.id)))}),Et}),Rn(rr=>rr+1),console.log(" State synchronized with Firestore - UI should now show students"),console.log(" Final persistence check:",{studentsSaved:Et.length,enrollmentsSaved:Xe.length,subject:ut,willPersist:Et.length>0&&Xe.length>0,message:Et.length>0&&Xe.length>0?" Data is saved and will persist on reload":" Warning: Some data may not persist",savedStudentIds:Et.map(rr=>Re(rr.id)),savedEnrollmentIds:Xe})}else{console.warn(" No enrolls data found in saved Firestore data"),Rn(Ue=>Ue+1),console.error(" CRITICAL: Saved data verification failed - no enrolls found"),console.log(" Attempting to re-save data to ensure persistence...");try{await vn(me,te,oe,ne,Ne,ge,bt,!0),console.log(" Re-save completed - data should now persist")}catch(Ue){console.error(" Re-save failed:",Ue)}}}catch(ke){console.warn("Could not verify saved data:",ke),Rn(Ue=>Ue+1)}setTimeout(()=>{yr(ke=>{const Ue=ke[ut]||[],Xe=oe[ut]||[];if(console.log(" Verifying state after save:",{currentEnrolled:Ue.length,expectedEnrolled:Xe.length,currentIds:Ue,expectedIds:Xe}),Ue.length!==Xe.length||JSON.stringify(Ue.sort())!==JSON.stringify(Xe.sort())){console.warn(" State mismatch detected - forcing update...",{current:Ue.length,expected:Xe.length,currentIds:Ue,expectedIds:Xe});const Et={...ke};return Et[ut]=[...Xe],Et}return ke}),Q(ke=>ke.length!==te.length?(console.warn(" Students count mismatch - forcing update...",{current:ke.length,expected:te.length}),te):ke)},500);let Nt={...g,term:g.term||"first"};try{const ke=await Cs(ut);ke&&ke.term&&(Nt={...Nt,term:ke.term},console.log(` Using term from MySQL for ${ut}: ${ke.term}`))}catch(ke){console.warn(" Could not fetch course term from MySQL, using local term:",ke)}const Ht=te.filter(ke=>{var Ue;return(Ue=oe[ut])==null?void 0:Ue.includes(Re(ke.id))}).map(async ke=>{try{const Ue=await xc(ke.id,ke.email);if(Ue.verified&&Ue.uid){const Xe=await Li(Ue.uid),Et=(Xe==null?void 0:Xe.subjects)||[],yt=Et.findIndex(Ir=>Ir.code===ut);if(yt===-1){const Ir=[...Et,Nt];await va(Ue.uid,Ir)}else{const Ir=Et.map((rr,sn)=>sn===yt?{...rr,term:Nt.term}:rr);await va(Ue.uid,Ir)}}else{const Xe=await qu(ke.id,ke.email);if(Xe){const Et=await Li(Xe),yt=(Et==null?void 0:Et.subjects)||[],Ir=yt.findIndex(rr=>rr.code===ut);if(Ir===-1){const rr=[...yt,Nt];await va(Xe,rr)}else{const rr=yt.map((sn,ar)=>ar===Ir?{...sn,term:Nt.term}:sn);await va(Xe,rr)}}}}catch(Ue){console.warn(`Failed to sync student ${ke.id} to Firestore:`,Ue)}});Promise.all(Ht).catch(ke=>{console.warn("Some student syncs failed:",ke)}),Gr(!1),Rn(ke=>ke+1),console.log(" UI refresh triggered");const Ar=3;for(let ke=0;ke<Ar;ke++)setTimeout(()=>{yr(Ue=>{const Xe=Ue[ut]||[],Et=oe[ut]||[];console.log(` Final force update ${ke+1}/${Ar}:`,{current:Xe.length,expected:Et.length,currentIds:Xe,expectedIds:Et,match:JSON.stringify(Xe.sort())===JSON.stringify(Et.sort())});const yt={...Ue};return Object.keys(yt).forEach(Ir=>{yt[Ir]=[...yt[Ir]||[]]}),yt[ut]=[...Et],yt}),Q(Ue=>{const Xe=[...te];return Ue.length!==Xe.length&&console.log(` Final force update ${ke+1}/${Ar} - students:`,{current:Ue.length,expected:Xe.length}),Xe})},(ke+1)*500);M>0?(vt(ke=>[...ke,{type:"success",title:"Import Complete",message:`Successfully imported ${M} student(s) to ${g.name}.${q>0?` ${q} error(s) occurred.`:""}`,summary:!0}]),console.log(` Import complete: ${M} students imported to ${g.name}`,{subject:ut,studentsAdded:M,totalStudents:te.length,enrolledInSubject:re[ut].length,enrolledStudentIds:re[ut],errors:q,studentsList:_e.length,enrollsForSubject:((Ny=ae[ut])==null?void 0:Ny.length)||0}),setTimeout(()=>{var ke;console.log(" Current UI state check:",{studentsInState:_e.length,enrollsInState:((ke=ae[ut])==null?void 0:ke.length)||0,enrollsArray:ae[ut]||[]})},500)):vt(ke=>[...ke,{type:"error",title:"Import Failed",message:`No students were imported. ${q>0?`${q} error(s) occurred.`:"Please check the file format."}`,summary:!0}]),q>0&&ce.length>0&&(console.warn("Import errors:",ce),ce.slice(0,5).forEach(ke=>console.warn("  -",ke)),ce.length>5&&console.warn(`  ... and ${ce.length-5} more errors`)),setTimeout(()=>{$n(!1),Zt(null),or([]),Vs("");const ke=document.getElementById("csvFileInput");ke&&(ke.value="")},M>0?1500:0)},gN=async g=>{var j,P;if(g.preventDefault(),g.stopPropagation(),console.log("Profile save initiated",{hasPic:!!_.pic,picType:typeof _.pic,name:_.name,profName:s}),C){console.log("Profile save already in progress, ignoring submission");return}if(!bt){gt("error","Authentication Error","Unable to determine your account. Please sign in again.",!1);return}const k=(((j=_.name)==null?void 0:j.trim())||s||"").trim();if(!k){gt("warning","Missing Name","Please enter your name.",!1);return}if(k.length<2){gt("warning","Invalid Name","Name must be at least 2 characters long.",!1);return}if(k.length>100){gt("warning","Invalid Name","Name must be less than 100 characters.",!1);return}let N=i;if(_.removePhoto||cc===null&&i&&!_.pic)console.log("Profile picture will be removed"),N=null;else if(_.pic){const D=_.pic;if(!D||!(D instanceof File)){console.error("Invalid file object:",D),gt("error","Invalid File","Please select a valid image file.",!1);return}if(!D.type||!D.type.startsWith("image/")){gt("error","Invalid File Type","Please select a valid image file.",!1);return}const U=5*1024*1024;if(D.size>U){gt("error","File Too Large","Image file size must be less than 5MB. Please choose a smaller image.",!1);return}try{console.log("Processing profile picture file:",{name:D.name,size:D.size,type:D.type}),N=await xN(D),console.log("Profile picture processed successfully, data length:",N==null?void 0:N.length)}catch(M){console.error("Failed to process image file",M),gt("error","Image Processing Error","Unable to process the selected image. Please try a different file.",!1);return}}else console.log(N===null?"Profile picture removed by user":"No new profile picture selected, keeping current photo");try{console.log("Starting profile save...",{profUid:bt,updatedName:k,hasPhoto:!!N,photoDataLength:N==null?void 0:N.length});const D={...nn||{},name:k,email:lo||(nn==null?void 0:nn.email)||"",department:(nn==null?void 0:nn.department)||"",photoUrl:N||null,photoURL:N||null};console.log("Profile data to save:",{name:D.name,email:D.email,department:D.department,hasPhoto:!!D.photoUrl,photoLength:(P=D.photoUrl)==null?void 0:P.substring(0,100)}),console.log("Calling setProfessor with profile:",{uid:bt,name:D.name,email:D.email,hasPhoto:!!D.photoURL});const U=await Yc(bt,D);if(console.log("Profile saved successfully:",U),!U)throw new Error("setProfessor returned null or undefined");a(k),o(N||null),uc(U),Fa(N||null),Fu({name:k}),L(!0),setTimeout(()=>{d(!1),L(!1),I({name:k,pic:null,removePhoto:!1}),Fa(N||null),c.current=null},300)}catch(D){console.error("Failed to save professor profile",D),console.error("Error details:",{message:D.message,stack:D.stack,response:D.response,data:D.data}),gt("error","Save Failed",`Unable to save profile changes: ${D.message||"Unknown error"}. Please try again.`,!1),L(!1)}},xN=g=>new Promise((k,N)=>{if(g.size>100*1024||g.type==="image/png"){console.log("Compressing image:",{originalSize:g.size,name:g.name});const P=document.createElement("canvas"),D=P.getContext("2d"),U=new Image;U.onload=()=>{let q=U.width,ce=U.height,se=400;q>ce&&q>se?(ce=ce/q*se,q=se):ce>se&&(q=q/ce*se,ce=se),P.width=q,P.height=ce,D.drawImage(U,0,0,q,ce);let te=g.type==="image/png"?.5:.6,re=P.toDataURL("image/jpeg",te);const fe=[.5,.4,.3,.2];for(const oe of fe)if(re.length>3e5)te=oe,re=P.toDataURL("image/jpeg",te);else break;re.length>3e5&&(se=300,q>ce?(ce=ce/q*se,q=se):(q=q/ce*se,ce=se),P.width=q,P.height=ce,D.drawImage(U,0,0,q,ce),re=P.toDataURL("image/jpeg",.5)),re.length>3e5&&(se=200,q>ce?(ce=ce/q*se,q=se):(q=q/ce*se,ce=se),P.width=q,P.height=ce,D.drawImage(U,0,0,q,ce),re=P.toDataURL("image/jpeg",.4)),console.log("Image compressed:",{originalSize:g.size,compressedSize:re.length,finalQuality:te,finalDimensions:`${q}x${ce}`,underLimit:re.length<=3e5}),re.length>3e5&&console.warn("Image still too large after compression:",re.length),k(re)},U.onerror=q=>{console.error("Error loading image for compression:",q),N(q)};const M=new FileReader;M.onload=q=>{U.src=q.target.result},M.onerror=N,M.readAsDataURL(g)}else{const P=new FileReader;P.onload=D=>{const U=D.target.result;if(console.log("Image small enough, using as-is:",{fileSize:g.size,dataUrlSize:U.length}),g.type==="image/png"||U.length>3e5){console.log("Base64 data too large, compressing anyway");const M=new Image;M.onload=()=>{const q=document.createElement("canvas"),ce=q.getContext("2d");let se=M.width,te=M.height;const re=400;se>te&&se>re?(te=te/se*re,se=re):te>re&&(se=se/te*re,te=re),q.width=se,q.height=te,ce.drawImage(M,0,0,se,te);const fe=q.toDataURL("image/jpeg",.5);console.log("Compressed small file:",{original:U.length,compressed:fe.length}),k(fe)},M.onerror=N,M.src=U}else k(U)},P.onerror=N,P.readAsDataURL(g)}}),vN=G.useCallback(g=>{const k=[],N=[];return g.forEach(j=>{const P=j.title||"",D=j.message||"";j.type,P.includes("Student Archived")||P.includes("Successfully restored")||P.includes("Archive")||P.includes("Restore")||D.includes("archived")||D.includes("restored")?N.push(j):k.push(j)}),{academic:k,administrative:N}},[]),yN=G.useCallback(g=>{if(g.length===0)return null;const k=g.filter(U=>U.title.includes("Student Archived")||U.message.includes("archived")).length,N=g.filter(U=>U.title.includes("Successfully restored")||U.message.includes("restored")).length,j=g.length,P=g.reduce((U,M)=>{let q=M.timestamp;q&&typeof q=="object"&&q.toDate?q=q.toDate():typeof q=="string"?q=new Date(q):typeof q=="number"?q=q>1e12?new Date(q):new Date(q*1e3):q instanceof Date||(q=new Date);const ce=q instanceof Date?q.getTime():new Date().getTime();return ce>U&&!isNaN(ce)&&ce>0?ce:U},0),D=P>0?new Date(P):new Date;return{id:"admin-summary",type:"administrative",title:"Administrative Update",message:`${k>0?`${k} student(s) archived`:""}${k>0&&N>0?", ":""}${N>0?`${N} student(s) restored`:""}`,timestamp:D,read:g.every(U=>U.read),count:j,originalNotifications:g}},[]),wN=G.useCallback(g=>{const k=g.title||"",N=g.message||"",j=g.type||"",P=N.match(/([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)\s*\((\d+)\)/),D=N.match(/([A-Z]{2,}\d{3}|[A-Z]+\s+\d+)/),U=N.match(/submitted\s+([^f]+?)\s+for/i)||N.match(/\[([^\]]+)\]/),M=g.subjectCode||(D==null?void 0:D[1])||null,q=g.type==="subject"||g.type==="enrollment"||k.includes("Enrolled");return{studentName:P?P[1]:null,studentId:P?P[2]:null,courseCode:g.target_courseId||g.subjectCode||M,assignmentName:U?U[1]:null,isGradeRelated:j==="grade"||k.includes("Grade")||N.includes("submitted")||N.includes("grading"),isAttendanceRelated:j==="attendance"||k.includes("Attendance")||N.includes("absent"),isEnrollmentRelated:q,isContentRelated:k.includes("Material")||k.includes("Content")||N.includes("posted"),isDiscussionRelated:N.includes("discussion")||N.includes("replies")}},[]);G.useCallback((g,k)=>k.isGradeRelated?l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}):k.isAttendanceRelated?l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}):k.isEnrollmentRelated?l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422A12.083 12.083 0 0112 21.5a12.083 12.083 0 01-6.16-10.922L12 14z"})}):k.isContentRelated?l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}):k.isDiscussionRelated?l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}):l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),[]),G.useCallback((g,k)=>k?"text-slate-600 bg-slate-100 border-2 border-slate-200":g.isGradeRelated?"text-red-700 bg-red-100 border-2 border-red-300":g.isAttendanceRelated?"text-red-600 bg-red-50 border-2 border-red-200":g.isContentRelated?"text-rose-700 bg-rose-100 border-2 border-rose-300":g.isDiscussionRelated?"text-red-800 bg-red-100 border-2 border-red-400":"text-[#7A1315] bg-red-50 border-2 border-red-200",[]),G.useCallback((g,k,N)=>k?N?"border-l-4 border-slate-300":"border-l-4 border-slate-400":g.isGradeRelated?N?"border-l-4 border-red-300":"border-l-4 border-red-600":g.isAttendanceRelated?N?"border-l-4 border-red-200":"border-l-4 border-red-500":g.isContentRelated?N?"border-l-4 border-rose-300":"border-l-4 border-rose-600":g.isDiscussionRelated?N?"border-l-4 border-red-400":"border-l-4 border-[#7A1315]":N?"border-l-4 border-red-200":"border-l-4 border-[#7A1315]",[]),G.useCallback((g,k,N)=>k?N?"bg-slate-50/30":"bg-slate-50/60":g.isGradeRelated?N?"bg-red-50/30":"bg-red-50/60":g.isAttendanceRelated?N?"bg-red-50/20":"bg-red-50/50":g.isContentRelated?N?"bg-rose-50/30":"bg-rose-50/60":g.isDiscussionRelated?N?"bg-red-50/30":"bg-red-50/60":N?"bg-red-50/20":"bg-red-50/50",[]),G.useCallback(g=>g.isGradeRelated?"text-red-700 hover:text-red-800 hover:bg-red-50":g.isAttendanceRelated?"text-red-600 hover:text-red-700 hover:bg-red-50":g.isContentRelated?"text-rose-700 hover:text-rose-800 hover:bg-rose-50":g.isDiscussionRelated?"text-[#7A1315] hover:text-red-900 hover:bg-red-50":"text-[#7A1315] hover:text-red-800 hover:bg-red-50",[]),G.useCallback((g,k)=>k?"text-slate-700":g.isGradeRelated?"text-red-700":g.isAttendanceRelated?"text-red-600":g.isContentRelated?"text-rose-700":(g.isDiscussionRelated,"text-[#7A1315]"),[]);const bN=G.useCallback((g,k)=>null,[]),_N=G.useCallback((g,k)=>k.isGradeRelated?g.message.includes("submitted")||g.message.includes("submission")?"New Submission Received":g.message.includes("ungraded")||g.message.includes("Grading Reminder")||g.message.includes("deadline")?"Grading Reminder":"New Grade Posted":k.isAttendanceRelated?"Attendance Alert":k.isEnrollmentRelated?"Student Enrolled":k.isContentRelated?"Material Released":k.isDiscussionRelated?"Discussion Response":g.title,[]),SN=G.useCallback((g,k)=>{if(k.isGradeRelated&&k.studentName&&k.assignmentName&&k.courseCode)return`${k.studentName} submitted ${k.assignmentName} for ${k.courseCode}`;if(k.isGradeRelated&&k.courseCode&&g.message.includes("ungraded")){const N=g.message.match(/(\d+)\s+ungraded/);return`${N?N[1]:"multiple"} ungraded submissions in ${k.courseCode}`}if(k.isAttendanceRelated&&k.studentName&&k.courseCode){const N=g.message.match(/(\d+)\s+times?/),j=N?N[1]:"multiple";return`${k.studentName} has missed ${j} classes in ${k.courseCode}`}if(k.isEnrollmentRelated&&g.message)return g.message;if(k.isContentRelated&&k.courseCode){const N=g.message.match(/\[([^\]]+)\]/);return`${N?N[1]:"new materials"} materials have been released for ${k.courseCode}`}return k.isDiscussionRelated&&k.studentName&&k.courseCode?`${k.studentName} replied to your post in ${k.courseCode}`:g.message},[]),EN=G.useCallback((g,k)=>{if(k.isGradeRelated&&(g.message.includes("deadline")||g.message.includes("overdue"))||k.isAttendanceRelated)return!0;if(k.isGradeRelated&&g.message.includes("due")){const N=g.message.match(/(\d{4}-\d{2}-\d{2})/);if(N){const j=new Date(N[1]);return Math.ceil((j-new Date)/(1e3*60*60*24))<=1}}return!1},[]),TN=G.useCallback(g=>{if(!g)return"Just now";let k;if(g&&typeof g=="object"&&g.toDate)k=g.toDate();else if(g instanceof Date)k=g;else if(typeof g=="number"){if(g<=0)return"Just now";k=g>1e12?new Date(g):new Date(g*1e3)}else if(typeof g=="string"){const se=Date.parse(g);!Number.isNaN(se)&&se>0&&(k=new Date(se))}if(!k||Number.isNaN(k.getTime())||k.getTime()<=0)return"Just now";const N=new Date,j=new Date(N.getFullYear()+1,N.getMonth(),N.getDate());if(k.getTime()<0||k>j)return"Just now";const P=N-k,D=Math.floor(P/6e4),U=Math.floor(P/36e5),M=Math.floor(P/864e5),q=Math.floor(M/7),ce=Math.floor(M/30);return D<1?"Just now":D<60?`${D} minute${D!==1?"s":""} ago`:U<24?`${U} hour${U!==1?"s":""} ago`:M<7?`${M} day${M!==1?"s":""} ago`:q<5?`${q} week${q!==1?"s":""} ago`:ce<12?`${ce} month${ce!==1?"s":""} ago`:k.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},[]),Ou=ne.filter(g=>!g.read).length;return l.jsxs("div",{className:A?"bg-[#000000] min-h-screen":"bg-white min-h-screen",children:[tr&&l.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm",children:l.jsxs("div",{className:`flex flex-col items-center justify-center space-y-4 p-8 rounded-2xl shadow-2xl ${A?"bg-[#1a1a1a]":"bg-white"}`,children:[l.jsxs("div",{className:"relative w-16 h-16",children:[l.jsx("div",{className:`absolute inset-0 border-4 border-t-transparent rounded-full animate-spin ${A?"border-red-600":"border-[#7A1315]"}`}),l.jsx("div",{className:`absolute inset-2 border-4 border-t-transparent rounded-full animate-spin ${A?"border-red-400":"border-red-300"}`,style:{animationDirection:"reverse",animationDuration:"0.8s"}})]}),l.jsx("p",{className:`text-lg font-semibold ${A?"text-white":"text-slate-800"}`,children:"Loading..."})]})}),Ce&&l.jsx("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 px-4 w-full max-w-2xl",children:l.jsxs("div",{className:`px-4 sm:px-6 md:px-8 py-3 sm:py-4 rounded-lg shadow-xl flex items-center justify-center space-x-2 sm:space-x-3 w-full ${Ce.includes("saved!")||Ce.includes("Attendance saved!")?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:[Ce.includes("saved!")||Ce.includes("Attendance saved!")?l.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}):l.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),l.jsx("span",{className:"font-semibold text-sm sm:text-base text-white break-words text-center",children:Ce})]})}),l.jsx("header",{className:`sticky top-0 z-40 bg-white/95 backdrop-blur-md ${A?"bg-[#1a1a1a]/95":""} shadow-sm`,children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-start sm:items-center py-3 sm:py-4 md:py-6 gap-2 sm:gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 md:space-x-4 min-w-0 flex-shrink",children:[l.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-xl flex items-center justify-center shadowLg overflow-hidden flex-shrink-0",children:l.jsx("img",{src:"/assets/logos/um logo.png",alt:"UM Logo",className:"w-full h-full object-contain"})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("h1",{className:"text-base sm:text-lg md:text-xl lg:text-2xl xl:text-3xl font-bold textGrad",children:"Student iTrack"}),l.jsx("p",{className:`text-[10px] sm:text-xs md:text-sm font-medium ${A?"text-slate-300":"text-slate-600"}`,children:"Smart Academic Monitoring System"})]})]}),l.jsxs("div",{className:"flex items-start sm:items-center space-x-2 sm:space-x-3 md:space-x-4 lg:space-x-6 flex-shrink-0 ml-auto pt-0.5 sm:pt-0",children:[l.jsx("label",{htmlFor:"view-mode-select",className:"sr-only",children:"View Mode"}),l.jsxs("select",{id:"view-mode-select",name:"view-mode-select",value:As,onChange:g=>Bs(g.target.value),className:`record-toggle-select focus:ring-2 focus:ring-maroon-500 text-xs sm:text-sm px-2 sm:px-3 py-1.5 sm:py-2 ${A?"text-white":""}`,children:[l.jsx("option",{value:"professor",children:"Professor Record"}),l.jsx("option",{value:"student",children:"Student Record"})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>{y(!p),b(!1)},className:`icon-button relative p-2 sm:p-2.5 rounded-lg transition-all duration-200 ${A?p?"bg-red-900/50 text-red-300":"hover:bg-slate-700":p?"bg-red-100 text-red-700":"hover:bg-slate-100"}`,children:[l.jsx("svg",{className:`w-4 h-4 sm:w-5 sm:h-5 ${A?"text-white":"text-slate-700"}`,fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"})}),Ou>0&&l.jsx("span",{className:`absolute -top-0.5 -right-0.5 sm:-top-1 sm:-right-1 w-4 h-4 sm:w-5 sm:h-5 bg-red-500 text-white text-[10px] sm:text-xs rounded-full flex items-center justify-center badge shadow-lg ${A?"bg-[#7A1315] text-white border-red-400":"bg-gradient-to-br from-red-500 to-red-600 text-white border-white"}`,children:Ou>9?"9+":Ou})]}),p&&(()=>{const{academic:g,administrative:k}=vN(ne),N=yN(k),j=[...g];return N&&j.push(N),l.jsxs("div",{className:`fixed sm:absolute left-4 right-4 sm:left-auto sm:right-0 top-16 sm:top-auto mt-0 sm:mt-2 w-auto sm:w-96 md:w-[420px] max-w-[280px] sm:max-w-[420px] max-h-[calc(100vh-5rem)] sm:max-h-[600px] rounded-2xl shadow-2xl border-2 z-50 overflow-hidden flex flex-col ${A?"bg-[#1a1a1a] border-slate-700":"bg-white border-slate-200"}`,children:[l.jsx("div",{className:`p-2.5 sm:p-4 md:p-5 border-b-2 flex-shrink-0 ${A?"bg-gradient-to-br from-red-600 via-[#7A1315] to-red-800 border-slate-700":"border-slate-200 bg-gradient-to-br from-red-600 via-[#7A1315] to-red-800"}`,children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsxs("h3",{className:"font-bold text-white text-sm sm:text-lg md:text-xl flex items-center gap-1.5 sm:gap-2",children:[l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"})}),l.jsx("span",{className:"truncate",children:"Notifications"})]}),l.jsx("p",{className:"text-[10px] sm:text-xs text-red-100 mt-0.5 sm:mt-1 font-medium hidden sm:block",children:"Academic Activity & Updates"})]}),Ou>0&&l.jsx("div",{className:`backdrop-blur-sm px-2 sm:px-3 py-0.5 sm:py-1 rounded-full border ${A?"bg-yellow-500/90 border-yellow-400":"bg-white/20 border-white/30"}`,children:l.jsx("span",{className:`font-bold text-xs sm:text-sm ${A?"text-black":"text-white"}`,children:Ou})})]})}),l.jsx("div",{className:`notification-scroll flex-1 min-h-0 overflow-y-auto max-h-[calc(100vh-20rem)] sm:max-h-[500px] ${A?"bg-[#1a1a1a]":"bg-gradient-to-b from-slate-50 to-white"}`,style:{scrollbarWidth:"thin",scrollbarColor:A?"#475569 #1a1a1a":"#cbd5e1 #ffffff"},children:j.length===0?l.jsxs("div",{className:"p-8 sm:p-12 text-center",children:[l.jsx("div",{className:`w-16 h-16 sm:w-20 sm:h-20 mx-auto mb-3 sm:mb-4 rounded-full flex items-center justify-center ${A?"bg-gradient-to-br from-red-900/30 to-rose-900/30":"bg-gradient-to-br from-red-100 to-rose-100"}`,children:l.jsx("svg",{className:"w-8 h-8 sm:w-10 sm:h-10 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),l.jsx("p",{className:`text-sm sm:text-base font-medium ${A?"text-slate-300":"text-slate-500"}`,children:"No notifications yet"}),l.jsx("p",{className:"text-xs sm:text-sm mt-1 px-2 text-slate-400",children:"You don't have any notification history at the moment."})]}):j.map(P=>{const D=P.type==="administrative",U=D?{}:wN(P),M=D?null:bN(P,U),q=D?P.title:_N(P,U),ce=D?P.message:SN(P,U),se=!D&&EN(P,U),te=TN(P.timestamp);return l.jsx("div",{className:`relative m-2 sm:m-3 rounded-xl shadow-md border-2 transition-all duration-200 cursor-pointer group ${A?"bg-[#1a1a1a]":"bg-white"} ${se?"border-[#7A1315]":A?"border-slate-700":"border-slate-200"} ${P.read?"hover:shadow-lg":"shadow-lg"} ${D?"opacity-80":""}`,onClick:()=>{const re=ne.map(fe=>fe.id===P.id?{...fe,read:!0}:fe);D&&P.originalNotifications&&P.originalNotifications.forEach(fe=>{const oe=re.findIndex(pe=>pe.id===fe.id);oe!==-1&&(re[oe].read=!0)}),Ae(re),vn(me,_e,ae,re,Ne,ge,bt).catch(fe=>console.warn("Background save failed",fe))},children:l.jsxs("div",{className:"p-2.5 sm:p-4",children:[l.jsxs("div",{className:"flex items-start justify-between mb-1.5 sm:mb-2",children:[l.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[l.jsx("h4",{className:`text-xs sm:text-sm font-bold leading-tight ${A?se?"text-red-400":"text-white":D?"text-slate-700":"text-[#7A1315]"}`,children:q}),!P.read&&l.jsx("div",{className:`flex-shrink-0 w-1.5 h-1.5 sm:w-2 sm:h-2 rounded-full ${A?"bg-red-400":"bg-[#7A1315]"}`})]}),l.jsx("button",{type:"button",onClick:re=>{re.stopPropagation();let fe;if(D&&P.originalNotifications&&P.originalNotifications.length>0){const oe=new Set(P.originalNotifications.map(pe=>pe.id));fe=ne.filter(pe=>!oe.has(pe.id)),console.log(`Deleted ${oe.size} administrative notifications`)}else P.id==="admin-summary"?(fe=ne.filter(oe=>{const pe=oe.title||"",ye=oe.message||"";return!(pe.includes("Student Archived")||pe.includes("Successfully restored")||pe.includes("Archive")||pe.includes("Restore")||ye.includes("archived")||ye.includes("restored"))}),console.log("Deleted all administrative notifications")):fe=ne.filter(oe=>oe.id!==P.id);Ae(fe),vn(me,_e,ae,fe,Ne,ge,bt,!0).catch(oe=>console.warn("Background save failed",oe))},className:`ml-1 sm:ml-2 rounded-full p-0.5 sm:p-1 text-[10px] sm:text-xs font-bold ${A?"text-slate-300 hover:text-white hover:bg-slate-700":"text-slate-500 hover:text-red-700 hover:bg-red-50"}`,"aria-label":"Delete notification",children:""})]}),l.jsx("p",{className:`text-[11px] sm:text-xs leading-relaxed mb-2 sm:mb-3 ${A?"text-white":"text-slate-700"}`,children:ce}),l.jsxs("div",{className:`flex items-center justify-between pt-1.5 sm:pt-2 border-t ${A?"border-slate-700":"border-slate-100"}`,children:[l.jsx("p",{className:`text-[10px] sm:text-xs font-medium ${A?"text-slate-400":"text-slate-500"}`,children:te}),M&&l.jsx("button",{onClick:re=>{re.stopPropagation();const fe=ne.map(oe=>oe.id===P.id?{...oe,read:!0}:oe);Ae(fe),vn(me,_e,ae,fe,Ne,ge,bt).catch(oe=>console.warn("Background save failed",oe)),M.action()},className:"bg-[#7A1315] hover:bg-red-800 text-white text-[10px] sm:text-xs font-semibold px-2.5 sm:px-4 py-1 sm:py-1.5 rounded-lg transition-all duration-200 shadow-sm hover:shadow-md",children:M.text})]})]})},P.id)})}),j.length>0&&l.jsx("div",{className:`p-2.5 sm:p-4 border-t-2 flex-shrink-0 ${A?"border-slate-700 bg-[#1a1a1a]":"border-slate-200 bg-gradient-to-r from-slate-50 to-red-50"}`,children:l.jsx("button",{onClick:async()=>{try{await MA(),console.log(" All notifications marked as read in MySQL");const P=ne.map(D=>({...D,read:!0}));Ae(P),await vn(me,_e,ae,P,Ne,ge,bt,!0),console.log(" All notifications cleared and saved")}catch(P){console.error(" Failed to clear all notifications:",P);const D=ne.map(U=>({...U,read:!0}));Ae(D),vn(me,_e,ae,D,Ne,ge,bt,!0).catch(U=>console.warn("Background save failed",U)),gt("error","Clear Failed","Failed to clear all notifications. Please try again.",!1)}},className:"w-full text-center text-xs sm:text-sm font-bold text-white hover:text-white bg-[#7A1315] hover:bg-red-800 px-3 sm:px-4 py-2 sm:py-2.5 rounded-lg transition-all duration-200 shadow-sm hover:shadow-md",children:"Clear All Notifications"})})]})})()]}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{type:"button",onClick:()=>{b(!v),y(!1)},className:"flex items-center space-x-1 sm:space-x-2 md:space-x-3 rounded-xl sm:rounded-2xl border border-slate-200 px-2 sm:px-3 py-1.5 sm:py-2 hover:bg-white transition-all focus:outline-none focus:ring-2 focus:ring-maroon-500",children:[l.jsx("div",{className:"w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-gradient-to-r from-red-800 to-red-600 rounded-full flex items-center justify-center text-white font-semibold text-xs sm:text-sm flex-shrink-0",children:i?l.jsx("img",{src:i,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):cp(s)}),l.jsxs("div",{className:"text-left min-w-0 hidden sm:block",children:[l.jsx("p",{className:`text-[10px] md:text-xs uppercase tracking-wide ${A?"text-slate-300":"text-slate-400"}`,children:"Profile"}),l.jsx("p",{className:`text-xs md:text-sm font-semibold truncate max-w-[100px] sm:max-w-[120px] md:max-w-[150px] lg:max-w-none ${A?"text-white":"text-slate-700"}`,children:s})]}),l.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-slate-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M6 9l6 6 6-6",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})]}),v&&l.jsxs("div",{className:`fixed sm:absolute left-4 right-4 sm:left-auto sm:right-0 top-16 sm:top-auto mt-0 sm:mt-2 w-auto sm:w-56 max-w-[280px] sm:max-w-none max-h-[calc(100vh-5rem)] sm:max-h-none rounded-xl shadow-2xl border-2 z-50 overflow-hidden ${A?"bg-[#1a1a1a] border-slate-700":"bg-white border-slate-200"}`,children:[l.jsx("div",{className:`p-4 border-b ${A?"border-slate-700":"border-slate-200"}`,children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-red-800 to-red-600 rounded-full flex items-center justify-center text-white font-semibold text-sm flex-shrink-0",children:i?l.jsx("img",{src:i,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):cp(s)}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("p",{className:`text-sm font-semibold truncate ${A?"text-white":"text-slate-800"}`,children:s}),l.jsx("p",{className:`text-xs truncate ${A?"text-slate-400":"text-slate-500"}`,children:lo||"Professor"})]})]})}),l.jsxs("div",{className:"py-2",children:[l.jsxs("button",{onClick:()=>{d(!0),b(!1)},className:`w-full px-4 py-3 text-left flex items-center space-x-3 transition-colors ${A?"hover:bg-slate-800/50 text-white":"hover:bg-slate-50 text-slate-700"}`,children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),l.jsx("span",{className:"text-sm font-medium",children:"Profile Settings"})]}),l.jsxs("button",{onClick:()=>{b(!1),EC()},className:`w-full px-4 py-3 text-left flex items-center space-x-3 transition-colors ${A?"hover:bg-slate-800/50 text-white":"hover:bg-slate-50 text-slate-700"}`,children:[l.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M16 17v-3H9v-4h7V7l5 5-5 5M14 2a2 2 0 012 2v2h-2V4H4v16h10v-2h2v2a2 2 0 01-2 2H4a2 2 0 01-2-2V4a2 2 0 012-2h10z"})}),l.jsx("span",{className:"text-sm font-medium",children:"Logout"})]})]})]})]})]})]})})}),cs&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-3 sm:p-4",children:l.jsxs("div",{className:`rounded-2xl shadow-2xl max-w-sm w-full mx-4 p-4 sm:p-6 border ${A?"bg-[#1a1a1a] border-slate-700":"bg-white border-slate-200"}`,children:[l.jsx("h2",{className:`text-base sm:text-lg font-semibold mb-2 text-center ${A?"text-white":"text-slate-900"}`,children:"Confirm Logout"}),l.jsx("p",{className:`text-sm mb-4 sm:mb-6 text-center ${A?"text-slate-300":"text-slate-600"}`,children:"Are you sure you want to logout?"}),l.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-3",children:[l.jsx("button",{type:"button",onClick:TC,className:"px-4 py-2 rounded-xl text-sm font-semibold border border-slate-300 text-slate-700 bg-white hover:bg-slate-50",children:"Cancel"}),l.jsx("button",{type:"button",onClick:SC,className:"px-4 py-2 rounded-xl text-sm font-semibold text-white bg-[#7A1315] hover:bg-[#8a1a1c] shadow-md",children:"Logout"})]})]})}),qf&&cn&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm",children:l.jsxs("div",{className:`rounded-3xl shadow-2xl max-w-md w-full mx-4 p-6 border-2 ${A?"bg-[#1a1a1a] border-slate-700":"bg-white border-slate-300"}`,children:[l.jsxs("div",{className:"flex items-start space-x-4 mb-5",children:[l.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center flex-shrink-0 ${A?"bg-slate-700 border-2 border-slate-600":"bg-slate-200 border-2 border-slate-300"}`,children:l.jsx("svg",{className:`w-6 h-6 ${A?"text-slate-300":"text-slate-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v4m0 4h.01M4.93 4.93l14.14 14.14M12 2a10 10 0 100 20 10 10 0 000-20z"})})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h2",{className:`text-xl font-bold mb-2 ${A?"text-white":"text-slate-900"}`,children:cn!=null&&cn.isBulkDelete?Kn==="permanent"?cn.code==="SELECTED"?`Permanently delete ${((Sy=cn.selectedCodes)==null?void 0:Sy.length)||0} selected subject(s)?`:"Permanently delete all subjects?":"Move all archived subjects to Recycle Bin?":Kn==="permanent"?"Permanently delete subject?":Kn==="delete"?"Move subject to Recycle Bin?":"Archive subject?"}),l.jsx("p",{className:`text-sm leading-relaxed ${A?"text-slate-300":"text-slate-600"}`,children:cn!=null&&cn.isBulkDelete?Kn==="permanent"?cn.code==="SELECTED"?`${((Ey=cn.selectedCodes)==null?void 0:Ey.length)||0} selected subject(s) will be permanently deleted and their course records will be removed from MySQL. This action cannot be undone.`:`All ${ie.length} subject(s) in Recycle Bin will be permanently deleted. This action cannot be undone.`:`All ${rt.length} archived subject(s) will be moved to Recycle Bin.`:Kn==="permanent"?`"${cn.name}" will be permanently deleted and its course record will be removed from MySQL. This action cannot be undone.`:Kn==="delete"?`"${cn.name}" will be moved to Recycle Bin. You can restore it later or permanently delete it.`:`"${cn.name}" will be moved to Archived Subjects. You can restore it later or move it to Recycle Bin.`})]})]}),l.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6",children:[l.jsx("button",{type:"button",onClick:()=>{Is(!1),zs(null)},className:`px-6 py-2.5 rounded-xl text-sm font-bold transition-all ${A?"border-2 border-slate-600 text-slate-300 bg-slate-800 hover:bg-slate-700":"border-2 border-slate-300 text-slate-700 bg-white hover:bg-slate-50"}`,children:"Cancel"}),l.jsx("button",{type:"button",onClick:Kn==="permanent"?MC:Kn==="delete"?LC:FC,className:`px-6 py-2.5 rounded-xl text-sm font-bold text-white shadow-lg hover:shadow-xl transition-all ${Kn==="permanent"?A?"bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600":"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-400 hover:to-red-500":Kn==="delete"?A?"bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-500 hover:to-emerald-600":"bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-400 hover:to-emerald-500":A?"bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600":"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-400 hover:to-red-500"}`,children:Kn==="permanent"?"Permanently Delete":Kn==="delete"?"Move to Recycle Bin":"Archive Subject"})]})]})}),l.jsx("main",{className:"max-w-7xl mx-auto px-2 sm:px-4 md:px-6 lg:px-8 py-4 sm:py-6 lg:py-10 w-full overflow-x-hidden",children:As==="professor"?l.jsxs("div",{className:"fadeIn",children:[l.jsx("div",{className:"glass rounded-2xl shadow-xl mb-4 sm:mb-6 lg:mb-8 overflow-hidden",children:l.jsxs("nav",{className:"flex overflow-x-auto whitespace-nowrap px-2 sm:px-4 lg:px-8 scrollbar-hide -mx-2 sm:mx-0",children:[l.jsx("button",{onClick:()=>{n("subjects"),T(!1)},className:`tab-btn relative py-3.5 sm:py-4 lg:py-6 px-4 sm:px-4 lg:px-6 font-semibold transition-all flex-shrink-0 min-h-[48px] sm:min-h-0 touch-manipulation ${r==="subjects"?"border-b-[3px] border-maroon-500 text-maroon-600 bg-red-50/50":"border-b-[3px] border-transparent text-slate-600 hover:text-slate-800 hover:bg-slate-50/50"}`,children:l.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"})}),l.jsx("span",{className:"text-sm sm:text-base",children:"Subjects"})]})}),l.jsx("button",{onClick:()=>n("attendance"),className:`tab-btn relative py-3.5 sm:py-4 lg:py-6 px-4 sm:px-4 lg:px-6 border-b-3 font-semibold transition-all flex-shrink-0 min-h-[48px] sm:min-h-0 touch-manipulation ${r==="attendance"?"border-maroon-500 text-maroon-600 bg-red-50/50":"border-transparent text-slate-600 hover:text-slate-800 hover:bg-slate-50/50"}`,children:l.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.jsx("span",{className:"text-sm sm:text-base",children:"Attendance"})]})}),l.jsx("button",{onClick:()=>n("grades"),className:`tab-btn relative py-3.5 sm:py-4 lg:py-6 px-4 sm:px-4 lg:px-6 border-b-3 font-semibold transition-all flex-shrink-0 min-h-[48px] sm:min-h-0 touch-manipulation ${r==="grades"?"border-maroon-500 text-maroon-600 bg-red-50/50":"border-transparent text-slate-600 hover:text-slate-800 hover:bg-slate-50/50"}`,children:l.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),l.jsx("span",{className:"text-sm sm:text-base",children:"Grades"})]})}),l.jsx("button",{onClick:()=>n("students"),className:`tab-btn relative py-3.5 sm:py-4 lg:py-6 px-4 sm:px-4 lg:px-6 border-b-3 font-semibold transition-all flex-shrink-0 min-h-[48px] sm:min-h-0 touch-manipulation ${r==="students"?"border-maroon-500 text-maroon-600 bg-red-50/50":"border-transparent text-slate-600 hover:text-slate-800 hover:bg-slate-50/50"}`,children:l.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[l.jsxs("div",{className:"relative w-4 h-4 sm:w-5 sm:h-5",children:[l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z",fill:"currentColor"})}),l.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-2 h-2 sm:w-3 sm:h-3 bg-current rounded-full flex items-center justify-center shadow-sm",children:l.jsx("svg",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:4,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})})})]}),l.jsx("span",{className:"text-sm sm:text-base",children:"Students"})]})})]})}),r==="subjects"&&!E&&l.jsxs("div",{className:`glass rounded-2xl sm:rounded-3xl shadow-2xl p-4 sm:p-6 md:p-8 lg:p-10 ${A?"bg-[#1a1a1a]":""}`,children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 sm:gap-6 mb-6 sm:mb-8",children:[l.jsx("div",{className:"min-w-0 flex-1",children:l.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2",children:[l.jsx("div",{className:`w-10 h-10 sm:w-12 sm:h-12 md:w-14 md:h-14 rounded-xl sm:rounded-2xl flex items-center justify-center shadow-lg border flex-shrink-0 ${A?"bg-transparent border-red-200/40":"bg-transparent border-red-200"}`,children:l.jsx("img",{src:J_,alt:"Subject icon",className:"w-full h-full rounded-xl sm:rounded-2xl object-cover"})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("h2",{className:`text-xl sm:text-2xl md:text-3xl font-bold break-words ${A?"text-white":"text-slate-800"}`,children:"Subject Management"}),l.jsx("p",{className:`text-xs sm:text-sm md:text-base mt-1 ${A?"text-slate-400":"text-slate-600"}`,children:Ws==="active"?"Click on any subject to view enrolled students and manage enrollment.":Ws==="archived"?"Manage archived subjects. You can restore them or move them to Recycle Bin.":"Manage subjects in Recycle Bin. You can restore them to Archived or permanently delete them."})]})]})}),l.jsxs("div",{className:"flex gap-2.5 sm:gap-3 w-full sm:w-auto",children:[l.jsxs("button",{onClick:_C,className:`group relative overflow-hidden px-4 py-3.5 sm:px-4 sm:py-3 rounded-xl sm:rounded-2xl font-semibold shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center space-x-2 flex-1 sm:flex-initial min-h-[50px] sm:min-h-0 touch-manipulation ${A?"bg-slate-700 text-white hover:bg-slate-600 border border-slate-600":"bg-white text-slate-700 hover:bg-slate-50 border border-slate-300"}`,title:"Refresh data from server",children:[l.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),l.jsx("span",{className:"text-sm sm:text-base font-medium",children:"Refresh"})]}),l.jsxs("button",{onClick:()=>m(!0),className:"group relative overflow-hidden px-4 py-3.5 sm:px-6 sm:py-3 rounded-xl sm:rounded-2xl font-bold text-white shadow-xl hover:shadow-2xl transition-all duration-300 flex items-center justify-center space-x-2 flex-1 sm:flex-initial min-h-[50px] sm:min-h-0 touch-manipulation bg-gradient-to-r from-[#7A1315] to-[#b91c1c] hover:from-[#8a1518] hover:to-[#c91d1d]",children:[l.jsx("div",{className:"absolute inset-0 bg-white opacity-0 group-hover:opacity-10 transition-opacity"}),l.jsx("svg",{className:"w-5 h-5 relative z-10 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 4v16m8-8H4"})}),l.jsx("span",{className:"relative z-10 text-sm sm:text-base",children:"Add Subject"})]})]})]}),l.jsx("div",{className:"mb-6 sm:mb-8",children:l.jsxs("div",{className:`relative w-full sm:w-auto sm:inline-flex rounded-2xl p-1.5 shadow-lg toggle-switch-container ${A?"bg-slate-800/50 border-2 border-slate-700":"bg-slate-50 border-2 border-slate-200"}`,children:[l.jsx("div",{className:`absolute top-1.5 bottom-1.5 rounded-xl bg-gradient-to-br from-[#7A1315] via-[#8a1518] to-[#b91c1c] transition-[left,right] duration-300 ease-out shadow-lg toggle-indicator ${Ws==="active"?"toggle-indicator-active":"toggle-indicator-archived"}`,style:{boxShadow:"0 4px 12px rgba(122, 19, 21, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.1)",zIndex:1}}),l.jsx("button",{type:"button",onClick:()=>na("active"),className:`relative z-20 flex-1 px-5 py-4 sm:px-4 sm:py-2.5 text-sm font-bold text-center transition-colors duration-300 rounded-xl min-h-[56px] sm:min-h-0 touch-manipulation whitespace-nowrap ${Ws==="active"?"text-white":A?"text-slate-300 hover:text-slate-200":"text-slate-600 hover:text-slate-700"}`,style:{textShadow:Ws==="active"?"0 1px 2px rgba(0, 0, 0, 0.3)":"none",backgroundColor:"transparent"},children:"Active Subjects"}),l.jsx("button",{type:"button",onClick:()=>na("archived"),className:`relative z-20 flex-1 px-5 py-4 sm:px-4 sm:py-2.5 text-sm font-bold text-center transition-colors duration-300 rounded-xl min-h-[56px] sm:min-h-0 touch-manipulation whitespace-nowrap ${Ws==="archived"?"text-white":A?"text-slate-300 hover:text-slate-200":"text-slate-600 hover:text-slate-700"}`,style:{textShadow:Ws==="archived"?"0 1px 2px rgba(0, 0, 0, 0.3)":"none",backgroundColor:"transparent"},children:"Archived Subjects"})]})}),Ws==="active"&&l.jsxs("div",{className:"flex flex-wrap items-center gap-2.5 sm:gap-3 mb-6",children:[l.jsx("button",{onClick:()=>{K("all"),be(1)},className:`px-5 py-3 sm:px-4 sm:py-2 rounded-xl sm:rounded-lg text-sm font-semibold transition-all min-h-[44px] sm:min-h-0 touch-manipulation flex-1 sm:flex-initial ${z==="all"?"bg-[#7A1315] text-white shadow-lg":A?"bg-[#2c2c2c] text-slate-300 border border-slate-600 hover:bg-[#3c3c3c] hover:border-slate-500":"bg-slate-100 text-slate-700 border border-slate-300 hover:bg-slate-200"}`,children:"All"}),l.jsx("button",{onClick:()=>{K("first"),be(1)},className:`px-5 py-3 sm:px-4 sm:py-2 rounded-xl sm:rounded-lg text-sm font-semibold transition-all min-h-[44px] sm:min-h-0 touch-manipulation flex-1 sm:flex-initial ${z==="first"?"bg-[#7A1315] text-white shadow-lg":A?"bg-[#2c2c2c] text-slate-300 border border-slate-600 hover:bg-[#3c3c3c] hover:border-slate-500":"bg-slate-100 text-slate-700 border border-slate-300 hover:bg-slate-200"}`,children:"1st Term"}),l.jsx("button",{onClick:()=>{K("second"),be(1)},className:`px-5 py-3 sm:px-4 sm:py-2 rounded-xl sm:rounded-lg text-sm font-semibold transition-all min-h-[44px] sm:min-h-0 touch-manipulation flex-1 sm:flex-initial ${z==="second"?"bg-[#7A1315] text-white shadow-lg":A?"bg-[#2c2c2c] text-slate-300 border border-slate-600 hover:bg-[#3c3c3c] hover:border-slate-500":"bg-slate-100 text-slate-700 border border-slate-300 hover:bg-slate-200"}`,children:"2nd Term"})]}),Ws==="active"&&(()=>{let g=me.filter(D=>{if(!R)return!0;const U=R.toLowerCase(),M=(D.name||"").toLowerCase(),q=(D.code||"").toLowerCase();return M.includes(U)||q.includes(U)});z!=="all"&&(g=g.filter(D=>z==="first"?!D.term||D.term==="first":z==="second"?D.term==="second":!0)),g.sort((D,U)=>{var ce,se;let M,q;switch(Y){case"name":M=(D.name||"").toLowerCase(),q=(U.name||"").toLowerCase();break;case"code":M=(D.code||"").toLowerCase(),q=(U.code||"").toLowerCase();break;case"credits":M=parseInt(D.credits)||0,q=parseInt(U.credits)||0;break;case"enrollment":M=((ce=ae[D.code])==null?void 0:ce.length)||0,q=((se=ae[U.code])==null?void 0:se.length)||0;break;default:M=(D.name||"").toLowerCase(),q=(U.name||"").toLowerCase()}return Ee==="asc"?M>q?1:M<q?-1:0:M<q?1:M>q?-1:0});const k=(xe-1)*Te,N=k+Te,j=g.slice(k,N),P=Math.ceil(g.length/Te);return l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx("input",{type:"text",placeholder:"Search subjects...",value:R,onChange:D=>{X(D.target.value),be(1)},className:`w-full px-4 py-2 pl-10 rounded-lg border text-sm ${A?"bg-[#2c2c2c] border-slate-600 text-white placeholder-slate-400":"bg-white border-slate-300 text-slate-800 placeholder-slate-400"} focus:outline-none focus:ring-2 focus:ring-[#7A1315] focus:border-transparent`}),l.jsx("i",{className:`fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-sm ${A?"text-slate-400":"text-slate-500"}`})]}),l.jsxs("select",{value:`${Y}-${Ee}`,onChange:D=>{const[U,M]=D.target.value.split("-");ee(U),De(M),be(1)},className:`px-4 py-2 rounded-lg border text-sm ${A?"bg-[#2c2c2c] border-slate-600 text-white":"bg-white border-slate-300 text-slate-800"} focus:outline-none focus:ring-2 focus:ring-[#7A1315] focus:border-transparent`,children:[l.jsx("option",{value:"name-asc",children:"Name (A-Z)"}),l.jsx("option",{value:"name-desc",children:"Name (Z-A)"}),l.jsx("option",{value:"code-asc",children:"Code (A-Z)"}),l.jsx("option",{value:"code-desc",children:"Code (Z-A)"}),l.jsx("option",{value:"credits-desc",children:"Credits (High-Low)"}),l.jsx("option",{value:"credits-asc",children:"Credits (Low-High)"}),l.jsx("option",{value:"enrollment-desc",children:"Enrollment (High-Low)"}),l.jsx("option",{value:"enrollment-asc",children:"Enrollment (Low-High)"})]})]}),g.length>0&&l.jsxs("div",{className:`text-sm mb-4 ${A?"text-slate-400":"text-slate-600"}`,children:["Showing ",j.length," of ",g.length," subject",g.length!==1?"s":""]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 sm:gap-6",children:[j.map(D=>{const U=ae[D.code]?ae[D.code].length:0;return l.jsxs("div",{onClick:()=>UC(D),className:`group relative overflow-hidden rounded-3xl p-6 cursor-pointer transition-all duration-300 hover:scale-[1.02] hover:shadow-2xl ${A?"bg-gradient-to-br from-[#2c2c2c] to-[#1f1f1f] border border-slate-700 hover:border-slate-600":"bg-gradient-to-br from-white to-slate-50 border border-slate-200 hover:border-[#7A1315]/30 shadow-xl"}`,children:[l.jsx("div",{className:`absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-gradient-to-br ${A?"from-[#7A1315]/20 to-transparent":"from-[#7A1315]/5 to-transparent"}`}),l.jsxs("div",{className:"relative z-10 flex flex-col space-y-3",children:[l.jsxs("div",{className:"flex items-start justify-between gap-3",children:[l.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[l.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center shadow-md flex-shrink-0 ${A?"bg-gradient-to-br from-[#7A1315]/40 to-[#4a0c0d]/40 border border-[#7A1315]/30":"bg-gradient-to-br from-red-100 to-red-50 border border-red-200"}`,children:l.jsx("svg",{className:`w-6 h-6 ${A?"text-red-400":"text-[#7A1315]"}`,fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"})})}),l.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("h3",{className:`text-lg font-bold truncate ${A?"text-white":"text-slate-800"}`,children:D.name}),l.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",onClick:M=>M.stopPropagation(),children:[l.jsx("button",{onClick:M=>Qf(D.code,"first",M),className:`px-2 py-0.5 rounded-md text-xs font-semibold transition-all ${!D.term||D.term==="first"?A?"bg-blue-600 text-white shadow-sm":"bg-blue-500 text-white shadow-sm":A?"bg-slate-700 text-slate-300 hover:bg-slate-600":"bg-slate-200 text-slate-600 hover:bg-slate-300"}`,title:"Click to set as 1st Term",children:"1st"}),l.jsx("button",{onClick:M=>Qf(D.code,"second",M),className:`px-2 py-0.5 rounded-md text-xs font-semibold transition-all ${D.term==="second"?A?"bg-purple-600 text-white shadow-sm":"bg-purple-500 text-white shadow-sm":A?"bg-slate-700 text-slate-300 hover:bg-slate-600":"bg-slate-200 text-slate-600 hover:bg-slate-300"}`,title:"Click to set as 2nd Term",children:"2nd"})]})]}),l.jsxs("div",{className:`text-xs font-medium ${A?"text-slate-400":"text-slate-500"}`,children:[D.code,"  ",D.credits," Credits"]})]})]}),l.jsx("button",{onClick:M=>NC(D.code,M),className:`flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center transition-all duration-200 ${A?"text-red-400 hover:text-red-300 hover:bg-red-900/30":"text-red-500 hover:text-red-700 hover:bg-red-50"}`,children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:`flex items-center gap-1.5 ${A?"text-slate-400":"text-slate-600"}`,children:[l.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})}),l.jsxs("span",{className:"text-xs font-semibold",children:[U," enrolled"]})]}),D.createdAt&&l.jsx("div",{className:`text-xs ${A?"text-slate-500":"text-slate-400"}`,children:(()=>{try{return new Date(D.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch{return new Date(D.createdAt).toLocaleDateString()}})()})]}),l.jsx("div",{className:`pt-2 border-t ${A?"border-slate-700":"border-slate-200"}`,children:l.jsxs("div",{className:`flex items-center gap-2 text-xs ${A?"text-slate-400":"text-slate-500"}`,children:[l.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),l.jsx("span",{className:"font-medium",children:"Click to view enrolled students and manage"})]})})]})]},`active-${D.code}`)}),g.length===0&&l.jsxs("div",{className:`col-span-full text-center py-12 rounded-2xl ${A?"bg-[#1a1a1a] border border-slate-700 text-slate-400":"bg-slate-50 border border-slate-200 text-slate-500"}`,children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),l.jsx("p",{className:"text-lg font-semibold mb-2",children:R?"No subjects found matching your search.":"No subjects yet"}),!R&&l.jsx("p",{className:"text-sm",children:'Click "Add Subject" to create your first subject'})]})]}),P>1&&l.jsxs("div",{className:`flex flex-col sm:flex-row justify-between items-center gap-3 mt-6 pt-6 border-t ${A?"border-slate-700":"border-slate-200"}`,children:[l.jsxs("div",{className:`text-sm ${A?"text-slate-400":"text-slate-600"}`,children:["Page ",xe," of ",P]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>be(D=>Math.max(1,D-1)),disabled:xe===1,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${xe===1?A?"bg-[#2c2c2c] text-slate-600 cursor-not-allowed opacity-50":"bg-slate-100 text-slate-400 cursor-not-allowed opacity-50":A?"bg-[#2c2c2c] text-white border border-slate-600 hover:bg-[#3c3c3c]":"bg-white text-slate-700 border border-slate-300 hover:bg-slate-50"}`,children:[l.jsx("i",{className:"fa-solid fa-chevron-left mr-1"})," Prev"]}),l.jsxs("button",{onClick:()=>be(D=>Math.min(P,D+1)),disabled:xe===P,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${xe===P?A?"bg-[#2c2c2c] text-slate-600 cursor-not-allowed opacity-50":"bg-slate-100 text-slate-400 cursor-not-allowed opacity-50":A?"bg-[#2c2c2c] text-white border border-slate-600 hover:bg-[#3c3c3c]":"bg-white text-slate-700 border border-slate-300 hover:bg-slate-50"}`,children:["Next ",l.jsx("i",{className:"fa-solid fa-chevron-right ml-1"})]})]})]})]})})(),Ws==="archived"&&(()=>{const g=iN(),k=g.filter(N=>{if(!oi.trim())return!0;const j=oi.toLowerCase().trim();return!N.name||typeof N.name!="string"?!1:N.name.toLowerCase().includes(j)});return g.length===0?l.jsxs("div",{className:`text-center py-12 rounded-2xl ${A?"bg-[#1a1a1a] border border-slate-700 text-slate-400":"bg-slate-50 border border-slate-200 text-slate-500"}`,children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),l.jsx("p",{className:"text-lg font-semibold mb-2",children:"No archived subjects yet"}),l.jsx("p",{className:"text-sm",children:"Archive a subject from the Active view to manage it here"})]}):l.jsxs("div",{className:"mt-2",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-4",children:[l.jsx("div",{className:"relative flex-1 w-full sm:max-w-md",children:l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"text",placeholder:"Search archived subjects...",value:oi,onChange:N=>{ju(N.target.value),N.target.value.trim()!==oi.trim()&&(de([]),xt(!1))},className:`w-full px-4 py-2.5 pl-10 pr-10 rounded-lg border-2 transition-all duration-200 ${A?"bg-[#1a1a1a] border-slate-700 text-white placeholder:text-slate-400 focus:border-amber-500 focus:ring-2 focus:ring-amber-500/20":"bg-white border-slate-300 text-slate-800 placeholder:text-slate-400 focus:border-amber-400 focus:ring-2 focus:ring-amber-400/20"}`}),l.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),oi&&l.jsx("button",{onClick:()=>{ju(""),de([]),xt(!1)},className:`absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 rounded-full flex items-center justify-center transition-colors ${A?"text-slate-400 hover:text-white hover:bg-slate-700":"text-slate-400 hover:text-slate-600 hover:bg-slate-100"}`,title:"Clear search",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),g.length>0&&l.jsxs("button",{onClick:()=>na("recyclebin"),className:`px-4 py-2.5 rounded-lg font-semibold text-sm transition-all duration-300 flex items-center justify-center space-x-2 shadow-lg hover:shadow-xl whitespace-nowrap ${A?"bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white border border-red-700":"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-400 hover:to-red-500 text-white border border-red-600"}`,title:"View Recycle Bin",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),l.jsxs("span",{children:["Recycle Bin (",ie.length,")"]})]})]}),oi&&k.length===0&&g.length>0&&l.jsxs("div",{className:`text-center py-12 rounded-2xl mb-4 ${A?"bg-[#1a1a1a] border border-slate-700 text-slate-400":"bg-slate-50 border border-slate-200 text-slate-500"}`,children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),l.jsx("p",{className:"text-lg font-semibold mb-2",children:"No results found"}),l.jsxs("p",{className:"text-sm",children:['No archived subjects match "',oi,'"']})]}),k.length>0&&l.jsxs("div",{className:`mb-4 p-4 rounded-xl flex items-center justify-between ${A?"bg-slate-800/50 border border-slate-700":"bg-slate-50 border border-slate-200"}`,children:[l.jsx("div",{className:"flex items-center gap-3",children:l.jsx("p",{className:`text-sm font-medium ${A?"text-slate-300":"text-slate-600"}`,children:Ie.length>0?`${Ie.length} subject${Ie.length===1?"":"s"} selected`:"No subjects selected"})}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{type:"button",onClick:()=>{de([]),xt(!1)},className:`px-3 py-1.5 text-xs font-semibold rounded-lg transition-colors ${A?"bg-slate-700 text-slate-300 hover:bg-slate-600":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Clear"}),l.jsx("button",{type:"button",onClick:()=>{if(Fe)de([]),xt(!1);else{const N=k.map(j=>j.code);de(N),xt(!0)}},className:`px-3 py-1.5 text-xs font-semibold rounded-lg transition-colors ${A?Fe?"bg-emerald-700 text-white hover:bg-emerald-600":"bg-emerald-800/50 text-emerald-300 hover:bg-emerald-700":Fe?"bg-emerald-600 text-white hover:bg-emerald-500":"bg-emerald-100 text-emerald-700 hover:bg-emerald-200"}`,children:Fe?"Deselect All":"Select All"})]})]}),k.length>0&&l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 sm:gap-6",children:k.map(N=>{const j=Ie.includes(N.code);return l.jsxs("div",{className:`group relative overflow-hidden rounded-3xl p-6 transition-all duration-300 hover:scale-[1.02] hover:shadow-2xl ${j?A?"bg-gradient-to-br from-[#2c2c2c] to-[#1f1f1f] border-2 border-emerald-500 shadow-lg shadow-emerald-500/20":"bg-gradient-to-br from-white to-slate-50 border-2 border-emerald-500 shadow-xl shadow-emerald-500/20":A?"bg-gradient-to-br from-[#2c2c2c] to-[#1f1f1f] border border-slate-700 hover:border-slate-600":"bg-gradient-to-br from-white to-slate-50 border border-amber-200 hover:border-amber-300 shadow-xl"}`,children:[l.jsx("div",{className:`absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-gradient-to-br ${A?"from-amber-900/20 to-transparent":"from-amber-50/50 to-transparent"}`}),l.jsxs("div",{className:"relative z-10 flex flex-col space-y-4",children:[l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsx("div",{className:"flex items-center mr-2",children:l.jsx("input",{type:"checkbox",checked:j,onChange:P=>{P.stopPropagation(),P.target.checked?(de([...Ie,N.code]),Ie.length+1===k.length&&xt(!0)):(de(Ie.filter(D=>D!==N.code)),xt(!1))},className:`w-5 h-5 rounded border-2 cursor-pointer transition-all ${j?"bg-emerald-500 border-emerald-500 text-white":A?"bg-slate-700 border-slate-600 text-transparent":"bg-white border-slate-300 text-transparent"}`,style:{accentColor:j?"#10b981":void 0}})}),l.jsxs("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[l.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center shadow-lg flex-shrink-0 ${A?"bg-gradient-to-br from-amber-900/40 to-amber-800/20 border border-amber-800/30":"bg-gradient-to-br from-amber-100 to-amber-50 border border-amber-200"}`,children:l.jsx("svg",{className:`w-8 h-8 ${A?"text-amber-400":"text-amber-600"}`,fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"})})}),l.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[l.jsx("div",{className:`text-lg font-bold mb-1 truncate ${A?"text-white":"text-slate-800"}`,children:N.name}),l.jsxs("div",{className:`text-xs font-medium ${A?"text-slate-400":"text-slate-500"}`,children:[N.code,"  ",N.credits," Credits"]}),l.jsx("div",{className:`mt-1 px-2 py-0.5 rounded-full text-xs font-semibold inline-block w-fit ${A?"bg-amber-900/30 text-amber-400 border border-amber-800/50":"bg-amber-100 text-amber-700 border border-amber-200"}`,children:"Archived"})]})]})]}),l.jsxs("div",{className:"pt-3 border-t border-slate-200 dark:border-slate-700 flex flex-col space-y-2.5",children:[l.jsxs("button",{onClick:P=>{P.stopPropagation(),RC(N.code)},className:`w-full py-2.5 px-4 rounded-xl font-bold transition-all flex items-center justify-center space-x-2 shadow-md hover:shadow-lg ${A?"bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white":"bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-400 hover:to-teal-400 text-white"}`,children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),l.jsx("span",{className:"text-sm",children:"Restore Subject"})]}),l.jsxs("button",{onClick:P=>{P.stopPropagation(),PC(N.code)},className:`w-full py-2.5 px-4 rounded-xl font-bold transition-all flex items-center justify-center space-x-2 shadow-md hover:shadow-lg ${A?"bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-500 hover:to-slate-600 text-white border border-slate-700":"bg-gradient-to-r from-slate-500 to-slate-600 hover:from-slate-400 hover:to-slate-500 text-white"}`,children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),l.jsx("span",{className:"text-sm",children:"Delete"})]})]})]})]},`archived-${N.code}`)})})]})})(),Ws==="recyclebin"&&(ie.length===0?l.jsxs("div",{className:"mt-2",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("button",{onClick:()=>na("archived"),className:`px-4 py-2.5 rounded-lg font-semibold text-sm transition-all duration-300 flex items-center justify-center space-x-2 shadow-lg hover:shadow-xl whitespace-nowrap ${A?"bg-slate-700 hover:bg-slate-600 text-white border border-slate-600":"bg-white hover:bg-slate-50 text-slate-700 border border-slate-300"}`,title:"Back to Archived Subjects",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsx("span",{children:"Back"})]}),l.jsx("div",{className:"flex-1"})]}),l.jsxs("div",{className:`text-center py-12 rounded-2xl ${A?"bg-[#1a1a1a] border border-slate-700 text-slate-400":"bg-slate-50 border border-slate-200 text-slate-500"}`,children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),l.jsx("p",{className:"text-lg font-semibold mb-2",children:"Recycle Bin is empty"}),l.jsx("p",{className:"text-sm",children:"Deleted subjects will appear here"})]})]}):l.jsxs("div",{className:"mt-2",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("button",{onClick:()=>na("archived"),className:`px-4 py-2.5 rounded-lg font-semibold text-sm transition-all duration-300 flex items-center justify-center space-x-2 shadow-lg hover:shadow-xl whitespace-nowrap ${A?"bg-slate-700 hover:bg-slate-600 text-white border border-slate-600":"bg-white hover:bg-slate-50 text-slate-700 border border-slate-300"}`,title:"Back to Archived Subjects",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsx("span",{children:"Back"})]}),ie.length>0&&l.jsxs("button",{onClick:jC,className:`px-4 py-2.5 rounded-lg font-semibold text-sm transition-all duration-300 flex items-center justify-center space-x-2 shadow-lg hover:shadow-xl whitespace-nowrap ${A?"bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white border border-red-700":"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-400 hover:to-red-500 text-white border border-red-600"}`,title:"Permanently delete all subjects in Recycle Bin",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),l.jsx("span",{children:"Empty Recycle Bin"})]})]}),ie.length>0&&l.jsxs("div",{className:`mb-4 p-4 rounded-xl flex items-center justify-between ${A?"bg-slate-800/50 border border-slate-700":"bg-slate-50 border border-slate-200"}`,children:[l.jsx("div",{className:"flex items-center gap-3",children:l.jsx("p",{className:`text-sm font-medium ${A?"text-slate-300":"text-slate-600"}`,children:He.length>0?`${He.length} subject${He.length===1?"":"s"} selected`:"No subjects selected"})}),l.jsxs("div",{className:"flex items-center gap-2",children:[He.length>0&&l.jsxs("button",{type:"button",onClick:DC,className:`px-3 py-1.5 text-xs font-semibold rounded-lg transition-colors ${A?"bg-red-700 text-white hover:bg-red-600":"bg-red-600 text-white hover:bg-red-500"}`,children:["Delete Selected (",He.length,")"]}),l.jsx("button",{type:"button",onClick:()=>{Oe([]),it(!1)},className:`px-3 py-1.5 text-xs font-semibold rounded-lg transition-colors ${A?"bg-slate-700 text-slate-300 hover:bg-slate-600":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Clear"}),l.jsx("button",{type:"button",onClick:()=>{if(Be)Oe([]),it(!1);else{const g=ie.map(k=>k.code);Oe(g),it(!0)}},className:`px-3 py-1.5 text-xs font-semibold rounded-lg transition-colors ${A?Be?"bg-emerald-700 text-white hover:bg-emerald-600":"bg-emerald-800/50 text-emerald-300 hover:bg-emerald-700":Be?"bg-emerald-600 text-white hover:bg-emerald-500":"bg-emerald-100 text-emerald-700 hover:bg-emerald-200"}`,children:Be?"Deselect All":"Select All"})]})]}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 sm:gap-6",children:ie.map(g=>{const k=He.includes(g.code);return l.jsxs("div",{className:`group relative overflow-hidden rounded-3xl p-6 transition-all duration-300 hover:scale-[1.02] hover:shadow-2xl ${k?A?"bg-gradient-to-br from-[#2c2c2c] to-[#1f1f1f] border-2 border-emerald-500 shadow-lg shadow-emerald-500/20":"bg-gradient-to-br from-white to-slate-50 border-2 border-emerald-500 shadow-xl shadow-emerald-500/20":A?"bg-gradient-to-br from-[#2c2c2c] to-[#1f1f1f] border border-slate-700 hover:border-slate-600":"bg-gradient-to-br from-white to-slate-50 border border-red-200 hover:border-red-300 shadow-xl"}`,children:[l.jsx("div",{className:`absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-gradient-to-br ${A?"from-red-900/20 to-transparent":"from-red-50/50 to-transparent"}`}),l.jsxs("div",{className:"relative z-10 flex flex-col space-y-4",children:[l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsx("div",{className:"flex items-center mr-2",children:l.jsx("input",{type:"checkbox",checked:k,onChange:N=>{N.stopPropagation(),N.target.checked?(Oe([...He,g.code]),He.length+1===ie.length&&it(!0)):(Oe(He.filter(j=>j!==g.code)),it(!1))},className:`w-5 h-5 rounded border-2 cursor-pointer transition-all ${k?"bg-emerald-500 border-emerald-500 text-white":A?"bg-slate-700 border-slate-600 text-transparent":"bg-white border-slate-300 text-transparent"}`,style:{accentColor:k?"#10b981":void 0}})}),l.jsxs("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[l.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center shadow-lg flex-shrink-0 ${A?"bg-gradient-to-br from-red-900/40 to-red-800/20 border border-red-800/30":"bg-gradient-to-br from-red-100 to-red-50 border border-red-200"}`,children:l.jsx("svg",{className:`w-8 h-8 ${A?"text-red-400":"text-red-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),l.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[l.jsx("div",{className:`text-lg font-bold mb-1 truncate ${A?"text-white":"text-slate-800"}`,children:g.name}),l.jsxs("div",{className:`text-xs font-medium ${A?"text-slate-400":"text-slate-500"}`,children:[g.code,"  ",g.credits," Credits"]}),l.jsx("div",{className:`mt-1 px-2 py-0.5 rounded-full text-xs font-semibold inline-block w-fit ${A?"bg-red-900/30 text-red-400 border border-red-800/50":"bg-red-100 text-red-700 border border-red-200"}`,children:"In Recycle Bin"})]})]})]}),l.jsxs("div",{className:"pt-3 border-t border-slate-200 dark:border-slate-700 flex flex-col space-y-2.5",children:[l.jsxs("button",{onClick:N=>{N.stopPropagation(),$C(g.code)},className:`w-full py-2.5 px-4 rounded-xl font-bold transition-all flex items-center justify-center space-x-2 shadow-md hover:shadow-lg ${A?"bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white":"bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-400 hover:to-teal-400 text-white"}`,children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),l.jsx("span",{className:"text-sm",children:"Restore to Archived"})]}),l.jsxs("button",{onClick:N=>{N.stopPropagation(),OC(g.code)},className:`w-full py-2.5 px-4 rounded-xl font-bold transition-all flex items-center justify-center space-x-2 shadow-md hover:shadow-lg ${A?"bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white border border-red-700":"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-400 hover:to-red-500 text-white"}`,children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),l.jsx("span",{className:"text-sm",children:"Permanently Delete"})]})]})]})]},`recyclebin-${g.code}`)})})]}))]}),r==="subjects"&&E&&w&&l.jsxs("div",{className:"glass rounded-2xl shadow-xl p-4 sm:p-6 lg:p-8",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 sm:gap-0 mb-4 sm:mb-6 lg:mb-8",children:[l.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4 min-w-0 flex-1",children:[l.jsx("button",{onClick:up,className:"w-10 h-10 sm:w-12 sm:h-12 bg-slate-100 hover:bg-slate-200 rounded-xl flex items-center justify-center transition-all flex-shrink-0",children:l.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-slate-600",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M19 12H5m7-7l-7 7 7 7"})})}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("h2",{className:"text-xl sm:text-2xl lg:text-3xl font-bold textGrad truncate",children:w.name}),l.jsxs("p",{className:"text-sm sm:text-base text-slate-600 mt-1 truncate",children:[w.code,"  ",w.credits," Credits"]})]})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-4 w-full sm:w-auto",children:[l.jsxs("button",{onClick:VC,className:"bg-emerald-500 hover:bg-emerald-600 text-white px-5 sm:px-6 py-3.5 sm:py-3 rounded-xl font-semibold shadow-lg transition-all flex items-center justify-center space-x-2 text-sm sm:text-base min-h-[48px] sm:min-h-0 touch-manipulation",children:[l.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.jsx("span",{children:"Take Attendance"})]}),l.jsxs("button",{onClick:BC,className:"bg-amber-500 hover:bg-amber-600 text-white px-5 sm:px-6 py-3.5 sm:py-3 rounded-xl font-semibold shadow-lg transition-all flex items-center justify-center space-x-2 text-sm sm:text-base min-h-[48px] sm:min-h-0 touch-manipulation",children:[l.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),l.jsx("span",{children:"Manage Grades"})]})]})]}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:ae[w.code]&&ae[w.code].length>0?ae[w.code].map(g=>{const k=_e.find(N=>Re(N.id)===Re(g));return k?l.jsx("div",{className:`p-4 rounded-xl border transition-all hover:shadow-md ${A?"bg-[#1a1a1a] border-slate-700":"bg-white border-slate-200"}`,children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(lp,{student:k,className:"w-12 h-12"}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:`font-semibold truncate ${A?"text-white":"text-slate-800"}`,children:k.name}),l.jsxs("p",{className:`text-xs truncate ${A?"text-slate-400":"text-slate-500"}`,children:["ID: ",k.id]})]})]})},g):null}):l.jsx("div",{className:`col-span-3 text-center py-8 ${A?"text-slate-400":"text-slate-500"}`,children:"No students enrolled in this subject yet."})})]}),r==="attendance"&&!we&&l.jsx("div",{className:"glass rounded-2xl shadow-xl p-8",children:l.jsxs("div",{className:"text-center py-12",children:[l.jsx("p",{className:"text-slate-600 text-lg mb-4",children:"No subject selected"}),l.jsx("p",{className:"text-slate-500",children:'Click on a subject and then click "Take Attendance" to manage attendance'})]})}),r==="attendance"&&we&&l.jsxs("div",{className:`glass rounded-2xl shadow-xl p-4 sm:p-6 lg:p-8 ${A?"bg-[#1a1a1a]":""}`,children:[l.jsxs("div",{className:"flex items-center justify-between space-x-3 sm:space-x-4 mb-4 sm:mb-5 lg:mb-6",children:[l.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4 min-w-0 flex-1",children:[l.jsx("button",{onClick:up,className:"w-10 h-10 sm:w-11 sm:h-11 lg:w-12 lg:h-12 bg-slate-100 hover:bg-slate-200 rounded-lg sm:rounded-xl flex items-center justify-center transition-all flex-shrink-0",children:l.jsx("svg",{className:"w-5 h-5 sm:w-5 sm:h-5 lg:w-6 lg:h-6 text-slate-600",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M19 12H5m7-7l-7 7 7 7"})})}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("h2",{className:"text-xl sm:text-2xl lg:text-3xl font-bold textGrad break-words",children:we.name}),l.jsxs("p",{className:`text-sm sm:text-base mt-1 ${A?"text-slate-300":"text-slate-600"}`,children:[we.code,"  ",we.credits," Credits"]})]})]}),l.jsxs("button",{onClick:YC,className:"bg-slate-100 hover:bg-slate-200 text-slate-700 px-4 sm:px-5 py-2 sm:py-2.5 rounded-lg sm:rounded-xl font-semibold shadow-md hover:shadow-lg transition-all duration-300 flex items-center space-x-2 text-sm sm:text-base flex-shrink-0",children:[l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),l.jsx("span",{className:"hidden sm:inline",children:"Export CSV"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-3 sm:gap-4 lg:gap-4 mb-5 sm:mb-6 lg:mb-8",children:[l.jsx("div",{className:"timeBox rounded-lg sm:rounded-xl px-3 sm:px-4 lg:px-5 xl:px-6 py-2.5 sm:py-3 lg:py-3.5 xl:py-4 shadow-lg",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"flex items-center justify-center space-x-1.5 sm:space-x-2 mb-1",children:[l.jsx("div",{className:"w-1.5 h-1.5 indicator rounded-full"}),l.jsx("div",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Live Time"})]}),l.jsx("div",{className:"dateText text-sm sm:text-base mb-0.5",children:ZC()}),l.jsx("div",{className:"timeText text-base sm:text-lg",children:qe}),l.jsx("div",{className:"text-[10px] sm:text-xs text-slate-400 mt-0.5 font-medium",children:l.jsx("span",{children:Intl.DateTimeFormat().resolvedOptions().timeZone||"UTC+8"})})]})}),l.jsxs("div",{className:"flex flex-col space-y-1.5",children:[l.jsx("label",{htmlFor:"attendance-date",className:`text-xs sm:text-sm font-medium ${A?"text-slate-300":"text-slate-600"}`,children:"Attendance Date"}),l.jsx("input",{id:"attendance-date",name:"attendance-date",type:"date",value:ht,onChange:g=>Qe(g.target.value),className:`form-input-field focus:ring-2 focus:ring-maroon-500 text-sm sm:text-base py-2 ${A?"bg-[#2c2c2c] text-white border-slate-600":""}`}),l.jsx("div",{className:`text-[10px] sm:text-xs text-center ${A?"text-slate-400":"text-slate-500"}`,children:l.jsx("span",{children:eN()})})]}),l.jsxs("div",{className:"flex flex-col items-stretch lg:items-center space-y-1.5 sm:space-y-2 lg:col-span-1",children:[l.jsxs("div",{className:`flex items-center justify-center lg:justify-start space-x-1.5 sm:space-x-2 text-xs ${A?"text-slate-400":"text-slate-500"}`,children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),l.jsx("span",{children:"Auto-saving"})]}),l.jsxs("button",{onClick:qC,className:"bg-emerald-500 hover:bg-emerald-600 text-white px-5 sm:px-6 py-2.5 sm:py-3 rounded-lg sm:rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center space-x-2 text-sm sm:text-base w-full",children:[l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M5 13l4 4L19 7"})}),l.jsx("span",{children:"Save Attendance"})]})]})]}),(()=>{const g=WC();return l.jsxs("div",{className:"mb-4 sm:mb-5 lg:mb-6 grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[l.jsx("div",{className:`border rounded-lg sm:rounded-xl p-3 sm:p-3.5 lg:p-4 ${A?"bg-emerald-900/20 border-emerald-700/50":"bg-emerald-50 border-emerald-200"}`,children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"min-w-0",children:[l.jsx("p",{className:`font-medium text-xs sm:text-sm ${A?"text-emerald-400":"text-emerald-600"}`,children:"Present"}),l.jsx("p",{className:`text-xl sm:text-2xl font-bold ${A?"text-emerald-300":"text-emerald-800"}`,children:g.present})]}),l.jsx("div",{className:`w-9 h-9 sm:w-10 sm:h-10 rounded-full flex items-center justify-center flex-shrink-0 ${A?"bg-emerald-800/30":"bg-emerald-100"}`,children:l.jsx("svg",{className:`w-4 h-4 sm:w-5 sm:h-5 ${A?"text-emerald-400":"text-emerald-600"}`,fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),l.jsx("div",{className:`border rounded-lg sm:rounded-xl p-3 sm:p-3.5 lg:p-4 ${A?"bg-red-900/20 border-red-700/50":"bg-red-50 border-red-200"}`,children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"min-w-0",children:[l.jsx("p",{className:`font-medium text-xs sm:text-sm ${A?"text-red-400":"text-red-600"}`,children:"Absent"}),l.jsx("p",{className:`text-xl sm:text-2xl font-bold ${A?"text-red-300":"text-red-800"}`,children:g.absent})]}),l.jsx("div",{className:`w-9 h-9 sm:w-10 sm:h-10 rounded-full flex items-center justify-center flex-shrink-0 ${A?"bg-red-800/30":"bg-red-100"}`,children:l.jsx("svg",{className:`w-4 h-4 sm:w-5 sm:h-5 ${A?"text-red-400":"text-red-600"}`,fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),l.jsx("div",{className:`border rounded-lg sm:rounded-xl p-3 sm:p-3.5 lg:p-4 ${A?"bg-blue-900/20 border-blue-700/50":"bg-blue-50 border-blue-200"}`,children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"min-w-0",children:[l.jsx("p",{className:`font-medium text-xs sm:text-sm ${A?"text-blue-400":"text-blue-600"}`,children:"Total Students"}),l.jsx("p",{className:`text-xl sm:text-2xl font-bold ${A?"text-blue-300":"text-blue-800"}`,children:g.total})]}),l.jsx("div",{className:`w-9 h-9 sm:w-10 sm:h-10 rounded-full flex items-center justify-center flex-shrink-0 ${A?"bg-blue-800/30":"bg-blue-100"}`,children:l.jsx("svg",{className:`w-4 h-4 sm:w-5 sm:h-5 ${A?"text-blue-400":"text-blue-600"}`,fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"})})})]})}),l.jsx("div",{className:`border rounded-lg sm:rounded-xl p-3 sm:p-3.5 lg:p-4 ${A?"bg-amber-900/20 border-amber-700/50":"bg-amber-50 border-amber-200"}`,children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"min-w-0",children:[l.jsx("p",{className:`font-medium text-xs sm:text-sm ${A?"text-amber-400":"text-amber-600"}`,children:"Attendance Rate"}),l.jsxs("p",{className:`text-xl sm:text-2xl font-bold ${A?"text-amber-300":"text-amber-800"}`,children:[g.rate,"%"]})]}),l.jsx("div",{className:`w-9 h-9 sm:w-10 sm:h-10 rounded-full flex items-center justify-center flex-shrink-0 ${A?"bg-amber-800/30":"bg-amber-100"}`,children:l.jsx("svg",{className:`w-4 h-4 sm:w-5 sm:h-5 ${A?"text-amber-400":"text-amber-600"}`,fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]})})]})})(),l.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[we&&ae[we.code]&&ae[we.code].length>0&&!GC()&&l.jsx("div",{className:"mb-3 sm:mb-4",children:l.jsxs("button",{onClick:HC,className:"bg-emerald-500 hover:bg-emerald-600 text-white px-5 sm:px-6 py-2.5 sm:py-3 rounded-lg sm:rounded-xl font-semibold shadow-md hover:shadow-lg transition-all duration-300 flex items-center space-x-2 text-sm sm:text-base w-full sm:w-auto justify-center",children:[l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.jsx("span",{children:"Select All Present"})]})}),we&&ae[we.code]&&ae[we.code].length>0?ae[we.code].map(g=>{const k=_e.find(j=>Re(j.id)===Re(g));if(!k)return null;const N=zC(g);return l.jsxs("div",{className:`flex flex-col sm:flex-row sm:justify-between sm:items-center border rounded-lg sm:rounded-xl p-3.5 sm:p-4 transition-all hover:shadow-md gap-3 ${A?"bg-[#1a1a1a] border-slate-700":"bg-white border-slate-200"}`,children:[l.jsxs("div",{className:"flex items-center space-x-3 flex-grow min-w-0",children:[l.jsx(lp,{student:k,className:"w-11 h-11 sm:w-12 sm:h-12 flex-shrink-0"}),l.jsxs("div",{className:"flex-grow min-w-0",children:[l.jsx("p",{className:`font-semibold truncate text-sm sm:text-base ${A?"text-white":"text-slate-800"}`,children:k.name}),l.jsxs("p",{className:`text-xs sm:text-sm truncate ${A?"text-slate-400":"text-slate-500"}`,children:["ID: ",k.id]})]})]}),l.jsxs("div",{className:"flex space-x-2 sm:flex-shrink-0",children:[l.jsx("button",{onClick:()=>wy(g,"present"),className:`flex-1 sm:flex-none sm:w-20 lg:w-24 px-4 sm:px-4 py-2.5 sm:py-2.5 rounded-lg sm:rounded-xl text-xs sm:text-sm font-medium transition-all ${N==="present"?A?"bg-emerald-600 text-white":"bg-emerald-100 text-emerald-700":A?"bg-slate-700 text-slate-300 hover:bg-slate-600":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Present"}),l.jsx("button",{onClick:()=>wy(g,"absent"),className:`flex-1 sm:flex-none sm:w-20 lg:w-24 px-4 sm:px-4 py-2.5 sm:py-2.5 rounded-lg sm:rounded-xl text-xs sm:text-sm font-medium transition-all ${N==="absent"?A?"bg-red-600 text-white":"bg-red-100 text-red-700":A?"bg-slate-700 text-slate-300 hover:bg-slate-600":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Absent"})]})]},g)}):l.jsx("div",{className:"text-center text-slate-500 py-8",children:"No students enrolled in this subject."})]})]}),r==="grades"&&!we&&l.jsx("div",{className:"glass rounded-2xl shadow-xl p-8",children:l.jsxs("div",{className:"text-center py-12",children:[l.jsx("p",{className:"text-slate-600 text-lg mb-4",children:"No subject selected"}),l.jsx("p",{className:"text-slate-500",children:'Click on a subject and then click "Manage Grades" to enter grades'})]})}),r==="grades"&&we&&l.jsxs("div",{className:"glass rounded-2xl shadow-xl p-8",children:[l.jsxs("div",{className:"flex items-center justify-between mb-8",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:up,className:"w-12 h-12 bg-slate-100 hover:bg-slate-200 rounded-xl flex items-center justify-center transition-all",children:l.jsx("svg",{className:"w-6 h-6 text-slate-600",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M19 12H5m7-7l-7 7 7 7"})})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-bold textGrad",children:we.name}),l.jsxs("p",{className:"text-slate-600 mt-1",children:[we.code,"  ",we.credits," Credits"]})]})]}),l.jsx("div",{className:"ml-auto relative",children:l.jsxs("button",{onClick:JC,className:"bg-white border border-slate-200 hover:bg-slate-50 text-slate-700 px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M5 20h14v-2H5v2zM12 2v12l4-4h-3V2h-2v8H8l4 4z"})}),l.jsx("span",{children:"Export CSV (Excel)"})]})})]}),l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:`rounded-2xl p-6 mb-6 ${A?"bg-[#1a1a1a]":"bg-white"} shadow-md`,children:[l.jsx("h3",{className:`text-lg font-bold mb-4 ${A?"text-white":"text-maroon-800"}`,children:"Quick Grade Entry"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"quick-grade-type",className:"sr-only",children:"Grade Type"}),l.jsxs("select",{id:"quick-grade-type",name:"quick-grade-type",value:Mt,onChange:g=>Ot(g.target.value),className:`form-select-field-red focus:ring-2 focus:ring-maroon-500 ${A?"bg-[#1a1a1a] border-slate-600 text-white":""}`,children:[l.jsx("option",{value:"quiz",children:" Quiz"}),l.jsx("option",{value:"exam",children:" Exam"}),l.jsx("option",{value:"laboratory",children:" Laboratory"}),l.jsx("option",{value:"assignment",children:" Assignment"}),l.jsx("option",{value:"research",children:" Research"}),l.jsx("option",{value:"project",children:" Project"})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"quick-grade-title",className:"sr-only",children:"Grade Title"}),l.jsx("input",{id:"quick-grade-title",name:"quick-grade-title",type:"text",value:er,onChange:g=>jt(g.target.value),placeholder:"QUIZ1",className:`form-input-field-red focus:ring-2 focus:ring-maroon-500 ${A?"bg-[#1a1a1a] border-slate-600 text-white placeholder:text-slate-400":""}`})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"quick-grade-max-points",className:"sr-only",children:"Max Points"}),l.jsx("input",{id:"quick-grade-max-points",name:"quick-grade-max-points",type:"number",value:lr,onChange:g=>Nr(g.target.value),placeholder:"20",min:"1",max:"1000",className:`form-input-field-red focus:ring-2 focus:ring-maroon-500 ${A?"bg-[#1a1a1a] border-slate-600 text-white placeholder:text-slate-400":""}`})]}),l.jsx("button",{onClick:KC,className:"btn text-white px-6 py-3 rounded-xl font-semibold shadowLg transition-all",children:"Start Entry"})]})]}),mn&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h4",{className:`text-lg font-semibold ${A?"text-white":"text-slate-800"}`,children:"Enter Grades"}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx("button",{onClick:QC,className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${A?"bg-red-900/50 hover:bg-red-900/70 text-red-200":"bg-red-100 hover:bg-red-200 text-red-700"}`,children:"Fill All Same Score"}),l.jsx("button",{onClick:XC,disabled:x,className:`px-6 py-3 rounded-xl font-semibold shadowLg transition-all ${H==="success"?"bg-green-500 text-white":H==="error"?"bg-red-500 text-white":x?"bg-emerald-400 text-white cursor-not-allowed":"bg-emerald-500 hover:bg-emerald-600 text-white"}`,children:H==="success"?l.jsxs("span",{className:"flex items-center gap-2",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Grades Saved!"]}):H==="error"?l.jsxs("span",{className:"flex items-center gap-2",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Save Failed"]}):x?l.jsxs("span",{className:"flex items-center gap-2",children:[l.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save All Grades"})]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:`min-w-full border rounded-xl overflow-hidden ${A?"border-slate-700":"border-slate-200"}`,children:[l.jsx("thead",{className:A?"bg-[#7A1315]":"bg-slate-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:`px-3 py-2 text-left text-xs font-semibold border-b ${A?"text-white border-slate-600":"text-slate-600 border-slate-200"}`,children:"Student ID"}),l.jsx("th",{className:`px-3 py-2 text-left text-xs font-semibold border-b ${A?"text-white border-slate-600":"text-slate-600 border-slate-200"}`,children:"Student Name"}),l.jsx("th",{className:`px-3 py-2 text-left text-xs font-semibold border-b ${A?"text-white border-slate-600":"text-slate-600 border-slate-200"}`,children:"Score"})]})}),l.jsx("tbody",{children:we&&ae[we.code]&&ae[we.code].map((g,k)=>{const N=_e.find(j=>Re(j.id)===Re(g));return N?l.jsxs("tr",{className:A&&k%2===0||A?"bg-[#1a1a1a]":"",children:[l.jsx("td",{className:`px-3 py-2 text-sm border-b ${A?"text-white border-slate-700":"text-slate-700 border-slate-200"}`,children:N.id}),l.jsx("td",{className:`px-3 py-2 text-sm border-b ${A?"text-white border-slate-700":"text-slate-700 border-slate-200"}`,children:N.name}),l.jsx("td",{className:`px-3 py-2 border-b ${A?"border-slate-700":"border-slate-200"}`,children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsxs("label",{htmlFor:`grade-score-${g}`,className:"sr-only",children:["Score for ",N.name]}),l.jsx("input",{id:`grade-score-${g}`,name:`grade-score-${g}`,type:"number",value:Lr[g]||"",onChange:j=>Bt(P=>({...P,[g]:j.target.value})),placeholder:"Score",className:`w-32 border rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-maroon-500 ${(()=>{const j=parseFloat(Lr[g]),P=parseFloat(lr);return!isNaN(j)&&!isNaN(P)&&j>P?A?"bg-[#1a1a1a] border-red-500 text-white focus:ring-red-500":"bg-red-50 border-red-500 text-red-900 focus:ring-red-500":A?"bg-[#1a1a1a] border-slate-600 text-white":"bg-white border-slate-300"})()}`})]}),(()=>{const j=parseFloat(Lr[g]),P=parseFloat(lr);return!isNaN(j)&&!isNaN(P)&&j>P?l.jsxs("span",{className:`text-xs font-medium whitespace-nowrap ${A?"text-red-400":"text-red-600"}`,title:`Score exceeds maximum of ${P}`,children:["Max: ",P]}):null})()]})})]},g):null})})]})})]})]})]}),r==="students"&&l.jsxs("div",{className:"glass rounded-2xl shadow-xl p-8",children:[l.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 mb-8",children:[l.jsxs("div",{children:[l.jsx("h2",{className:`text-2xl font-bold ${A?"text-white":"text-slate-800"}`,children:"Student Management"}),l.jsx("p",{className:`mt-1 ${A?"text-slate-300":"text-slate-600"}`,children:"Manage student profiles and information"})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 w-full lg:w-auto",children:[l.jsxs("div",{className:"relative flex-1 sm:flex-initial sm:w-64",children:[l.jsx("input",{type:"text",placeholder:"Search by name or ID...",value:Dt,onChange:g=>Tt(g.target.value),className:`w-full px-4 py-2.5 rounded-xl border focus:ring-2 focus:ring-maroon-500 focus:outline-none ${A?"bg-[#1a1a1a] text-white border-slate-600 placeholder-slate-400":"bg-white text-slate-800 border-slate-300 placeholder-slate-400"}`}),l.jsx("svg",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),l.jsx("label",{htmlFor:"student-subject-filter",className:"sr-only",children:"Filter by Subject"}),l.jsxs("select",{id:"student-subject-filter",name:"student-subject-filter",value:ut,onChange:g=>Vs(g.target.value),className:`subject-filter-select focus:ring-2 focus:ring-maroon-500 px-4 py-2.5 rounded-xl ${A?"bg-[#1a1a1a] text-white border-slate-600":"bg-white text-slate-800 border-slate-300"}`,children:[l.jsx("option",{value:"",children:"All Subjects"}),me.map(g=>l.jsxs("option",{value:g.code,children:[g.code,"  ",g.name]},g.code))]}),l.jsxs("button",{onClick:()=>{gn({id:"",name:"",email:"",subjects:[]}),Ur("import"),Zt(null),or([]),$n(!0)},className:"btn text-white px-6 py-2.5 rounded-xl font-semibold shadowLg hover:shadow-xl transition-all duration-300 flex items-center justify-center space-x-2",children:[l.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 4v16m8-8H4"})}),l.jsx("span",{children:"Add Student"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[me.filter(g=>!ut||g.code===ut).map(g=>{const N=(ae[g.code]||[]).map(Re).filter(Boolean);if(N.length>0){const D=N.map(M=>{const q=_e.find(ce=>Re(ce.id)===M)||vr[M];return q?{id:M,name:q.name,found:!0}:{id:M,found:!1}}),U=N.filter(M=>!(_e.find(ce=>Re(ce.id)===M)||vr[M]));console.log(` Subject ${g.code} (${g.name}):`,{enrolledStudentIds:N,totalStudentsInSystem:_e.length,foundCount:D.filter(M=>M.found).length,missingCount:U.length,foundStudents:D,missingIds:U,allStudentIds:_e.map(M=>Re(M.id))}),U.length>0&&console.warn(` Missing ${U.length} students for ${g.code}:`,U)}const j=N.map(D=>{let U=_e.find(M=>Re(M.id)===D);return U||(U=vr[D]),U||(console.error(` CRITICAL: Student ID ${D} is enrolled in ${g.code} but not found in students array`,{enrollmentId:D,subjectCode:g.code,totalStudents:_e.length,studentIds:_e.map(M=>Re(M.id)),enrollments:N,studentsByIdKeys:Object.keys(vr),studentsArray:_e.map(M=>({id:Re(M.id),name:M.name}))}),null)}).filter(Boolean).filter(D=>{const U=(D.archivedSubjects||[]).includes(g.code);return U&&console.log(` Student ${D.name} (${D.id}) is archived from ${g.code}`),!U});if(N.length>j.length){const D=N.filter(U=>!j.find(q=>Re(q.id)===U));D.length>0&&console.warn(` Subject ${g.code} is missing ${D.length} enrolled students (this may be a temporary sync issue):`,{missingIds:D,enrolledCount:N.length,displayedCount:j.length})}const P=j;if(N.length>0){const D=N.filter(U=>!vr[U]&&!_e.find(M=>Re(M.id)===U));if(D.length>0)console.warn(` Subject ${g.code} has ${D.length} enrolled students not found in students array:`,{missingStudentIds:D,totalEnrollments:N.length,displayedStudents:P.length,studentsInSystem:_e.length,studentsByIdKeys:Object.keys(vr)});else if(P.length!==N.length){const U=Math.abs(N.length-P.length);U>1&&console.warn(` Subject ${g.code} enrollment count mismatch:`,{enrollments:N.length,displayed:P.length,difference:U})}else console.log(` Subject ${g.code}: All ${N.length} enrolled students found and displayed`)}return l.jsxs("div",{className:"glass card shadowLg p-6 rounded-2xl flex flex-col space-y-4",children:[l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl font-bold text-slate-800",children:g.name}),l.jsxs("p",{className:"text-sm font-medium text-slate-500 mt-1",children:[g.code,"  ",g.credits," Credits"]})]}),l.jsx("div",{className:"flex items-center",children:l.jsx("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center border bg-transparent border-red-200",children:l.jsx("img",{src:J_,alt:"Subject icon",className:"w-full h-full rounded-2xl object-cover"})})})]}),l.jsxs("div",{className:"mt-2",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsxs("h4",{className:"font-semibold text-slate-700",children:["Current Students (",P.filter(D=>{var ce,se;if(Dt.trim()==="")return!0;const U=Dt.toLowerCase().trim(),M=((ce=D.name)==null?void 0:ce.toLowerCase().includes(U))||!1,q=((se=D.id)==null?void 0:se.toString().includes(U))||!1;return M||q}).length,Dt.trim()!==""&&P.length>0?` of ${P.length}`:"",")"]}),l.jsx("button",{onClick:()=>{ni(g.code),at([]),ur({id:"",name:"",email:""}),ra(!0)},className:"text-sm text-green-600 hover:text-green-800 font-semibold",children:"Add Student"})]}),l.jsx("div",{className:"space-y-2 max-h-72 overflow-y-auto pr-1",children:P.filter(D=>{var ce,se;if(Dt.trim()==="")return!0;const U=Dt.toLowerCase().trim(),M=((ce=D.name)==null?void 0:ce.toLowerCase().includes(U))||!1,q=((se=D.id)==null?void 0:se.toString().includes(U))||!1;return M||q}).length>0?P.filter(D=>{var ce,se;if(Dt.trim()==="")return!0;const U=Dt.toLowerCase().trim(),M=((ce=D.name)==null?void 0:ce.toLowerCase().includes(U))||!1,q=((se=D.id)==null?void 0:se.toString().includes(U))||!1;return M||q}).map(D=>l.jsxs("div",{className:"flex items-center justify-between bg-slate-50 p-3 rounded-lg",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm text-slate-700",children:D.name}),l.jsxs("div",{className:"text-xs text-slate-500",children:["ID: ",D.id]})]}),l.jsx("div",{className:"flex items-center",children:l.jsx("button",{onClick:()=>fN(D.id,g.code),disabled:!!st[`${g.code}-${Re(D.id)}`],className:`text-red-500 hover:text-red-700 font-semibold px-2 py-1 rounded bg-white/80 border border-slate-200 transition ${st[`${g.code}-${Re(D.id)}`]?"opacity-50 cursor-not-allowed":""}`,title:"Archive Student",children:st[`${g.code}-${Re(D.id)}`]?"Archiving":""})})]},D.id)):l.jsx("div",{className:"text-sm text-slate-500 p-3 bg-slate-50 rounded-lg text-center",children:Dt.trim()!==""?`No students found matching "${Dt}"`:"No enrolled students."})})]})]},`${g.code}-${P.length}-${P.map(D=>D.id).join(",")}-${Di}`)}),me.filter(g=>!ut||g.code===ut).length===0&&l.jsx("div",{className:"col-span-3 text-center text-slate-500 py-8",children:"No subjects found."})]})]})]}):lN()}),h&&l.jsx("div",{className:"fixed inset-0 modal items-center justify-center z-50 p-3 sm:p-4 flex",onClick:()=>m(!1),children:l.jsxs("div",{className:`glass rounded-2xl p-4 sm:p-6 md:p-8 w-full max-w-md shadow-2xl ${A?"bg-[#1a1a1a]":""}`,onClick:g=>g.stopPropagation(),children:[l.jsxs("div",{className:"text-center mb-4 sm:mb-6",children:[l.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 primary rounded-2xl flex items-center justify-center mx-auto mb-3 sm:mb-4",children:l.jsx("svg",{className:"w-6 h-6 sm:w-8 sm:h-8 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"})})}),l.jsx("h3",{className:`text-xl sm:text-2xl font-bold mb-2 ${A?"text-white":"text-slate-800"}`,children:"Add New Subject"}),l.jsx("p",{className:`text-sm sm:text-base ${A?"text-slate-300":"text-slate-600"}`,children:"Create a new academic subject"})]}),l.jsxs("form",{onSubmit:AC,className:"space-y-5",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"subject-code",className:"sr-only",children:"Subject Code"}),l.jsx("input",{id:"subject-code",name:"subject-code",type:"text",value:J.code,onChange:g=>Z(k=>({...k,code:g.target.value})),placeholder:"Subject Code",className:"form-input-field focus:ring-2 focus:ring-maroon-500",required:!0,disabled:O})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"subject-name",className:"sr-only",children:"Subject Name"}),l.jsx("input",{id:"subject-name",name:"subject-name",type:"text",value:J.name,onChange:g=>Z(k=>({...k,name:g.target.value})),placeholder:"Subject Name",className:"form-input-field focus:ring-2 focus:ring-maroon-500",required:!0,disabled:O})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"subject-credits",className:"sr-only",children:"Credits"}),l.jsx("input",{id:"subject-credits",name:"subject-credits",type:"text",value:J.credits,onChange:g=>Z(k=>({...k,credits:g.target.value})),placeholder:"Credits",className:"form-input-field focus:ring-2 focus:ring-maroon-500",required:!0,disabled:O})]}),l.jsxs("div",{children:[l.jsx("label",{className:`block text-sm font-medium mb-2 ${A?"text-slate-300":"text-slate-700"}`,children:"Term"}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{type:"button",onClick:()=>Z(g=>({...g,term:"first"})),disabled:O,className:`flex-1 px-4 py-3 rounded-lg font-semibold transition-all ${J.term==="first"?"bg-[#7A1315] text-white shadow-lg":A?"bg-[#2c2c2c] text-slate-300 border border-slate-600 hover:bg-[#3c3c3c] hover:border-slate-500":"bg-slate-100 text-slate-700 border border-slate-300 hover:bg-slate-200"} ${O?"opacity-50 cursor-not-allowed":""}`,children:"1st Term"}),l.jsx("button",{type:"button",onClick:()=>Z(g=>({...g,term:"second"})),disabled:O,className:`flex-1 px-4 py-3 rounded-lg font-semibold transition-all ${J.term==="second"?"bg-[#7A1315] text-white shadow-lg":A?"bg-[#2c2c2c] text-slate-300 border border-slate-600 hover:bg-[#3c3c3c] hover:border-slate-500":"bg-slate-100 text-slate-700 border border-slate-300 hover:bg-slate-200"} ${O?"opacity-50 cursor-not-allowed":""}`,children:"2nd Term"})]})]}),F&&l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-start space-x-3 animate-fade-in",children:[l.jsx("svg",{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),l.jsx("p",{className:"text-red-800 font-medium text-sm flex-1",children:F})]}),l.jsxs("div",{className:"flex justify-end space-x-4 mt-8",children:[l.jsx("button",{type:"button",onClick:()=>{m(!1),V(""),ct(!1),Z({code:"",name:"",credits:"",term:"first"})},className:"px-6 py-3 text-slate-600 hover:text-slate-800 font-medium rounded-xl hover:bg-slate-100 transition-all disabled:opacity-50 disabled:cursor-not-allowed",disabled:O,children:"Cancel"}),l.jsx("button",{type:"submit",className:"btn text-white px-6 py-3 rounded-xl font-semibold shadowLg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",disabled:O,children:O?"Saving...":"Add Subject"})]})]})]})}),u&&l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-3 sm:p-4",onClick:()=>{d(!1),L(!1),ii("account")},children:l.jsxs("div",{className:`w-full max-w-6xl max-h-[90vh] overflow-hidden rounded-2xl shadow-2xl flex flex-col lg:flex-row ${A?"bg-[#1a1a1a]":"bg-white"}`,onClick:g=>g.stopPropagation(),children:[l.jsxs("div",{className:`lg:w-80 flex-shrink-0 ${A?"bg-[#7A1315]":"bg-gradient-to-b from-[#7A1315] to-red-800"} flex flex-col`,children:[l.jsxs("div",{className:"p-4 sm:p-6 md:p-8 flex flex-col items-center border-b border-red-900/30",children:[l.jsxs("div",{className:"relative mb-3 sm:mb-4 group",children:[l.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 md:w-28 md:h-28 rounded-full border-4 border-white shadow-xl bg-gradient-to-br from-red-600 to-[#7A1315] flex items-center justify-center overflow-hidden",children:cc||i?l.jsx("img",{src:cc||i,alt:"Profile",className:"w-full h-full object-cover"}):l.jsx("span",{className:"text-white text-xl sm:text-2xl md:text-3xl font-semibold tracking-wide",children:cp(_.name||s)})}),l.jsxs("label",{className:"absolute inset-0 rounded-full bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer flex items-center justify-center",children:[l.jsx("span",{className:"text-white text-xs font-medium",children:"Change Photo"}),l.jsx("input",{type:"file",accept:"image/*",onChange:g=>yy(g.target.files[0]),className:"absolute inset-0 opacity-0 cursor-pointer",disabled:C})]})]}),l.jsx("h3",{className:"text-white font-bold text-lg sm:text-xl md:text-2xl text-center mb-1 sm:mb-2 px-2 break-words text-white",children:_.name||s}),l.jsx("p",{className:"text-red-100 text-xs sm:text-sm font-medium mb-1 text-center",children:"Professor"}),l.jsx("p",{className:"text-red-200 text-[10px] sm:text-xs text-center px-2 break-words",children:lo||"Institutional Email"})]}),l.jsxs("nav",{className:"flex lg:flex-col flex-row overflow-x-auto lg:overflow-y-auto py-2 sm:py-4",children:[l.jsxs("button",{onClick:()=>ii("account"),className:`w-full lg:w-full px-6 py-4 text-left text-white font-medium transition-all flex items-center space-x-3 ${dl==="account"?"bg-red-900/50 border-l-4 border-red-400":"hover:bg-red-900/30"}`,children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),l.jsx("span",{children:"Account Settings"})]}),l.jsxs("button",{onClick:()=>ii("appearance"),className:`w-full lg:w-full px-6 py-4 text-left text-white font-medium transition-all flex items-center space-x-3 ${dl==="appearance"?"bg-red-900/50 border-l-4 border-red-400":"hover:bg-red-900/30"}`,children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})}),l.jsx("span",{children:"Appearance"})]})]}),l.jsx("div",{className:"p-4 border-t border-red-900/30",children:l.jsx("button",{onClick:()=>{d(!1),L(!1),ii("account")},className:"w-full px-4 py-2 bg-red-900/50 hover:bg-red-900/70 text-white font-medium rounded-lg transition-all",children:"Close Profile"})})]}),l.jsx("div",{className:`flex-1 overflow-y-auto ${A?"bg-[#1a1a1a]":"bg-white"}`,children:l.jsxs("div",{className:"max-w-4xl mx-auto p-6 lg:p-8",children:[dl==="account"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:`text-3xl font-bold mb-2 ${A?"text-white":"text-slate-800"}`,children:"Account Settings"}),l.jsx("p",{className:A?"text-slate-300":"text-slate-600",children:"Manage your personal information and security"})]}),l.jsxs("div",{className:`rounded-2xl shadow-lg border p-6 ${A?"bg-[#1a1a1a] border-slate-700":"bg-white border-slate-200"}`,children:[l.jsx("h3",{className:`text-xl font-bold mb-4 ${A?"text-white":"text-slate-800"}`,children:"Personal Information"}),l.jsxs("form",{onSubmit:gN,className:"space-y-5",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"profile-name",className:`block text-sm font-semibold mb-2 ${A?"text-white":"text-slate-700"}`,children:"Name"}),l.jsx("input",{id:"profile-name",name:"profile-name",type:"text",value:_.name,onChange:g=>I(k=>({...k,name:g.target.value})),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-[#7A1315] ${A?"bg-[#1a1a1a] border-[#7A1315] text-white":"bg-white border-slate-300 text-slate-800"}`,required:!0,disabled:C})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"profile-email",className:`block text-sm font-semibold mb-2 ${A?"text-white":"text-slate-700"}`,children:"University Email"}),l.jsx("input",{id:"profile-email",name:"profile-email",type:"email",value:lo||"",disabled:!0,className:`w-full px-4 py-3 border rounded-lg ${A?"bg-[#1a1a1a] border-slate-600 text-slate-400":"bg-slate-50 border-slate-300 text-slate-600"}`}),l.jsx("small",{className:`text-xs mt-1 block ${A?"text-slate-400":"text-slate-500"}`,children:"Your institutional email address"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"profile-picture",className:`block text-sm font-semibold mb-2 ${A?"text-slate-200":"text-slate-700"}`,children:"Profile Picture"}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("input",{id:"profile-picture",name:"profile-picture",type:"file",accept:"image/*",onChange:g=>yy(g.target.files[0]),className:"file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-[#7A1315] file:text-white hover:file:bg-red-800",disabled:C}),(cc||i)&&l.jsx("button",{type:"button",onClick:kC,disabled:C,className:`px-4 py-2 rounded-lg text-sm font-semibold transition-all ${A?"bg-slate-700 text-slate-200 hover:bg-slate-600":"bg-slate-100 text-slate-700 hover:bg-slate-200"} disabled:opacity-50 disabled:cursor-not-allowed`,children:"Remove Photo"})]}),l.jsx("small",{className:`block text-xs mt-1 ${A?"text-slate-400":"text-slate-500"}`,children:"Choose a square image for best results"})]}),C&&l.jsxs("div",{className:`rounded-xl p-4 flex items-center space-x-3 border ${A?"bg-emerald-900/30 border-emerald-700":"bg-emerald-50 border-emerald-200"}`,children:[l.jsx("svg",{className:`w-5 h-5 flex-shrink-0 ${A?"text-emerald-400":"text-emerald-600"}`,fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),l.jsx("p",{className:`font-medium ${A?"text-emerald-300":"text-emerald-800"}`,children:"Profile updated successfully!"})]}),l.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>{d(!1),L(!1),ii("account")},className:`px-5 py-2 rounded-xl font-semibold ${A?"bg-slate-700 text-slate-200 hover:bg-slate-600":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"Cancel"}),l.jsx("button",{type:"submit",className:"px-6 py-2 rounded-xl bg-[#7A1315] text-white font-semibold hover:bg-red-800 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed relative z-10",disabled:C,children:C?"Saved!":"Save Changes"})]})]})]})]}),dl==="appearance"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:`text-3xl font-bold mb-2 ${A?"text-white":"text-slate-800"}`,children:"Appearance"}),l.jsx("p",{className:A?"text-slate-300":"text-slate-600",children:"Customize your interface theme and display preferences"})]}),l.jsxs("div",{className:`rounded-2xl shadow-lg border p-6 ${A?"bg-[#1a1a1a] border-slate-700":"bg-white border-slate-200"}`,children:[l.jsx("h3",{className:`text-xl font-bold mb-4 ${A?"text-white":"text-slate-800"}`,children:"Interface Theme"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:`flex items-center justify-between p-4 rounded-xl border ${A?"bg-[#1a1a1a] border-slate-700":"bg-slate-50 border-slate-200"}`,children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[A?l.jsx("svg",{className:"w-8 h-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}):l.jsx("svg",{className:"w-8 h-8 text-[#7A1315]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),l.jsxs("div",{children:[l.jsx("p",{className:`font-semibold ${A?"text-white":"text-slate-800"}`,children:A?"Dark Mode":"Light Mode"}),l.jsx("p",{className:`text-sm ${A?"text-slate-400":"text-slate-600"}`,children:A?"Dark theme for reduced eye strain":"Light theme for better visibility"})]})]}),l.jsx("button",{type:"button",onClick:ci,className:`relative inline-flex h-8 w-16 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-[#7A1315] focus:ring-offset-2 ${A?"bg-[#7A1315]":"bg-slate-300"}`,"aria-label":"Toggle dark mode",children:l.jsx("span",{className:`inline-block h-6 w-6 transform rounded-full bg-white transition-transform ${A?"translate-x-9":"translate-x-1"}`})})]}),l.jsx("p",{className:`text-sm ${A?"text-slate-400":"text-slate-600"}`,children:"The theme applies system-wide to all screens, maintaining consistent readability and navigation across the application."})]}),l.jsx("div",{className:`rounded-2xl shadow-lg border p-6 ${A?"bg-[#1a1a1a] border-slate-700":"bg-white border-slate-200"}`,children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:`text-lg font-semibold mb-1 ${A?"text-white":"text-slate-800"}`,children:"Real-Time Updates"}),l.jsx("p",{className:`text-sm ${A?"text-slate-400":"text-slate-600"}`,children:co?"Disabled - Reduces Firestore quota usage by 90%+. Data loads once but won't update automatically.":"Enabled - Dashboard updates automatically when data changes. Uses more Firestore reads."}),co&&l.jsx("p",{className:`text-xs mt-2 ${A?"text-red-300":"text-amber-600"}`,children:" Refresh the page after toggling for changes to take effect."})]}),l.jsx("button",{type:"button",onClick:async()=>{const g=!co;try{if(g?localStorage.setItem("disableRealtimeUpdates","true"):localStorage.removeItem("disableRealtimeUpdates"),fl(g),bt)try{const k=await Yn(bt),N={...k,preferences:{...(k==null?void 0:k.preferences)||{},disableRealtimeUpdates:g}};await Ns("professors",bt,N,{merge:!0}),console.log(" Real-time preference saved to Firestore")}catch(k){console.warn("Could not save to Firestore, using localStorage backup:",k.message)}gt("info","Real-Time Updates",g?"Real-time updates disabled. Refresh page to apply. This reduces Firestore quota usage significantly.":"Real-time updates enabled. Refresh page to apply.",!1)}catch(k){console.error("Failed to update real-time settings:",k)}},className:`relative inline-flex h-8 w-16 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-[#7A1315] focus:ring-offset-2 ${co?"bg-slate-400":"bg-[#7A1315]"}`,"aria-label":"Toggle real-time updates",children:l.jsx("span",{className:`inline-block h-6 w-6 transform rounded-full bg-white transition-transform ${co?"translate-x-1":"translate-x-9"}`})})]})})]})]})]})})]})}),Gn&&l.jsx("div",{className:"fixed inset-0 modal items-center justify-center z-50 p-4 flex",onClick:()=>{$n(!1),Ur("import"),Le([]),Je([]),Pe(!1),Tt(""),jr(!1),zt(null),Zt(null),or([])},children:l.jsxs("div",{className:"glass rounded-2xl p-8 w-full max-w-2xl shadow-2xl max-h-[90vh] overflow-hidden flex flex-col",onClick:g=>g.stopPropagation(),children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsxs("div",{className:"relative w-24 h-24 mx-auto mb-5",children:[l.jsx("div",{className:"absolute inset-0 rounded-3xl bg-gradient-to-br from-[#7A1315] via-[#b11e22] to-[#f97373] shadow-2xl flex items-center justify-center border-2 border-white/20 transform rotate-3 hover:rotate-6 transition-transform duration-300",children:l.jsx("svg",{className:"w-12 h-12 text-white drop-shadow-lg",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 12a4 4 0 100-8 4 4 0 000 8zM4 20a8 8 0 0116 0v1.25A.75.75 0 0119.25 22H4.75A.75.75 0 014 21.25V20z"})})}),l.jsx("span",{className:"absolute -bottom-1 -right-1 inline-flex items-center justify-center w-7 h-7 rounded-full bg-white text-[#7A1315] shadow-xl border-2 border-red-100 animate-pulse",children:l.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z"})})})]}),l.jsx("h3",{className:`text-3xl font-bold mb-2 ${A?"text-white":"text-slate-800"}`,children:"Student Management"}),l.jsx("p",{className:`text-sm ${A?"text-slate-400":"text-slate-600"}`,children:"Enroll existing students or create new profiles"})]}),l.jsxs("div",{className:`flex flex-col gap-4 mb-6 border-b pb-4 ${A?"border-slate-800":"border-slate-200"}`,children:[l.jsxs("div",{className:`flex flex-wrap gap-2 p-1 rounded-2xl shadow-inner ${A?"bg-[#111317]":"bg-slate-100"}`,children:[l.jsx("button",{onClick:()=>{Ur("import"),Zt(null),or([])},className:`px-5 py-2.5 rounded-xl font-semibold transition-all ${kr==="import"?A?"bg-[#7A1315] text-white shadow-lg shadow-red-900/40":"bg-white text-maroon-600 shadow-md":A?"text-slate-300 hover:text-white":"text-slate-600 hover:text-slate-800"}`,children:"Import File"}),l.jsx("button",{onClick:()=>{Ur("archived"),Le([]),Je([]),Pe(!1),Tt(""),jr(!1)},className:`px-5 py-2.5 rounded-xl font-semibold transition-all ${kr==="archived"?A?"bg-[#7A1315] text-white shadow-lg shadow-red-900/40":"bg-white text-maroon-600 shadow-md":A?"text-slate-300 hover:text-white":"text-slate-600 hover:text-slate-800"}`,children:"Archived Students"}),l.jsx("button",{onClick:()=>{Ur("create"),Le([]),Je([]),Pe(!1),Tt(""),jr(!1)},className:`px-5 py-2.5 rounded-xl font-semibold transition-all ${kr==="create"?A?"bg-[#7A1315] text-white shadow-lg shadow-red-900/40":"bg-white text-maroon-600 shadow-md":A?"text-slate-300 hover:text-white":"text-slate-600 hover:text-slate-800"}`,children:"Create New Student"})]}),kr==="import"&&(kt==null?void 0:kt.length)>0&&l.jsx("div",{className:"flex flex-col gap-2 mt-2",children:kt.map((g,k)=>l.jsxs("div",{className:`flex items-start gap-3 rounded-xl px-4 py-3 border text-sm ${g.type==="error"?A?"bg-red-900/20 border-red-700 text-red-100":"bg-red-50 border-red-200 text-red-700":g.type==="success"?A?"bg-emerald-900/20 border-emerald-700 text-emerald-100":"bg-emerald-50 border-emerald-200 text-emerald-700":A?"bg-amber-900/20 border-amber-700 text-amber-100":"bg-amber-50 border-amber-200 text-amber-700"}`,children:[l.jsx("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01M4.93 4.93l14.14 14.14M12 2a10 10 0 100 20 10 10 0 000-20z"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-semibold",children:g.title||"Import Warning"}),l.jsx("p",{children:g.message})]}),l.jsx("button",{type:"button",onClick:()=>{vt(N=>N.filter((j,P)=>P!==k))},className:`text-xs font-semibold px-2 py-1 rounded-lg ${g.type==="error"?A?"bg-red-800 text-white":"bg-red-600 text-white":g.type==="success"?A?"bg-emerald-800 text-white":"bg-emerald-600 text-white":A?"bg-amber-800 text-white":"bg-amber-600 text-white"}`,children:"Dismiss"})]},`csv-warning-modal-${k}`))}),kr==="archived"&&l.jsx("div",{className:"flex items-center",children:l.jsxs("div",{className:"relative flex-1 max-w-md",children:[l.jsx("input",{type:"text",placeholder:"Search by name or ID...",value:Dt,onChange:g=>{Tt(g.target.value),jr(!0)},onFocus:()=>{Dt.trim()&&jr(!0)},onBlur:()=>{setTimeout(()=>jr(!1),200)},className:`w-full pl-10 pr-10 py-2.5 rounded-xl border focus:ring-2 focus:ring-maroon-500 focus:outline-none text-sm ${A?"bg-[#1b1b1b] text-white border-slate-600 placeholder-slate-400":"bg-white text-slate-800 border-slate-300 placeholder-slate-400"}`}),l.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),Dt&&l.jsx("button",{onClick:()=>{Tt(""),jr(!1)},className:`absolute right-3 top-1/2 transform -translate-y-1/2 ${A?"text-slate-400 hover:text-slate-300":"text-slate-400 hover:text-slate-600"}`,children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),dr&&Dt.trim()&&(()=>{const g=_e.filter(k=>{var U,M;if(!(Ke.length===0?(k.archivedSubjects||[]).length>0:Ke.some(q=>(k.archivedSubjects||[]).includes(q))))return!1;const j=Dt.toLowerCase().trim(),P=((U=k.name)==null?void 0:U.toLowerCase().includes(j))||!1,D=((M=k.id)==null?void 0:M.toString().includes(j))||!1;return P||D}).slice(0,10);return g.length===0?null:l.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-slate-300 rounded-lg shadow-lg max-h-64 overflow-y-auto",children:g.map(k=>{const N=Re(k.id),j=Xr.has(N);return l.jsxs("div",{onMouseDown:P=>{P.preventDefault(),Le(j?ve.filter(D=>Re(D)!==N):[...ve,N]),jr(!1),Pe(!1)},className:`px-4 py-2 cursor-pointer hover:bg-amber-50 transition-colors flex items-center justify-between ${j?"bg-amber-100":""}`,children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"font-medium text-slate-800",children:k.name}),l.jsxs("div",{className:"text-xs text-slate-500",children:["ID: ",k.id]})]}),j&&l.jsx("svg",{className:"w-5 h-5 text-maroon-600",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},k.id)})})})()]})})]}),l.jsx("div",{className:"flex-1 overflow-y-auto",children:kr==="import"?l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:`rounded-3xl border-2 shadow-xl px-6 py-6 ${A?"bg-gradient-to-br from-[#1b1b1b] to-[#151515] border-slate-700":"bg-gradient-to-br from-white to-slate-50 border-slate-200"}`,children:[l.jsxs("div",{className:"flex items-start justify-between mb-5",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[l.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center font-bold text-sm ${A?"bg-[#7A1315]/30 text-red-400 border border-[#7A1315]/50":"bg-[#7A1315]/10 text-[#7A1315] border border-[#7A1315]/20"}`,children:"1"}),l.jsxs("div",{children:[l.jsx("p",{className:`text-xs uppercase tracking-wider font-bold mb-1 ${A?"text-slate-400":"text-slate-500"}`,children:"Step 1"}),l.jsx("h4",{className:`text-xl font-bold ${A?"text-white":"text-slate-900"}`,children:"Select Subject to Enroll"})]})]}),l.jsx("p",{className:`text-sm ml-13 ${A?"text-slate-400":"text-slate-600"}`,children:"Choose the class that will receive the uploaded students."})]}),l.jsxs("div",{className:`hidden md:flex items-center px-4 py-2 rounded-xl text-xs font-bold shadow-sm ${A?"bg-gradient-to-r from-slate-800 to-slate-700 text-slate-200 border border-slate-600":"bg-gradient-to-r from-slate-100 to-slate-50 text-slate-700 border border-slate-200"}`,children:[l.jsx("svg",{className:"w-4 h-4 mr-1.5",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"})}),me.length," available"]})]}),l.jsxs("div",{className:"mt-5",children:[l.jsxs("select",{value:ut||"",onChange:g=>Vs(g.target.value),className:`w-full px-4 py-3 rounded-xl border-2 font-medium transition-all ${A?"bg-[#111827] border-slate-600 text-slate-100 focus:border-[#7A1315] focus:ring-2 focus:ring-[#7A1315]/20":"bg-white border-slate-300 text-slate-800 focus:border-[#7A1315] focus:ring-2 focus:ring-[#7A1315]/20"}`,required:!0,children:[l.jsx("option",{value:"",children:"-- Select a Subject --"}),me.map(g=>l.jsxs("option",{value:g.code,children:[g.code,"  ",g.name]},g.code))]}),!ut&&l.jsxs("div",{className:`mt-3 p-3 rounded-xl flex items-start gap-2 ${A?"bg-amber-900/20 border border-amber-800/50":"bg-amber-50 border border-amber-200"}`,children:[l.jsx("svg",{className:`w-5 h-5 flex-shrink-0 mt-0.5 ${A?"text-amber-400":"text-amber-600"}`,fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),l.jsx("p",{className:`text-xs font-medium ${A?"text-amber-300":"text-amber-700"}`,children:"Please select a subject to enable the import button."})]})]})]}),l.jsxs("div",{className:`rounded-3xl border-2 shadow-xl px-6 py-6 ${A?"bg-gradient-to-br from-[#1b1b1b] to-[#151515] border-slate-700":"bg-gradient-to-br from-white to-slate-50 border-slate-200"}`,children:[l.jsxs("div",{className:"flex items-start justify-between mb-5",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[l.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center font-bold text-sm ${A?"bg-[#7A1315]/30 text-red-400 border border-[#7A1315]/50":"bg-[#7A1315]/10 text-[#7A1315] border border-[#7A1315]/20"}`,children:"2"}),l.jsxs("div",{children:[l.jsx("p",{className:`text-xs uppercase tracking-wider font-bold mb-1 ${A?"text-slate-400":"text-slate-500"}`,children:"Step 2"}),l.jsx("h4",{className:`text-xl font-bold ${A?"text-white":"text-slate-900"}`,children:"Upload CSV or Excel File"})]})]}),l.jsx("p",{className:`text-sm ml-13 ${A?"text-slate-400":"text-slate-600"}`,children:"Use the official template (ID, Name, Email). We'll validate everything before saving."})]}),$e&&l.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 rounded-xl text-xs font-bold shadow-sm ${A?"bg-gradient-to-r from-emerald-500/20 to-emerald-600/20 text-emerald-300 border border-emerald-500/30":"bg-gradient-to-r from-emerald-100 to-emerald-50 text-emerald-700 border border-emerald-200"}`,children:[l.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Math.round($e.size/1024)," KB"]})]}),l.jsxs("div",{className:`border-2 border-dashed rounded-2xl p-8 text-center transition-all duration-300 ${A?$e?"border-[#7A1315]/50 bg-[#7A1315]/10 ring-2 ring-[#7A1315]/30":"border-slate-600 bg-[#151515]/60 hover:border-slate-500 hover:bg-[#151515]/80":$e?"border-[#7A1315]/50 bg-[#7A1315]/5 ring-2 ring-[#7A1315]/20":"border-slate-300 bg-slate-50/70 hover:border-[#7A1315]/30 hover:bg-slate-100/70"}`,children:[l.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:g=>{const k=g.target.files[0];k?(Zt(k),or([]),mN(k)):(Zt(null),or([]))},className:"hidden",id:"csvFileInput"}),l.jsxs("label",{htmlFor:"csvFileInput",className:"cursor-pointer flex flex-col items-center space-y-4",children:[l.jsx("div",{className:`w-20 h-20 rounded-2xl flex items-center justify-center ${A?$e?"bg-[#7A1315]/20":"bg-slate-800/50":$e?"bg-[#7A1315]/10":"bg-slate-100"}`,children:l.jsx("svg",{className:`w-10 h-10 ${$e?"text-[#7A1315]":A?"text-slate-400":"text-slate-500"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),l.jsxs("div",{children:[l.jsx("span",{className:`text-base font-bold block mb-1 ${A?"text-white":"text-slate-800"}`,children:$e?l.jsxs("span",{className:"flex items-center gap-2",children:[l.jsx("svg",{className:"w-5 h-5 text-emerald-500",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),$e.name]}):"Click to upload CSV or Excel file"}),l.jsx("span",{className:`text-xs block mt-2 ${A?"text-slate-400":"text-slate-500"}`,children:"Supported formats: CSV, XLSX, XLS  Required columns: ID, Name, Email"})]})]}),$e&&l.jsx("button",{onClick:g=>{g.stopPropagation(),Zt(null),or([]);const k=document.getElementById("csvFileInput");k&&(k.value="")},className:`mt-4 px-4 py-2 rounded-lg text-xs font-semibold transition-all ${A?"bg-red-900/30 text-red-400 hover:bg-red-900/50 border border-red-800/50":"bg-red-50 text-red-600 hover:bg-red-100 border border-red-200"}`,children:l.jsxs("span",{className:"flex items-center gap-1.5",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Remove file"]})})]})]}),Wt.length>0?(()=>{const g=new Map;Wt.forEach((j,P)=>{const D=Re((j.id||"").trim());D&&(g.has(D)?g.get(D).push(P):g.set(D,[P]))});const k=new Set;g.forEach(j=>{j.length>1&&j.forEach(P=>k.add(P))});const N=new Set((ae[ut]||[]).map(j=>Re(j)));return l.jsxs("div",{className:`rounded-3xl border-2 shadow-xl overflow-hidden ${A?"bg-gradient-to-br from-[#1b1b1b] to-[#151515] border-slate-700":"bg-gradient-to-br from-white to-slate-50 border-slate-200"}`,children:[l.jsxs("div",{className:`flex items-center justify-between px-6 py-4 border-b ${A?"border-slate-700 bg-slate-800/30":"border-slate-200 bg-slate-50"}`,children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center font-bold text-sm ${A?"bg-[#7A1315]/30 text-red-400 border border-[#7A1315]/50":"bg-[#7A1315]/10 text-[#7A1315] border border-[#7A1315]/20"}`,children:"3"}),l.jsxs("div",{children:[l.jsx("p",{className:`text-xs uppercase tracking-wider font-bold mb-1 ${A?"text-slate-400":"text-slate-500"}`,children:"Step 3"}),l.jsxs("h4",{className:`text-lg font-bold ${A?"text-white":"text-slate-900"}`,children:["Preview (",Wt.length," ",Wt.length===1?"student":"students",")",k.size>0&&l.jsxs("span",{className:`ml-2 text-xs font-normal ${A?"text-amber-400":"text-amber-600"}`,children:["(",k.size," duplicate",k.size>1?"s":"",")"]})]})]})]}),l.jsx("button",{className:`text-xs font-bold px-4 py-2 rounded-xl transition-all ${A?"bg-slate-700 text-slate-200 hover:bg-slate-600 border border-slate-600":"bg-slate-100 text-slate-700 hover:bg-slate-200 border border-slate-200"}`,onClick:()=>or([]),children:"Clear Preview"})]}),l.jsx("div",{className:"max-h-64 overflow-y-auto",children:l.jsxs("table",{className:"min-w-full",children:[l.jsx("thead",{className:A?"bg-slate-800/50 sticky top-0":"bg-slate-100 sticky top-0",children:l.jsxs("tr",{children:[l.jsx("th",{className:`px-4 py-3 text-left text-xs font-bold uppercase tracking-wider ${A?"text-slate-300":"text-slate-600"}`,children:"ID"}),l.jsx("th",{className:`px-4 py-3 text-left text-xs font-bold uppercase tracking-wider ${A?"text-slate-300":"text-slate-600"}`,children:"Name"}),l.jsx("th",{className:`px-4 py-3 text-left text-xs font-bold uppercase tracking-wider ${A?"text-slate-300":"text-slate-600"}`,children:"Email"}),l.jsx("th",{className:`px-4 py-3 text-left text-xs font-bold uppercase tracking-wider ${A?"text-slate-300":"text-slate-600"}`,children:"Status"})]})}),l.jsx("tbody",{className:A?"divide-slate-800":"divide-slate-200",children:Wt.map((j,P)=>{const D=Re((j.id||"").trim()),U=k.has(P),M=N.has(D);return l.jsxs("tr",{className:`${U||M?A?"bg-amber-900/20 border-l-4 border-amber-600":"bg-amber-50 border-l-4 border-amber-400":A?P%2===0?"bg-[#1a1a1a]":"bg-[#151515]":P%2===0?"bg-white":"bg-slate-50/50"} hover:bg-opacity-80 transition-colors`,children:[l.jsx("td",{className:`px-4 py-3 text-sm font-semibold ${A?"text-white":"text-slate-800"}`,children:j.id}),l.jsx("td",{className:`px-4 py-3 text-sm ${A?"text-slate-200":"text-slate-800"}`,children:j.name}),l.jsx("td",{className:`px-4 py-3 text-sm ${A?"text-slate-400":"text-slate-600"}`,children:j.email?j.email:"N/A"}),l.jsxs("td",{className:"px-4 py-3",children:[U&&l.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-lg text-xs font-semibold ${A?"bg-amber-900/40 text-amber-300 border border-amber-700":"bg-amber-100 text-amber-700 border border-amber-300"}`,children:[l.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),"Duplicate"]}),!U&&M&&l.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-lg text-xs font-semibold ${A?"bg-blue-900/40 text-blue-300 border border-blue-700":"bg-blue-100 text-blue-700 border border-blue-300"}`,children:[l.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Enrolled"]}),!U&&!M&&l.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-lg text-xs font-semibold ${A?"bg-emerald-900/40 text-emerald-300 border border-emerald-700":"bg-emerald-100 text-emerald-700 border border-emerald-300"}`,children:[l.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 4v16m8-8H4"})}),"New"]})]})]},P)})})]})})]})})():$e?l.jsxs("div",{className:`mt-4 p-4 rounded-2xl border ${A?"bg-amber-900/20 border-amber-700 text-amber-200":"bg-amber-50 border-amber-200 text-amber-800"}`,children:[l.jsx("p",{className:"text-sm font-semibold",children:" No data found in file"}),l.jsx("p",{className:"text-xs mt-1",children:'Please check that your file contains columns labeled "ID" (or "Student ID") and "Name" (or "Student Name").'}),l.jsx("p",{className:"text-xs mt-1",children:"Check the browser console (F12) for detailed parsing information."})]}):null,l.jsxs("div",{className:`flex flex-col sm:flex-row sm:justify-end sm:items-center gap-3 pt-6 border-t-2 ${A?"border-slate-700":"border-slate-200"}`,children:[l.jsx("button",{onClick:()=>{$n(!1),Zt(null),or([]),Vs("")},className:`px-6 py-3 rounded-xl font-semibold transition-all ${A?"text-slate-300 hover:text-white hover:bg-slate-800":"text-slate-600 hover:text-slate-800 hover:bg-slate-100"}`,children:"Cancel"}),l.jsxs("button",{type:"button",onClick:async g=>{if(g.preventDefault(),g.stopPropagation(),console.log(" Add Student button clicked:",{csvFile:$e==null?void 0:$e.name,subject:ut,previewCount:Wt.length,hasFile:!!$e,hasSubject:!!ut,isImporting:Hr,previewData:Wt,subjectsAvailable:me.length}),!$e){console.error(" Validation failed: No file"),gt("error","No File","Please upload a CSV or Excel file first.",!1);return}if(!ut){console.error(" Validation failed: No subject selected"),gt("error","No Subject Selected","Please select a subject to enroll students.",!1);return}if(Wt.length===0){console.error(" Validation failed: No preview data",{csvPreview:Wt}),gt("error","No Data","The file appears to be empty or could not be parsed. Please check the file format and try again.",!1);return}try{console.log(" All validations passed, calling handleImportCSV..."),await pN(),console.log(" handleImportCSV completed")}catch(k){console.error(" Error in handleImportCSV:",k),vt(N=>[...N,{type:"error",title:"Import Failed",message:`Failed to import students: ${k.message}. Please check the console (F12) for details.`,summary:!0}])}},disabled:!$e||!ut||Wt.length===0||Hr,className:"group relative overflow-hidden px-8 py-3 rounded-xl font-bold text-white shadow-xl hover:shadow-2xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed bg-gradient-to-r from-[#7A1315] to-[#b91c1c] hover:from-[#8a1518] hover:to-[#c91d1d]",title:$e?ut?Wt.length===0?"No data found. Check console (F12) for details. Expected: ID, Name, Email columns.":Hr?"Import in progress...":`Click to import ${Wt.length} student${Wt.length!==1?"s":""}`:"Please select a subject first":"Please upload a file first",children:[l.jsx("div",{className:"absolute inset-0 bg-white opacity-0 group-hover:opacity-10 transition-opacity"}),l.jsx("span",{className:"relative z-10 flex items-center gap-2",children:Hr?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin w-5 h-5",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Importing..."]}):l.jsxs(l.Fragment,{children:[l.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 4v16m8-8H4"})}),"Add Student",Wt.length>0?` (${Wt.length})`:""]})})]})]})]}):kr==="archived"?l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:`rounded-2xl border shadow-md px-5 py-4 ${A?"bg-[#1b1b1b] border-slate-700":"bg-white border-slate-200"}`,children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-xs uppercase tracking-wider font-semibold text-maroon-500 mb-1",children:"Recovery Scope"}),l.jsx("h4",{className:`text-base font-bold ${A?"text-white":"text-slate-900"}`,children:"Select Subjects to Restore From"}),l.jsx("p",{className:`text-xs mt-1 ${A?"text-slate-400":"text-slate-500"}`,children:"Choose one or more subjects to re-enroll archived students."})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{type:"button",onClick:()=>Je([]),className:`px-3 py-1.5 text-xs font-semibold rounded-lg transition-colors ${A?"bg-slate-700 text-slate-300 hover:bg-slate-600":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:"Clear"}),l.jsx("button",{type:"button",onClick:()=>{const g=me.map(k=>k.code);Je(g)},className:`px-3 py-1.5 text-xs font-semibold rounded-lg transition-colors ${A?"bg-emerald-700 text-white hover:bg-emerald-600":"bg-emerald-100 text-emerald-700 hover:bg-emerald-200"}`,children:"Select All"})]})]}),l.jsxs("div",{className:"mt-4 relative",ref:fc,children:[l.jsxs("button",{type:"button",onClick:()=>dc(g=>!g),className:`w-full flex items-center justify-between rounded-xl border px-4 py-3 text-left transition-all hover:shadow-md ${A?"border-slate-600 bg-[#0f0f0f] hover:bg-[#151515]":"border-slate-300 bg-white hover:border-maroon-300"}`,children:[l.jsxs("div",{className:"pr-4 flex-1 min-w-0",children:[l.jsx("p",{className:`text-xs font-medium mb-1 ${A?"text-slate-400":"text-slate-500"}`,children:Ke.length>0?`${Ke.length} subject${Ke.length===1?"":"s"} selected`:"No subjects selected"}),l.jsx("p",{className:`text-sm font-semibold ${A?"text-white":"text-slate-800"} truncate`,children:Ke.length>0?Ke.map(li).join(", "):"Click to choose subjects"})]}),l.jsx("svg",{className:`w-5 h-5 flex-shrink-0 transition-transform ${Du?"rotate-180":""} ${A?"text-slate-400":"text-maroon-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),Du&&l.jsxs("div",{className:"absolute z-40 mt-2 w-full rounded-2xl border shadow-2xl bg-white border-slate-200",children:[l.jsx("div",{className:"max-h-56 overflow-y-auto divide-y divide-slate-100",children:me.length===0?l.jsx("p",{className:`text-sm px-4 py-3 ${A?"text-slate-400":"text-slate-500"}`,children:"No subjects available."}):me.map(g=>{const k=Ke.includes(g.code);return l.jsxs("label",{className:"flex items-center justify-between px-4 py-2 cursor-pointer hover:bg-slate-50",onMouseDown:N=>N.preventDefault(),children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("input",{type:"checkbox",checked:k,onChange:()=>IC(g.code),className:"form-checkbox h-4 w-4 text-maroon-600 rounded"}),l.jsxs("span",{className:A?"text-white":"text-slate-800",children:[g.code,"  ",g.name]})]}),k&&l.jsx("svg",{className:"w-4 h-4 text-maroon-600",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},g.code)})}),l.jsx("div",{className:`flex items-center justify-end gap-3 px-4 py-2 border-t ${A?"border-slate-700":"border-slate-100"}`,children:l.jsx("button",{type:"button",onClick:()=>dc(!1),className:"text-sm font-semibold text-maroon-600 hover:text-maroon-800",children:"Done"})})]})]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:`flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4 p-4 rounded-xl ${A?"bg-[#1b1b1b] border border-slate-700":"bg-slate-50 border border-slate-200"}`,children:[l.jsxs("div",{children:[l.jsx("label",{className:`block text-sm font-bold ${A?"text-white":"text-slate-800"}`,children:"Select Archived Students"}),l.jsxs("p",{className:`text-xs mt-1 ${A?"text-slate-400":"text-slate-500"}`,children:[ve.length," student",ve.length===1?"":"s"," selected"]})]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("button",{onClick:()=>{const g=_e.filter(k=>{var U,M;if(!(Ke.length===0?(k.archivedSubjects||[]).length>0:Ke.some(q=>(k.archivedSubjects||[]).includes(q))))return!1;if(Dt.trim()==="")return!0;const j=Dt.toLowerCase().trim(),P=((U=k.name)==null?void 0:U.toLowerCase().includes(j))||!1,D=((M=k.id)==null?void 0:M.toString().includes(j))||!1;return P||D});Se?(Le([]),Pe(!1)):(Le(g.map(k=>Re(k.id)).filter(Boolean)),Pe(!0))},className:`px-4 py-2 rounded-lg font-semibold text-sm transition-all shadow-sm ${Se?"bg-maroon-600 text-white hover:bg-maroon-700":A?"bg-slate-700 text-slate-300 hover:bg-slate-600":"bg-slate-200 text-slate-700 hover:bg-slate-300"}`,children:Se?"Deselect All":"Select All"}),l.jsx("button",{onClick:async()=>{if(ve.length===0){gt("warning","No Selection","Please select at least one archived student to delete.",!1);return}if(!window.confirm(`Delete ${ve.length} selected student(s)? This action cannot be undone.`))return;const g=new Set(ve.map(Re));let k={...ae};Object.keys(k).forEach(M=>{k[M]=(k[M]||[]).filter(q=>!g.has(Re(q)))});const N=_e.filter(M=>!g.has(Re(M.id))),j={...ge};Object.keys(j).forEach(M=>{const q=j[M];q&&Xr.has(Re(q.studentId))&&delete j[M]});const P={...Ne};Object.keys(P).forEach(M=>{const q=P[M];q&&Xr.has(Re(q.studentId))&&delete P[M]}),Q(N),yr(k),W(j),Ve(P);const U=[{id:Date.now(),type:"general",title:"Students Deleted",message:`Deleted ${ve.length} archived student(s).`,timestamp:new Date,read:!1},...ne];Ae(U),await vn(me,N,k,U,P,j,bt,!0),Le([]),Pe(!1),gt("success","Students Deleted","Selected archived students were removed permanently.",!1)},disabled:ve.length===0,className:`px-4 py-2 rounded-lg font-semibold text-sm transition-all shadow-sm ${ve.length===0?A?"bg-red-900/30 text-red-400 cursor-not-allowed border border-red-800":"bg-red-100 text-red-400 cursor-not-allowed border border-red-200":"bg-red-600 text-white hover:bg-red-700"}`,children:"Delete Selected"})]})]}),l.jsx("div",{className:`border rounded-2xl overflow-hidden shadow-inner ${A?"border-slate-700 bg-[#1b1b1b]":"border-amber-200 bg-gradient-to-br from-amber-50/60 to-amber-100/30"}`,children:l.jsxs("div",{className:"max-h-72 overflow-y-auto custom-scrollbar",children:[_e.filter(g=>{var D,U;if(!(Ke.length===0?(g.archivedSubjects||[]).length>0:Ke.some(M=>(g.archivedSubjects||[]).includes(M))))return!1;if(Dt.trim()==="")return!0;const N=Dt.toLowerCase().trim(),j=((D=g.name)==null?void 0:D.toLowerCase().includes(N))||!1,P=((U=g.id)==null?void 0:U.toString().includes(N))||!1;return j||P}).map(g=>{const k=Re(g.id),N=Xr.has(k),j=Object.keys(ae).filter(U=>(ae[U]||[]).some(M=>Re(M)===k)),P=g.archivedSubjects||[],D=Ke.length>0?P.filter(U=>Ke.includes(U)):P;return l.jsxs("div",{children:[l.jsxs("div",{className:`flex items-center space-x-3 px-4 py-3 border-b transition-colors cursor-pointer ${N?A?"bg-slate-700/50 border-slate-600":"bg-amber-100 border-amber-200":A?"border-slate-700 hover:bg-slate-800/50":"border-amber-100 hover:bg-amber-50"}`,onClick:U=>{U.target.type!=="checkbox"&&zt($t===g.id?null:g.id)},children:[l.jsx("input",{type:"checkbox",checked:N,onChange:U=>{U.stopPropagation(),U.target.checked?(Le([...ve,k]),Pe(!1)):(Le(ve.filter(M=>Re(M)!==k)),Pe(!1))},onClick:U=>U.stopPropagation(),className:"w-5 h-5 text-maroon-600 border-slate-300 rounded focus:ring-maroon-500 cursor-pointer"}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-sm font-semibold text-amber-900",children:g.name}),l.jsxs("div",{className:"text-xs text-amber-700",children:["ID: ",g.id]}),D.length>0&&l.jsxs("div",{className:"text-xs text-amber-600 mt-1",children:["Archived from ",D.length," selected subject(s)"]}),j.length>0&&l.jsxs("div",{className:"text-xs text-slate-400 mt-1",children:["Also enrolled in ",j.length," other subject(s)"]})]}),l.jsx("svg",{className:`w-5 h-5 text-amber-600 transition-transform ${$t===g.id?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),$t===g.id&&l.jsxs("div",{className:"bg-amber-50 border-l-4 border-amber-400 px-4 py-4 space-y-4",children:[l.jsxs("div",{children:[l.jsxs("h5",{className:"text-sm font-bold text-amber-900 mb-2 flex items-center",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),"Removed Subjects (Archived History)"]}),P.length>0?l.jsx("div",{className:"space-y-2",children:P.map(U=>{const M=me.find(q=>q.code===U);return l.jsxs("div",{className:"bg-white rounded-lg p-3 border border-amber-200",children:[l.jsx("div",{className:"text-sm font-semibold text-amber-900",children:M?M.name:U}),l.jsx("div",{className:"text-xs text-amber-600 mt-1",children:M?`${M.code}  ${M.credits} Credits`:U})]},U)})}):l.jsx("div",{className:"text-sm text-amber-600 italic bg-white rounded-lg p-3 border border-amber-200",children:"No archived subjects"})]}),l.jsxs("div",{children:[l.jsxs("h5",{className:"text-sm font-bold text-emerald-900 mb-2 flex items-center",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Enrolled Subjects (Active Status)"]}),j.length>0?l.jsx("div",{className:"space-y-2",children:j.map(U=>{const M=me.find(q=>q.code===U);return l.jsxs("div",{className:"bg-white rounded-lg p-3 border border-emerald-200",children:[l.jsx("div",{className:"text-sm font-semibold text-emerald-900",children:M?M.name:U}),l.jsx("div",{className:"text-xs text-emerald-600 mt-1",children:M?`${M.code}  ${M.credits} Credits`:U})]},U)})}):l.jsx("div",{className:"text-sm text-emerald-600 italic bg-white rounded-lg p-3 border border-emerald-200",children:"Not currently enrolled in any subjects"})]})]})]},g.id)}),_e.filter(g=>{var D,U;if(!(Ke.length===0?(g.archivedSubjects||[]).length>0:Ke.some(M=>(g.archivedSubjects||[]).includes(M))))return!1;if(Dt.trim()==="")return!0;const N=Dt.toLowerCase().trim(),j=((D=g.name)==null?void 0:D.toLowerCase().includes(N))||!1,P=((U=g.id)==null?void 0:U.toString().includes(N))||!1;return j||P}).length===0&&l.jsx("div",{className:"px-4 py-8 text-center text-amber-600",children:Dt.trim()?`No archived students found matching "${Dt}" for the selected subjects.`:"No archived students found for the selected subjects."})]})})]})]}):l.jsxs("div",{className:"space-y-5",children:[l.jsxs("div",{className:`rounded-2xl border shadow-lg px-6 py-5 ${A?"bg-[#1b1b1b] border-slate-700":"bg-white border-slate-200"}`,children:[l.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-maroon-500",children:"Basic Information"}),l.jsx("h4",{className:`mt-1 text-lg font-bold ${A?"text-white":"text-slate-900"}`,children:"Create New Student Profile"}),l.jsx("p",{className:`text-sm mb-4 ${A?"text-slate-400":"text-slate-500"}`,children:"Enter the official student ID, full name, and institutional email. Well automatically create the profile."}),l.jsxs("div",{className:"space-y-4 mt-2",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"new-student-id",className:"sr-only",children:"Student ID"}),l.jsx("input",{id:"new-student-id",name:"new-student-id",type:"text",value:hr.id,onChange:g=>{const k=g.target.value.replace(/\D/g,"");gn(N=>({...N,id:k}))},placeholder:"Student ID",className:`form-input-field focus:ring-2 focus:ring-maroon-500 ${A?"bg-[#101010] border-slate-700 text-white placeholder:text-slate-500":""}`,pattern:"[0-9]*",inputMode:"numeric"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"new-student-name",className:"sr-only",children:"Student full name"}),l.jsx("input",{id:"new-student-name",name:"new-student-name",type:"text",value:hr.name,onChange:g=>gn(k=>({...k,name:g.target.value})),placeholder:"Student full name",className:`form-input-field focus:ring-2 focus:ring-maroon-500 ${A?"bg-[#101010] border-slate-700 text-white placeholder:text-slate-500":""}`})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"new-student-email",className:"sr-only",children:"Institutional email"}),l.jsx("input",{id:"new-student-email",name:"new-student-email",type:"email",value:hr.email,onChange:g=>gn(k=>({...k,email:g.target.value})),placeholder:"Institutional email",className:`form-input-field focus:ring-2 focus:ring-maroon-500 ${A?"bg-[#101010] border-slate-700 text-white placeholder:text-slate-500":""}`})]})]})]}),l.jsxs("div",{className:`rounded-2xl border shadow-lg px-6 py-5 ${A?"bg-[#1b1b1b] border-slate-700":"bg-white border-slate-200"}`,children:[l.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-maroon-500",children:"Enrollment"}),l.jsx("h4",{className:`mt-1 text-lg font-bold ${A?"text-white":"text-slate-900"}`,children:"Assign Subjects"}),l.jsx("p",{className:`text-sm mb-3 ${A?"text-slate-400":"text-slate-500"}`,children:"Select one or more subjects where this student should be enrolled immediately."}),l.jsxs("div",{className:"mt-3 relative",ref:hc,children:[l.jsxs("button",{type:"button",onClick:()=>Qn(g=>!g),className:`w-full flex items-center justify-between rounded-2xl border px-4 py-3 text-left transition-all ${A?"border-slate-600 bg-[#0f0f0f]":"border-slate-200 bg-white"}`,children:[l.jsxs("div",{className:"pr-4",children:[l.jsx("p",{className:`text-xs ${A?"text-slate-400":"text-slate-500"}`,children:((Ty=hr.subjects)==null?void 0:Ty.length)>0?`${hr.subjects.length} subject${hr.subjects.length===1?"":"s"} selected`:"No subjects selected"}),l.jsx("p",{className:`text-sm font-semibold ${A?"text-white":"text-slate-800"} truncate`,children:((ky=hr.subjects)==null?void 0:ky.length)>0?hr.subjects.map(li).join(", "):"Click to choose subjects"})]}),l.jsx("svg",{className:`w-5 h-5 flex-shrink-0 transition-transform ${ml?"rotate-180":""} ${A?"text-white":"text-maroon-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),ml&&l.jsxs("div",{className:"absolute z-40 mt-2 w-full rounded-2xl border shadow-2xl bg-white border-slate-200",children:[l.jsx("div",{className:"max-h-56 overflow-y-auto divide-y divide-slate-100",children:me.length===0?l.jsx("p",{className:`text-sm px-4 py-3 ${A?"text-slate-400":"text-slate-500"}`,children:"No subjects available. Create a subject first."}):me.map(g=>{const k=(hr.subjects||[]).includes(g.code);return l.jsxs("label",{className:"flex items-center justify-between px-4 py-2 cursor-pointer hover:bg-slate-50",onMouseDown:N=>N.preventDefault(),children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("input",{type:"checkbox",checked:k,onChange:()=>CC(g.code),className:"form-checkbox h-4 w-4 text-maroon-600 rounded"}),l.jsxs("span",{className:A?"text-white":"text-slate-800",children:[g.code,"  ",g.name]})]}),k&&l.jsx("svg",{className:"w-4 h-4 text-maroon-600",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},g.code)})}),l.jsxs("div",{className:`flex items-center justify-between px-4 py-2 border-t ${A?"border-slate-700":"border-slate-100"}`,children:[l.jsx("button",{type:"button",onClick:()=>gn(g=>({...g,subjects:[]})),className:"text-xs font-semibold text-slate-500 hover:text-slate-700",children:"Clear"}),l.jsx("button",{type:"button",onClick:()=>Qn(!1),className:"text-sm font-semibold text-maroon-600 hover:text-maroon-800",children:"Done"})]})]})]})]})]})}),kr!=="import"&&l.jsxs("div",{className:"flex justify-end space-x-4 mt-6 pt-6 border-t border-slate-200",children:[l.jsx("button",{type:"button",onClick:()=>{$n(!1),Ur("archived"),Le([]),Je([]),Pe(!1),zt(null)},className:"px-6 py-3 text-slate-600 hover:text-slate-800 font-medium rounded-xl hover:bg-slate-100 transition-all",children:"Cancel"}),kr==="archived"?l.jsx("button",{onClick:async()=>{try{if(ve.length===0){gt("warning","No Selection","Please select at least one archived student.",!1);return}if(Ke.length===0){gt("warning","No Subject Selected","Please select at least one subject to restore from.",!1);return}let g=0;const k=new Set;for(const N of ve){const j=_e.find(P=>Re(P.id)===Re(N));if(j)for(const P of Ke)(j.archivedSubjects||[]).includes(P)&&(await hN(N,P),g++,k.add(N))}if(g===0){gt("info","Nothing to Restore","Selected students are not archived in the selected subject(s).",!1);return}gt("success","Students Restored",`Successfully restored ${k.size} student(s) from ${Ke.length} subject(s).`,!1),$n(!1),Le([]),Je([]),Pe(!1)}catch(g){console.error("Error restoring students:",g),gt("error","Restore Failed",`Failed to restore students: ${g.message}`,!1)}},className:"btn text-white px-6 py-3 rounded-xl font-semibold shadowLg hover:shadow-xl transition-all duration-300",children:"Restore Selected Students"}):l.jsx("button",{onClick:async()=>{await cN(),$n(!1),Ur("enroll"),gn({id:"",name:"",email:"",subjects:[]})},className:"btn text-white px-6 py-3 rounded-xl font-semibold shadowLg hover:shadow-xl transition-all duration-300",children:"Add Student"})]})]})}),In&&ue&&l.jsx("div",{className:"fixed inset-0 modal items-center justify-center z-50 p-4 flex",onClick:()=>{ra(!1),ni(null),at([]),nt(""),Ut(!1),ur({id:"",name:"",email:""}),pn(null)},children:l.jsxs("div",{className:`glass rounded-2xl p-8 w-full max-w-md shadow-2xl ${A?"bg-[#1a1a1a] border border-slate-700":""}`,onClick:g=>g.stopPropagation(),children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsxs("div",{className:"w-16 h-16 bg-[#7A1315] rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg relative",children:[l.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z",fill:"currentColor"})}),l.jsx("div",{className:"absolute bottom-0 right-0 w-5 h-5 bg-white rounded-full flex items-center justify-center shadow-md",children:l.jsx("svg",{className:"w-3 h-3 text-[#7A1315]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:3,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})})})]}),l.jsx("h3",{className:`text-2xl font-bold mb-2 ${A?"text-white":"text-slate-800"}`,children:"Add Student to Subject"}),l.jsx("p",{className:A?"text-slate-300":"text-slate-600",children:(()=>{const g=me.find(k=>k.code===ue);return g?`Add student to ${g.name} (${g.code})`:"Select a student to enroll"})()})]}),l.jsxs("div",{className:"space-y-5",children:[Da&&l.jsxs("div",{className:`flex items-start gap-3 rounded-xl px-4 py-3 border text-sm ${A?"bg-red-900/20 border-red-700 text-red-100":"bg-red-50 border-red-200 text-red-700"}`,children:[l.jsx("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v4m0 4h.01M4.93 4.93l14.14 14.14M12 2a10 10 0 100 20 10 10 0 000-20z"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-semibold",children:"Student Already Enrolled in This Subject"}),l.jsx("p",{children:Da}),l.jsx("p",{className:"text-xs mt-1 opacity-75",children:"Note: Students can be enrolled in multiple subjects. This message only appears if they're already enrolled in the current subject."})]}),l.jsx("button",{type:"button",onClick:()=>pn(null),className:`text-xs font-semibold px-2 py-1 rounded-lg ${A?"bg-red-800 text-white":"bg-red-600 text-white"}`,children:"OK"})]}),l.jsxs("div",{className:"relative",children:[l.jsx("label",{className:`block text-sm font-semibold mb-2 ${A?"text-slate-300":"text-slate-700"}`,children:"Select Student"}),l.jsxs("button",{type:"button",onClick:()=>Ut(g=>!g),className:`w-full flex items-center justify-between rounded-xl px-4 py-3 text-sm border transition-all focus:ring-2 focus:ring-maroon-500 ${A?"bg-[#1a1a1a] text-white border-slate-600":"bg-white text-slate-800 border-slate-300"}`,children:[l.jsx("span",{children:We&&We.length>0?`${We.length} student${We.length===1?"":"s"} selected`:"Select Student"}),l.jsx("svg",{className:`w-5 h-5 transition-transform ${pt?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),pt&&l.jsxs("div",{className:`absolute z-50 mt-2 w-full rounded-xl border shadow-xl ${A?"bg-[#1a1a1a] border-slate-700":"bg-white border-slate-200"}`,children:[l.jsx("div",{className:"p-3 border-b border-slate-200/40",children:l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"text",value:wt,onChange:g=>nt(g.target.value),placeholder:"Search by name or ID...",className:`w-full rounded-lg px-4 py-2 text-sm border ${A?"bg-[#111111] text-white border-slate-600 placeholder:text-slate-400":"bg-white text-slate-800 border-slate-300 placeholder:text-slate-500"}`,autoFocus:!0}),l.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:l.jsx("svg",{className:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),l.jsxs("div",{className:"max-h-60 overflow-y-auto",children:[_e.filter(g=>{var N,j;if(!Re(g.id)||!g.id)return!1;if(wt.trim()){const P=wt.toLowerCase().trim(),D=((N=g.name)==null?void 0:N.toLowerCase().includes(P))||!1,U=((j=g.id)==null?void 0:j.toString().includes(P))||!1;if(!D&&!U)return!1}return!0}).map(g=>{const k=Re(g.id),N=We&&We.some(D=>Re(D)===k),j=(ae[ue]||[]).some(D=>Re(D)===k),P=(g.archivedSubjects||[]).includes(ue);return l.jsxs("label",{className:`w-full text-left px-4 py-2 text-sm flex items-start gap-3 border-b last:border-b-0 cursor-pointer ${N?A?"bg-slate-800":"bg-amber-50":""} ${A?"border-slate-800 hover:bg-slate-800":"border-slate-100 hover:bg-slate-50"}`,onMouseDown:D=>D.preventDefault(),children:[l.jsx("input",{type:"checkbox",checked:N,onChange:D=>{D.target.checked?at(U=>[...U,g.id]):at(U=>U.filter(M=>Re(M)!==k))},className:"mt-1 w-4 h-4 text-maroon-600 rounded focus:ring-maroon-500"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("span",{className:A?"text-white font-medium":"text-slate-800 font-medium",children:g.name}),l.jsxs("div",{className:A?"text-slate-400 text-xs":"text-slate-500 text-xs",children:["ID: ",g.id,j&&l.jsx("span",{className:"ml-2 text-emerald-600 font-semibold",children:"(Already Enrolled)"}),P&&l.jsx("span",{className:"ml-2 text-orange-600 font-semibold",children:"(Archived)"})]})]})]},g.id)}),_e.filter(g=>{var N,j;if(!Re(g.id)||!g.id)return!1;if(wt.trim()){const P=wt.toLowerCase().trim(),D=((N=g.name)==null?void 0:N.toLowerCase().includes(P))||!1,U=((j=g.id)==null?void 0:j.toString().includes(P))||!1;if(!D&&!U)return!1}return!0}).length===0&&l.jsx("div",{className:`px-4 py-6 text-center text-sm ${A?"text-slate-400":"text-slate-500"}`,children:wt.trim()?"No students found matching your search.":"No students available."})]})]})]}),l.jsxs("div",{className:`space-y-3 mt-4 border-t pt-4 ${A?"border-slate-600":"border-slate-200"}`,children:[l.jsx("p",{className:`text-sm font-semibold ${A?"text-slate-300":"text-slate-700"}`,children:"Or create new student:"}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"quick-student-id",className:"sr-only",children:"New Student ID"}),l.jsx("input",{id:"quick-student-id",name:"quick-student-id",type:"text",value:sr.id,onChange:g=>{const k=g.target.value.replace(/\D/g,"");ur(N=>({...N,id:k}))},placeholder:"New Student ID",className:`w-full rounded-xl px-4 py-3 text-sm border transition-all focus:ring-2 focus:ring-maroon-500 ${A?"bg-[#1a1a1a] text-white border-slate-600 placeholder:text-slate-400":"bg-white/80 text-slate-800 border-slate-200 placeholder:text-slate-500"}`,pattern:"[0-9]*",inputMode:"numeric"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"quick-student-name",className:"sr-only",children:"New Student Name"}),l.jsx("input",{id:"quick-student-name",name:"quick-student-name",type:"text",value:sr.name,onChange:g=>ur(k=>({...k,name:g.target.value})),placeholder:"New Student Name",className:`w-full rounded-xl px-4 py-3 text-sm border transition-all focus:ring-2 focus:ring-maroon-500 ${A?"bg-[#1a1a1a] text-white border-slate-600 placeholder:text-slate-400":"bg-white/80 text-slate-800 border-slate-200 placeholder:text-slate-500"}`})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"quick-student-email",className:"sr-only",children:"Email (optional)"}),l.jsx("input",{id:"quick-student-email",name:"quick-student-email",type:"email",value:sr.email,onChange:g=>ur(k=>({...k,email:g.target.value})),placeholder:"Email (optional)",className:`w-full rounded-xl px-4 py-3 text-sm border transition-all focus:ring-2 focus:ring-maroon-500 ${A?"bg-[#1a1a1a] text-white border-slate-600 placeholder:text-slate-400":"bg-white/80 text-slate-800 border-slate-200 placeholder:text-slate-500"}`})]})]})]}),l.jsxs("div",{className:"flex justify-end space-x-4 mt-8",children:[l.jsx("button",{type:"button",onClick:()=>{ra(!1),ni(null),at([]),nt(""),Ut(!1),ur({id:"",name:"",email:""}),pn(null)},className:`px-6 py-3 font-medium rounded-xl transition-all ${A?"text-slate-300 hover:text-white hover:bg-slate-700":"text-slate-600 hover:text-slate-800 hover:bg-slate-100"}`,children:"Cancel"}),l.jsx("button",{type:"button",onClick:async()=>{await uN()},disabled:Oa||We.length===0&&!sr.id.trim()&&!sr.name.trim(),className:`btn text-white px-6 py-3 rounded-xl font-semibold shadowLg hover:shadow-xl transition-all duration-300 ${Oa||We.length===0&&!sr.id.trim()&&!sr.name.trim()?"opacity-60 cursor-not-allowed":""}`,children:Oa?"Adding":We.length>0?`Add ${We.length} Student${We.length===1?"":"s"}`:"Add Student"})]})]})}),Fr&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm",onClick:dp,children:l.jsxs("div",{className:`rounded-2xl shadow-2xl max-w-md w-full mx-4 p-6 border ${A?"bg-[#1a1a1a] border-slate-700":"bg-white border-slate-200"}`,onClick:g=>g.stopPropagation(),children:[l.jsx("h2",{className:`text-lg font-semibold mb-2 text-center ${A?"text-white":"text-slate-900"}`,children:"Fill All Same Score"}),l.jsx("p",{className:`text-sm mb-6 text-center ${A?"text-slate-300":"text-slate-600"}`,children:"Enter the score to apply to all students:"}),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{htmlFor:"fill-score-input",className:"sr-only",children:"Score"}),l.jsx("input",{id:"fill-score-input",type:"number",min:"0",step:"0.01",value:ks,onChange:g=>qn(g.target.value),onKeyDown:g=>{g.key==="Enter"?by():g.key==="Escape"&&dp()},placeholder:"Enter score",autoFocus:!0,className:`w-full rounded-xl px-4 py-3 text-sm border transition-all focus:ring-2 focus:ring-maroon-500 ${A?"bg-[#1a1a1a] text-white border-slate-600 placeholder:text-slate-400":"bg-white text-slate-800 border-slate-300 placeholder:text-slate-500"}`,style:{MozAppearance:"textfield",WebkitAppearance:"none"}})]}),l.jsxs("div",{className:"flex items-center justify-center gap-3",children:[l.jsx("button",{type:"button",onClick:dp,className:`px-4 py-2 rounded-xl text-sm font-semibold border transition-all ${A?"border-slate-600 text-slate-300 bg-slate-800 hover:bg-slate-700":"border-slate-300 text-slate-700 bg-white hover:bg-slate-50"}`,children:"Cancel"}),l.jsx("button",{type:"button",onClick:by,className:"px-4 py-2 rounded-xl text-sm font-semibold text-white bg-[#7A1315] hover:bg-[#8a1a1c] shadow-md transition-all",children:"Apply"})]})]})})]})}function Z_({children:t,requiredRole:e="Professor"}){const[r,n]=G.useState(!0),[s,a]=G.useState(!1);return G.useEffect(()=>{const i=ep(async o=>{if(!o){a(!1),n(!1);return}try{let c=await IA(o.uid);if(c||(c=e==="Professor"?await Yn(o.uid):e==="Student"?await El(o.uid):null,c&&await Yh(o.uid,c)),c&&c.role===e)a(!0);else if(c)a(!1);else try{const u=sessionStorage.getItem("currentUser");u&&JSON.parse(u).type===e?a(!0):a(!1)}catch(u){console.warn("ProtectedRoute sessionStorage parse error",u),a(!1)}}catch(c){console.error("ProtectedRoute error fetching profile",c),a(!1)}finally{n(!1)}});return()=>i()},[e]),r?null:s?t:l.jsx(TT,{to:"/login",replace:!0})}function kq(){return l.jsx(KR,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:l.jsxs(HR,{children:[l.jsx(Ju,{path:"/",element:l.jsx(TT,{to:"/login",replace:!0})}),l.jsx(Ju,{path:"/login",element:l.jsx(A7,{})}),l.jsx(Ju,{path:"/student",element:l.jsx(Z_,{requiredRole:"Student",children:l.jsx(u9,{})})}),l.jsx(Ju,{path:"/prof",element:l.jsx(Z_,{requiredRole:"Professor",children:l.jsx(Tq,{})})})]})})}try{const t=document.getElementById("root");if(!t)throw new Error('Root element not found! Check index.html for <div id="root"></div>');vg.createRoot(t).render(l.jsx(uS.StrictMode,{children:l.jsx(kq,{})}))}catch(t){console.error(" Fatal error initializing React app:",t),document.body.innerHTML=`
    <div style="padding: 20px; font-family: Arial; text-align: center;">
      <h1 style="color: #7b1113;">Application Error</h1>
      <p>Failed to initialize the application.</p>
      <pre style="background: #f5f5f5; padding: 10px; border-radius: 5px; text-align: left; max-width: 600px; margin: 20px auto;">
${t.message}
${t.stack||""}
      </pre>
      <p>Please check the browser console (F12) for more details.</p>
    </div>
  `}
